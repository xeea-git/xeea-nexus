{"version":3,"sources":["../node_modules/@dagrejs/dagre/dist/dagre.js","../src/theme.ts","../src/parser.ts","../src/ascii/types.ts","../src/ascii/canvas.ts","../src/ascii/converter.ts","../src/ascii/pathfinder.ts","../src/ascii/edge-routing.ts","../src/ascii/draw.ts","../src/ascii/grid.ts","../src/sequence/parser.ts","../src/ascii/sequence.ts","../src/class/parser.ts","../src/ascii/class-diagram.ts","../src/er/parser.ts","../src/ascii/er-diagram.ts","../src/ascii/index.ts","../src/layout.ts","../src/styles.ts","../src/dagre-adapter.ts","../src/renderer.ts","../src/sequence/layout.ts","../src/sequence/renderer.ts","../src/class/layout.ts","../src/class/renderer.ts","../src/er/layout.ts","../src/er/renderer.ts","../src/index.ts","../src/browser.ts"],"names":["require_dagre","__commonJSMin","exports","module","f","g","r","e","n","t","o","i","c","__require","u","a","require","greedyFAS","uniqueId","run","undo","weightFn","dfsFAS","label","fas","stack","visited","dfs","v","forwardName","util","addBorderSegments","children","node","rank","maxRank","addBorderNode","prop","prefix","sg","sgNode","prev","curr","adjust","rankDir","swapWidthHeight","reverseY","swapXY","swapWidthHeightOne","attrs","w","reverseYOne","edge","swapXYOne","List","sentinel","entry","unlink","strs","filterOutLinks","k","Graph","debugOrdering","layerMatrix","h","layer","layerV","DEFAULT_WEIGHT_FN","state","buildState","doGreedyFAS","buckets","zeroIdx","results","sources","sinks","removeNode","collectPredecessors","weight","uEntry","assignBucket","wEntry","fasGraph","maxIn","maxOut","prevWeight","edgeWeight","range","limit","acyclic","normalize","normalizeRanks","parentDummyChains","removeEmptyRanks","nestingGraph","coordinateSystem","order","position","layout","opts","time","layoutGraph","buildLayoutGraph","runLayout","updateInputGraph","makeSpaceForEdgeLabels","removeSelfEdges","injectEdgeLabelProxies","assignRankMinMax","removeEdgeLabelProxies","insertSelfEdges","positionSelfEdges","removeBorderNodes","fixupEdgeLabelCoords","translateGraph","assignNodeIntersects","reversePointsForReversedEdges","inputGraph","inputLabel","layoutLabel","graphNumAttrs","graphDefaults","graphAttrs","nodeNumAttrs","nodeDefaults","edgeNumAttrs","edgeDefaults","edgeAttrs","graph","canonicalize","selectNumberAttrs","newNode","minX","maxX","minY","maxY","graphLabel","marginX","marginY","getExtremes","x","y","p","nodeV","nodeW","p1","p2","b","l","layers","orderShift","selfEdge","selfNode","dx","dy","obj","newAttrs","cleanup","root","depths","treeDepths","depthsArr","height","nodeSep","sumWeights","child","top","bottom","childNode","childTop","childBottom","thisWeight","minlen","depth","acc","normalizeEdge","vRank","wRank","name","edgeLabel","labelRank","dummy","origLabel","addSubgraphConstraints","cg","vs","rootPrev","parent","prevChild","barycenter","movable","inV","result","nodeU","buildLayerGraph","relationship","nodesWithRank","createRootNode","zipObject","crossCount","layering","cc","twoLayerCrossCount","northLayer","southLayer","southPos","southEntries","firstIndex","treeSize","tree","index","weightSum","initOrder","sortSubgraph","downLayerGraphs","buildLayerGraphs","upLayerGraphs","assignOrder","bestCC","best","lastBest","sweepLayerGraphs","ranks","nodesByRank","addNodeToRank","layerGraphs","biasRight","lg","sorted","simpleNodes","simpleNodesRanks","resolveConflicts","entries","mappedEntries","tmp","entryV","entryW","sourceSet","doResolveConflicts","handleIn","vEntry","mergeEntries","handleOut","target","source","sum","sort","bl","br","subgraphs","barycenters","subgraphResult","mergeBarycenters","expandSubgraphs","blPred","brPred","other","parts","sortable","unsortable","vsIndex","compareWithBias","consumeUnsortable","last","bias","postorderNums","postorder","edgeObj","pathData","findPath","path","lca","pathIdx","pathV","ascending","vPath","wPath","low","lim","positionX","findType1Conflicts","findType2Conflicts","addConflict","hasConflict","verticalAlignment","horizontalCompaction","alignCoordinates","findSmallestWidthAlignment","balance","conflicts","visitLayer","prevLayer","k0","scanPos","prevLayerLength","lastNode","findOtherInnerSegmentNode","k1","scanNode","uLabel","uPos","scan","south","southEnd","prevNorthBorder","nextNorthBorder","uNode","north","prevNorthPos","nextNorthPos","southLookahead","predecessors","conflictsV","neighborFn","align","pos","prevIdx","ws","mp","il","reverseSep","xs","blockG","buildBlockGraph","borderType","iterate","setXsFunc","nextNodesFunc","elem","pass1","pass2","min","blockGraph","sepFn","sep","vRoot","uRoot","prevMax","xss","currentMinAndXs","max","halfWidth","width","newMin","alignTo","alignToVals","alignToMin","alignToMax","vert","horiz","alignment","xsVals","delta","num","adjustedLayering","inner","smallestWidth","edgeSep","vLabel","wLabel","positionY","rankSep","prevY","maxHeight","slack","feasibleTree","start","size","tightTree","findMinSlackEdge","shiftRanks","edgeV","edgeSlack","rankUtil","longestPath","networkSimplex","ranker","networkSimplexRanker","tightTreeRanker","longestPathRanker","initRank","preorder","simplify","initLowLimValues","initCutValues","calcCutValue","leaveEdge","enterEdge","exchangeEdges","assignCutValue","childLab","childIsTail","graphEdge","cutValue","isOutEdge","pointsToHead","otherWeight","isTreeEdge","otherCutValue","dfsAssignLowLim","nextLim","tailLabel","flip","candidates","isDescendant","updateRanks","flipped","rootLabel","applyWithChunking","outEdgesMinLens","addDummyNode","asNonCompoundGraph","buildLayerMatrix","intersectRect","mapValues","notime","partition","pick","predecessorWeights","successorWeights","type","simplified","simpleLabel","weightMap","sucs","preds","rect","point","sx","sy","nodeRanks","offset","nodeRankFactor","splitToChunks","array","chunkSize","CHUNKING_THRESHOLD","chunks","chunk","fn","argsArray","collection","value","idCounter","id","step","endCon","keys","dest","key","funcOrProp","func","val","props","values","lib","components","cmpts","cmpt","navigation","orderFunc","postOrderDfs","preOrderDfs","forEachRight","iteratee","length","dijkstra","dijkstraAll","weightFunc","edgeFunc","PriorityQueue","DEFAULT_WEIGHT_FUNC","edgeFn","runDijkstra","pq","updateNeighbors","distance","tarjan","findCycles","floydWarshall","runFloydWarshall","nodes","d","rowK","rowI","j","ik","kj","ij","altDistance","topsort","isAcyclic","prim","parents","pri","init","visit","CycleException","priority","keyIndices","arr","largest","origArrI","origArrJ","DEFAULT_EDGE_NAME","GRAPH_NODE","EDGE_KEY_DELIM","newDefault","self","args","removeEdge","ancestor","predsV","sucsV","union","succ","neighbors","filter","copy","findParent","valueSpecified","arg0","edgeArgsToId","edgeArgsToObj","incrementOrInitEntry","edgeObjToId","decrementOrRemoveEntry","edges","outV","inEdges","map","isDirected","v_","w_","write","read","json","writeNodes","writeEdges","nodeValue","edgeValue","DEFAULTS","MIX","THEMES","fromShikiTheme","theme","dark","tokenColor","scope","buildStyleBlock","font","hasMonoFont","fontImports","derivedVars","svgOpenTag","colors","transparent","vars","parseMermaid","text","lines","header","parseStateDiagram","parseFlowchart","headerMatch","subgraphStack","line","classDefMatch","propsStr","parseStyleProps","classAssignMatch","nodeIds","s","className","styleMatch","dirMatch","subgraphMatch","rest","bracketMatch","completed","parseEdgeLine","compositeStack","startCount","endCount","compositeMatch","stateAliasMatch","registerStateNode","transitionMatch","sourceId","targetId","ensureStateNode","stateDescMatch","current","pair","colonIdx","ARROW_REGEX","NODE_PATTERNS","BARE_NODE_REGEX","CLASS_SHORTHAND_REGEX","remaining","firstGroup","consumeNodeGroup","prevGroupIds","arrowMatch","hasArrowStart","arrowOp","style","arrowStyleFromOp","hasArrowEnd","nextGroup","first","consumeNode","ids","next","regex","shape","match","registerNode","bareMatch","trackInSubgraph","classMatch","nodeId","op","Up","Down","Left","Right","UpperRight","UpperLeft","LowerRight","LowerLeft","Middle","gridCoordEquals","drawingCoordEquals","gridCoordDirection","dir","gridKey","EMPTY_STYLE","mkCanvas","canvas","col","copyCanvas","getCanvasSize","increaseSize","newX","newY","currX","currY","targetX","targetY","grown","JUNCTION_CHARS","isJunctionChar","JUNCTION_MAP","mergeJunctions","c1","c2","mergeCanvases","base","useAscii","overlays","overlay","oX","oY","merged","mx","my","canvasToString","VERTICAL_FLIP_MAP","flipCanvasVertically","drawText","setCanvasSizeToGrid","columnWidth","rowHeight","convertToAsciiGraph","parsed","config","nodeMap","mNode","asciiNode","mEdge","from","to","mSg","convertSubgraph","deduplicateSubgraphNodes","classDef","allSubgraphs","childMSg","mermaidSubgraphs","asciiSubgraphs","sgMap","buildSgMap","nodeOwner","claimNodes","asciiSg","owner","isAncestorOrSelf","candidate","mSgs","aSgs","flatMermaid","flatten","sgs","MinHeap","item","smallest","left","right","heuristic","absX","absY","MOVE_DIRS","isFreeInGrid","grid","getPath","costSoFar","cameFrom","currentCost","newCost","nextKey","existingCost","mergePath","toRemove","step0","step1","idx","step2","prevDx","prevDy","_","getOpposite","dirEquals","determineDirection","selfReferenceDirection","graphDirection","determineStartAndEndDir","preferredDir","preferredOppositeDir","alternativeDir","alternativeOppositeDir","isBackwards","determinePath","prefFrom","prefTo","preferredPath","altFrom","altTo","alternativePath","determineLabelLine","lenLabel","prevStep","largestLine","largestLineSize","lineWidth","calculateLineWidth","middleX","total","startX","endX","drawBox","gc","box","textY","textX","drawMultiBox","sections","padding","maxTextWidth","section","boxWidth","totalLines","numDividers","boxHeight","hLine","vLine","tl","tr","divL","divR","row","drawLine","offsetFrom","offsetTo","drawnCoords","hChar","vChar","bslash","fslash","drawArrow","empty","labelCanvas","drawArrowLabel","pathCanvas","linesDrawn","lineDirs","drawPath","boxStartCanvas","drawBoxStart","arrowHeadCanvas","drawArrowHead","cornersCanvas","drawCorners","previousCoord","nextCoord","prevDC","gridToDrawingCoord","nextDC","segment","firstLine","lastLine","fallbackDir","lastPos","char","coord","dc","prevDir","nextDir","corner","drawingLine","lineToDrawing","drawTextOnLine","middleY","drawSubgraphBox","drawSubgraphLabel","labelY","labelX","sortSubgraphsByDepth","getDepth","drawGraph","sortedSgs","sgCanvas","lineCanvases","cornerCanvases","arrowHeadCanvases","boxStartCanvases","labelCanvases","pathC","boxStartC","arrowHeadC","cornersC","labelC","zero","colW","rowH","reserveSpotInGrid","requested","reserved","setColumnWidth","colWidths","rowHeights","xCoord","yCoord","basePadding","hasIncomingEdgeFromOutsideSubgraph","increaseGridSizeForPath","isNodeInAnySubgraph","getNodeSubgraph","nodeSg","hasExternalEdge","otherNode","otherHasExternal","calculateSubgraphBoundingBox","nodeMinX","nodeMinY","nodeMaxX","nodeMaxY","subgraphPadding","subgraphLabelSpace","ensureSubgraphSpacing","rootSubgraphs","sg1","sg2","calculateSubgraphBoundingBoxes","offsetDrawingForSubgraphs","offsetX","offsetY","createMapping","highestPositionPerLevel","nodesFound","rootNodes","getChildren","hasExternalRoots","hasSubgraphRootsWithEdges","shouldSeparate","externalRootNodes","subgraphRootNodes","childLevel","highestPosition","getEdgesFromNode","parseSequenceDiagram","diagram","actorIds","blockStack","actorMatch","noteMatch","posStr","actorsStr","noteActorIds","aid","ensureActor","blockMatch","blockType","dividerMatch","msgMatch","arrow","activationMark","lineStyle","arrowHead","msg","simpleMsgMatch","renderSequenceAscii","H","V","TL","TR","BL","BR","JT","JB","JL","JR","actorIdx","boxPad","halfBox","actorBoxH","adjMaxWidth","fi","ti","lo","hi","needed","numGaps","perGap","llX","gap","msgArrowY","msgLabelY","blockStartY","blockEndY","divYMap","notePositions","curY","m","note","nLines","nWidth","nHeight","aIdx","nx","aIdx2","footerY","totalH","lastLL","lastHalf","totalW","selfRight","np","drawActorBox","cx","topY","ls","actor","fromX","toX","isSelf","isDashed","isFilled","lineChar","y0","loopW","arrowChar","arrowY","leftToRight","labelStart","lx","ah","block","botY","minLX","maxLX","bLeft","bRight","hdrLabel","dY","dashChar","isDashedH","dLabel","dStr","ly","by","parseClassDiagram","classMap","currentNamespace","currentClass","braceDepth","annotMatch","member","parseMember","nsMatch","classBlockMatch","generic","cls","ensureClass","classOnlyMatch","inlineAnnotMatch","inlineAttrMatch","rel","parseRelationship","trimmed","visibility","methodMatch","isStatic","isAbstract","fromCardinality","toCardinality","parseArrow","formatMember","vis","buildClassSections","methods","getRelMarker","markerAt","getMarkerShape","direction","renderClassAscii","hGap","vGap","classSections","classBoxW","classBoxH","maxTextW","boxW","boxH","classById","isHierarchical","parentId","childId","level","queue","levelCap","qi","childSet","newLevel","maxLevel","levelGroups","placed","currentY","lv","group","currentX","maxH","boxCanvas","bx","ch","cy","dashH","dashV","fromP","toP","marker","lineH","lineV","fromCX","fromBY","toCX","toTY","midY","rx","markerChar","fromTY","toBY","markerDir","detourY","paddedLabel","midX","parseErDiagram","entityMap","currentEntity","attr","parseAttribute","entityBlockMatch","ensureEntity","parseRelationshipLine","entity","comment","commentMatch","restWithoutComment","part","upper","entity1","cardinalityStr","entity2","lineMatch","leftStr","rightStr","cardinality1","parseCardinality","cardinality2","identifying","str","formatAttribute","buildEntitySections","getCrowsFootChars","card","renderErAscii","entitySections","entityBoxW","entityBoxH","ent","maxPerRow","maxRowH","colCount","e1","e2","e1CX","e1CY","e2CX","e2CY","leftCard","rightCard","lineY","leftChars","rightChars","gapMid","lower","upperCard","lowerCard","startY","endY","lineX","lowerCX","upperChars","lowerChars","detectDiagramType","renderMermaidAscii","options","import_dagre","estimateTextWidth","fontSize","fontWeight","widthRatio","estimateMonoTextWidth","FONT_SIZES","FONT_WEIGHTS","GROUP_HEADER_CONTENT_PAD","NODE_PADDING","STROKE_WIDTHS","TEXT_BASELINE_SHIFT","ARROW_HEAD","centerToTopLeft","clipToDiamondBoundary","hw","hh","scale","clipToCircleBoundary","dist","snapToOrthogonal","points","verticalFirst","removeCollinear","pts","out","sameX","sameY","clipEndpointsToNodes","sourceNode","targetNode","sideY","sideX","isStrictlyHorizontal","isStrictlyVertical","isPrimarilyHorizontal","isPrimarilyVertical","CIRCULAR_SHAPES","NON_RECT_SHAPES","preComputeSubgraphLayout","subG","dagre","directionToDagre","collectSubgraphNodeIds","estimateNodeSize","addSubgraphToDagre","internalEdgeIndices","nestedSubgraphIds","collectAllSubgraphIds","dagreNode","topLeft","resolveNodeStyle","dagreEdge","originalEdge","rawPoints","srcShape","sn","tgtShape","tn","orthoPoints","srcRect","tgtRect","labelPosition","groups","extractGroup","graphInfo","preComputed","subgraphNodeIds","pc","subgraphEntryNode","subgraphExitNode","buildSubgraphRedirects","sgId","allInternalIndices","introducedTargets","err","message","extractPositionedGraph","side","diameter","entryMap","exitMap","childIds","firstChild","lastChild","classProps","inlineProps","subgraphIds","preComputedNodeIds","srcShapeForClip","tgtShapeForClip","nodePositionMap","placeholder","pcNode","composed","pcEdge","findGroupById","offsetGroup","modified","headerHeight","expandGroupsForHeaders","flatGroups","flattenAllGroups","allYs","currentMinY","graphWidth","graphHeight","fg","maxBottom","expandGroupForHeader","expansion","found","renderSvg","arrowMarkerDefs","renderGroup","renderEdge","renderEdgeLabel","renderNodeShape","renderNodeLabel","escapeXml","pointsToPolylinePath","dashArray","strokeWidth","markers","mid","edgeMidpoint","textWidth","bgWidth","bgHeight","totalLength","segLen","inlineStyle","fill","stroke","sw","renderDiamond","renderRoundedRect","renderStadium","renderCircle","renderSubroutine","renderDoubleCircle","renderHexagon","renderCylinder","renderAsymmetric","renderTrapezoid","renderTrapezoidAlt","renderStateStart","renderStateEnd","renderRect","outerR","innerR","inset","bodyTop","bodyH","textColor","SEQ","layoutSequenceDiagram","_options","actorWidths","textW","actorCenterX","minGap","actorIndex","actorY","actors","messageY","messages","extraSpaceBefore","div","prevDiv","activationStacks","activations","msgIdx","fromIdx","toIdx","extra","x1","x2","actorId","blocks","startMsg","endMsg","blockTop","blockBottom","involvedActors","mi","ai","minIdx","maxIdx","blockLeft","blockRight","dividers","msgY","divLabelText","divLabelW","divLabelLeft","divLabelRight","msgLabelW","msgLabelLeft","msgLabelRight","notes","noteW","noteH","noteY","firstActorIdx","noteX","lastActorIdx","diagramBottom","globalMinX","globalMaxX","shiftX","act","lifelines","diagramWidth","diagramHeight","renderSequenceSvg","renderBlock","lifeline","renderLifeline","activation","renderActivation","renderMessage","renderNote","renderActor","tx","ty","iconStroke","markerId","labelText","tabWidth","tabHeight","divider","CLS","layoutClassDiagram","classSizes","attrHeight","methodHeight","headerTextW","maxAttrW","maxMemberWidth","maxMethodW","classLookup","positionedClasses","relationships","srcNode","tgtNode","members","maxW","memberToString","CLS_FONT","renderClassSvg","relationshipMarkerDefs","renderRelationship","renderClassBox","renderRelationshipLabels","nameY","annotY","attrTop","memberRowH","memberY","renderMember","methodTop","fontStyle","decoration","spans","getRelationshipMarkers","getMarkerDefId","midpoint","cardinalityOffset","ER","layoutErDiagram","entitySizes","attrText","entityLookup","positionedEntities","ER_FONT","renderErSvg","renderRelationshipLine","renderEntityBox","renderCardinality","renderRelationshipLabel","attributes","rowY","renderAttribute","boxX","keyWidth","keyText","typeX","nameX","bgW","bgH","renderCrowsFoot","pN","pN1","toward","cardinality","len","ux","uy","px","py","tipX","tipY","backX","backY","hasOneLine","hasCrowsFoot","hasCircle","line2X","line2Y","cfTipX","cfTipY","circleOffset","circleX","circleY","totalLen","halfLen","walked","buildColors","renderMermaid","diagramType","positioned"],"mappings":"ozBAAA,IAAAA,EAAAA,CAAAC,GAAA,CAAAC,EAAAA,CAAAC,KAAA,CAAA,CAAC,SAASC,EAAE,CAAC,GAAG,OAAOF,EAAAA,EAAU,QAAA,EAAU,OAAOC,EAAAA,CAAS,GAAA,CAAaA,GAAO,OAAA,CAAQC,CAAAA,EAAE,CAAA,KAAA,GAAU,OAAO,MAAA,EAAS,UAAA,EAAY,OAAO,GAAA,CAAK,MAAA,CAAO,EAAC,CAAEA,CAAC,OAAM,CAAC,IAAIC,CAAAA,CAAK,OAAO,MAAA,CAAS,GAAA,CAAaA,EAAE,MAAA,CAAe,OAAO,OAAS,GAAA,CAAaA,CAAAA,CAAE,OAAe,OAAO,IAAA,CAAO,GAAA,CAAaA,CAAAA,CAAE,IAAA,CAAUA,CAAAA,CAAE,KAAKA,CAAAA,CAAE,KAAA,CAAQD,IAAG,CAAC,GAAG,UAAU,CAA2B,OAAA,CAAQ,UAAU,CAAC,SAASE,CAAAA,CAAEC,EAAEC,CAAAA,CAAEC,CAAAA,CAAE,CAAC,SAASC,CAAAA,CAAEC,CAAAA,CAAEP,EAAE,CAAC,GAAG,CAACI,CAAAA,CAAEG,CAAC,EAAE,CAAC,GAAG,CAACJ,CAAAA,CAAEI,CAAC,CAAA,CAAE,CAAC,IAAIC,CAAAA,CAAc,OAAOC,EAAAA,EAAnB,UAAA,EAA4BA,GAAQ,GAAG,CAACT,CAAAA,EAAGQ,CAAAA,CAAE,OAAOA,CAAAA,CAAED,EAAE,IAAE,CAAA,CAAE,GAAGG,CAAAA,CAAE,OAAOA,EAAEH,CAAAA,CAAE,IAAE,EAAE,IAAII,CAAAA,CAAE,IAAI,KAAA,CAAM,sBAAA,CAAuBJ,EAAE,GAAG,CAAA,CAAE,MAAMI,CAAAA,CAAE,IAAA,CAAK,kBAAA,CAAmBA,CAAC,CAAC,IAAI,EAAEP,CAAAA,CAAEG,CAAC,EAAE,CAAC,OAAA,CAAQ,EAAE,CAAA,CAAEJ,CAAAA,CAAEI,CAAC,CAAA,CAAE,CAAC,EAAE,IAAA,CAAK,CAAA,CAAE,QAAQ,SAASL,CAAAA,CAAE,CAAC,IAAIE,CAAAA,CAAED,CAAAA,CAAEI,CAAC,CAAA,CAAE,CAAC,EAAEL,CAAC,CAAA,CAAE,OAAOI,CAAAA,CAAEF,CAAAA,EAAGF,CAAC,CAAC,CAAA,CAAE,CAAA,CAAE,CAAA,CAAE,OAAA,CAAQA,CAAAA,CAAEC,EAAEC,CAAAA,CAAEC,CAAC,EAAC,CAAC,OAAOD,EAAEG,CAAC,CAAA,CAAE,OAAO,CAAC,IAAA,IAAQG,CAAAA,CAAc,OAAOD,EAAAA,EAAnB,UAAA,EAA4BA,GAAQF,CAAAA,CAAE,CAAA,CAAEA,EAAEF,CAAAA,CAAE,MAAA,CAAOE,CAAAA,EAAAA,CAAID,CAAAA,CAAED,CAAAA,CAAEE,CAAC,CAAC,CAAA,CAAE,OAAOD,CAAC,CAAC,OAAOJ,CAAC,CAAA,GAAG,CAAE,CAAC,CAAA,CAAE,CAAC,SAASU,EAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CAuB71BC,CAAAA,CAAO,OAAA,CAAU,CACf,QAAA,CAAUa,CAAAA,CAAQ,mBAAmB,CAAA,CAErC,MAAA,CAAQA,EAAQ,cAAc,CAAA,CAC9B,MAAOA,CAAAA,CAAQ,aAAa,EAC5B,IAAA,CAAM,CACJ,IAAA,CAAMA,CAAAA,CAAQ,YAAY,CAAA,CAAE,KAC5B,MAAA,CAAQA,CAAAA,CAAQ,YAAY,CAAA,CAAE,MAChC,EACA,OAAA,CAASA,CAAAA,CAAQ,eAAe,CAClC,EAEA,CAAA,CAAE,CAAC,aAAA,CAAc,CAAA,CAAE,eAAe,CAAA,CAAE,YAAA,CAAa,GAAG,eAAA,CAAgB,EAAA,CAAG,mBAAA,CAAoB,EAAE,CAAC,CAAA,CAAE,EAAE,CAAC,SAASA,EAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CAGnI,IAAIe,CAAAA,CAAYD,CAAAA,CAAQ,cAAc,CAAA,CAClCE,EAAWF,CAAAA,CAAQ,QAAQ,EAAE,QAAA,CAEjCb,CAAAA,CAAO,QAAU,CACf,GAAA,CAAKgB,CAAAA,CACL,IAAA,CAAMC,CACR,CAAA,CAEA,SAASD,CAAAA,CAAId,CAAAA,CAAG,EACHA,CAAAA,CAAE,KAAA,GAAQ,SAAA,GAAc,QAAA,CAC/BY,CAAAA,CAAUZ,CAAAA,CAAGgB,CAAAA,CAAShB,CAAC,CAAC,CAAA,CACxBiB,CAAAA,CAAOjB,CAAC,CAAA,EACR,OAAA,CAAQE,GAAK,CACf,IAAIgB,CAAAA,CAAQlB,CAAAA,CAAE,IAAA,CAAKE,CAAC,EACpBF,CAAAA,CAAE,UAAA,CAAWE,CAAC,CAAA,CACdgB,CAAAA,CAAM,YAAchB,CAAAA,CAAE,IAAA,CACtBgB,EAAM,QAAA,CAAW,IAAA,CACjBlB,EAAE,OAAA,CAAQE,CAAAA,CAAE,EAAGA,CAAAA,CAAE,CAAA,CAAGgB,EAAOL,CAAAA,CAAS,KAAK,CAAC,EAC5C,CAAC,CAAA,CAED,SAASG,CAAAA,CAAShB,CAAAA,CAAG,CACnB,OAAOE,CAAAA,EACEF,EAAE,IAAA,CAAKE,CAAC,CAAA,CAAE,MAErB,CACF,CAEA,SAASe,CAAAA,CAAOjB,CAAAA,CAAG,CACjB,IAAImB,CAAAA,CAAM,EAAC,CACPC,CAAAA,CAAQ,EAAC,CACTC,CAAAA,CAAU,GAEd,SAASC,CAAAA,CAAIC,EAAG,CACV,MAAA,CAAO,OAAOF,CAAAA,CAASE,CAAC,CAAA,GAG5BF,CAAAA,CAAQE,CAAC,CAAA,CAAI,KACbH,CAAAA,CAAMG,CAAC,EAAI,IAAA,CACXvB,CAAAA,CAAE,SAASuB,CAAC,CAAA,CAAE,OAAA,CAAQrB,CAAAA,EAAK,CACrB,MAAA,CAAO,OAAOkB,CAAAA,CAAOlB,CAAAA,CAAE,CAAC,CAAA,CAC1BiB,CAAAA,CAAI,KAAKjB,CAAC,CAAA,CAEVoB,CAAAA,CAAIpB,CAAAA,CAAE,CAAC,EAEX,CAAC,CAAA,CACD,OAAOkB,EAAMG,CAAC,CAAA,EAChB,CAEA,OAAAvB,CAAAA,CAAE,KAAA,EAAM,CAAE,OAAA,CAAQsB,CAAG,EACdH,CACT,CAEA,SAASJ,CAAAA,CAAKf,CAAAA,CAAG,CACfA,CAAAA,CAAE,KAAA,GAAQ,OAAA,CAAQE,CAAAA,EAAK,CACrB,IAAIgB,CAAAA,CAAQlB,EAAE,IAAA,CAAKE,CAAC,EACpB,GAAIgB,CAAAA,CAAM,QAAA,CAAU,CAClBlB,CAAAA,CAAE,UAAA,CAAWE,CAAC,CAAA,CAEd,IAAIsB,EAAcN,CAAAA,CAAM,WAAA,CACxB,OAAOA,CAAAA,CAAM,QAAA,CACb,OAAOA,CAAAA,CAAM,WAAA,CACblB,CAAAA,CAAE,QAAQE,CAAAA,CAAE,CAAA,CAAGA,EAAE,CAAA,CAAGgB,CAAAA,CAAOM,CAAW,EACxC,CACF,CAAC,EACH,CAEA,CAAA,CAAE,CAAC,cAAA,CAAe,CAAA,CAAE,SAAS,EAAE,CAAC,EAAE,CAAA,CAAE,CAAC,SAASb,CAAAA,CAAQb,CAAAA,CAAOD,EAAQ,CACrE,IAAI4B,EAAOd,CAAAA,CAAQ,QAAQ,EAE3Bb,CAAAA,CAAO,OAAA,CAAU4B,CAAAA,CAEjB,SAASA,CAAAA,CAAkB1B,CAAAA,CAAG,CAC5B,SAASsB,CAAAA,CAAIC,EAAG,CACd,IAAII,EAAW3B,CAAAA,CAAE,QAAA,CAASuB,CAAC,CAAA,CACvBK,CAAAA,CAAO5B,CAAAA,CAAE,KAAKuB,CAAC,CAAA,CAKnB,GAJII,CAAAA,CAAS,MAAA,EACXA,EAAS,OAAA,CAAQL,CAAG,CAAA,CAGlB,MAAA,CAAO,MAAA,CAAOM,CAAAA,CAAM,SAAS,CAAA,CAAG,CAClCA,EAAK,UAAA,CAAa,GAClBA,CAAAA,CAAK,WAAA,CAAc,EAAC,CACpB,IAAA,IAASC,EAAOD,CAAAA,CAAK,OAAA,CAASE,EAAUF,CAAAA,CAAK,OAAA,CAAU,EACrDC,CAAAA,CAAOC,CAAAA,CACP,EAAED,CAAAA,CACFE,CAAAA,CAAc/B,CAAAA,CAAG,aAAc,KAAA,CAAOuB,CAAAA,CAAGK,EAAMC,CAAI,CAAA,CACnDE,EAAc/B,CAAAA,CAAG,aAAA,CAAe,KAAA,CAAOuB,CAAAA,CAAGK,CAAAA,CAAMC,CAAI,EAExD,CACF,CAEA7B,EAAE,QAAA,EAAS,CAAE,QAAQsB,CAAG,EAC1B,CAEA,SAASS,CAAAA,CAAc/B,CAAAA,CAAGgC,EAAMC,CAAAA,CAAQC,CAAAA,CAAIC,EAAQN,CAAAA,CAAM,CACxD,IAAIX,CAAAA,CAAQ,CAAE,KAAA,CAAO,CAAA,CAAG,MAAA,CAAQ,CAAA,CAAG,KAAMW,CAAAA,CAAM,UAAA,CAAYG,CAAK,CAAA,CAC5DI,CAAAA,CAAOD,EAAOH,CAAI,CAAA,CAAEH,CAAAA,CAAO,CAAC,CAAA,CAC5BQ,CAAAA,CAAOZ,EAAK,YAAA,CAAazB,CAAAA,CAAG,SAAUkB,CAAAA,CAAOe,CAAM,EACvDE,CAAAA,CAAOH,CAAI,CAAA,CAAEH,CAAI,CAAA,CAAIQ,CAAAA,CACrBrC,EAAE,SAAA,CAAUqC,CAAAA,CAAMH,CAAE,CAAA,CAChBE,CAAAA,EACFpC,EAAE,OAAA,CAAQoC,CAAAA,CAAMC,CAAAA,CAAM,CAAE,MAAA,CAAQ,CAAE,CAAC,EAEvC,CAEA,EAAE,CAAC,QAAA,CAAS,EAAE,CAAC,CAAA,CAAE,EAAE,CAAC,SAAS1B,EAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CAGpDC,CAAAA,CAAO,QAAU,CACf,MAAA,CAAQwC,CAAAA,CACR,IAAA,CAAMvB,CACR,CAAA,CAEA,SAASuB,CAAAA,CAAOtC,CAAAA,CAAG,CACjB,IAAIuC,CAAAA,CAAUvC,EAAE,KAAA,EAAM,CAAE,OAAA,CAAQ,WAAA,EAAY,CAAA,CACxCuC,CAAAA,GAAY,MAAQA,CAAAA,GAAY,IAAA,GAClCC,EAAgBxC,CAAC,EAErB,CAEA,SAASe,CAAAA,CAAKf,CAAAA,CAAG,CACf,IAAIuC,CAAAA,CAAUvC,EAAE,KAAA,EAAM,CAAE,QAAQ,WAAA,EAAY,CAAA,CACxCuC,IAAY,IAAA,EAAQA,CAAAA,GAAY,IAAA,GAClCE,CAAAA,CAASzC,CAAC,CAAA,CAAA,CAGRuC,IAAY,IAAA,EAAQA,CAAAA,GAAY,QAClCG,CAAAA,CAAO1C,CAAC,EACRwC,CAAAA,CAAgBxC,CAAC,CAAA,EAErB,CAEA,SAASwC,CAAAA,CAAgBxC,EAAG,CAC1BA,CAAAA,CAAE,OAAM,CAAE,OAAA,CAAQuB,GAAKoB,CAAAA,CAAmB3C,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAC,CAAC,EACpDvB,CAAAA,CAAE,KAAA,GAAQ,OAAA,CAAQE,CAAAA,EAAKyC,EAAmB3C,CAAAA,CAAE,IAAA,CAAKE,CAAC,CAAC,CAAC,EACtD,CAEA,SAASyC,CAAAA,CAAmBC,EAAO,CACjC,IAAIC,EAAID,CAAAA,CAAM,KAAA,CACdA,EAAM,KAAA,CAAQA,CAAAA,CAAM,OACpBA,CAAAA,CAAM,MAAA,CAASC,EACjB,CAEA,SAASJ,EAASzC,CAAAA,CAAG,CACnBA,CAAAA,CAAE,KAAA,EAAM,CAAE,OAAA,CAAQuB,GAAKuB,CAAAA,CAAY9C,CAAAA,CAAE,KAAKuB,CAAC,CAAC,CAAC,CAAA,CAE7CvB,CAAAA,CAAE,KAAA,EAAM,CAAE,OAAA,CAAQE,CAAAA,EAAK,CACrB,IAAI6C,CAAAA,CAAO/C,EAAE,IAAA,CAAKE,CAAC,EACnB6C,CAAAA,CAAK,MAAA,CAAO,OAAA,CAAQD,CAAW,CAAA,CAC3B,MAAA,CAAO,OAAOC,CAAAA,CAAM,GAAG,GACzBD,CAAAA,CAAYC,CAAI,EAEpB,CAAC,EACH,CAEA,SAASD,CAAAA,CAAYF,CAAAA,CAAO,CAC1BA,CAAAA,CAAM,CAAA,CAAI,CAACA,CAAAA,CAAM,EACnB,CAEA,SAASF,CAAAA,CAAO1C,CAAAA,CAAG,CACjBA,CAAAA,CAAE,KAAA,GAAQ,OAAA,CAAQuB,CAAAA,EAAKyB,EAAUhD,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAC,CAAC,CAAA,CAE3CvB,CAAAA,CAAE,KAAA,EAAM,CAAE,QAAQE,CAAAA,EAAK,CACrB,IAAI6C,CAAAA,CAAO/C,CAAAA,CAAE,KAAKE,CAAC,CAAA,CACnB6C,CAAAA,CAAK,MAAA,CAAO,OAAA,CAAQC,CAAS,EACzB,MAAA,CAAO,MAAA,CAAOD,EAAM,GAAG,CAAA,EACzBC,EAAUD,CAAI,EAElB,CAAC,EACH,CAEA,SAASC,CAAAA,CAAUJ,CAAAA,CAAO,CACxB,IAAI,CAAA,CAAIA,EAAM,CAAA,CACdA,CAAAA,CAAM,CAAA,CAAIA,CAAAA,CAAM,CAAA,CAChBA,CAAAA,CAAM,EAAI,EACZ,CAEA,EAAE,EAAE,EAAE,CAAA,CAAE,CAAC,SAASjC,CAAAA,CAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CAMzC,MAAMoD,CAAK,CACT,WAAA,EAAc,CACZ,IAAIC,CAAAA,CAAW,EAAC,CAChBA,CAAAA,CAAS,KAAA,CAAQA,CAAAA,CAAS,MAAQA,CAAAA,CAClC,IAAA,CAAK,UAAYA,EACnB,CAEA,SAAU,CACR,IAAIA,EAAW,IAAA,CAAK,SAAA,CAChBC,EAAQD,CAAAA,CAAS,KAAA,CACrB,GAAIC,CAAAA,GAAUD,CAAAA,CACZ,OAAAE,CAAAA,CAAOD,CAAK,CAAA,CACLA,CAEX,CAEA,OAAA,CAAQA,EAAO,CACb,IAAID,EAAW,IAAA,CAAK,SAAA,CAChBC,EAAM,KAAA,EAASA,CAAAA,CAAM,KAAA,EACvBC,CAAAA,CAAOD,CAAK,CAAA,CAEdA,EAAM,KAAA,CAAQD,CAAAA,CAAS,MACvBA,CAAAA,CAAS,KAAA,CAAM,MAAQC,CAAAA,CACvBD,CAAAA,CAAS,KAAA,CAAQC,CAAAA,CACjBA,CAAAA,CAAM,KAAA,CAAQD,EAChB,CAEA,QAAA,EAAW,CACT,IAAIG,CAAAA,CAAO,EAAC,CACRH,CAAAA,CAAW,KAAK,SAAA,CAChBb,CAAAA,CAAOa,EAAS,KAAA,CACpB,KAAOb,IAASa,CAAAA,EACdG,CAAAA,CAAK,KAAK,IAAA,CAAK,SAAA,CAAUhB,CAAAA,CAAMiB,CAAc,CAAC,CAAA,CAC9CjB,EAAOA,CAAAA,CAAK,KAAA,CAEd,OAAO,GAAA,CAAMgB,CAAAA,CAAK,KAAK,IAAI,CAAA,CAAI,GACjC,CACF,CAEA,SAASD,EAAOD,CAAAA,CAAO,CACrBA,EAAM,KAAA,CAAM,KAAA,CAAQA,EAAM,KAAA,CAC1BA,CAAAA,CAAM,KAAA,CAAM,KAAA,CAAQA,CAAAA,CAAM,KAAA,CAC1B,OAAOA,CAAAA,CAAM,KAAA,CACb,OAAOA,CAAAA,CAAM,MACf,CAEA,SAASG,CAAAA,CAAeC,CAAAA,CAAGhC,CAAAA,CAAG,CAC5B,GAAIgC,IAAM,OAAA,EAAWA,CAAAA,GAAM,QACzB,OAAOhC,CAEX,CAEAzB,CAAAA,CAAO,OAAA,CAAUmD,EAEjB,CAAA,CAAE,EAAE,EAAE,CAAA,CAAE,CAAC,SAAStC,CAAAA,CAAQb,CAAAA,CAAOD,EAAQ,CACzC,IAAI4B,CAAAA,CAAOd,CAAAA,CAAQ,QAAQ,CAAA,CACvB6C,EAAQ7C,CAAAA,CAAQ,mBAAmB,EAAE,KAAA,CAEzCb,CAAAA,CAAO,QAAU,CACf,aAAA,CAAe2D,CACjB,CAAA,CAGA,SAASA,CAAAA,CAAczD,EAAG,CACxB,IAAI0D,EAAcjC,CAAAA,CAAK,gBAAA,CAAiBzB,CAAC,CAAA,CAErC2D,CAAAA,CAAI,IAAIH,CAAAA,CAAM,CAAE,SAAU,IAAA,CAAM,UAAA,CAAY,IAAK,CAAC,CAAA,CAAE,SAAS,EAAE,CAAA,CAEnE,OAAAxD,CAAAA,CAAE,KAAA,GAAQ,OAAA,CAAQuB,CAAAA,EAAK,CACrBoC,CAAAA,CAAE,OAAA,CAAQpC,EAAG,CAAE,KAAA,CAAOA,CAAE,CAAC,CAAA,CACzBoC,CAAAA,CAAE,UAAUpC,CAAAA,CAAG,OAAA,CAAUvB,EAAE,IAAA,CAAKuB,CAAC,EAAE,IAAI,EACzC,CAAC,CAAA,CAEDvB,CAAAA,CAAE,KAAA,GAAQ,OAAA,CAAQE,CAAAA,EAAKyD,EAAE,OAAA,CAAQzD,CAAAA,CAAE,EAAGA,CAAAA,CAAE,CAAA,CAAG,EAAC,CAAGA,CAAAA,CAAE,IAAI,CAAC,CAAA,CAEtDwD,CAAAA,CAAY,QAAQ,CAACE,CAAAA,CAAOtD,IAAM,CAChC,IAAIuD,CAAAA,CAAS,OAAA,CAAUvD,CAAAA,CACvBqD,CAAAA,CAAE,QAAQE,CAAAA,CAAQ,CAAE,KAAM,MAAO,CAAC,EAClCD,CAAAA,CAAM,MAAA,CAAO,CAACnD,CAAAA,CAAGc,CAAAA,IACfoC,CAAAA,CAAE,QAAQlD,CAAAA,CAAGc,CAAAA,CAAG,CAAE,KAAA,CAAO,OAAQ,CAAC,CAAA,CAC3BA,CAAAA,CACR,EACH,CAAC,CAAA,CAEMoC,CACT,CAEA,CAAA,CAAE,CAAC,SAAS,EAAA,CAAG,mBAAA,CAAoB,EAAE,CAAC,CAAA,CAAE,EAAE,CAAC,SAAShD,EAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CAC3E,IAAI2D,CAAAA,CAAQ7C,EAAQ,mBAAmB,CAAA,CAAE,KAAA,CACrCsC,CAAAA,CAAOtC,CAAAA,CAAQ,aAAa,EAShCb,CAAAA,CAAO,OAAA,CAAUc,EAEjB,IAAIkD,CAAAA,CAAoB,IAAM,CAAA,CAE9B,SAASlD,CAAAA,CAAUZ,CAAAA,CAAGgB,CAAAA,CAAU,CAC9B,GAAIhB,CAAAA,CAAE,SAAA,IAAe,CAAA,CACnB,OAAO,EAAC,CAEV,IAAI+D,CAAAA,CAAQC,CAAAA,CAAWhE,CAAAA,CAAGgB,CAAAA,EAAY8C,CAAiB,CAAA,CAIvD,OAHcG,EAAYF,CAAAA,CAAM,KAAA,CAAOA,EAAM,OAAA,CAASA,CAAAA,CAAM,OAAO,CAAA,CAGpD,OAAA,CAAQ7D,CAAAA,EAAKF,EAAE,QAAA,CAASE,CAAAA,CAAE,EAAGA,CAAAA,CAAE,CAAC,CAAC,CAClD,CAEA,SAAS+D,CAAAA,CAAYjE,CAAAA,CAAGkE,CAAAA,CAASC,EAAS,CACxC,IAAIC,EAAU,EAAC,CACXC,EAAUH,CAAAA,CAAQA,CAAAA,CAAQ,MAAA,CAAS,CAAC,CAAA,CACpCI,CAAAA,CAAQJ,EAAQ,CAAC,CAAA,CAEjBf,EACJ,KAAOnD,CAAAA,CAAE,WAAU,EAAG,CACpB,KAAQmD,CAAAA,CAAQmB,CAAAA,CAAM,OAAA,IAAgBC,CAAAA,CAAWvE,CAAAA,CAAGkE,EAASC,CAAAA,CAAShB,CAAK,EAC3E,KAAQA,CAAAA,CAAQkB,EAAQ,OAAA,EAAQ,EAAME,EAAWvE,CAAAA,CAAGkE,CAAAA,CAASC,EAAShB,CAAK,CAAA,CAC3E,GAAInD,CAAAA,CAAE,SAAA,EAAU,CAAA,CACd,IAAA,IAASM,CAAAA,CAAI4D,CAAAA,CAAQ,OAAS,CAAA,CAAG5D,CAAAA,CAAI,EAAG,EAAEA,CAAAA,CAExC,GADA6C,CAAAA,CAAQe,CAAAA,CAAQ5D,CAAC,CAAA,CAAE,OAAA,EAAQ,CACvB6C,EAAO,CACTiB,CAAAA,CAAUA,EAAQ,MAAA,CAAOG,CAAAA,CAAWvE,EAAGkE,CAAAA,CAASC,CAAAA,CAAShB,CAAAA,CAAO,IAAI,CAAC,CAAA,CACrE,KACF,CAAA,CAGN,CAEA,OAAOiB,CACT,CAEA,SAASG,CAAAA,CAAWvE,CAAAA,CAAGkE,CAAAA,CAASC,CAAAA,CAAShB,CAAAA,CAAOqB,CAAAA,CAAqB,CACnE,IAAIJ,CAAAA,CAAUI,EAAsB,EAAC,CAAI,OAEzC,OAAAxE,CAAAA,CAAE,OAAA,CAAQmD,CAAAA,CAAM,CAAC,CAAA,CAAE,QAAQJ,CAAAA,EAAQ,CACjC,IAAI0B,CAAAA,CAASzE,CAAAA,CAAE,KAAK+C,CAAI,CAAA,CACpB2B,CAAAA,CAAS1E,CAAAA,CAAE,IAAA,CAAK+C,CAAAA,CAAK,CAAC,CAAA,CAEtByB,CAAAA,EACFJ,EAAQ,IAAA,CAAK,CAAE,EAAGrB,CAAAA,CAAK,CAAA,CAAG,CAAA,CAAGA,CAAAA,CAAK,CAAE,CAAC,EAGvC2B,CAAAA,CAAO,GAAA,EAAOD,EACdE,CAAAA,CAAaT,CAAAA,CAASC,EAASO,CAAM,EACvC,CAAC,CAAA,CAED1E,CAAAA,CAAE,SAASmD,CAAAA,CAAM,CAAC,EAAE,OAAA,CAAQJ,CAAAA,EAAQ,CAClC,IAAI0B,CAAAA,CAASzE,CAAAA,CAAE,IAAA,CAAK+C,CAAI,CAAA,CACpB,EAAIA,CAAAA,CAAK,CAAA,CACT6B,EAAS5E,CAAAA,CAAE,IAAA,CAAK,CAAC,CAAA,CACrB4E,CAAAA,CAAO,EAAA,EAASH,CAAAA,CAChBE,CAAAA,CAAaT,CAAAA,CAASC,EAASS,CAAM,EACvC,CAAC,CAAA,CAED5E,CAAAA,CAAE,WAAWmD,CAAAA,CAAM,CAAC,CAAA,CAEbiB,CACT,CAEA,SAASJ,EAAWhE,CAAAA,CAAGgB,CAAAA,CAAU,CAC/B,IAAI6D,CAAAA,CAAW,IAAIrB,CAAAA,CACfsB,CAAAA,CAAQ,CAAA,CACRC,CAAAA,CAAS,CAAA,CAEb/E,CAAAA,CAAE,OAAM,CAAE,OAAA,CAAQuB,GAAK,CACrBsD,CAAAA,CAAS,QAAQtD,CAAAA,CAAG,CAAE,CAAA,CAAGA,CAAAA,CAAG,EAAA,CAAM,CAAA,CAAG,IAAK,CAAE,CAAC,EAC/C,CAAC,CAAA,CAIDvB,EAAE,KAAA,EAAM,CAAE,OAAA,CAAQE,CAAAA,EAAK,CACrB,IAAI8E,EAAaH,CAAAA,CAAS,IAAA,CAAK3E,EAAE,CAAA,CAAGA,CAAAA,CAAE,CAAC,CAAA,EAAK,CAAA,CACxCuE,CAAAA,CAASzD,CAAAA,CAASd,CAAC,CAAA,CACnB+E,EAAaD,CAAAA,CAAaP,CAAAA,CAC9BI,EAAS,OAAA,CAAQ3E,CAAAA,CAAE,EAAGA,CAAAA,CAAE,CAAA,CAAG+E,CAAU,CAAA,CACrCF,CAAAA,CAAS,KAAK,GAAA,CAAIA,CAAAA,CAAQF,EAAS,IAAA,CAAK3E,CAAAA,CAAE,CAAC,CAAA,CAAE,GAAA,EAAOuE,CAAM,CAAA,CAC1DK,CAAAA,CAAS,IAAA,CAAK,IAAIA,CAAAA,CAAQD,CAAAA,CAAS,KAAK3E,CAAAA,CAAE,CAAC,EAAE,EAAA,EAAUuE,CAAM,EAC/D,CAAC,CAAA,CAED,IAAIP,EAAUgB,CAAAA,CAAMH,CAAAA,CAASD,EAAQ,CAAC,CAAA,CAAE,IAAI,IAAM,IAAI7B,CAAM,CAAA,CACxDkB,CAAAA,CAAUW,CAAAA,CAAQ,EAEtB,OAAAD,CAAAA,CAAS,OAAM,CAAE,OAAA,CAAQtD,GAAK,CAC5BoD,CAAAA,CAAaT,CAAAA,CAASC,CAAAA,CAASU,CAAAA,CAAS,IAAA,CAAKtD,CAAC,CAAC,EACjD,CAAC,CAAA,CAEM,CAAE,MAAOsD,CAAAA,CAAU,OAAA,CAASX,CAAAA,CAAS,OAAA,CAASC,CAAQ,CAC/D,CAEA,SAASQ,CAAAA,CAAaT,EAASC,CAAAA,CAAShB,CAAAA,CAAO,CACxCA,CAAAA,CAAM,GAAA,CAECA,CAAAA,CAAM,EAAA,CAGhBe,CAAAA,CAAQf,CAAAA,CAAM,IAAMA,CAAAA,CAAM,EAAA,CAAQgB,CAAO,CAAA,CAAE,OAAA,CAAQhB,CAAK,CAAA,CAFxDe,CAAAA,CAAQA,CAAAA,CAAQ,MAAA,CAAS,CAAC,CAAA,CAAE,QAAQf,CAAK,CAAA,CAFzCe,EAAQ,CAAC,CAAA,CAAE,QAAQf,CAAK,EAM5B,CAEA,SAAS+B,CAAAA,CAAMC,EAAO,CACpB,IAAMD,EAAQ,EAAC,CACf,QAAS5E,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAI6E,CAAAA,CAAO7E,CAAAA,EAAAA,CACzB4E,CAAAA,CAAM,KAAK5E,CAAC,CAAA,CAGd,OAAO4E,CACT,CAEA,EAAE,CAAC,aAAA,CAAc,CAAA,CAAE,mBAAA,CAAoB,EAAE,CAAC,EAAE,CAAA,CAAE,CAAC,SAASvE,CAAAA,CAAQb,CAAAA,CAAOD,EAAQ,CAG/E,IAAIuF,CAAAA,CAAUzE,CAAAA,CAAQ,WAAW,EAC7B0E,CAAAA,CAAY1E,CAAAA,CAAQ,aAAa,CAAA,CACjCkB,CAAAA,CAAOlB,EAAQ,QAAQ,CAAA,CACvB2E,CAAAA,CAAiB3E,CAAAA,CAAQ,QAAQ,CAAA,CAAE,eACnC4E,CAAAA,CAAoB5E,CAAAA,CAAQ,uBAAuB,CAAA,CACnD6E,CAAAA,CAAmB7E,EAAQ,QAAQ,CAAA,CAAE,gBAAA,CACrC8E,CAAAA,CAAe9E,CAAAA,CAAQ,iBAAiB,EACxCe,CAAAA,CAAoBf,CAAAA,CAAQ,uBAAuB,CAAA,CACnD+E,CAAAA,CAAmB/E,EAAQ,qBAAqB,CAAA,CAChDgF,CAAAA,CAAQhF,CAAAA,CAAQ,SAAS,CAAA,CACzBiF,EAAWjF,CAAAA,CAAQ,YAAY,EAC/Bc,CAAAA,CAAOd,CAAAA,CAAQ,QAAQ,CAAA,CACvB6C,CAAAA,CAAQ7C,CAAAA,CAAQ,mBAAmB,CAAA,CAAE,KAAA,CAEzCb,EAAO,OAAA,CAAU+F,CAAAA,CAEjB,SAASA,CAAAA,CAAO7F,CAAAA,CAAG8F,EAAM,CACvB,IAAIC,EAAOD,CAAAA,EAAQA,CAAAA,CAAK,YAAcrE,CAAAA,CAAK,IAAA,CAAOA,EAAK,MAAA,CACvDsE,CAAAA,CAAK,SAAU,IAAM,CACnB,IAAIC,CAAAA,CACFD,CAAAA,CAAK,oBAAA,CAAsB,IAAME,CAAAA,CAAiBjG,CAAC,CAAC,CAAA,CACtD+F,CAAAA,CAAK,cAAsB,IAAMG,CAAAA,CAAUF,CAAAA,CAAaD,CAAAA,CAAMD,CAAI,CAAC,EACnEC,CAAAA,CAAK,oBAAA,CAAsB,IAAMI,CAAAA,CAAiBnG,CAAAA,CAAGgG,CAAW,CAAC,EACnE,CAAC,EACH,CAEA,SAASE,EAAUlG,CAAAA,CAAG+F,CAAAA,CAAMD,EAAM,CAChCC,CAAAA,CAAK,6BAA8B,IAAMK,CAAAA,CAAuBpG,CAAC,CAAC,CAAA,CAClE+F,EAAK,qBAAA,CAA8B,IAAMM,EAAgBrG,CAAC,CAAC,EAC3D+F,CAAAA,CAAK,aAAA,CAA8B,IAAMX,CAAAA,CAAQ,GAAA,CAAIpF,CAAC,CAAC,CAAA,CACvD+F,CAAAA,CAAK,uBAA8B,IAAMN,CAAAA,CAAa,IAAIzF,CAAC,CAAC,CAAA,CAC5D+F,CAAAA,CAAK,UAAA,CAA8B,IAAMlE,EAAKJ,CAAAA,CAAK,kBAAA,CAAmBzB,CAAC,CAAC,CAAC,EACzE+F,CAAAA,CAAK,4BAAA,CAA8B,IAAMO,CAAAA,CAAuBtG,CAAC,CAAC,EAClE+F,CAAAA,CAAK,sBAAA,CAA8B,IAAMP,CAAAA,CAAiBxF,CAAC,CAAC,CAAA,CAC5D+F,CAAAA,CAAK,2BAA8B,IAAMN,CAAAA,CAAa,QAAQzF,CAAC,CAAC,EAChE+F,CAAAA,CAAK,oBAAA,CAA8B,IAAMT,CAAAA,CAAetF,CAAC,CAAC,CAAA,CAC1D+F,CAAAA,CAAK,sBAAA,CAA8B,IAAMQ,CAAAA,CAAiBvG,CAAC,CAAC,CAAA,CAC5D+F,CAAAA,CAAK,6BAA8B,IAAMS,CAAAA,CAAuBxG,CAAC,CAAC,CAAA,CAClE+F,CAAAA,CAAK,oBAA8B,IAAMV,CAAAA,CAAU,IAAIrF,CAAC,CAAC,EACzD+F,CAAAA,CAAK,uBAAA,CAA8B,IAAMR,CAAAA,CAAkBvF,CAAC,CAAC,EAC7D+F,CAAAA,CAAK,uBAAA,CAA8B,IAAMrE,CAAAA,CAAkB1B,CAAC,CAAC,CAAA,CAC7D+F,CAAAA,CAAK,WAAA,CAA8B,IAAMJ,CAAAA,CAAM3F,CAAAA,CAAG8F,CAAI,CAAC,CAAA,CACvDC,EAAK,qBAAA,CAA8B,IAAMU,EAAgBzG,CAAC,CAAC,CAAA,CAC3D+F,CAAAA,CAAK,4BAAA,CAA8B,IAAML,EAAiB,MAAA,CAAO1F,CAAC,CAAC,CAAA,CACnE+F,CAAAA,CAAK,eAA8B,IAAMH,CAAAA,CAAS5F,CAAC,CAAC,CAAA,CACpD+F,CAAAA,CAAK,wBAA8B,IAAMW,CAAAA,CAAkB1G,CAAC,CAAC,CAAA,CAC7D+F,EAAK,uBAAA,CAA8B,IAAMY,CAAAA,CAAkB3G,CAAC,CAAC,CAAA,CAC7D+F,EAAK,oBAAA,CAA8B,IAAMV,EAAU,IAAA,CAAKrF,CAAC,CAAC,CAAA,CAC1D+F,CAAAA,CAAK,2BAA8B,IAAMa,CAAAA,CAAqB5G,CAAC,CAAC,CAAA,CAChE+F,EAAK,0BAAA,CAA8B,IAAML,EAAiB,IAAA,CAAK1F,CAAC,CAAC,CAAA,CACjE+F,CAAAA,CAAK,oBAAA,CAA8B,IAAMc,CAAAA,CAAe7G,CAAC,CAAC,CAAA,CAC1D+F,CAAAA,CAAK,2BAA8B,IAAMe,CAAAA,CAAqB9G,CAAC,CAAC,CAAA,CAChE+F,CAAAA,CAAK,oBAA8B,IAAMgB,CAAAA,CAA8B/G,CAAC,CAAC,CAAA,CACzE+F,EAAK,kBAAA,CAA8B,IAAMX,CAAAA,CAAQ,IAAA,CAAKpF,CAAC,CAAC,EAC1D,CAQA,SAASmG,EAAiBa,CAAAA,CAAYhB,CAAAA,CAAa,CACjDgB,CAAAA,CAAW,KAAA,EAAM,CAAE,OAAA,CAAQzF,CAAAA,EAAK,CAC9B,IAAI0F,CAAAA,CAAaD,CAAAA,CAAW,KAAKzF,CAAC,CAAA,CAC9B2F,EAAclB,CAAAA,CAAY,IAAA,CAAKzE,CAAC,CAAA,CAEhC0F,CAAAA,GACFA,CAAAA,CAAW,EAAIC,CAAAA,CAAY,CAAA,CAC3BD,EAAW,CAAA,CAAIC,CAAAA,CAAY,EAC3BD,CAAAA,CAAW,IAAA,CAAOC,CAAAA,CAAY,IAAA,CAE1BlB,CAAAA,CAAY,QAAA,CAASzE,CAAC,CAAA,CAAE,MAAA,GAC1B0F,EAAW,KAAA,CAAQC,CAAAA,CAAY,MAC/BD,CAAAA,CAAW,MAAA,CAASC,CAAAA,CAAY,MAAA,CAAA,EAGtC,CAAC,CAAA,CAEDF,EAAW,KAAA,EAAM,CAAE,QAAQ9G,CAAAA,EAAK,CAC9B,IAAI+G,CAAAA,CAAaD,CAAAA,CAAW,KAAK9G,CAAC,CAAA,CAC9BgH,EAAclB,CAAAA,CAAY,IAAA,CAAK9F,CAAC,CAAA,CAEpC+G,CAAAA,CAAW,OAASC,CAAAA,CAAY,MAAA,CAC5B,MAAA,CAAO,MAAA,CAAOA,CAAAA,CAAa,GAAG,IAChCD,CAAAA,CAAW,CAAA,CAAIC,EAAY,CAAA,CAC3BD,CAAAA,CAAW,EAAIC,CAAAA,CAAY,CAAA,EAE/B,CAAC,CAAA,CAEDF,CAAAA,CAAW,KAAA,GAAQ,KAAA,CAAQhB,CAAAA,CAAY,OAAM,CAAE,KAAA,CAC/CgB,EAAW,KAAA,EAAM,CAAE,MAAA,CAAShB,CAAAA,CAAY,KAAA,EAAM,CAAE,OAClD,CAEA,IAAImB,EAAgB,CAAC,SAAA,CAAW,UAAW,SAAA,CAAW,SAAA,CAAW,SAAS,CAAA,CACtEC,CAAAA,CAAgB,CAAE,QAAS,EAAA,CAAI,OAAA,CAAS,GAAI,OAAA,CAAS,EAAA,CAAI,QAAS,IAAK,CAAA,CACvEC,CAAAA,CAAa,CAAC,WAAA,CAAa,QAAA,CAAU,UAAW,OAAO,CAAA,CACvDC,EAAe,CAAC,OAAA,CAAS,SAAU,MAAM,CAAA,CACzCC,CAAAA,CAAe,CAAE,KAAA,CAAO,CAAA,CAAG,OAAQ,CAAE,CAAA,CACrCC,EAAe,CAAC,QAAA,CAAU,SAAU,OAAA,CAAS,QAAA,CAAU,aAAa,CAAA,CACpEC,CAAAA,CAAe,CACjB,OAAQ,CAAA,CAAG,MAAA,CAAQ,EAAG,KAAA,CAAO,CAAA,CAAG,OAAQ,CAAA,CACxC,WAAA,CAAa,GAAI,QAAA,CAAU,GAC7B,EACIC,CAAAA,CAAY,CAAC,UAAU,CAAA,CAQ3B,SAASzB,EAAiBe,CAAAA,CAAY,CACpC,IAAIhH,CAAAA,CAAI,IAAIwD,CAAAA,CAAM,CAAE,UAAA,CAAY,IAAA,CAAM,SAAU,IAAK,CAAC,EAClDmE,CAAAA,CAAQC,CAAAA,CAAaZ,CAAAA,CAAW,KAAA,EAAO,CAAA,CAE3C,OAAAhH,CAAAA,CAAE,QAAA,CAAS,OAAO,MAAA,CAAO,GACvBoH,CAAAA,CACAS,CAAAA,CAAkBF,CAAAA,CAAOR,CAAa,CAAA,CACtC1F,CAAAA,CAAK,KAAKkG,CAAAA,CAAON,CAAU,CAAC,CAAC,CAAA,CAE/BL,EAAW,KAAA,EAAM,CAAE,QAAQzF,CAAAA,EAAK,CAC9B,IAAIK,CAAAA,CAAOgG,CAAAA,CAAaZ,EAAW,IAAA,CAAKzF,CAAC,CAAC,CAAA,CACpCuG,CAAAA,CAAUD,CAAAA,CAAkBjG,CAAAA,CAAM0F,CAAY,CAAA,CACpD,OAAO,IAAA,CAAKC,CAAY,EAAE,OAAA,CAAQhE,CAAAA,EAAK,CACjCuE,CAAAA,CAAQvE,CAAC,CAAA,GAAM,MAAA,GACjBuE,CAAAA,CAAQvE,CAAC,EAAIgE,CAAAA,CAAahE,CAAC,GAE/B,CAAC,CAAA,CAEDvD,EAAE,OAAA,CAAQuB,CAAAA,CAAGuG,CAAO,CAAA,CACpB9H,CAAAA,CAAE,SAAA,CAAUuB,EAAGyF,CAAAA,CAAW,MAAA,CAAOzF,CAAC,CAAC,EACrC,CAAC,CAAA,CAEDyF,CAAAA,CAAW,OAAM,CAAE,OAAA,CAAQ9G,GAAK,CAC9B,IAAI6C,EAAO6E,CAAAA,CAAaZ,CAAAA,CAAW,KAAK9G,CAAC,CAAC,CAAA,CAC1CF,CAAAA,CAAE,OAAA,CAAQE,CAAAA,CAAG,OAAO,MAAA,CAAO,GACzBuH,CAAAA,CACAI,CAAAA,CAAkB9E,EAAMyE,CAAY,CAAA,CACpC/F,CAAAA,CAAK,IAAA,CAAKsB,CAAAA,CAAM2E,CAAS,CAAC,CAAC,EAC/B,CAAC,CAAA,CAEM1H,CACT,CAUA,SAASoG,CAAAA,CAAuBpG,CAAAA,CAAG,CACjC,IAAI2H,CAAAA,CAAQ3H,EAAE,KAAA,EAAM,CACpB2H,EAAM,OAAA,EAAW,CAAA,CACjB3H,EAAE,KAAA,EAAM,CAAE,OAAA,CAAQE,CAAAA,EAAK,CACrB,IAAI6C,EAAO/C,CAAAA,CAAE,IAAA,CAAKE,CAAC,CAAA,CACnB6C,CAAAA,CAAK,QAAU,CAAA,CACXA,CAAAA,CAAK,QAAA,CAAS,WAAA,EAAY,GAAM,GAAA,GAC9B4E,EAAM,OAAA,GAAY,IAAA,EAAQA,EAAM,OAAA,GAAY,IAAA,CAC9C5E,EAAK,KAAA,EAASA,CAAAA,CAAK,WAAA,CAEnBA,CAAAA,CAAK,MAAA,EAAUA,CAAAA,CAAK,aAG1B,CAAC,EACH,CAQA,SAASuD,CAAAA,CAAuBtG,EAAG,CACjCA,CAAAA,CAAE,KAAA,EAAM,CAAE,OAAA,CAAQE,CAAAA,EAAK,CACrB,IAAI6C,CAAAA,CAAO/C,EAAE,IAAA,CAAKE,CAAC,EACnB,GAAI6C,CAAAA,CAAK,OAASA,CAAAA,CAAK,MAAA,CAAQ,CAC7B,IAAIxB,CAAAA,CAAIvB,EAAE,IAAA,CAAKE,CAAAA,CAAE,CAAC,CAAA,CAEdgB,CAAAA,CAAQ,CAAE,IAAA,CAAA,CADNlB,CAAAA,CAAE,IAAA,CAAKE,EAAE,CAAC,CAAA,CACK,KAAOqB,CAAAA,CAAE,IAAA,EAAQ,EAAIA,CAAAA,CAAE,IAAA,CAAM,CAAA,CAAGrB,CAAE,CAAA,CACzDuB,CAAAA,CAAK,aAAazB,CAAAA,CAAG,YAAA,CAAckB,EAAO,KAAK,EACjD,CACF,CAAC,EACH,CAEA,SAASqF,CAAAA,CAAiBvG,CAAAA,CAAG,CAC3B,IAAI8B,CAAAA,CAAU,EACd9B,CAAAA,CAAE,KAAA,GAAQ,OAAA,CAAQuB,CAAAA,EAAK,CACrB,IAAIK,CAAAA,CAAO5B,CAAAA,CAAE,KAAKuB,CAAC,CAAA,CACfK,EAAK,SAAA,GACPA,CAAAA,CAAK,QAAU5B,CAAAA,CAAE,IAAA,CAAK4B,CAAAA,CAAK,SAAS,CAAA,CAAE,IAAA,CACtCA,EAAK,OAAA,CAAU5B,CAAAA,CAAE,KAAK4B,CAAAA,CAAK,YAAY,EAAE,IAAA,CACzCE,CAAAA,CAAU,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAASF,CAAAA,CAAK,OAAO,CAAA,EAE5C,CAAC,EACD5B,CAAAA,CAAE,KAAA,GAAQ,OAAA,CAAU8B,EACtB,CAEA,SAAS0E,CAAAA,CAAuBxG,CAAAA,CAAG,CACjCA,CAAAA,CAAE,KAAA,GAAQ,OAAA,CAAQuB,CAAAA,EAAK,CACrB,IAAIK,CAAAA,CAAO5B,EAAE,IAAA,CAAKuB,CAAC,EACfK,CAAAA,CAAK,KAAA,GAAU,eACjB5B,CAAAA,CAAE,IAAA,CAAK4B,EAAK,CAAC,CAAA,CAAE,SAAA,CAAYA,CAAAA,CAAK,IAAA,CAChC5B,CAAAA,CAAE,WAAWuB,CAAC,CAAA,EAElB,CAAC,EACH,CAEA,SAASsF,CAAAA,CAAe7G,CAAAA,CAAG,CACzB,IAAI+H,CAAAA,CAAO,MAAA,CAAO,kBACdC,CAAAA,CAAO,CAAA,CACPC,EAAO,MAAA,CAAO,iBAAA,CACdC,EAAO,CAAA,CACPC,CAAAA,CAAanI,CAAAA,CAAE,KAAA,EAAM,CACrBoI,CAAAA,CAAUD,EAAW,OAAA,EAAW,CAAA,CAChCE,GAAUF,CAAAA,CAAW,OAAA,EAAW,EAEpC,SAASG,EAAAA,CAAY1F,EAAAA,CAAO,CAC1B,IAAI2F,EAAAA,CAAI3F,GAAM,CAAA,CACV4F,EAAAA,CAAI5F,GAAM,CAAA,CACVC,EAAAA,CAAID,GAAM,KAAA,CACVe,EAAAA,CAAIf,EAAAA,CAAM,MAAA,CACdmF,CAAAA,CAAO,IAAA,CAAK,IAAIA,CAAAA,CAAMQ,EAAAA,CAAI1F,GAAI,CAAC,CAAA,CAC/BmF,EAAO,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAMO,EAAAA,CAAI1F,EAAAA,CAAI,CAAC,EAC/BoF,CAAAA,CAAO,IAAA,CAAK,IAAIA,CAAAA,CAAMO,EAAAA,CAAI7E,GAAI,CAAC,CAAA,CAC/BuE,CAAAA,CAAO,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAMM,GAAI7E,EAAAA,CAAI,CAAC,EACjC,CAEA3D,CAAAA,CAAE,OAAM,CAAE,OAAA,CAAQuB,IAAK+G,EAAAA,CAAYtI,CAAAA,CAAE,KAAKuB,EAAC,CAAC,CAAC,CAAA,CAC7CvB,CAAAA,CAAE,OAAM,CAAE,OAAA,CAAQE,EAAAA,EAAK,CACrB,IAAI6C,EAAAA,CAAO/C,EAAE,IAAA,CAAKE,EAAC,EACf,MAAA,CAAO,MAAA,CAAO6C,GAAM,GAAG,CAAA,EACzBuF,EAAAA,CAAYvF,EAAI,EAEpB,CAAC,EAEDgF,CAAAA,EAAQK,CAAAA,CACRH,GAAQI,EAAAA,CAERrI,CAAAA,CAAE,OAAM,CAAE,OAAA,CAAQuB,EAAAA,EAAK,CACrB,IAAIK,EAAAA,CAAO5B,EAAE,IAAA,CAAKuB,EAAC,EACnBK,EAAAA,CAAK,CAAA,EAAKmG,EACVnG,EAAAA,CAAK,CAAA,EAAKqG,EACZ,CAAC,CAAA,CAEDjI,EAAE,KAAA,EAAM,CAAE,QAAQE,EAAAA,EAAK,CACrB,IAAI6C,EAAAA,CAAO/C,CAAAA,CAAE,IAAA,CAAKE,EAAC,CAAA,CACnB6C,EAAAA,CAAK,OAAO,OAAA,CAAQ0F,EAAAA,EAAK,CACvBA,EAAAA,CAAE,CAAA,EAAKV,EACPU,EAAAA,CAAE,CAAA,EAAKR,EACT,CAAC,CAAA,CACG,MAAA,CAAO,OAAOlF,EAAAA,CAAM,GAAG,IAAKA,EAAAA,CAAK,CAAA,EAAKgF,GACtC,MAAA,CAAO,MAAA,CAAOhF,EAAAA,CAAM,GAAG,CAAA,GAAKA,EAAAA,CAAK,GAAKkF,CAAAA,EAC5C,CAAC,EAEDE,CAAAA,CAAW,KAAA,CAAQH,EAAOD,CAAAA,CAAOK,CAAAA,CACjCD,EAAW,MAAA,CAASD,CAAAA,CAAOD,EAAOI,GACpC,CAEA,SAASvB,CAAAA,CAAqB9G,CAAAA,CAAG,CAC/BA,CAAAA,CAAE,KAAA,EAAM,CAAE,OAAA,CAAQE,CAAAA,EAAK,CACrB,IAAI6C,CAAAA,CAAO/C,CAAAA,CAAE,KAAKE,CAAC,CAAA,CACfwI,EAAQ1I,CAAAA,CAAE,IAAA,CAAKE,CAAAA,CAAE,CAAC,CAAA,CAClByI,CAAAA,CAAQ3I,EAAE,IAAA,CAAKE,CAAAA,CAAE,CAAC,CAAA,CAClB0I,CAAAA,CAAIC,EACH9F,CAAAA,CAAK,MAAA,EAKR6F,CAAAA,CAAK7F,CAAAA,CAAK,MAAA,CAAO,CAAC,EAClB8F,CAAAA,CAAK9F,CAAAA,CAAK,OAAOA,CAAAA,CAAK,MAAA,CAAO,OAAS,CAAC,CAAA,GALvCA,CAAAA,CAAK,MAAA,CAAS,EAAC,CACf6F,EAAKD,CAAAA,CACLE,CAAAA,CAAKH,GAKP3F,CAAAA,CAAK,MAAA,CAAO,QAAQtB,CAAAA,CAAK,aAAA,CAAciH,CAAAA,CAAOE,CAAE,CAAC,CAAA,CACjD7F,EAAK,MAAA,CAAO,IAAA,CAAKtB,EAAK,aAAA,CAAckH,CAAAA,CAAOE,CAAE,CAAC,EAChD,CAAC,EACH,CAEA,SAASjC,EAAqB5G,CAAAA,CAAG,CAC/BA,EAAE,KAAA,EAAM,CAAE,QAAQE,CAAAA,EAAK,CACrB,IAAI6C,CAAAA,CAAO/C,CAAAA,CAAE,IAAA,CAAKE,CAAC,CAAA,CACnB,GAAI,OAAO,MAAA,CAAO6C,CAAAA,CAAM,GAAG,CAAA,CAIzB,OAAA,CAHIA,EAAK,QAAA,GAAa,GAAA,EAAOA,EAAK,QAAA,GAAa,GAAA,IAC7CA,EAAK,KAAA,EAASA,CAAAA,CAAK,aAEbA,CAAAA,CAAK,QAAA,EACb,KAAK,GAAA,CAAKA,CAAAA,CAAK,GAAKA,CAAAA,CAAK,KAAA,CAAQ,EAAIA,CAAAA,CAAK,WAAA,CAAa,MACvD,KAAK,GAAA,CAAKA,CAAAA,CAAK,CAAA,EAAKA,CAAAA,CAAK,KAAA,CAAQ,EAAIA,CAAAA,CAAK,WAAA,CAAa,KACvD,CAEJ,CAAC,EACH,CAEA,SAASgE,CAAAA,CAA8B/G,CAAAA,CAAG,CACxCA,CAAAA,CAAE,OAAM,CAAE,OAAA,CAAQE,GAAK,CACrB,IAAI6C,EAAO/C,CAAAA,CAAE,IAAA,CAAKE,CAAC,CAAA,CACf6C,CAAAA,CAAK,QAAA,EACPA,EAAK,MAAA,CAAO,OAAA,GAEhB,CAAC,EACH,CAEA,SAAS4D,CAAAA,CAAkB3G,CAAAA,CAAG,CAC5BA,CAAAA,CAAE,KAAA,GAAQ,OAAA,CAAQuB,CAAAA,EAAK,CACrB,GAAIvB,CAAAA,CAAE,SAASuB,CAAC,CAAA,CAAE,MAAA,CAAQ,CACxB,IAAIK,CAAAA,CAAO5B,EAAE,IAAA,CAAKuB,CAAC,EACfnB,CAAAA,CAAIJ,CAAAA,CAAE,KAAK4B,CAAAA,CAAK,SAAS,CAAA,CACzBkH,CAAAA,CAAI9I,CAAAA,CAAE,IAAA,CAAK4B,EAAK,YAAY,CAAA,CAC5BmH,EAAI/I,CAAAA,CAAE,IAAA,CAAK4B,EAAK,UAAA,CAAWA,CAAAA,CAAK,WAAW,MAAA,CAAS,CAAC,CAAC,CAAA,CACtD3B,CAAAA,CAAID,EAAE,IAAA,CAAK4B,CAAAA,CAAK,YAAYA,CAAAA,CAAK,WAAA,CAAY,MAAA,CAAS,CAAC,CAAC,CAAA,CAE5DA,EAAK,KAAA,CAAQ,IAAA,CAAK,IAAI3B,CAAAA,CAAE,CAAA,CAAI8I,EAAE,CAAC,CAAA,CAC/BnH,CAAAA,CAAK,MAAA,CAAS,IAAA,CAAK,GAAA,CAAIkH,EAAE,CAAA,CAAI1I,CAAAA,CAAE,CAAC,CAAA,CAChCwB,CAAAA,CAAK,EAAImH,CAAAA,CAAE,CAAA,CAAInH,CAAAA,CAAK,KAAA,CAAQ,CAAA,CAC5BA,CAAAA,CAAK,EAAIxB,CAAAA,CAAE,CAAA,CAAIwB,EAAK,MAAA,CAAS,EAC/B,CACF,CAAC,CAAA,CAED5B,CAAAA,CAAE,KAAA,EAAM,CAAE,OAAA,CAAQuB,GAAK,CACjBvB,CAAAA,CAAE,KAAKuB,CAAC,CAAA,CAAE,QAAU,QAAA,EACtBvB,CAAAA,CAAE,UAAA,CAAWuB,CAAC,EAElB,CAAC,EACH,CAEA,SAAS8E,EAAgBrG,CAAAA,CAAG,CAC1BA,EAAE,KAAA,EAAM,CAAE,OAAA,CAAQE,CAAAA,EAAK,CACrB,GAAIA,EAAE,CAAA,GAAMA,CAAAA,CAAE,EAAG,CACf,IAAI0B,EAAO5B,CAAAA,CAAE,IAAA,CAAKE,CAAAA,CAAE,CAAC,CAAA,CAChB0B,CAAAA,CAAK,YACRA,CAAAA,CAAK,SAAA,CAAY,EAAC,CAAA,CAEpBA,CAAAA,CAAK,UAAU,IAAA,CAAK,CAAE,EAAG1B,CAAAA,CAAG,KAAA,CAAOF,EAAE,IAAA,CAAKE,CAAC,CAAE,CAAC,CAAA,CAC9CF,EAAE,UAAA,CAAWE,CAAC,EAChB,CACF,CAAC,EACH,CAEA,SAASuG,CAAAA,CAAgBzG,EAAG,CAC1B,IAAIgJ,EAASvH,CAAAA,CAAK,gBAAA,CAAiBzB,CAAC,CAAA,CACpCgJ,CAAAA,CAAO,OAAA,CAAQpF,GAAS,CACtB,IAAIqF,EAAa,CAAA,CACjBrF,CAAAA,CAAM,QAAQ,CAACrC,CAAAA,CAAGjB,CAAAA,GAAM,CACtB,IAAIsB,CAAAA,CAAO5B,EAAE,IAAA,CAAKuB,CAAC,EACnBK,CAAAA,CAAK,KAAA,CAAQtB,EAAI2I,CAAAA,CAAAA,CAChBrH,CAAAA,CAAK,SAAA,EAAa,EAAC,EAAG,OAAA,CAAQsH,IAAY,CACzCzH,CAAAA,CAAK,aAAazB,CAAAA,CAAG,UAAA,CAAY,CAC/B,KAAA,CAAOkJ,EAAAA,CAAS,KAAA,CAAM,KAAA,CACtB,MAAA,CAAQA,EAAAA,CAAS,MAAM,MAAA,CACvB,IAAA,CAAMtH,EAAK,IAAA,CACX,KAAA,CAAOtB,GAAK,EAAE2I,CAAAA,CACd,CAAA,CAAGC,EAAAA,CAAS,CAAA,CACZ,KAAA,CAAOA,GAAS,KAClB,CAAA,CAAG,KAAK,EACV,CAAC,EACD,OAAOtH,CAAAA,CAAK,UACd,CAAC,EACH,CAAC,EACH,CAEA,SAAS8E,EAAkB1G,CAAAA,CAAG,CAC5BA,EAAE,KAAA,EAAM,CAAE,QAAQuB,CAAAA,EAAK,CACrB,IAAIK,CAAAA,CAAO5B,CAAAA,CAAE,KAAKuB,CAAC,CAAA,CACnB,GAAIK,CAAAA,CAAK,KAAA,GAAU,UAAA,CAAY,CAC7B,IAAIuH,CAAAA,CAAWnJ,EAAE,IAAA,CAAK4B,CAAAA,CAAK,EAAE,CAAC,CAAA,CAC1B2G,EAAIY,CAAAA,CAAS,CAAA,CAAIA,CAAAA,CAAS,KAAA,CAAQ,CAAA,CAClCX,CAAAA,CAAIW,EAAS,CAAA,CACbC,CAAAA,CAAKxH,EAAK,CAAA,CAAI2G,CAAAA,CACdc,GAAKF,CAAAA,CAAS,MAAA,CAAS,CAAA,CAC3BnJ,CAAAA,CAAE,OAAA,CAAQ4B,CAAAA,CAAK,EAAGA,CAAAA,CAAK,KAAK,EAC5B5B,CAAAA,CAAE,UAAA,CAAWuB,CAAC,CAAA,CACdK,CAAAA,CAAK,KAAA,CAAM,MAAA,CAAS,CAClB,CAAE,EAAG2G,CAAAA,CAAI,CAAA,CAAIa,EAAK,CAAA,CAAG,CAAA,CAAGZ,EAAIa,EAAG,CAAA,CAC/B,CAAE,CAAA,CAAGd,CAAAA,CAAI,CAAA,CAAIa,EAAK,CAAA,CAAG,CAAA,CAAGZ,EAAIa,EAAG,CAAA,CAC/B,CAAE,CAAA,CAAGd,CAAAA,CAAQa,CAAAA,CAAQ,CAAA,CAAGZ,CAAE,CAAA,CAC1B,CAAE,CAAA,CAAGD,CAAAA,CAAI,EAAIa,CAAAA,CAAK,CAAA,CAAG,EAAGZ,CAAAA,CAAIa,EAAG,CAAA,CAC/B,CAAE,CAAA,CAAGd,CAAAA,CAAI,EAAIa,CAAAA,CAAK,CAAA,CAAG,EAAGZ,CAAAA,CAAIa,EAAG,CACjC,CAAA,CACAzH,CAAAA,CAAK,MAAM,CAAA,CAAIA,CAAAA,CAAK,EACpBA,CAAAA,CAAK,KAAA,CAAM,EAAIA,CAAAA,CAAK,EACtB,CACF,CAAC,EACH,CAEA,SAASiG,CAAAA,CAAkByB,CAAAA,CAAK1G,EAAO,CACrC,OAAOnB,EAAK,SAAA,CAAUA,CAAAA,CAAK,KAAK6H,CAAAA,CAAK1G,CAAK,CAAA,CAAG,MAAM,CACrD,CAEA,SAASgF,CAAAA,CAAahF,CAAAA,CAAO,CAC3B,IAAI2G,CAAAA,CAAW,EAAC,CAChB,OAAI3G,CAAAA,EACF,MAAA,CAAO,OAAA,CAAQA,CAAK,EAAE,OAAA,CAAQ,CAAC,CAACW,CAAAA,CAAGhC,CAAC,IAAM,CACpC,OAAOgC,CAAAA,EAAM,QAAA,GACfA,CAAAA,CAAIA,CAAAA,CAAE,aAAY,CAAA,CAGpBgG,CAAAA,CAAShG,CAAC,CAAA,CAAIhC,EAChB,CAAC,CAAA,CAEIgI,CACT,CAEA,CAAA,CAAE,CAAC,WAAA,CAAY,EAAE,uBAAA,CAAwB,CAAA,CAAE,sBAAsB,CAAA,CAAE,iBAAA,CAAkB,EAAE,aAAA,CAAc,EAAA,CAAG,SAAA,CAAU,EAAA,CAAG,uBAAA,CAAwB,EAAA,CAAG,aAAa,EAAA,CAAG,QAAA,CAAS,GAAG,QAAA,CAAS,EAAA,CAAG,oBAAoB,EAAE,CAAC,CAAA,CAAE,CAAA,CAAE,CAAC,SAAS5I,EAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CACpP,IAAI4B,CAAAA,CAAOd,EAAQ,QAAQ,CAAA,CAE3Bb,EAAO,OAAA,CAAU,CACf,IAAAgB,CAAAA,CACA,OAAA,CAAA0I,CACF,CAAA,CAyBA,SAAS1I,EAAId,CAAAA,CAAG,CACd,IAAIyJ,CAAAA,CAAOhI,CAAAA,CAAK,YAAA,CAAazB,EAAG,MAAA,CAAQ,GAAI,OAAO,CAAA,CAC/C0J,EAASC,CAAAA,CAAW3J,CAAC,CAAA,CACrB4J,CAAAA,CAAY,MAAA,CAAO,MAAA,CAAOF,CAAM,CAAA,CAChCG,CAAAA,CAASpI,EAAK,iBAAA,CAAkB,IAAA,CAAK,IAAKmI,CAAS,CAAA,CAAI,CAAA,CACvDE,CAAAA,CAAU,CAAA,CAAID,CAAAA,CAAS,EAE3B7J,CAAAA,CAAE,KAAA,GAAQ,WAAA,CAAcyJ,CAAAA,CAGxBzJ,EAAE,KAAA,EAAM,CAAE,OAAA,CAAQE,CAAAA,EAAKF,CAAAA,CAAE,IAAA,CAAKE,CAAC,CAAA,CAAE,MAAA,EAAU4J,CAAO,CAAA,CAGlD,IAAIrF,EAASsF,CAAAA,CAAW/J,CAAC,CAAA,CAAI,CAAA,CAG7BA,CAAAA,CAAE,QAAA,GAAW,OAAA,CAAQgK,CAAAA,EAAS1I,EAAItB,CAAAA,CAAGyJ,CAAAA,CAAMK,EAASrF,CAAAA,CAAQoF,CAAAA,CAAQH,CAAAA,CAAQM,CAAK,CAAC,CAAA,CAIlFhK,EAAE,KAAA,EAAM,CAAE,eAAiB8J,EAC7B,CAEA,SAASxI,CAAAA,CAAItB,CAAAA,CAAGyJ,CAAAA,CAAMK,CAAAA,CAASrF,CAAAA,CAAQoF,CAAAA,CAAQH,EAAQnI,CAAAA,CAAG,CACxD,IAAII,CAAAA,CAAW3B,CAAAA,CAAE,SAASuB,CAAC,CAAA,CAC3B,GAAI,CAACI,CAAAA,CAAS,OAAQ,CAChBJ,CAAAA,GAAMkI,GACRzJ,CAAAA,CAAE,OAAA,CAAQyJ,EAAMlI,CAAAA,CAAG,CAAE,MAAA,CAAQ,CAAA,CAAG,MAAA,CAAQuI,CAAQ,CAAC,CAAA,CAEnD,MACF,CAEA,IAAIG,CAAAA,CAAMxI,EAAK,aAAA,CAAczB,CAAAA,CAAG,KAAK,CAAA,CACjCkK,CAAAA,CAASzI,CAAAA,CAAK,cAAczB,CAAAA,CAAG,KAAK,EACpCkB,CAAAA,CAAQlB,CAAAA,CAAE,KAAKuB,CAAC,CAAA,CAEpBvB,CAAAA,CAAE,SAAA,CAAUiK,CAAAA,CAAK1I,CAAC,EAClBL,CAAAA,CAAM,SAAA,CAAY+I,EAClBjK,CAAAA,CAAE,SAAA,CAAUkK,EAAQ3I,CAAC,CAAA,CACrBL,EAAM,YAAA,CAAegJ,CAAAA,CAErBvI,EAAS,OAAA,CAAQqI,CAAAA,EAAS,CACxB1I,CAAAA,CAAItB,CAAAA,CAAGyJ,EAAMK,CAAAA,CAASrF,CAAAA,CAAQoF,CAAAA,CAAQH,CAAAA,CAAQM,CAAK,CAAA,CAEnD,IAAIG,CAAAA,CAAYnK,CAAAA,CAAE,KAAKgK,CAAK,CAAA,CACxBI,EAAWD,CAAAA,CAAU,SAAA,CAAYA,CAAAA,CAAU,SAAA,CAAYH,CAAAA,CACvDK,CAAAA,CAAcF,EAAU,YAAA,CAAeA,CAAAA,CAAU,aAAeH,CAAAA,CAChEM,CAAAA,CAAaH,EAAU,SAAA,CAAY1F,CAAAA,CAAS,CAAA,CAAIA,CAAAA,CAChD8F,CAAAA,CAASH,CAAAA,GAAaC,EAAc,CAAA,CAAIR,CAAAA,CAASH,EAAOnI,CAAC,CAAA,CAAI,EAEjEvB,CAAAA,CAAE,OAAA,CAAQiK,EAAKG,CAAAA,CAAU,CACvB,OAAQE,CAAAA,CACR,MAAA,CAAQC,EACR,WAAA,CAAa,IACf,CAAC,CAAA,CAEDvK,CAAAA,CAAE,OAAA,CAAQqK,CAAAA,CAAaH,CAAAA,CAAQ,CAC7B,OAAQI,CAAAA,CACR,MAAA,CAAQC,EACR,WAAA,CAAa,IACf,CAAC,EACH,CAAC,CAAA,CAEIvK,CAAAA,CAAE,MAAA,CAAOuB,CAAC,GACbvB,CAAAA,CAAE,OAAA,CAAQyJ,EAAMQ,CAAAA,CAAK,CAAE,OAAQ,CAAA,CAAG,MAAA,CAAQJ,CAAAA,CAASH,CAAAA,CAAOnI,CAAC,CAAE,CAAC,EAElE,CAEA,SAASoI,CAAAA,CAAW3J,CAAAA,CAAG,CACrB,IAAI0J,CAAAA,CAAS,EAAC,CACd,SAASpI,CAAAA,CAAIC,EAAGiJ,CAAAA,CAAO,CACrB,IAAI7I,CAAAA,CAAW3B,CAAAA,CAAE,SAASuB,CAAC,CAAA,CACvBI,CAAAA,EAAYA,CAAAA,CAAS,MAAA,EACvBA,CAAAA,CAAS,QAAQqI,CAAAA,EAAS1I,CAAAA,CAAI0I,EAAOQ,CAAAA,CAAQ,CAAC,CAAC,CAAA,CAEjDd,CAAAA,CAAOnI,CAAC,CAAA,CAAIiJ,EACd,CACA,OAAAxK,CAAAA,CAAE,QAAA,GAAW,OAAA,CAAQuB,CAAAA,EAAKD,EAAIC,CAAAA,CAAG,CAAC,CAAC,CAAA,CAC5BmI,CACT,CAEA,SAASK,CAAAA,CAAW/J,CAAAA,CAAG,CACrB,OAAOA,CAAAA,CAAE,OAAM,CAAE,MAAA,CAAO,CAACyK,CAAAA,CAAKvK,CAAAA,GAAMuK,EAAMzK,CAAAA,CAAE,IAAA,CAAKE,CAAC,CAAA,CAAE,MAAA,CAAQ,CAAC,CAC/D,CAEA,SAASsJ,CAAAA,CAAQxJ,CAAAA,CAAG,CAClB,IAAImI,CAAAA,CAAanI,CAAAA,CAAE,OAAM,CACzBA,CAAAA,CAAE,WAAWmI,CAAAA,CAAW,WAAW,CAAA,CACnC,OAAOA,CAAAA,CAAW,WAAA,CAClBnI,EAAE,KAAA,EAAM,CAAE,QAAQE,CAAAA,EAAK,CACrB,IAAI6C,CAAAA,CAAO/C,CAAAA,CAAE,IAAA,CAAKE,CAAC,CAAA,CACf6C,CAAAA,CAAK,aACP/C,CAAAA,CAAE,UAAA,CAAWE,CAAC,EAElB,CAAC,EACH,CAEA,CAAA,CAAE,CAAC,QAAA,CAAS,EAAE,CAAC,EAAE,EAAA,CAAG,CAAC,SAASS,CAAAA,CAAQb,CAAAA,CAAOD,EAAQ,CAGrD,IAAI4B,CAAAA,CAAOd,CAAAA,CAAQ,QAAQ,EAE3Bb,CAAAA,CAAO,OAAA,CAAU,CACf,GAAA,CAAKgB,CAAAA,CACL,KAAMC,CACR,CAAA,CAkBA,SAASD,CAAAA,CAAId,CAAAA,CAAG,CACdA,EAAE,KAAA,EAAM,CAAE,YAAc,EAAC,CACzBA,EAAE,KAAA,EAAM,CAAE,OAAA,CAAQ+C,CAAAA,EAAQ2H,CAAAA,CAAc1K,CAAAA,CAAG+C,CAAI,CAAC,EAClD,CAEA,SAAS2H,CAAAA,CAAc1K,EAAGE,CAAAA,CAAG,CAC3B,IAAIqB,CAAAA,CAAIrB,CAAAA,CAAE,EACNyK,CAAAA,CAAQ3K,CAAAA,CAAE,KAAKuB,CAAC,CAAA,CAAE,KAClBsB,CAAAA,CAAI3C,CAAAA,CAAE,CAAA,CACN0K,CAAAA,CAAQ5K,CAAAA,CAAE,IAAA,CAAK6C,CAAC,CAAA,CAAE,IAAA,CAClBgI,EAAO3K,CAAAA,CAAE,IAAA,CACT4K,EAAY9K,CAAAA,CAAE,IAAA,CAAKE,CAAC,CAAA,CACpB6K,CAAAA,CAAYD,CAAAA,CAAU,UAE1B,GAAIF,CAAAA,GAAUD,EAAQ,CAAA,CAAG,OAEzB3K,EAAE,UAAA,CAAWE,CAAC,CAAA,CAEd,IAAI8K,CAAAA,CAAOpI,CAAAA,CAAOtC,EAClB,IAAKA,CAAAA,CAAI,EAAG,EAAEqK,CAAAA,CAAOA,EAAQC,CAAAA,CAAO,EAAEtK,CAAAA,CAAG,EAAEqK,CAAAA,CACzCG,CAAAA,CAAU,OAAS,EAAC,CACpBlI,EAAQ,CACN,KAAA,CAAO,EAAG,MAAA,CAAQ,CAAA,CAClB,SAAA,CAAWkI,CAAAA,CAAW,OAAA,CAAS5K,CAAAA,CAC/B,KAAMyK,CACR,CAAA,CACAK,EAAQvJ,CAAAA,CAAK,YAAA,CAAazB,EAAG,MAAA,CAAQ4C,CAAAA,CAAO,IAAI,CAAA,CAC5C+H,CAAAA,GAAUI,CAAAA,GACZnI,EAAM,KAAA,CAAQkI,CAAAA,CAAU,MACxBlI,CAAAA,CAAM,MAAA,CAASkI,EAAU,MAAA,CACzBlI,CAAAA,CAAM,KAAA,CAAQ,YAAA,CACdA,CAAAA,CAAM,QAAA,CAAWkI,EAAU,QAAA,CAAA,CAE7B9K,CAAAA,CAAE,QAAQuB,CAAAA,CAAGyJ,CAAAA,CAAO,CAAE,MAAA,CAAQF,CAAAA,CAAU,MAAO,CAAA,CAAGD,CAAI,EAClDvK,CAAAA,GAAM,CAAA,EACRN,EAAE,KAAA,EAAM,CAAE,YAAY,IAAA,CAAKgL,CAAK,CAAA,CAElCzJ,CAAAA,CAAIyJ,CAAAA,CAGNhL,CAAAA,CAAE,QAAQuB,CAAAA,CAAGsB,CAAAA,CAAG,CAAE,MAAA,CAAQiI,CAAAA,CAAU,MAAO,CAAA,CAAGD,CAAI,EACpD,CAEA,SAAS9J,CAAAA,CAAKf,EAAG,CACfA,CAAAA,CAAE,OAAM,CAAE,WAAA,CAAY,QAAQuB,CAAAA,EAAK,CACjC,IAAIK,CAAAA,CAAO5B,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CACf0J,CAAAA,CAAYrJ,EAAK,SAAA,CACjBiB,CAAAA,CAEJ,IADA7C,CAAAA,CAAE,OAAA,CAAQ4B,EAAK,OAAA,CAASqJ,CAAS,EAC1BrJ,CAAAA,CAAK,KAAA,EACViB,EAAI7C,CAAAA,CAAE,UAAA,CAAWuB,CAAC,CAAA,CAAE,CAAC,CAAA,CACrBvB,CAAAA,CAAE,UAAA,CAAWuB,CAAC,EACd0J,CAAAA,CAAU,MAAA,CAAO,KAAK,CAAE,CAAA,CAAGrJ,EAAK,CAAA,CAAG,CAAA,CAAGA,CAAAA,CAAK,CAAE,CAAC,CAAA,CAC1CA,EAAK,KAAA,GAAU,YAAA,GACjBqJ,EAAU,CAAA,CAAIrJ,CAAAA,CAAK,EACnBqJ,CAAAA,CAAU,CAAA,CAAIrJ,CAAAA,CAAK,CAAA,CACnBqJ,CAAAA,CAAU,KAAA,CAAQrJ,EAAK,KAAA,CACvBqJ,CAAAA,CAAU,OAASrJ,CAAAA,CAAK,MAAA,CAAA,CAE1BL,EAAIsB,CAAAA,CACJjB,CAAAA,CAAO5B,EAAE,IAAA,CAAKuB,CAAC,EAEnB,CAAC,EACH,CAEA,CAAA,CAAE,CAAC,SAAS,EAAE,CAAC,CAAA,CAAE,EAAA,CAAG,CAAC,SAASZ,EAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CACrDC,CAAAA,CAAO,OAAA,CAAUoL,EAEjB,SAASA,CAAAA,CAAuBlL,CAAAA,CAAGmL,CAAAA,CAAIC,CAAAA,CAAI,CACzC,IAAIhJ,CAAAA,CAAO,GACTiJ,CAAAA,CAEFD,CAAAA,CAAG,QAAQ7J,CAAAA,EAAK,CACd,IAAIyI,CAAAA,CAAQhK,CAAAA,CAAE,MAAA,CAAOuB,CAAC,CAAA,CACpB+J,CAAAA,CACAC,EACF,KAAOvB,CAAAA,EAAO,CASZ,GARAsB,CAAAA,CAAStL,CAAAA,CAAE,MAAA,CAAOgK,CAAK,CAAA,CACnBsB,GACFC,CAAAA,CAAYnJ,CAAAA,CAAKkJ,CAAM,CAAA,CACvBlJ,CAAAA,CAAKkJ,CAAM,CAAA,CAAItB,CAAAA,GAEfuB,CAAAA,CAAYF,CAAAA,CACZA,CAAAA,CAAWrB,CAAAA,CAAAA,CAETuB,GAAaA,CAAAA,GAAcvB,CAAAA,CAAO,CACpCmB,CAAAA,CAAG,OAAA,CAAQI,EAAWvB,CAAK,CAAA,CAC3B,MACF,CACAA,CAAAA,CAAQsB,EACV,CACF,CAAC,EAyBH,CAEA,CAAA,CAAE,EAAE,CAAA,CAAE,EAAA,CAAG,CAAC,SAAS3K,CAAAA,CAAQb,CAAAA,CAAOD,EAAQ,CAC1CC,CAAAA,CAAO,QAAU0L,CAAAA,CAEjB,SAASA,EAAWxL,CAAAA,CAAGyL,CAAAA,CAAU,EAAC,CAAG,CACnC,OAAOA,CAAAA,CAAQ,GAAA,CAAIlK,GAAK,CACtB,IAAImK,EAAM1L,CAAAA,CAAE,OAAA,CAAQuB,CAAC,CAAA,CACrB,GAAKmK,CAAAA,CAAI,OAEF,CACL,IAAIC,EAASD,CAAAA,CAAI,MAAA,CAAO,CAACjB,CAAAA,CAAKvK,CAAAA,GAAM,CAClC,IAAI6C,CAAAA,CAAO/C,CAAAA,CAAE,KAAKE,CAAC,CAAA,CACjB0L,EAAQ5L,CAAAA,CAAE,IAAA,CAAKE,EAAE,CAAC,CAAA,CACpB,OAAO,CACL,GAAA,CAAKuK,CAAAA,CAAI,IAAO1H,CAAAA,CAAK,MAAA,CAAS6I,EAAM,KAAA,CACpC,MAAA,CAAQnB,EAAI,MAAA,CAAS1H,CAAAA,CAAK,MAC5B,CACF,CAAA,CAAG,CAAE,IAAK,CAAA,CAAG,MAAA,CAAQ,CAAE,CAAC,CAAA,CAExB,OAAO,CACL,CAAA,CAAGxB,CAAAA,CACH,UAAA,CAAYoK,CAAAA,CAAO,GAAA,CAAMA,EAAO,MAAA,CAChC,MAAA,CAAQA,EAAO,MACjB,CACF,MAhBE,OAAO,CAAE,CAAA,CAAGpK,CAAE,CAiBlB,CAAC,CACH,CAGA,CAAA,CAAE,EAAE,CAAA,CAAE,GAAG,CAAC,SAASZ,CAAAA,CAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CAC1C,IAAI2D,CAAAA,CAAQ7C,CAAAA,CAAQ,mBAAmB,CAAA,CAAE,KAAA,CACrCc,EAAOd,CAAAA,CAAQ,SAAS,EAE5Bb,CAAAA,CAAO,OAAA,CAAU+L,EAkCjB,SAASA,CAAAA,CAAgB7L,EAAG6B,CAAAA,CAAMiK,CAAAA,CAAcC,EAAe,CACxDA,CAAAA,GACHA,CAAAA,CAAgB/L,CAAAA,CAAE,KAAA,EAAM,CAAA,CAE1B,IAAIyJ,CAAAA,CAAOuC,CAAAA,CAAehM,CAAC,CAAA,CACzB2L,CAAAA,CAAS,IAAInI,CAAAA,CAAM,CAAE,QAAA,CAAU,IAAK,CAAC,CAAA,CAClC,SAAS,CAAE,IAAA,CAAMiG,CAAK,CAAC,CAAA,CACvB,oBAAqBlI,CAAAA,EAAMvB,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAC,CAAA,CAEzC,OAAAwK,CAAAA,CAAc,OAAA,CAASxK,GAAM,CAC3B,IAAIK,EAAO5B,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CACjB+J,CAAAA,CAAStL,CAAAA,CAAE,OAAOuB,CAAC,CAAA,CAAA,CAEjBK,EAAK,IAAA,GAASC,CAAAA,EAAQD,EAAK,OAAA,EAAWC,CAAAA,EAAQA,CAAAA,EAAQD,CAAAA,CAAK,OAAA,IAC7D+J,CAAAA,CAAO,QAAQpK,CAAC,CAAA,CAChBoK,EAAO,SAAA,CAAUpK,CAAAA,CAAG+J,GAAU7B,CAAI,CAAA,CAGlCzJ,CAAAA,CAAE8L,CAAY,CAAA,CAAEvK,CAAC,EAAE,OAAA,CAAQrB,CAAAA,EAAK,CAC9B,IAAIO,CAAAA,CAAIP,EAAE,CAAA,GAAMqB,CAAAA,CAAIrB,CAAAA,CAAE,CAAA,CAAIA,CAAAA,CAAE,CAAA,CAC1B6C,EAAO4I,CAAAA,CAAO,IAAA,CAAKlL,EAAGc,CAAC,CAAA,CACvBkD,EAAS1B,CAAAA,GAAS,MAAA,CAAYA,EAAK,MAAA,CAAS,CAAA,CAC9C4I,EAAO,OAAA,CAAQlL,CAAAA,CAAGc,EAAG,CAAE,MAAA,CAAQvB,EAAE,IAAA,CAAKE,CAAC,CAAA,CAAE,MAAA,CAASuE,CAAO,CAAC,EAC5D,CAAC,CAAA,CAEG,OAAO,MAAA,CAAO7C,CAAAA,CAAM,SAAS,CAAA,EAC/B+J,CAAAA,CAAO,OAAA,CAAQpK,CAAAA,CAAG,CAChB,UAAA,CAAYK,EAAK,UAAA,CAAWC,CAAI,EAChC,WAAA,CAAaD,CAAAA,CAAK,YAAYC,CAAI,CACpC,CAAC,CAAA,EAGP,CAAC,CAAA,CAEM8J,CACT,CAEA,SAASK,EAAehM,CAAAA,CAAG,CAEzB,QADIuB,CAAAA,CACGvB,CAAAA,CAAE,QAASuB,CAAAA,CAAIE,CAAAA,CAAK,SAAS,OAAO,CAAE,GAAE,CAC/C,OAAOF,CACT,CAEA,CAAA,CAAE,CAAC,SAAA,CAAU,EAAA,CAAG,mBAAA,CAAoB,EAAE,CAAC,CAAA,CAAE,GAAG,CAAC,SAASZ,EAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CAG7E,IAAIoM,CAAAA,CAAYtL,EAAQ,SAAS,CAAA,CAAE,UAEnCb,CAAAA,CAAO,OAAA,CAAUoM,EAkBjB,SAASA,CAAAA,CAAWlM,CAAAA,CAAGmM,CAAAA,CAAU,CAC/B,IAAIC,EAAK,CAAA,CACT,IAAA,IAAS9L,EAAI,CAAA,CAAGA,CAAAA,CAAI6L,EAAS,MAAA,CAAQ,EAAE7L,EACrC8L,CAAAA,EAAMC,CAAAA,CAAmBrM,EAAGmM,CAAAA,CAAS7L,CAAAA,CAAE,CAAC,CAAA,CAAG6L,CAAAA,CAAS7L,CAAC,CAAC,CAAA,CAExD,OAAO8L,CACT,CAEA,SAASC,EAAmBrM,CAAAA,CAAGsM,CAAAA,CAAYC,EAAY,CAIrD,IAAIC,EAAWP,CAAAA,CAAUM,CAAAA,CAAYA,CAAAA,CAAW,GAAA,CAAI,CAAChL,CAAAA,CAAGjB,IAAMA,CAAC,CAAC,EAC5DmM,CAAAA,CAAeH,CAAAA,CAAW,QAAQ/K,CAAAA,EAC7BvB,CAAAA,CAAE,QAAA,CAASuB,CAAC,CAAA,CAAE,GAAA,CAAIrB,IAChB,CAAE,GAAA,CAAKsM,EAAStM,CAAAA,CAAE,CAAC,EAAG,MAAA,CAAQF,CAAAA,CAAE,IAAA,CAAKE,CAAC,CAAA,CAAE,MAAO,EACvD,CAAA,CAAE,IAAA,CAAK,CAACQ,CAAAA,CAAGoI,CAAAA,GAAMpI,EAAE,GAAA,CAAMoI,CAAAA,CAAE,GAAG,CAChC,CAAA,CAGG4D,CAAAA,CAAa,EACjB,KAAOA,CAAAA,CAAaH,EAAW,MAAA,EAAQG,CAAAA,GAAe,EACtD,IAAIC,CAAAA,CAAW,CAAA,CAAID,CAAAA,CAAa,CAAA,CAChCA,CAAAA,EAAc,EACd,IAAIE,CAAAA,CAAO,IAAI,KAAA,CAAMD,CAAQ,EAAE,IAAA,CAAK,CAAC,CAAA,CAGjCP,CAAAA,CAAK,CAAA,CACT,OAAAK,EAAa,OAAA,CAAQtJ,CAAAA,EAAS,CAC5B,IAAI0J,CAAAA,CAAQ1J,EAAM,GAAA,CAAMuJ,CAAAA,CACxBE,EAAKC,CAAK,CAAA,EAAK1J,EAAM,MAAA,CACrB,IAAI2J,EAAY,CAAA,CAChB,KAAOD,EAAQ,CAAA,EACTA,CAAAA,CAAQ,CAAA,GACVC,CAAAA,EAAaF,CAAAA,CAAKC,CAAAA,CAAQ,CAAC,CAAA,CAAA,CAE7BA,CAAAA,CAASA,EAAQ,CAAA,EAAM,CAAA,CACvBD,EAAKC,CAAK,CAAA,EAAK1J,CAAAA,CAAM,MAAA,CAEvBiJ,CAAAA,EAAMjJ,CAAAA,CAAM,OAAS2J,EACvB,CAAC,EAEMV,CACT,CAEA,EAAE,CAAC,SAAA,CAAU,EAAE,CAAC,CAAA,CAAE,EAAA,CAAG,CAAC,SAASzL,CAAAA,CAAQb,EAAOD,CAAAA,CAAQ,CAGtD,IAAIkN,CAAAA,CAAYpM,CAAAA,CAAQ,cAAc,CAAA,CAClCuL,CAAAA,CAAavL,EAAQ,eAAe,CAAA,CACpCqM,EAAerM,CAAAA,CAAQ,iBAAiB,EACxCkL,CAAAA,CAAkBlL,CAAAA,CAAQ,qBAAqB,CAAA,CAC/CuK,CAAAA,CAAyBvK,CAAAA,CAAQ,4BAA4B,CAAA,CAC7D6C,CAAAA,CAAQ7C,EAAQ,mBAAmB,CAAA,CAAE,MACrCc,CAAAA,CAAOd,CAAAA,CAAQ,SAAS,CAAA,CAE5Bb,CAAAA,CAAO,OAAA,CAAU6F,EAiBjB,SAASA,CAAAA,CAAM,EAAGG,CAAAA,CAAM,CACtB,GAAIA,CAAAA,EAAQ,OAAOA,CAAAA,CAAK,WAAA,EAAgB,UAAA,CAAY,CAClDA,EAAK,WAAA,CAAY,CAAA,CAAGH,CAAK,CAAA,CACzB,MACF,CAEA,IAAI7D,CAAAA,CAAUL,EAAK,OAAA,CAAQ,CAAC,EAC1BwL,CAAAA,CAAkBC,CAAAA,CAAiB,EAAGzL,CAAAA,CAAK,KAAA,CAAM,EAAGK,CAAAA,CAAU,CAAC,CAAA,CAAG,SAAS,CAAA,CAC3EqL,CAAAA,CAAgBD,EAAiB,CAAA,CAAGzL,CAAAA,CAAK,MAAMK,CAAAA,CAAU,CAAA,CAAG,GAAI,EAAE,CAAA,CAAG,UAAU,CAAA,CAE7EqK,CAAAA,CAAWY,CAAAA,CAAU,CAAC,CAAA,CAG1B,GAFAK,EAAY,CAAA,CAAGjB,CAAQ,EAEnBrG,CAAAA,EAAQA,CAAAA,CAAK,4BAAA,CACf,OAGF,IAAIuH,CAAAA,CAAS,OAAO,iBAAA,CAClBC,CAAAA,CAEF,QAAShN,CAAAA,CAAI,CAAA,CAAGiN,EAAW,CAAA,CAAGA,CAAAA,CAAW,CAAA,CAAG,EAAEjN,CAAAA,CAAG,EAAEiN,EAAU,CAC3DC,CAAAA,CAAiBlN,EAAI,CAAA,CAAI2M,CAAAA,CAAkBE,EAAe7M,CAAAA,CAAI,CAAA,EAAK,CAAC,CAAA,CAEpE6L,CAAAA,CAAW1K,CAAAA,CAAK,iBAAiB,CAAC,CAAA,CAClC,IAAI2K,CAAAA,CAAKF,CAAAA,CAAW,EAAGC,CAAQ,CAAA,CAC3BC,CAAAA,CAAKiB,CAAAA,GACPE,CAAAA,CAAW,CAAA,CACXD,EAAO,MAAA,CAAO,MAAA,CAAO,EAAC,CAAGnB,CAAQ,EACjCkB,CAAAA,CAASjB,CAAAA,EAEb,CAEAgB,CAAAA,CAAY,CAAA,CAAGE,CAAI,EACrB,CAEA,SAASJ,EAAiB,CAAA,CAAGO,CAAAA,CAAO3B,EAAc,CAIhD,IAAM4B,EAAc,IAAI,GAAA,CAClBC,EAAgB,CAAC9L,CAAAA,CAAMD,IAAS,CAC/B8L,CAAAA,CAAY,IAAI7L,CAAI,CAAA,EACvB6L,CAAAA,CAAY,GAAA,CAAI7L,CAAAA,CAAM,EAAE,CAAA,CAE1B6L,CAAAA,CAAY,IAAI7L,CAAI,CAAA,CAAE,KAAKD,CAAI,EACjC,CAAA,CAIA,IAAA,IAAWL,CAAAA,IAAK,CAAA,CAAE,OAAM,CAAG,CACzB,IAAMK,CAAAA,CAAO,CAAA,CAAE,KAAKL,CAAC,CAAA,CAMrB,GALI,OAAOK,CAAAA,CAAK,IAAA,EAAS,UACvB+L,CAAAA,CAAc/L,CAAAA,CAAK,KAAML,CAAC,CAAA,CAIxB,OAAOK,CAAAA,CAAK,OAAA,EAAY,QAAA,EAAY,OAAOA,CAAAA,CAAK,OAAA,EAAY,SAC9D,IAAA,IAAS3B,CAAAA,CAAI2B,EAAK,OAAA,CAAS3B,CAAAA,EAAK2B,EAAK,OAAA,CAAS3B,CAAAA,EAAAA,CACxCA,CAAAA,GAAM2B,CAAAA,CAAK,IAAA,EAEb+L,CAAAA,CAAc1N,EAAGsB,CAAC,EAI1B,CAEA,OAAOkM,CAAAA,CAAM,IAAI,SAAU5L,CAAAA,CAAM,CAC/B,OAAOgK,CAAAA,CAAgB,CAAA,CAAGhK,EAAMiK,CAAAA,CAAc4B,CAAAA,CAAY,IAAI7L,CAAI,CAAA,EAAK,EAAE,CAC3E,CAAC,CACH,CAEA,SAAS2L,EAAiBI,CAAAA,CAAaC,CAAAA,CAAW,CAChD,IAAI1C,CAAAA,CAAK,IAAI3H,CAAAA,CACboK,CAAAA,CAAY,QAAQ,SAASE,CAAAA,CAAI,CAC/B,IAAIrE,CAAAA,CAAOqE,EAAG,KAAA,EAAM,CAAE,KAClBC,CAAAA,CAASf,CAAAA,CAAac,CAAAA,CAAIrE,CAAAA,CAAM0B,CAAAA,CAAI0C,CAAS,EACjDE,CAAAA,CAAO,EAAA,CAAG,QAAQ,CAACxM,CAAAA,CAAGjB,IAAMwN,CAAAA,CAAG,IAAA,CAAKvM,CAAC,CAAA,CAAE,KAAA,CAAQjB,CAAC,EAChD4K,CAAAA,CAAuB4C,CAAAA,CAAI3C,EAAI4C,CAAAA,CAAO,EAAE,EAC1C,CAAC,EACH,CAEA,SAASX,CAAAA,CAAY,CAAA,CAAGjB,EAAU,CAChC,MAAA,CAAO,OAAOA,CAAQ,CAAA,CAAE,QAAQvI,CAAAA,EAASA,CAAAA,CAAM,OAAA,CAAQ,CAACrC,CAAAA,CAAGjB,CAAAA,GAAM,EAAE,IAAA,CAAKiB,CAAC,EAAE,KAAA,CAAQjB,CAAC,CAAC,EACvF,CAEA,CAAA,CAAE,CAAC,SAAA,CAAU,EAAA,CAAG,6BAA6B,EAAA,CAAG,qBAAA,CAAsB,GAAG,eAAA,CAAgB,EAAA,CAAG,eAAe,EAAA,CAAG,iBAAA,CAAkB,EAAA,CAAG,mBAAA,CAAoB,EAAE,CAAC,EAAE,EAAA,CAAG,CAAC,SAASK,CAAAA,CAAQb,CAAAA,CAAOD,EAAQ,CAGhM,IAAI4B,CAAAA,CAAOd,CAAAA,CAAQ,SAAS,EAE5Bb,CAAAA,CAAO,OAAA,CAAUiN,EAajB,SAASA,CAAAA,CAAU/M,EAAG,CACpB,IAAIqB,EAAU,EAAC,CACX2M,EAAchO,CAAAA,CAAE,KAAA,GAAQ,MAAA,CAAOuB,CAAAA,EAAK,CAACvB,CAAAA,CAAE,QAAA,CAASuB,CAAC,CAAA,CAAE,MAAM,CAAA,CACzD0M,EAAmBD,CAAAA,CAAY,GAAA,CAAIzM,GAAKvB,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CAAE,IAAI,CAAA,CACtDO,CAAAA,CAAUL,CAAAA,CAAK,iBAAA,CAAkB,KAAK,GAAA,CAAKwM,CAAgB,EAC3DjF,CAAAA,CAASvH,CAAAA,CAAK,MAAMK,CAAAA,CAAU,CAAC,CAAA,CAAE,GAAA,CAAI,IAAM,EAAE,CAAA,CAEjD,SAASR,EAAIC,CAAAA,CAAG,CACd,GAAIF,CAAAA,CAAQE,CAAC,CAAA,CAAG,OAChBF,CAAAA,CAAQE,CAAC,EAAI,IAAA,CACb,IAAIK,EAAO5B,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CACnByH,CAAAA,CAAOpH,CAAAA,CAAK,IAAI,CAAA,CAAE,IAAA,CAAKL,CAAC,CAAA,CACxBvB,CAAAA,CAAE,WAAWuB,CAAC,CAAA,CAAE,QAAQD,CAAG,EAC7B,CAGA,OADgB0M,CAAAA,CAAY,IAAA,CAAK,CAACtN,CAAAA,CAAGoI,CAAAA,GAAM9I,EAAE,IAAA,CAAKU,CAAC,EAAE,IAAA,CAAOV,CAAAA,CAAE,IAAA,CAAK8I,CAAC,CAAA,CAAE,IAAI,EAChE,OAAA,CAAQxH,CAAG,EAEd0H,CACT,CAEA,EAAE,CAAC,SAAA,CAAU,EAAE,CAAC,CAAA,CAAE,GAAG,CAAC,SAASrI,EAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CAGtD,IAAI4B,CAAAA,CAAOd,CAAAA,CAAQ,SAAS,CAAA,CAE5Bb,EAAO,OAAA,CAAUoO,CAAAA,CA2BjB,SAASA,CAAAA,CAAiBC,CAAAA,CAAShD,EAAI,CACrC,IAAIiD,CAAAA,CAAgB,EAAC,CACrBD,CAAAA,CAAQ,QAAQ,CAAChL,CAAAA,CAAO7C,IAAM,CAC5B,IAAI+N,EAAMD,CAAAA,CAAcjL,CAAAA,CAAM,CAAC,CAAA,CAAI,CACjC,QAAA,CAAU,EACV,EAAA,CAAM,GACN,GAAA,CAAK,GACL,EAAA,CAAI,CAACA,CAAAA,CAAM,CAAC,CAAA,CACZ,CAAA,CAAG7C,CACL,CAAA,CACI6C,CAAAA,CAAM,aAAe,MAAA,GACvBkL,CAAAA,CAAI,WAAalL,CAAAA,CAAM,UAAA,CACvBkL,CAAAA,CAAI,MAAA,CAASlL,CAAAA,CAAM,MAAA,EAEvB,CAAC,CAAA,CAEDgI,CAAAA,CAAG,OAAM,CAAE,OAAA,CAAQjL,GAAK,CACtB,IAAIoO,CAAAA,CAASF,CAAAA,CAAclO,CAAAA,CAAE,CAAC,EAC1BqO,CAAAA,CAASH,CAAAA,CAAclO,EAAE,CAAC,CAAA,CAC1BoO,IAAW,MAAA,EAAaC,CAAAA,GAAW,MAAA,GACrCA,CAAAA,CAAO,QAAA,EAAA,CACPD,CAAAA,CAAO,IAAI,IAAA,CAAKF,CAAAA,CAAclO,EAAE,CAAC,CAAC,GAEtC,CAAC,CAAA,CAED,IAAIsO,CAAAA,CAAY,MAAA,CAAO,OAAOJ,CAAa,CAAA,CAAE,OAAOjL,CAAAA,EAAS,CAACA,EAAM,QAAQ,CAAA,CAE5E,OAAOsL,CAAAA,CAAmBD,CAAS,CACrC,CAEA,SAASC,CAAAA,CAAmBD,EAAW,CACrC,IAAIL,EAAU,EAAC,CAEf,SAASO,CAAAA,CAASC,CAAAA,CAAQ,CACxB,OAAOjK,CAAAA,EAAU,CACXA,EAAO,MAAA,EAAA,CAGPA,CAAAA,CAAO,aAAe,MAAA,EACtBiK,CAAAA,CAAO,UAAA,GAAe,MAAA,EACtBjK,CAAAA,CAAO,UAAA,EAAciK,EAAO,UAAA,GAC9BC,CAAAA,CAAaD,EAAQjK,CAAM,EAE/B,CACF,CAEA,SAASmK,EAAUF,CAAAA,CAAQ,CACzB,OAAO/J,CAAAA,EAAU,CACfA,EAAO,EAAA,CAAM,IAAA,CAAK+J,CAAM,CAAA,CACpB,EAAE/J,CAAAA,CAAO,QAAA,GAAa,CAAA,EACxB4J,CAAAA,CAAU,KAAK5J,CAAM,EAEzB,CACF,CAEA,KAAO4J,EAAU,MAAA,EAAQ,CACvB,IAAIrL,CAAAA,CAAQqL,CAAAA,CAAU,GAAA,GACtBL,CAAAA,CAAQ,IAAA,CAAKhL,CAAK,CAAA,CAClBA,CAAAA,CAAM,GAAM,OAAA,EAAQ,CAAE,OAAA,CAAQuL,CAAAA,CAASvL,CAAK,CAAC,EAC7CA,CAAAA,CAAM,GAAA,CAAI,QAAQ0L,CAAAA,CAAU1L,CAAK,CAAC,EACpC,CAEA,OAAOgL,CAAAA,CAAQ,MAAA,CAAOhL,GAAS,CAACA,CAAAA,CAAM,MAAM,CAAA,CAAE,GAAA,CAAIA,GACzC1B,CAAAA,CAAK,IAAA,CAAK0B,CAAAA,CAAO,CAAC,IAAA,CAAM,GAAA,CAAK,aAAc,QAAQ,CAAC,CAC5D,CACH,CAEA,SAASyL,CAAAA,CAAaE,CAAAA,CAAQC,CAAAA,CAAQ,CACpC,IAAIC,CAAAA,CAAM,EACNvK,CAAAA,CAAS,CAAA,CAETqK,EAAO,MAAA,GACTE,CAAAA,EAAOF,EAAO,UAAA,CAAaA,CAAAA,CAAO,MAAA,CAClCrK,CAAAA,EAAUqK,CAAAA,CAAO,MAAA,CAAA,CAGfC,EAAO,MAAA,GACTC,CAAAA,EAAOD,EAAO,UAAA,CAAaA,CAAAA,CAAO,OAClCtK,CAAAA,EAAUsK,CAAAA,CAAO,MAAA,CAAA,CAGnBD,CAAAA,CAAO,EAAA,CAAKC,CAAAA,CAAO,GAAG,MAAA,CAAOD,CAAAA,CAAO,EAAE,CAAA,CACtCA,CAAAA,CAAO,WAAaE,CAAAA,CAAMvK,CAAAA,CAC1BqK,CAAAA,CAAO,MAAA,CAASrK,CAAAA,CAChBqK,CAAAA,CAAO,EAAI,IAAA,CAAK,GAAA,CAAIC,EAAO,CAAA,CAAGD,CAAAA,CAAO,CAAC,CAAA,CACtCC,CAAAA,CAAO,MAAA,CAAS,KAClB,CAEA,CAAA,CAAE,CAAC,SAAA,CAAU,EAAE,CAAC,CAAA,CAAE,EAAA,CAAG,CAAC,SAASpO,CAAAA,CAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CACtD,IAAI2L,EAAa7K,CAAAA,CAAQ,cAAc,EACnCuN,CAAAA,CAAmBvN,CAAAA,CAAQ,qBAAqB,CAAA,CAChDsO,CAAAA,CAAOtO,EAAQ,QAAQ,CAAA,CAE3Bb,EAAO,OAAA,CAAUkN,CAAAA,CAEjB,SAASA,CAAAA,CAAahN,CAAAA,CAAGuB,EAAG4J,CAAAA,CAAI0C,CAAAA,CAAW,CACzC,IAAIpC,CAAAA,CAAUzL,CAAAA,CAAE,SAASuB,CAAC,CAAA,CACtBK,EAAO5B,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CACf2N,CAAAA,CAAKtN,CAAAA,CAAOA,CAAAA,CAAK,UAAA,CAAa,MAAA,CAC9BuN,EAAKvN,CAAAA,CAAOA,CAAAA,CAAK,YAAa,MAAA,CAC9BwN,CAAAA,CAAY,EAAC,CAEbF,CAAAA,GACFzD,CAAAA,CAAUA,CAAAA,CAAQ,MAAA,CAAO5I,CAAAA,EAAKA,IAAMqM,CAAAA,EAAMrM,CAAAA,GAAMsM,CAAE,CAAA,CAAA,CAGpD,IAAIE,EAAc7D,CAAAA,CAAWxL,CAAAA,CAAGyL,CAAO,CAAA,CACvC4D,CAAAA,CAAY,OAAA,CAAQlM,GAAS,CAC3B,GAAInD,EAAE,QAAA,CAASmD,CAAAA,CAAM,CAAC,CAAA,CAAE,MAAA,CAAQ,CAC9B,IAAImM,CAAAA,CAAiBtC,CAAAA,CAAahN,EAAGmD,CAAAA,CAAM,CAAA,CAAGgI,EAAI0C,CAAS,CAAA,CAC3DuB,EAAUjM,CAAAA,CAAM,CAAC,CAAA,CAAImM,CAAAA,CACjB,MAAA,CAAO,MAAA,CAAOA,EAAgB,YAAY,CAAA,EAC5CC,EAAiBpM,CAAAA,CAAOmM,CAAc,EAE1C,CACF,CAAC,CAAA,CAED,IAAInB,CAAAA,CAAUD,CAAAA,CAAiBmB,EAAalE,CAAE,CAAA,CAC9CqE,EAAgBrB,CAAAA,CAASiB,CAAS,EAElC,IAAIzD,CAAAA,CAASsD,EAAKd,CAAAA,CAASN,CAAS,EAEpC,GAAIqB,CAAAA,GACFvD,EAAO,EAAA,CAAK,CAACuD,EAAIvD,CAAAA,CAAO,EAAA,CAAIwD,CAAE,CAAA,CAAE,IAAA,CAAK,IAAI,EACrCnP,CAAAA,CAAE,YAAA,CAAakP,CAAE,CAAA,CAAE,MAAA,CAAA,CAAQ,CAC7B,IAAIO,CAAAA,CAASzP,CAAAA,CAAE,IAAA,CAAKA,CAAAA,CAAE,YAAA,CAAakP,CAAE,CAAA,CAAE,CAAC,CAAC,CAAA,CACvCQ,CAAAA,CAAS1P,EAAE,IAAA,CAAKA,CAAAA,CAAE,YAAA,CAAamP,CAAE,CAAA,CAAE,CAAC,CAAC,CAAA,CAClC,MAAA,CAAO,OAAOxD,CAAAA,CAAQ,YAAY,IACrCA,CAAAA,CAAO,UAAA,CAAa,CAAA,CACpBA,CAAAA,CAAO,MAAA,CAAS,CAAA,CAAA,CAElBA,EAAO,UAAA,CAAA,CAAcA,CAAAA,CAAO,WAAaA,CAAAA,CAAO,MAAA,CAC3B8D,EAAO,KAAA,CAAQC,CAAAA,CAAO,KAAA,GAAU/D,CAAAA,CAAO,MAAA,CAAS,CAAA,CAAA,CACrEA,EAAO,MAAA,EAAU,EACnB,CAGF,OAAOA,CACT,CAEA,SAAS6D,CAAAA,CAAgBrB,CAAAA,CAASiB,CAAAA,CAAW,CAC3CjB,CAAAA,CAAQ,QAAQhL,CAAAA,EAAS,CACvBA,EAAM,EAAA,CAAKA,CAAAA,CAAM,GAAG,OAAA,CAAQ5B,CAAAA,EACtB6N,CAAAA,CAAU7N,CAAC,CAAA,CACN6N,CAAAA,CAAU7N,CAAC,CAAA,CAAE,EAAA,CAEfA,CACR,EACH,CAAC,EACH,CAEA,SAASgO,EAAiBT,CAAAA,CAAQa,CAAAA,CAAO,CACnCb,CAAAA,CAAO,UAAA,GAAe,QACxBA,CAAAA,CAAO,UAAA,CAAA,CAAcA,EAAO,UAAA,CAAaA,CAAAA,CAAO,MAAA,CAC3Ba,CAAAA,CAAM,UAAA,CAAaA,CAAAA,CAAM,SACzBb,CAAAA,CAAO,MAAA,CAASa,EAAM,MAAA,CAAA,CAC3Cb,CAAAA,CAAO,QAAUa,CAAAA,CAAM,MAAA,GAEvBb,CAAAA,CAAO,UAAA,CAAaa,CAAAA,CAAM,UAAA,CAC1Bb,EAAO,MAAA,CAASa,CAAAA,CAAM,QAE1B,CAEA,CAAA,CAAE,CAAC,cAAA,CAAe,EAAA,CAAG,qBAAA,CAAsB,EAAA,CAAG,QAAA,CAAS,EAAE,CAAC,CAAA,CAAE,EAAA,CAAG,CAAC,SAAShP,CAAAA,CAAQb,EAAOD,CAAAA,CAAQ,CAChG,IAAI4B,CAAAA,CAAOd,CAAAA,CAAQ,SAAS,CAAA,CAE5Bb,CAAAA,CAAO,QAAUmP,CAAAA,CAEjB,SAASA,EAAKd,CAAAA,CAASN,CAAAA,CAAW,CAChC,IAAI+B,CAAAA,CAAQnO,CAAAA,CAAK,UAAU0M,CAAAA,CAAShL,CAAAA,EAC3B,OAAO,MAAA,CAAOA,CAAAA,CAAO,YAAY,CACzC,CAAA,CACG0M,CAAAA,CAAWD,CAAAA,CAAM,GAAA,CACnBE,CAAAA,CAAaF,EAAM,GAAA,CAAI,IAAA,CAAK,CAAClP,CAAAA,CAAGoI,CAAAA,GAAMA,EAAE,CAAA,CAAIpI,CAAAA,CAAE,CAAC,CAAA,CAC/C0K,CAAAA,CAAK,GACL4D,CAAAA,CAAM,CAAA,CACNvK,EAAS,CAAA,CACTsL,CAAAA,CAAU,EAEZF,CAAAA,CAAS,IAAA,CAAKG,EAAgB,CAAC,CAACnC,CAAS,CAAC,CAAA,CAE1CkC,EAAUE,CAAAA,CAAkB7E,CAAAA,CAAI0E,EAAYC,CAAO,CAAA,CAEnDF,CAAAA,CAAS,OAAA,CAAQ1M,CAAAA,EAAS,CACxB4M,GAAW5M,CAAAA,CAAM,EAAA,CAAG,OACpBiI,CAAAA,CAAG,IAAA,CAAKjI,EAAM,EAAE,CAAA,CAChB6L,CAAAA,EAAO7L,CAAAA,CAAM,UAAA,CAAaA,CAAAA,CAAM,OAChCsB,CAAAA,EAAUtB,CAAAA,CAAM,OAChB4M,CAAAA,CAAUE,CAAAA,CAAkB7E,EAAI0E,CAAAA,CAAYC,CAAO,EACrD,CAAC,CAAA,CAED,IAAIpE,EAAS,CAAE,EAAA,CAAIP,EAAG,IAAA,CAAK,IAAI,CAAE,CAAA,CACjC,OAAI3G,CAAAA,GACFkH,CAAAA,CAAO,UAAA,CAAaqD,CAAAA,CAAMvK,EAC1BkH,CAAAA,CAAO,MAAA,CAASlH,GAEXkH,CACT,CAEA,SAASsE,CAAAA,CAAkB7E,CAAAA,CAAI0E,CAAAA,CAAYjD,CAAAA,CAAO,CAChD,IAAIqD,EACJ,KAAOJ,CAAAA,CAAW,SAAWI,CAAAA,CAAOJ,CAAAA,CAAWA,EAAW,MAAA,CAAS,CAAC,CAAA,EAAG,CAAA,EAAKjD,CAAAA,EAC1EiD,CAAAA,CAAW,KAAI,CACf1E,CAAAA,CAAG,KAAK8E,CAAAA,CAAK,EAAE,EACfrD,CAAAA,EAAAA,CAEF,OAAOA,CACT,CAEA,SAASmD,CAAAA,CAAgBG,EAAM,CAC7B,OAAO,CAAC7B,CAAAA,CAAQC,CAAAA,GACVD,EAAO,UAAA,CAAaC,CAAAA,CAAO,WACtB,EAAA,CACED,CAAAA,CAAO,WAAaC,CAAAA,CAAO,UAAA,CAC7B,EAGD4B,CAAAA,CAA6B5B,CAAAA,CAAO,EAAID,CAAAA,CAAO,CAAA,CAAxCA,CAAAA,CAAO,CAAA,CAAIC,CAAAA,CAAO,CAErC,CAEA,CAAA,CAAE,CAAC,UAAU,EAAE,CAAC,EAAE,EAAA,CAAG,CAAC,SAAS5N,CAAAA,CAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CACtDC,CAAAA,CAAO,OAAA,CAAUyF,EAEjB,SAASA,CAAAA,CAAkBvF,EAAG,CAC5B,IAAIoQ,CAAAA,CAAgBC,CAAAA,CAAUrQ,CAAC,CAAA,CAE/BA,EAAE,KAAA,EAAM,CAAE,YAAY,OAAA,CAAQuB,CAAAA,EAAK,CACjC,IAAIK,CAAAA,CAAO5B,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CACf+O,EAAU1O,CAAAA,CAAK,OAAA,CACf2O,EAAWC,CAAAA,CAASxQ,CAAAA,CAAGoQ,EAAeE,CAAAA,CAAQ,CAAA,CAAGA,CAAAA,CAAQ,CAAC,CAAA,CAC1DG,CAAAA,CAAOF,EAAS,IAAA,CAChBG,CAAAA,CAAMH,EAAS,GAAA,CACfI,CAAAA,CAAU,EACVC,CAAAA,CAAQH,CAAAA,CAAKE,CAAO,CAAA,CACpBE,CAAAA,CAAY,IAAA,CAEhB,KAAOtP,CAAAA,GAAM+O,CAAAA,CAAQ,GAAG,CAGtB,GAFA1O,EAAO5B,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CAEXsP,CAAAA,CAAW,CACb,MAAQD,CAAAA,CAAQH,CAAAA,CAAKE,CAAO,CAAA,IAAOD,CAAAA,EAC5B1Q,EAAE,IAAA,CAAK4Q,CAAK,EAAE,OAAA,CAAUhP,CAAAA,CAAK,MAClC+O,CAAAA,EAAAA,CAGEC,CAAAA,GAAUF,IACZG,CAAAA,CAAY,KAAA,EAEhB,CAEA,GAAI,CAACA,CAAAA,CAAW,CACd,KAAOF,CAAAA,CAAUF,EAAK,MAAA,CAAS,CAAA,EACxBzQ,EAAE,IAAA,CAAK4Q,CAAAA,CAAQH,EAAKE,CAAAA,CAAU,CAAC,CAAC,CAAA,CAAE,OAAA,EAAW/O,CAAAA,CAAK,MACvD+O,CAAAA,EAAAA,CAEFC,CAAAA,CAAQH,EAAKE,CAAO,EACtB,CAEA3Q,CAAAA,CAAE,SAAA,CAAUuB,CAAAA,CAAGqP,CAAK,CAAA,CACpBrP,CAAAA,CAAIvB,EAAE,UAAA,CAAWuB,CAAC,EAAE,CAAC,EACvB,CACF,CAAC,EACH,CAIA,SAASiP,CAAAA,CAASxQ,CAAAA,CAAGoQ,EAAe7O,CAAAA,CAAGsB,CAAAA,CAAG,CACxC,IAAIiO,CAAAA,CAAQ,EAAC,CACTC,CAAAA,CAAQ,EAAC,CACTC,CAAAA,CAAM,IAAA,CAAK,IAAIZ,CAAAA,CAAc7O,CAAC,EAAE,GAAA,CAAK6O,CAAAA,CAAcvN,CAAC,CAAA,CAAE,GAAG,CAAA,CACzDoO,CAAAA,CAAM,IAAA,CAAK,GAAA,CAAIb,EAAc7O,CAAC,CAAA,CAAE,IAAK6O,CAAAA,CAAcvN,CAAC,EAAE,GAAG,CAAA,CACzDyI,CAAAA,CACAoF,CAAAA,CAGJpF,CAAAA,CAAS/J,CAAAA,CACT,GACE+J,CAAAA,CAAStL,CAAAA,CAAE,OAAOsL,CAAM,CAAA,CACxBwF,EAAM,IAAA,CAAKxF,CAAM,QACVA,CAAAA,GACC8E,CAAAA,CAAc9E,CAAM,CAAA,CAAE,GAAA,CAAM0F,GAAOC,CAAAA,CAAMb,CAAAA,CAAc9E,CAAM,CAAA,CAAE,GAAA,CAAA,EAKzE,IAJAoF,CAAAA,CAAMpF,CAAAA,CAGNA,CAAAA,CAASzI,GACDyI,CAAAA,CAAStL,CAAAA,CAAE,OAAOsL,CAAM,CAAA,IAAOoF,GACrCK,CAAAA,CAAM,IAAA,CAAKzF,CAAM,CAAA,CAGnB,OAAO,CAAE,KAAMwF,CAAAA,CAAM,MAAA,CAAOC,EAAM,OAAA,EAAS,EAAG,GAAA,CAAKL,CAAI,CACzD,CAEA,SAASL,CAAAA,CAAUrQ,EAAG,CACpB,IAAI2L,EAAS,EAAC,CACVsF,EAAM,CAAA,CAEV,SAAS3P,EAAIC,CAAAA,CAAG,CACd,IAAIyP,CAAAA,CAAMC,CAAAA,CACVjR,EAAE,QAAA,CAASuB,CAAC,EAAE,OAAA,CAAQD,CAAG,CAAA,CACzBqK,CAAAA,CAAOpK,CAAC,CAAA,CAAI,CAAE,GAAA,CAAKyP,CAAAA,CAAK,IAAKC,CAAAA,EAAM,EACrC,CACA,OAAAjR,CAAAA,CAAE,QAAA,EAAS,CAAE,OAAA,CAAQsB,CAAG,EAEjBqK,CACT,CAEA,EAAE,EAAE,EAAE,EAAA,CAAG,CAAC,SAAShL,CAAAA,CAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CAG1C,IAAI2D,EAAQ7C,CAAAA,CAAQ,mBAAmB,EAAE,KAAA,CACrCc,CAAAA,CAAOd,EAAQ,SAAS,CAAA,CAO5Bb,EAAO,OAAA,CAAU,CACf,UAAWoR,CAAAA,CACX,kBAAA,CAAoBC,EACpB,kBAAA,CAAoBC,CAAAA,CACpB,WAAA,CAAaC,CAAAA,CACb,WAAA,CAAaC,CAAAA,CACb,kBAAmBC,CAAAA,CACnB,oBAAA,CAAsBC,EACtB,gBAAA,CAAkBC,CAAAA,CAClB,2BAA4BC,CAAAA,CAC5B,OAAA,CAASC,CACX,CAAA,CAmBA,SAASR,CAAAA,CAAmBnR,EAAGmM,CAAAA,CAAU,CACvC,IAAIyF,CAAAA,CAAY,GAEhB,SAASC,CAAAA,CAAWC,CAAAA,CAAWlO,CAAAA,CAAO,CACpC,IAGEmO,EAAK,CAAA,CAGLC,CAAAA,CAAU,EACVC,CAAAA,CAAkBH,CAAAA,CAAU,OAC5BI,CAAAA,CAAWtO,CAAAA,CAAMA,CAAAA,CAAM,MAAA,CAAS,CAAC,CAAA,CAEnC,OAAAA,CAAAA,CAAM,OAAA,CAAQ,CAACrC,CAAAA,CAAGjB,CAAAA,GAAM,CACtB,IAAIuC,CAAAA,CAAIsP,CAAAA,CAA0BnS,CAAAA,CAAGuB,CAAC,CAAA,CACpC6Q,EAAKvP,CAAAA,CAAI7C,CAAAA,CAAE,KAAK6C,CAAC,CAAA,CAAE,MAAQoP,CAAAA,CAAAA,CAEzBpP,CAAAA,EAAKtB,CAAAA,GAAM2Q,CAAAA,IACbtO,CAAAA,CAAM,KAAA,CAAMoO,EAAS1R,CAAAA,CAAE,CAAC,EAAE,OAAA,CAAQ+R,CAAAA,EAAY,CAC5CrS,CAAAA,CAAE,YAAA,CAAaqS,CAAQ,CAAA,CAAE,OAAA,CAAQ5R,CAAAA,EAAK,CACpC,IAAI6R,CAAAA,CAAStS,EAAE,IAAA,CAAKS,CAAC,EACnB8R,CAAAA,CAAOD,CAAAA,CAAO,OACXC,CAAAA,CAAOR,CAAAA,EAAMK,EAAKG,CAAAA,GACnB,EAAED,EAAO,KAAA,EAAStS,CAAAA,CAAE,KAAKqS,CAAQ,CAAA,CAAE,KAAA,CAAA,EACrChB,CAAAA,CAAYO,CAAAA,CAAWnR,CAAAA,CAAG4R,CAAQ,EAEtC,CAAC,EACH,CAAC,CAAA,CACDL,EAAU1R,CAAAA,CAAI,CAAA,CACdyR,CAAAA,CAAKK,CAAAA,EAET,CAAC,CAAA,CAEMxO,CACT,CAEA,OAAAuI,EAAS,MAAA,EAAUA,CAAAA,CAAS,OAAO0F,CAAU,CAAA,CAEtCD,CACT,CAEA,SAASR,CAAAA,CAAmBpR,EAAGmM,CAAAA,CAAU,CACvC,IAAIyF,CAAAA,CAAY,GAEhB,SAASY,CAAAA,CAAKC,CAAAA,CAAOjG,CAAAA,CAAUkG,CAAAA,CAAUC,CAAAA,CAAiBC,EAAiB,CACzE,IAAIrR,EACJE,CAAAA,CAAK,KAAA,CAAM+K,EAAUkG,CAAQ,CAAA,CAAE,OAAA,CAAQpS,CAAAA,EAAK,CAC1CiB,CAAAA,CAAIkR,EAAMnS,CAAC,CAAA,CACPN,EAAE,IAAA,CAAKuB,CAAC,EAAE,KAAA,EACZvB,CAAAA,CAAE,YAAA,CAAauB,CAAC,CAAA,CAAE,OAAA,CAAQd,GAAK,CAC7B,IAAIoS,EAAQ7S,CAAAA,CAAE,IAAA,CAAKS,CAAC,CAAA,CAChBoS,CAAAA,CAAM,KAAA,GACLA,CAAAA,CAAM,KAAA,CAAQF,CAAAA,EAAmBE,EAAM,KAAA,CAAQD,CAAAA,CAAAA,EAClDvB,EAAYO,CAAAA,CAAWnR,CAAAA,CAAGc,CAAC,EAE/B,CAAC,EAEL,CAAC,EACH,CAGA,SAASsQ,CAAAA,CAAWiB,EAAOL,CAAAA,CAAO,CAChC,IAAIM,CAAAA,CAAe,EAAA,CACjBC,CAAAA,CACAxG,CAAAA,CAAW,CAAA,CAEb,OAAAiG,EAAM,OAAA,CAAQ,CAAClR,EAAG0R,CAAAA,GAAmB,CACnC,GAAIjT,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CAAE,KAAA,GAAU,QAAA,CAAU,CAChC,IAAI2R,CAAAA,CAAelT,EAAE,YAAA,CAAauB,CAAC,EAC/B2R,CAAAA,CAAa,MAAA,GACfF,CAAAA,CAAehT,CAAAA,CAAE,IAAA,CAAKkT,CAAAA,CAAa,CAAC,CAAC,CAAA,CAAE,MACvCV,CAAAA,CAAKC,CAAAA,CAAOjG,EAAUyG,CAAAA,CAAgBF,CAAAA,CAAcC,CAAY,CAAA,CAChExG,CAAAA,CAAWyG,CAAAA,CACXF,EAAeC,CAAAA,EAEnB,CACAR,EAAKC,CAAAA,CAAOjG,CAAAA,CAAUiG,EAAM,MAAA,CAAQO,CAAAA,CAAcF,CAAAA,CAAM,MAAM,EAChE,CAAC,EAEML,CACT,CAEA,OAAAtG,CAAAA,CAAS,MAAA,EAAUA,EAAS,MAAA,CAAO0F,CAAU,CAAA,CAEtCD,CACT,CAEA,SAASO,EAA0BnS,CAAAA,CAAGuB,CAAAA,CAAG,CACvC,GAAIvB,CAAAA,CAAE,KAAKuB,CAAC,CAAA,CAAE,KAAA,CACZ,OAAOvB,CAAAA,CAAE,YAAA,CAAauB,CAAC,CAAA,CAAE,IAAA,CAAKd,GAAKT,CAAAA,CAAE,IAAA,CAAKS,CAAC,CAAA,CAAE,KAAK,CAEtD,CAEA,SAAS4Q,EAAYO,CAAAA,CAAWrQ,CAAAA,CAAGsB,EAAG,CACpC,GAAItB,EAAIsB,CAAAA,CAAG,CACT,IAAIwL,CAAAA,CAAM9M,CAAAA,CACVA,CAAAA,CAAIsB,EACJA,CAAAA,CAAIwL,EACN,CAEA,IAAI8E,CAAAA,CAAavB,EAAUrQ,CAAC,CAAA,CACvB4R,CAAAA,GACHvB,CAAAA,CAAUrQ,CAAC,CAAA,CAAI4R,EAAa,EAAC,CAAA,CAE/BA,EAAWtQ,CAAC,CAAA,CAAI,KAClB,CAEA,SAASyO,CAAAA,CAAYM,CAAAA,CAAWrQ,CAAAA,CAAGsB,CAAAA,CAAG,CACpC,GAAItB,CAAAA,CAAIsB,EAAG,CACT,IAAIwL,EAAM9M,CAAAA,CACVA,CAAAA,CAAIsB,CAAAA,CACJA,CAAAA,CAAIwL,EACN,CACA,OAAO,CAAC,CAACuD,EAAUrQ,CAAC,CAAA,EAAK,OAAO,MAAA,CAAOqQ,CAAAA,CAAUrQ,CAAC,CAAA,CAAGsB,CAAC,CACxD,CAUA,SAAS0O,CAAAA,CAAkBvR,EAAGmM,CAAAA,CAAUyF,CAAAA,CAAWwB,EAAY,CAC7D,IAAI3J,CAAAA,CAAO,EAAC,CACV4J,CAAAA,CAAQ,EAAC,CACTC,CAAAA,CAAM,EAAC,CAKT,OAAAnH,EAAS,OAAA,CAAQvI,CAAAA,EAAS,CACxBA,CAAAA,CAAM,OAAA,CAAQ,CAACrC,EAAGoE,CAAAA,GAAU,CAC1B8D,EAAKlI,CAAC,CAAA,CAAIA,EACV8R,CAAAA,CAAM9R,CAAC,EAAIA,CAAAA,CACX+R,CAAAA,CAAI/R,CAAC,CAAA,CAAIoE,EACX,CAAC,EACH,CAAC,EAEDwG,CAAAA,CAAS,OAAA,CAAQvI,CAAAA,EAAS,CACxB,IAAI2P,CAAAA,CAAU,GACd3P,CAAAA,CAAM,OAAA,CAAQrC,GAAK,CACjB,IAAIiS,EAAKJ,CAAAA,CAAW7R,CAAC,CAAA,CACrB,GAAIiS,CAAAA,CAAG,MAAA,CAAQ,CACbA,CAAAA,CAAKA,CAAAA,CAAG,KAAK,CAAC9S,CAAAA,CAAGoI,IAAMwK,CAAAA,CAAI5S,CAAC,CAAA,CAAI4S,CAAAA,CAAIxK,CAAC,CAAC,EACtC,IAAI2K,CAAAA,CAAAA,CAAMD,EAAG,MAAA,CAAS,CAAA,EAAK,EAC3B,IAAA,IAASlT,CAAAA,CAAI,IAAA,CAAK,KAAA,CAAMmT,CAAE,CAAA,CAAGC,EAAK,IAAA,CAAK,IAAA,CAAKD,CAAE,CAAA,CAAGnT,CAAAA,EAAKoT,EAAI,EAAEpT,CAAAA,CAAG,CAC7D,IAAIuC,CAAAA,CAAI2Q,CAAAA,CAAGlT,CAAC,CAAA,CACR+S,CAAAA,CAAM9R,CAAC,CAAA,GAAMA,CAAAA,EACbgS,EAAUD,CAAAA,CAAIzQ,CAAC,CAAA,EACf,CAACyO,CAAAA,CAAYM,CAAAA,CAAWrQ,EAAGsB,CAAC,CAAA,GAC9BwQ,EAAMxQ,CAAC,CAAA,CAAItB,EACX8R,CAAAA,CAAM9R,CAAC,CAAA,CAAIkI,CAAAA,CAAKlI,CAAC,CAAA,CAAIkI,EAAK5G,CAAC,CAAA,CAC3B0Q,EAAUD,CAAAA,CAAIzQ,CAAC,GAEnB,CACF,CACF,CAAC,EACH,CAAC,EAEM,CAAE,IAAA,CAAM4G,EAAM,KAAA,CAAO4J,CAAM,CACpC,CAEA,SAAS7B,CAAAA,CAAqBxR,CAAAA,CAAGmM,CAAAA,CAAU1C,CAAAA,CAAM4J,EAAOM,CAAAA,CAAY,CAMlE,IAAIC,CAAAA,CAAK,GACPC,CAAAA,CAASC,CAAAA,CAAgB9T,CAAAA,CAAGmM,CAAAA,CAAU1C,CAAAA,CAAMkK,CAAU,EACtDI,CAAAA,CAAaJ,CAAAA,CAAa,aAAe,aAAA,CAE3C,SAASK,EAAQC,CAAAA,CAAWC,CAAAA,CAAe,CACzC,IAAI9S,CAAAA,CAAQyS,CAAAA,CAAO,OAAM,CACrBM,CAAAA,CAAO/S,EAAM,GAAA,EAAI,CACjBC,EAAU,EAAC,CACf,KAAO8S,CAAAA,EACD9S,CAAAA,CAAQ8S,CAAI,EACdF,CAAAA,CAAUE,CAAI,GAEd9S,CAAAA,CAAQ8S,CAAI,EAAI,IAAA,CAChB/S,CAAAA,CAAM,IAAA,CAAK+S,CAAI,CAAA,CACf/S,CAAAA,CAAQA,EAAM,MAAA,CAAO8S,CAAAA,CAAcC,CAAI,CAAC,CAAA,CAAA,CAG1CA,EAAO/S,CAAAA,CAAM,GAAA,GAEjB,CAGA,SAASgT,CAAAA,CAAMD,EAAM,CACnBP,CAAAA,CAAGO,CAAI,CAAA,CAAIN,CAAAA,CAAO,QAAQM,CAAI,CAAA,CAAE,MAAA,CAAO,CAAC1J,CAAAA,CAAKvK,CAAAA,GACpC,KAAK,GAAA,CAAIuK,CAAAA,CAAKmJ,EAAG1T,CAAAA,CAAE,CAAC,EAAI2T,CAAAA,CAAO,IAAA,CAAK3T,CAAC,CAAC,CAAA,CAC5C,CAAC,EACN,CAGA,SAASmU,CAAAA,CAAMF,CAAAA,CAAM,CACnB,IAAIG,CAAAA,CAAMT,CAAAA,CAAO,QAAA,CAASM,CAAI,CAAA,CAAE,OAAO,CAAC1J,CAAAA,CAAKvK,IACpC,IAAA,CAAK,GAAA,CAAIuK,EAAKmJ,CAAAA,CAAG1T,CAAAA,CAAE,CAAC,CAAA,CAAI2T,CAAAA,CAAO,IAAA,CAAK3T,CAAC,CAAC,CAAA,CAC5C,OAAO,iBAAiB,CAAA,CAEvB0B,EAAO5B,CAAAA,CAAE,IAAA,CAAKmU,CAAI,CAAA,CAClBG,CAAAA,GAAQ,MAAA,CAAO,mBAAqB1S,CAAAA,CAAK,UAAA,GAAemS,IAC1DH,CAAAA,CAAGO,CAAI,EAAI,IAAA,CAAK,GAAA,CAAIP,CAAAA,CAAGO,CAAI,CAAA,CAAGG,CAAG,GAErC,CAEA,OAAAN,EAAQI,CAAAA,CAAOP,CAAAA,CAAO,aAAa,IAAA,CAAKA,CAAM,CAAC,CAAA,CAC/CG,CAAAA,CAAQK,CAAAA,CAAOR,EAAO,UAAA,CAAW,IAAA,CAAKA,CAAM,CAAC,CAAA,CAG7C,OAAO,IAAA,CAAKR,CAAK,CAAA,CAAE,OAAA,CAAQ9R,CAAAA,EAAKqS,CAAAA,CAAGrS,CAAC,CAAA,CAAIqS,CAAAA,CAAGnK,EAAKlI,CAAC,CAAC,CAAC,CAAA,CAE5CqS,CACT,CAGA,SAASE,CAAAA,CAAgB9T,CAAAA,CAAGmM,EAAU1C,CAAAA,CAAMkK,CAAAA,CAAY,CACtD,IAAIY,CAAAA,CAAa,IAAI/Q,CAAAA,CACnB2E,CAAAA,CAAanI,EAAE,KAAA,EAAM,CACrBwU,EAAQC,CAAAA,CAAItM,CAAAA,CAAW,QAASA,CAAAA,CAAW,OAAA,CAASwL,CAAU,CAAA,CAEhE,OAAAxH,CAAAA,CAAS,OAAA,CAAQvI,CAAAA,EAAS,CACxB,IAAInD,CAAAA,CACJmD,CAAAA,CAAM,QAAQrC,CAAAA,EAAK,CACjB,IAAImT,CAAAA,CAAQjL,CAAAA,CAAKlI,CAAC,CAAA,CAElB,GADAgT,CAAAA,CAAW,QAAQG,CAAK,CAAA,CACpBjU,EAAG,CACL,IAAIkU,EAAQlL,CAAAA,CAAKhJ,CAAC,CAAA,CAChBmU,CAAAA,CAAUL,CAAAA,CAAW,IAAA,CAAKI,EAAOD,CAAK,CAAA,CACxCH,EAAW,OAAA,CAAQI,CAAAA,CAAOD,EAAO,IAAA,CAAK,GAAA,CAAIF,EAAMxU,CAAAA,CAAGuB,CAAAA,CAAGd,CAAC,CAAA,CAAGmU,CAAAA,EAAW,CAAC,CAAC,EACzE,CACAnU,CAAAA,CAAIc,EACN,CAAC,EACH,CAAC,CAAA,CAEMgT,CACT,CAKA,SAAS7C,EAA2B1R,CAAAA,CAAG6U,CAAAA,CAAK,CAC1C,OAAO,MAAA,CAAO,MAAA,CAAOA,CAAG,CAAA,CAAE,MAAA,CAAO,CAACC,CAAAA,CAAiBlB,CAAAA,GAAO,CACxD,IAAImB,CAAAA,CAAM,OAAO,iBAAA,CACbT,CAAAA,CAAM,MAAA,CAAO,iBAAA,CAEjB,MAAA,CAAO,OAAA,CAAQV,CAAE,CAAA,CAAE,OAAA,CAAQ,CAAC,CAACrS,CAAAA,CAAGgH,CAAC,CAAA,GAAM,CACrC,IAAIyM,CAAAA,CAAYC,CAAAA,CAAMjV,EAAGuB,CAAC,CAAA,CAAI,EAE9BwT,CAAAA,CAAM,IAAA,CAAK,IAAIxM,CAAAA,CAAIyM,CAAAA,CAAWD,CAAG,CAAA,CACjCT,CAAAA,CAAM,IAAA,CAAK,IAAI/L,CAAAA,CAAIyM,CAAAA,CAAWV,CAAG,EACnC,CAAC,EAED,IAAMY,CAAAA,CAASH,CAAAA,CAAMT,CAAAA,CACrB,OAAIY,CAAAA,CAASJ,EAAgB,CAAC,CAAA,GAC5BA,EAAkB,CAACI,CAAAA,CAAQtB,CAAE,CAAA,CAAA,CAExBkB,CACT,CAAA,CAAG,CAAC,MAAA,CAAO,iBAAA,CAAmB,IAAI,CAAC,CAAA,CAAE,CAAC,CACxC,CASA,SAASrD,CAAAA,CAAiBoD,CAAAA,CAAKM,CAAAA,CAAS,CACtC,IAAIC,CAAAA,CAAc,OAAO,MAAA,CAAOD,CAAO,EACrCE,CAAAA,CAAa5T,CAAAA,CAAK,kBAAkB,IAAA,CAAK,GAAA,CAAK2T,CAAW,CAAA,CACzDE,CAAAA,CAAa7T,CAAAA,CAAK,kBAAkB,IAAA,CAAK,GAAA,CAAK2T,CAAW,CAAA,CAE3D,CAAC,IAAK,GAAG,CAAA,CAAE,OAAA,CAAQG,CAAAA,EAAQ,CACzB,CAAC,IAAK,GAAG,CAAA,CAAE,QAAQC,CAAAA,EAAS,CAC1B,IAAIC,CAAAA,CAAYF,CAAAA,CAAOC,CAAAA,CACrB5B,CAAAA,CAAKiB,CAAAA,CAAIY,CAAS,EAEpB,GAAI7B,CAAAA,GAAOuB,EAAS,OAEpB,IAAIO,EAAS,MAAA,CAAO,MAAA,CAAO9B,CAAE,CAAA,CACzB+B,CAAAA,CAAQN,EAAa5T,CAAAA,CAAK,iBAAA,CAAkB,KAAK,GAAA,CAAKiU,CAAM,EAC5DF,CAAAA,GAAU,GAAA,GACZG,CAAAA,CAAQL,CAAAA,CAAa7T,CAAAA,CAAK,iBAAA,CAAkB,KAAK,GAAA,CAAIiU,CAAM,GAGzDC,CAAAA,GACFd,CAAAA,CAAIY,CAAS,CAAA,CAAIhU,CAAAA,CAAK,SAAA,CAAUmS,CAAAA,CAAIrL,CAAAA,EAAKA,CAAAA,CAAIoN,CAAK,CAAA,EAEtD,CAAC,EACH,CAAC,EACH,CAEA,SAAShE,CAAAA,CAAQkD,CAAAA,CAAKxB,CAAAA,CAAO,CAC3B,OAAO5R,EAAK,SAAA,CAAUoT,CAAAA,CAAI,GAAI,CAACe,CAAAA,CAAKrU,IAAM,CACxC,GAAI8R,CAAAA,CACF,OAAOwB,CAAAA,CAAIxB,CAAAA,CAAM,aAAa,CAAA,CAAE9R,CAAC,CAAA,CAC5B,CACL,IAAIqS,CAAAA,CAAK,MAAA,CAAO,MAAA,CAAOiB,CAAG,CAAA,CAAE,GAAA,CAAIjB,GAAMA,CAAAA,CAAGrS,CAAC,CAAC,CAAA,CAAE,IAAA,CAAK,CAACb,CAAAA,CAAGoI,CAAAA,GAAMpI,CAAAA,CAAIoI,CAAC,CAAA,CACjE,OAAA,CAAQ8K,EAAG,CAAC,CAAA,CAAIA,EAAG,CAAC,CAAA,EAAK,CAC3B,CACF,CAAC,CACH,CAEA,SAAS1C,CAAAA,CAAUlR,EAAG,CACpB,IAAImM,EAAW1K,CAAAA,CAAK,gBAAA,CAAiBzB,CAAC,CAAA,CAClC4R,CAAAA,CAAY,OAAO,MAAA,CACrBT,CAAAA,CAAmBnR,EAAGmM,CAAQ,CAAA,CAC9BiF,EAAmBpR,CAAAA,CAAGmM,CAAQ,CAAC,CAAA,CAE7B0I,CAAAA,CAAM,EAAC,CACPgB,CAAAA,CACJ,CAAC,IAAK,GAAG,CAAA,CAAE,QAAQN,CAAAA,EAAQ,CACzBM,EAAmBN,CAAAA,GAAS,GAAA,CAAMpJ,CAAAA,CAAW,MAAA,CAAO,MAAA,CAAOA,CAAQ,EAAE,OAAA,EAAQ,CAC7E,CAAC,GAAA,CAAK,GAAG,EAAE,OAAA,CAAQqJ,CAAAA,EAAS,CACtBA,CAAAA,GAAU,GAAA,GACZK,CAAAA,CAAmBA,EAAiB,GAAA,CAAIC,CAAAA,EAC/B,OAAO,MAAA,CAAOA,CAAK,EAAE,OAAA,EAC7B,CAAA,CAAA,CAGH,IAAI1C,CAAAA,CAAAA,CAAcmC,CAAAA,GAAS,IAAMvV,CAAAA,CAAE,YAAA,CAAeA,EAAE,UAAA,EAAY,IAAA,CAAKA,CAAC,CAAA,CAClEqT,CAAAA,CAAQ9B,CAAAA,CAAkBvR,CAAAA,CAAG6V,CAAAA,CAAkBjE,CAAAA,CAAWwB,CAAU,CAAA,CACpEQ,CAAAA,CAAKpC,EAAqBxR,CAAAA,CAAG6V,CAAAA,CAC/BxC,EAAM,IAAA,CAAMA,CAAAA,CAAM,KAAA,CAAOmC,CAAAA,GAAU,GAAG,CAAA,CACpCA,IAAU,GAAA,GACZ5B,CAAAA,CAAKnS,EAAK,SAAA,CAAUmS,CAAAA,CAAIrL,GAAK,CAACA,CAAC,CAAA,CAAA,CAEjCsM,CAAAA,CAAIU,CAAAA,CAAOC,CAAK,EAAI5B,EACtB,CAAC,EACH,CAAC,CAAA,CAGD,IAAImC,CAAAA,CAAgBrE,CAAAA,CAA2B1R,EAAG6U,CAAG,CAAA,CACrD,OAAApD,CAAAA,CAAiBoD,CAAAA,CAAKkB,CAAa,CAAA,CAC5BpE,CAAAA,CAAQkD,EAAK7U,CAAAA,CAAE,KAAA,EAAM,CAAE,KAAK,CACrC,CAEA,SAASyU,CAAAA,CAAI3K,CAAAA,CAASkM,EAASrC,CAAAA,CAAY,CACzC,OAAO,CAAC3T,CAAAA,CAAGuB,CAAAA,CAAGsB,CAAAA,GAAM,CAClB,IAAIoT,EAASjW,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CACjB2U,CAAAA,CAASlW,EAAE,IAAA,CAAK6C,CAAC,CAAA,CACjBmM,CAAAA,CAAM,CAAA,CACN2G,CAAAA,CAGJ,GADA3G,CAAAA,EAAOiH,CAAAA,CAAO,MAAQ,CAAA,CAClB,MAAA,CAAO,OAAOA,CAAAA,CAAQ,UAAU,EAClC,OAAQA,CAAAA,CAAO,SAAS,WAAA,EAAY,EACpC,KAAK,GAAA,CAAKN,EAAQ,CAACM,CAAAA,CAAO,KAAA,CAAQ,CAAA,CAAG,MACrC,KAAK,IAAKN,CAAAA,CAAQM,CAAAA,CAAO,MAAQ,CAAA,CAAG,KACpC,CAWF,GATIN,CAAAA,GACF3G,CAAAA,EAAO2E,CAAAA,CAAagC,CAAAA,CAAQ,CAACA,GAE/BA,CAAAA,CAAQ,CAAA,CAER3G,IAAQiH,CAAAA,CAAO,KAAA,CAAQD,EAAUlM,CAAAA,EAAW,CAAA,CAC5CkF,CAAAA,EAAAA,CAAQkH,CAAAA,CAAO,KAAA,CAAQF,CAAAA,CAAUlM,GAAW,CAAA,CAE5CkF,CAAAA,EAAOkH,EAAO,KAAA,CAAQ,CAAA,CAClB,OAAO,MAAA,CAAOA,CAAAA,CAAQ,UAAU,CAAA,CAClC,OAAQA,EAAO,QAAA,CAAS,WAAA,IACxB,KAAK,IAAKP,CAAAA,CAAQO,CAAAA,CAAO,KAAA,CAAQ,CAAA,CAAG,MACpC,KAAK,IAAKP,CAAAA,CAAQ,CAACO,EAAO,KAAA,CAAQ,CAAA,CAAG,KACrC,CAEF,OAAIP,CAAAA,GACF3G,CAAAA,EAAO2E,CAAAA,CAAagC,CAAAA,CAAQ,CAACA,CAAAA,CAAAA,CAE/BA,CAAAA,CAAQ,EAED3G,CACT,CACF,CAEA,SAASiG,CAAAA,CAAMjV,CAAAA,CAAGuB,CAAAA,CAAG,CACnB,OAAOvB,EAAE,IAAA,CAAKuB,CAAC,EAAE,KACnB,CAEA,EAAE,CAAC,SAAA,CAAU,EAAA,CAAG,mBAAA,CAAoB,EAAE,CAAC,EAAE,EAAA,CAAG,CAAC,SAASZ,CAAAA,CAAQb,CAAAA,CAAOD,EAAQ,CAG7E,IAAI4B,CAAAA,CAAOd,CAAAA,CAAQ,SAAS,EACxBuQ,CAAAA,CAAYvQ,CAAAA,CAAQ,MAAM,CAAA,CAAE,SAAA,CAEhCb,EAAO,OAAA,CAAU8F,CAAAA,CAEjB,SAASA,CAAAA,CAAS5F,CAAAA,CAAG,CACnBA,EAAIyB,CAAAA,CAAK,kBAAA,CAAmBzB,CAAC,CAAA,CAE7BmW,CAAAA,CAAUnW,CAAC,CAAA,CACX,MAAA,CAAO,OAAA,CAAQkR,CAAAA,CAAUlR,CAAC,CAAC,EAAE,OAAA,CAAQ,CAAC,CAACuB,CAAAA,CAAGgH,CAAC,IAAMvI,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CAAE,CAAA,CAAIgH,CAAC,EAClE,CAEA,SAAS4N,CAAAA,CAAUnW,CAAAA,CAAG,CACpB,IAAImM,CAAAA,CAAW1K,CAAAA,CAAK,gBAAA,CAAiBzB,CAAC,CAAA,CAClCoW,EAAUpW,CAAAA,CAAE,KAAA,GAAQ,OAAA,CACpBqW,CAAAA,CAAQ,EACZlK,CAAAA,CAAS,OAAA,CAAQvI,CAAAA,EAAS,CACxB,IAAM0S,CAAAA,CAAY1S,EAAM,MAAA,CAAO,CAAC6G,EAAKlJ,CAAAA,GAAM,CACzC,IAAMsI,CAAAA,CAAS7J,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CAAE,MAAA,CACzB,OAAIkJ,CAAAA,CAAMZ,CAAAA,CACDY,EAEAZ,CAEX,CAAA,CAAG,CAAC,CAAA,CACJjG,CAAAA,CAAM,OAAA,CAAQrC,CAAAA,EAAKvB,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CAAE,CAAA,CAAI8U,EAAQC,CAAAA,CAAY,CAAC,EACtDD,CAAAA,EAASC,CAAAA,CAAYF,EACvB,CAAC,EACH,CAGA,EAAE,CAAC,SAAA,CAAU,GAAG,MAAA,CAAO,EAAE,CAAC,CAAA,CAAE,EAAA,CAAG,CAAC,SAASzV,CAAAA,CAAQb,CAAAA,CAAOD,EAAQ,CAGhE,IAAI2D,CAAAA,CAAQ7C,CAAAA,CAAQ,mBAAmB,CAAA,CAAE,KAAA,CACrC4V,CAAAA,CAAQ5V,CAAAA,CAAQ,QAAQ,CAAA,CAAE,MAE9Bb,CAAAA,CAAO,OAAA,CAAU0W,EA2BjB,SAASA,CAAAA,CAAaxW,EAAG,CACvB,IAAII,EAAI,IAAIoD,CAAAA,CAAM,CAAE,QAAA,CAAU,KAAM,CAAC,CAAA,CAGjCiT,CAAAA,CAAQzW,EAAE,KAAA,EAAM,CAAE,CAAC,CAAA,CACnB0W,CAAAA,CAAO1W,CAAAA,CAAE,WAAU,CACvBI,CAAAA,CAAE,QAAQqW,CAAAA,CAAO,EAAE,CAAA,CAGnB,IAAA,IADI1T,CAAAA,CAAM4S,CAAAA,CACHgB,CAAAA,CAAUvW,CAAAA,CAAGJ,CAAC,CAAA,CAAI0W,CAAAA,EACvB3T,EAAO6T,CAAAA,CAAiBxW,CAAAA,CAAGJ,CAAC,CAAA,CAC5B2V,CAAAA,CAAQvV,CAAAA,CAAE,OAAA,CAAQ2C,CAAAA,CAAK,CAAC,EAAIwT,CAAAA,CAAMvW,CAAAA,CAAG+C,CAAI,CAAA,CAAI,CAACwT,EAAMvW,CAAAA,CAAG+C,CAAI,CAAA,CAC3D8T,CAAAA,CAAWzW,CAAAA,CAAGJ,CAAAA,CAAG2V,CAAK,CAAA,CAGxB,OAAOvV,CACT,CAMA,SAASuW,EAAUvW,CAAAA,CAAGJ,CAAAA,CAAG,CACvB,SAASsB,CAAAA,CAAIC,CAAAA,CAAG,CACdvB,CAAAA,CAAE,SAAA,CAAUuB,CAAC,CAAA,CAAE,OAAA,CAAQrB,GAAK,CAC1B,IAAI4W,CAAAA,CAAQ5W,CAAAA,CAAE,CAAA,CACZ2C,CAAAA,CAAKtB,IAAMuV,CAAAA,CAAS5W,CAAAA,CAAE,EAAI4W,CAAAA,CACxB,CAAC1W,EAAE,OAAA,CAAQyC,CAAC,CAAA,EAAK,CAAC0T,CAAAA,CAAMvW,CAAAA,CAAGE,CAAC,CAAA,GAC9BE,CAAAA,CAAE,QAAQyC,CAAAA,CAAG,EAAE,CAAA,CACfzC,CAAAA,CAAE,QAAQmB,CAAAA,CAAGsB,CAAAA,CAAG,EAAE,CAAA,CAClBvB,EAAIuB,CAAC,CAAA,EAET,CAAC,EACH,CAEA,OAAAzC,CAAAA,CAAE,KAAA,EAAM,CAAE,QAAQkB,CAAG,CAAA,CACdlB,EAAE,SAAA,EACX,CAMA,SAASwW,CAAAA,CAAiBxW,CAAAA,CAAGJ,CAAAA,CAAG,CAG9B,OAFcA,EAAE,KAAA,EAAM,CAET,OAAO,CAACyK,CAAAA,CAAK1H,IAAS,CACjC,IAAIgU,CAAAA,CAAY,MAAA,CAAO,iBAAA,CAKvB,OAJI3W,EAAE,OAAA,CAAQ2C,CAAAA,CAAK,CAAC,CAAA,GAAM3C,CAAAA,CAAE,QAAQ2C,CAAAA,CAAK,CAAC,IACxCgU,CAAAA,CAAYR,CAAAA,CAAMvW,EAAG+C,CAAI,CAAA,CAAA,CAGvBgU,EAAYtM,CAAAA,CAAI,CAAC,EACZ,CAACsM,CAAAA,CAAWhU,CAAI,CAAA,CAGlB0H,CACT,CAAA,CAAG,CAAC,MAAA,CAAO,iBAAA,CAAmB,IAAI,CAAC,CAAA,CAAE,CAAC,CACxC,CAEA,SAASoM,CAAAA,CAAWzW,CAAAA,CAAGJ,CAAAA,CAAG2V,EAAO,CAC/BvV,CAAAA,CAAE,OAAM,CAAE,OAAA,CAAQmB,GAAKvB,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CAAE,IAAA,EAAQoU,CAAK,EAChD,CAEA,CAAA,CAAE,CAAC,QAAA,CAAS,EAAA,CAAG,oBAAoB,EAAE,CAAC,EAAE,EAAA,CAAG,CAAC,SAAShV,CAAAA,CAAQb,CAAAA,CAAOD,EAAQ,CAG5E,IAAImX,CAAAA,CAAWrW,CAAAA,CAAQ,QAAQ,CAAA,CAC3BsW,CAAAA,CAAcD,CAAAA,CAAS,YACvBR,CAAAA,CAAe7V,CAAAA,CAAQ,iBAAiB,CAAA,CACxCuW,CAAAA,CAAiBvW,EAAQ,mBAAmB,CAAA,CAEhDb,CAAAA,CAAO,OAAA,CAAU+B,CAAAA,CAqBjB,SAASA,EAAK7B,CAAAA,CAAG,CACf,IAAImX,CAAAA,CAASnX,CAAAA,CAAE,OAAM,CAAE,MAAA,CACvB,GAAImX,CAAAA,YAAkB,QAAA,CACpB,OAAOA,EAAOnX,CAAC,CAAA,CAGjB,OAAOA,CAAAA,CAAE,KAAA,GAAQ,MAAA,EACjB,KAAK,iBAAA,CAAmBoX,CAAAA,CAAqBpX,CAAC,EAAG,MACjD,KAAK,aAAcqX,CAAAA,CAAgBrX,CAAC,EAAG,MACvC,KAAK,cAAA,CAAgBsX,CAAAA,CAAkBtX,CAAC,CAAA,CAAG,MAC3C,KAAK,MAAA,CAAQ,MACb,QAASoX,CAAAA,CAAqBpX,CAAC,EAC/B,CACF,CAGA,IAAIsX,CAAAA,CAAoBL,CAAAA,CAExB,SAASI,CAAAA,CAAgBrX,CAAAA,CAAG,CAC1BiX,CAAAA,CAAYjX,CAAC,EACbwW,CAAAA,CAAaxW,CAAC,EAChB,CAEA,SAASoX,CAAAA,CAAqBpX,EAAG,CAC/BkX,CAAAA,CAAelX,CAAC,EAClB,CAEA,EAAE,CAAC,iBAAA,CAAkB,GAAG,mBAAA,CAAoB,EAAA,CAAG,SAAS,EAAE,CAAC,EAAE,EAAA,CAAG,CAAC,SAASW,CAAAA,CAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CAGjG,IAAI2W,EAAe7V,CAAAA,CAAQ,iBAAiB,EACxC4V,CAAAA,CAAQ5V,CAAAA,CAAQ,QAAQ,CAAA,CAAE,KAAA,CAC1B4W,CAAAA,CAAW5W,CAAAA,CAAQ,QAAQ,CAAA,CAAE,YAC7B6W,CAAAA,CAAW7W,CAAAA,CAAQ,mBAAmB,CAAA,CAAE,GAAA,CAAI,SAC5C0P,CAAAA,CAAY1P,CAAAA,CAAQ,mBAAmB,CAAA,CAAE,GAAA,CAAI,SAAA,CAC7C8W,EAAW9W,CAAAA,CAAQ,SAAS,EAAE,QAAA,CAElCb,CAAAA,CAAO,QAAUoX,CAAAA,CAGjBA,CAAAA,CAAe,gBAAA,CAAmBQ,CAAAA,CAClCR,CAAAA,CAAe,aAAA,CAAgBS,EAC/BT,CAAAA,CAAe,YAAA,CAAeU,EAC9BV,CAAAA,CAAe,SAAA,CAAYW,EAC3BX,CAAAA,CAAe,SAAA,CAAYY,CAAAA,CAC3BZ,CAAAA,CAAe,aAAA,CAAgBa,CAAAA,CAmC/B,SAASb,CAAAA,CAAelX,CAAAA,CAAG,CACzBA,CAAAA,CAAIyX,CAAAA,CAASzX,CAAC,CAAA,CACduX,CAAAA,CAASvX,CAAC,CAAA,CACV,IAAII,CAAAA,CAAIoW,EAAaxW,CAAC,CAAA,CACtB0X,EAAiBtX,CAAC,CAAA,CAClBuX,EAAcvX,CAAAA,CAAGJ,CAAC,CAAA,CAGlB,IAAA,IADIE,CAAAA,CAAGH,CAAAA,CACCG,EAAI2X,CAAAA,CAAUzX,CAAC,GACrBL,CAAAA,CAAI+X,CAAAA,CAAU1X,EAAGJ,CAAAA,CAAGE,CAAC,EACrB6X,CAAAA,CAAc3X,CAAAA,CAAGJ,EAAGE,CAAAA,CAAGH,CAAC,EAE5B,CAKA,SAAS4X,EAAcvX,CAAAA,CAAGJ,CAAAA,CAAG,CAC3B,IAAIoL,CAAAA,CAAKiF,CAAAA,CAAUjQ,EAAGA,CAAAA,CAAE,KAAA,EAAO,CAAA,CAC/BgL,CAAAA,CAAKA,EAAG,KAAA,CAAM,CAAA,CAAGA,CAAAA,CAAG,MAAA,CAAS,CAAC,CAAA,CAC9BA,EAAG,OAAA,CAAQ7J,CAAAA,EAAKyW,EAAe5X,CAAAA,CAAGJ,CAAAA,CAAGuB,CAAC,CAAC,EACzC,CAEA,SAASyW,CAAAA,CAAe5X,CAAAA,CAAGJ,EAAGgK,CAAAA,CAAO,CACnC,IAAIiO,CAAAA,CAAW7X,CAAAA,CAAE,KAAK4J,CAAK,CAAA,CACvBsB,CAAAA,CAAS2M,CAAAA,CAAS,MAAA,CACtB7X,CAAAA,CAAE,KAAK4J,CAAAA,CAAOsB,CAAM,EAAE,QAAA,CAAWsM,CAAAA,CAAaxX,EAAGJ,CAAAA,CAAGgK,CAAK,EAC3D,CAMA,SAAS4N,CAAAA,CAAaxX,EAAGJ,CAAAA,CAAGgK,CAAAA,CAAO,CACjC,IAAIiO,CAAAA,CAAW7X,EAAE,IAAA,CAAK4J,CAAK,CAAA,CACvBsB,CAAAA,CAAS2M,CAAAA,CAAS,MAAA,CAElBC,EAAc,IAAA,CAEdC,CAAAA,CAAYnY,EAAE,IAAA,CAAKgK,CAAAA,CAAOsB,CAAM,CAAA,CAEhC8M,CAAAA,CAAW,CAAA,CAEf,OAAKD,CAAAA,GACHD,CAAAA,CAAc,MACdC,CAAAA,CAAYnY,CAAAA,CAAE,KAAKsL,CAAAA,CAAQtB,CAAK,GAGlCoO,CAAAA,CAAWD,CAAAA,CAAU,OAErBnY,CAAAA,CAAE,SAAA,CAAUgK,CAAK,CAAA,CAAE,OAAA,CAAQ9J,GAAK,CAC9B,IAAImY,EAAYnY,CAAAA,CAAE,CAAA,GAAM8J,CAAAA,CACtB2F,CAAAA,CAAQ0I,CAAAA,CAAYnY,CAAAA,CAAE,EAAIA,CAAAA,CAAE,CAAA,CAE9B,GAAIyP,CAAAA,GAAUrE,CAAAA,CAAQ,CACpB,IAAIgN,CAAAA,CAAeD,CAAAA,GAAcH,CAAAA,CAC/BK,CAAAA,CAAcvY,CAAAA,CAAE,KAAKE,CAAC,CAAA,CAAE,OAG1B,GADAkY,CAAAA,EAAYE,EAAeC,CAAAA,CAAc,CAACA,CAAAA,CACtCC,CAAAA,CAAWpY,CAAAA,CAAG4J,CAAAA,CAAO2F,CAAK,CAAA,CAAG,CAC/B,IAAI8I,CAAAA,CAAgBrY,CAAAA,CAAE,KAAK4J,CAAAA,CAAO2F,CAAK,CAAA,CAAE,QAAA,CACzCyI,CAAAA,EAAYE,CAAAA,CAAe,CAACG,CAAAA,CAAgBA,EAC9C,CACF,CACF,CAAC,EAEML,CACT,CAEA,SAASV,CAAAA,CAAiB9K,CAAAA,CAAMnD,CAAAA,CAAM,CAChC,SAAA,CAAU,MAAA,CAAS,IACrBA,CAAAA,CAAOmD,CAAAA,CAAK,OAAM,CAAE,CAAC,CAAA,CAAA,CAEvB8L,CAAAA,CAAgB9L,CAAAA,CAAM,GAAI,CAAA,CAAGnD,CAAI,EACnC,CAEA,SAASiP,EAAgB9L,CAAAA,CAAMvL,CAAAA,CAASsX,CAAAA,CAASpX,CAAAA,CAAG+J,CAAAA,CAAQ,CAC1D,IAAI0F,CAAAA,CAAM2H,CAAAA,CACNzX,EAAQ0L,CAAAA,CAAK,IAAA,CAAKrL,CAAC,CAAA,CAEvB,OAAAF,EAAQE,CAAC,CAAA,CAAI,KACbqL,CAAAA,CAAK,SAAA,CAAUrL,CAAC,CAAA,CAAE,OAAA,CAAQsB,GAAK,CACxB,MAAA,CAAO,MAAA,CAAOxB,CAAAA,CAASwB,CAAC,CAAA,GAC3B8V,EAAUD,CAAAA,CAAgB9L,CAAAA,CAAMvL,EAASsX,CAAAA,CAAS9V,CAAAA,CAAGtB,CAAC,CAAA,EAE1D,CAAC,CAAA,CAEDL,CAAAA,CAAM,GAAA,CAAM8P,CAAAA,CACZ9P,EAAM,GAAA,CAAMyX,CAAAA,EAAAA,CACRrN,EACFpK,CAAAA,CAAM,MAAA,CAASoK,EAGf,OAAOpK,CAAAA,CAAM,MAAA,CAGRyX,CACT,CAEA,SAASd,EAAUjL,CAAAA,CAAM,CACvB,OAAOA,CAAAA,CAAK,KAAA,GAAQ,IAAA,CAAK1M,CAAAA,EAAK0M,CAAAA,CAAK,IAAA,CAAK1M,CAAC,CAAA,CAAE,SAAW,CAAC,CACzD,CAEA,SAAS4X,CAAAA,CAAU1X,EAAGJ,CAAAA,CAAG+C,CAAAA,CAAM,CAC7B,IAAIxB,CAAAA,CAAIwB,CAAAA,CAAK,EACTF,CAAAA,CAAIE,CAAAA,CAAK,EAKR/C,CAAAA,CAAE,OAAA,CAAQuB,EAAGsB,CAAC,CAAA,GACjBtB,CAAAA,CAAIwB,CAAAA,CAAK,CAAA,CACTF,CAAAA,CAAIE,EAAK,CAAA,CAAA,CAGX,IAAIkT,EAAS7V,CAAAA,CAAE,IAAA,CAAKmB,CAAC,CAAA,CACjB2U,CAAAA,CAAS9V,CAAAA,CAAE,IAAA,CAAKyC,CAAC,CAAA,CACjB+V,EAAY3C,CAAAA,CACZ4C,CAAAA,CAAO,MAIP5C,CAAAA,CAAO,GAAA,CAAMC,EAAO,GAAA,GACtB0C,CAAAA,CAAY1C,EACZ2C,CAAAA,CAAO,IAAA,CAAA,CAGT,IAAIC,CAAAA,CAAa9Y,CAAAA,CAAE,OAAM,CAAE,MAAA,CAAO+C,GACzB8V,CAAAA,GAASE,CAAAA,CAAa3Y,CAAAA,CAAGA,CAAAA,CAAE,IAAA,CAAK2C,CAAAA,CAAK,CAAC,CAAA,CAAG6V,CAAS,GAClDC,CAAAA,GAASE,CAAAA,CAAa3Y,EAAGA,CAAAA,CAAE,IAAA,CAAK2C,CAAAA,CAAK,CAAC,CAAA,CAAG6V,CAAS,CAC1D,CAAA,CAED,OAAOE,EAAW,MAAA,CAAO,CAACrO,EAAK1H,CAAAA,GACzBwT,CAAAA,CAAMvW,CAAAA,CAAG+C,CAAI,CAAA,CAAIwT,CAAAA,CAAMvW,EAAGyK,CAAG,CAAA,CACxB1H,EAGF0H,CACR,CACH,CAEA,SAASsN,CAAAA,CAAc3X,CAAAA,CAAGJ,CAAAA,CAAGE,CAAAA,CAAGH,CAAAA,CAAG,CACjC,IAAIwB,CAAAA,CAAIrB,EAAE,CAAA,CACN2C,CAAAA,CAAI3C,EAAE,CAAA,CACVE,CAAAA,CAAE,UAAA,CAAWmB,CAAAA,CAAGsB,CAAC,CAAA,CACjBzC,EAAE,OAAA,CAAQL,CAAAA,CAAE,EAAGA,CAAAA,CAAE,CAAA,CAAG,EAAE,CAAA,CACtB2X,CAAAA,CAAiBtX,CAAC,CAAA,CAClBuX,CAAAA,CAAcvX,EAAGJ,CAAC,CAAA,CAClBgZ,EAAY5Y,CAAAA,CAAGJ,CAAC,EAClB,CAEA,SAASgZ,CAAAA,CAAY5Y,CAAAA,CAAGJ,CAAAA,CAAG,CACzB,IAAIyJ,CAAAA,CAAOrJ,CAAAA,CAAE,OAAM,CAAE,IAAA,CAAKmB,GAAK,CAACvB,CAAAA,CAAE,KAAKuB,CAAC,CAAA,CAAE,MAAM,CAAA,CAC5C6J,CAAAA,CAAKoM,EAASpX,CAAAA,CAAGqJ,CAAI,EACzB2B,CAAAA,CAAKA,CAAAA,CAAG,KAAA,CAAM,CAAC,CAAA,CACfA,CAAAA,CAAG,QAAQ7J,CAAAA,EAAK,CACd,IAAI+J,CAAAA,CAASlL,CAAAA,CAAE,KAAKmB,CAAC,CAAA,CAAE,MAAA,CACrBwB,CAAAA,CAAO/C,CAAAA,CAAE,IAAA,CAAKuB,EAAG+J,CAAM,CAAA,CACvB2N,EAAU,KAAA,CAEPlW,CAAAA,GACHA,EAAO/C,CAAAA,CAAE,IAAA,CAAKsL,CAAAA,CAAQ/J,CAAC,CAAA,CACvB0X,CAAAA,CAAU,MAGZjZ,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CAAE,IAAA,CAAOvB,EAAE,IAAA,CAAKsL,CAAM,CAAA,CAAE,IAAA,EAAQ2N,CAAAA,CAAUlW,CAAAA,CAAK,OAAS,CAACA,CAAAA,CAAK,QACxE,CAAC,EACH,CAKA,SAASyV,CAAAA,CAAW5L,CAAAA,CAAMnM,CAAAA,CAAGc,CAAAA,CAAG,CAC9B,OAAOqL,CAAAA,CAAK,OAAA,CAAQnM,EAAGc,CAAC,CAC1B,CAMA,SAASwX,CAAAA,CAAanM,CAAAA,CAAMqJ,CAAAA,CAAQiD,CAAAA,CAAW,CAC7C,OAAOA,CAAAA,CAAU,GAAA,EAAOjD,EAAO,GAAA,EAAOA,CAAAA,CAAO,KAAOiD,CAAAA,CAAU,GAChE,CAEA,CAAA,CAAE,CAAC,SAAA,CAAU,GAAG,iBAAA,CAAkB,EAAA,CAAG,SAAS,EAAA,CAAG,mBAAA,CAAoB,EAAE,CAAC,CAAA,CAAE,GAAG,CAAC,SAASvY,EAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CAG9G,GAAM,CAAE,iBAAA,CAAAsZ,CAAkB,CAAA,CAAIxY,CAAAA,CAAQ,SAAS,CAAA,CAE/Cb,EAAO,OAAA,CAAU,CACf,YAAamX,CAAAA,CACb,KAAA,CAAOV,CACT,CAAA,CAuBA,SAASU,CAAAA,CAAYjX,CAAAA,CAAG,CACtB,IAAIqB,EAAU,EAAC,CAEf,SAASC,CAAAA,CAAIC,CAAAA,CAAG,CACd,IAAIL,CAAAA,CAAQlB,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CACpB,GAAI,MAAA,CAAO,MAAA,CAAOF,EAASE,CAAC,CAAA,CAC1B,OAAOL,CAAAA,CAAM,IAAA,CAEfG,EAAQE,CAAC,CAAA,CAAI,KAEb,IAAI6X,CAAAA,CAAkBpZ,EAAE,QAAA,CAASuB,CAAC,EAAE,GAAA,CAAIrB,CAAAA,EAClCA,CAAAA,EAAK,IAAA,CACA,MAAA,CAAO,iBAAA,CAGToB,EAAIpB,CAAAA,CAAE,CAAC,EAAIF,CAAAA,CAAE,IAAA,CAAKE,CAAC,CAAA,CAAE,MAC7B,CAAA,CAED,IAAI2B,CAAAA,CAAOsX,CAAAA,CAAkB,KAAK,GAAA,CAAKC,CAAe,EAEtD,OAAIvX,CAAAA,GAAS,OAAO,iBAAA,GAClBA,CAAAA,CAAO,CAAA,CAAA,CAGDX,CAAAA,CAAM,IAAA,CAAOW,CACvB,CAEA7B,CAAAA,CAAE,OAAA,GAAU,OAAA,CAAQsB,CAAG,EACzB,CAMA,SAASiV,EAAMvW,CAAAA,CAAGE,CAAAA,CAAG,CACnB,OAAOF,CAAAA,CAAE,KAAKE,CAAAA,CAAE,CAAC,EAAE,IAAA,CAAOF,CAAAA,CAAE,IAAA,CAAKE,CAAAA,CAAE,CAAC,CAAA,CAAE,KAAOF,CAAAA,CAAE,IAAA,CAAKE,CAAC,CAAA,CAAE,MACzD,CAEA,CAAA,CAAE,CAAC,SAAA,CAAU,EAAE,CAAC,CAAA,CAAE,GAAG,CAAC,SAASS,EAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CAKtD,IAAI2D,CAAAA,CAAQ7C,CAAAA,CAAQ,mBAAmB,CAAA,CAAE,MAEzCb,CAAAA,CAAO,OAAA,CAAU,CACf,aAAA,CAAAiC,CAAAA,CACA,aAAAsX,CAAAA,CACA,iBAAA,CAAAF,CAAAA,CACA,kBAAA,CAAAG,CAAAA,CACA,gBAAA,CAAAC,EACA,aAAA,CAAAC,CAAAA,CACA,UAAAC,CAAAA,CACA,OAAA,CAAA3X,EACA,cAAA,CAAAwD,CAAAA,CACA,MAAA,CAAAoU,CAAAA,CACA,SAAA,CAAAC,CAAAA,CACA,KAAAC,CAAAA,CACA,kBAAA,CAAAC,EACA,KAAA,CAAA3U,CAAAA,CACA,iBAAAM,CAAAA,CACA,QAAA,CAAAiS,CAAAA,CACA,gBAAA,CAAAqC,CAAAA,CACA,IAAA,CAAA/T,EACA,QAAA,CAAAlF,CAAAA,CACA,UAAAoL,CACF,CAAA,CAKA,SAASoN,CAAAA,CAAarZ,CAAAA,CAAG+Z,CAAAA,CAAMnX,CAAAA,CAAOiI,CAAAA,CAAM,CAE1C,QADItJ,CAAAA,CAAIsJ,CAAAA,CACD7K,EAAE,OAAA,CAAQuB,CAAC,GAChBA,CAAAA,CAAIV,CAAAA,CAASgK,CAAI,CAAA,CAGnB,OAAAjI,EAAM,KAAA,CAAQmX,CAAAA,CACd/Z,EAAE,OAAA,CAAQuB,CAAAA,CAAGqB,CAAK,CAAA,CACXrB,CACT,CAMA,SAASkW,CAAAA,CAASzX,CAAAA,CAAG,CACnB,IAAIga,CAAAA,CAAa,IAAIxW,CAAAA,EAAM,CAAE,SAASxD,CAAAA,CAAE,KAAA,EAAO,CAAA,CAC/C,OAAAA,CAAAA,CAAE,OAAM,CAAE,OAAA,CAAQuB,GAAKyY,CAAAA,CAAW,OAAA,CAAQzY,EAAGvB,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAC,CAAC,CAAA,CACvDvB,EAAE,KAAA,EAAM,CAAE,QAAQE,CAAAA,EAAK,CACrB,IAAI+Z,CAAAA,CAAcD,CAAAA,CAAW,IAAA,CAAK9Z,CAAAA,CAAE,CAAA,CAAGA,CAAAA,CAAE,CAAC,CAAA,EAAK,CAAE,OAAQ,CAAA,CAAG,MAAA,CAAQ,CAAE,CAAA,CAClEgB,CAAAA,CAAQlB,CAAAA,CAAE,IAAA,CAAKE,CAAC,CAAA,CACpB8Z,EAAW,OAAA,CAAQ9Z,CAAAA,CAAE,EAAGA,CAAAA,CAAE,CAAA,CAAG,CAC3B,MAAA,CAAQ+Z,CAAAA,CAAY,MAAA,CAAS/Y,CAAAA,CAAM,MAAA,CACnC,MAAA,CAAQ,KAAK,GAAA,CAAI+Y,CAAAA,CAAY,OAAQ/Y,CAAAA,CAAM,MAAM,CACnD,CAAC,EACH,CAAC,CAAA,CACM8Y,CACT,CAEA,SAASV,CAAAA,CAAmBtZ,CAAAA,CAAG,CAC7B,IAAIga,CAAAA,CAAa,IAAIxW,CAAAA,CAAM,CAAE,WAAYxD,CAAAA,CAAE,YAAA,EAAe,CAAC,CAAA,CAAE,SAASA,CAAAA,CAAE,KAAA,EAAO,CAAA,CAC/E,OAAAA,CAAAA,CAAE,KAAA,EAAM,CAAE,OAAA,CAAQuB,GAAK,CAChBvB,CAAAA,CAAE,SAASuB,CAAC,CAAA,CAAE,QACjByY,CAAAA,CAAW,OAAA,CAAQzY,CAAAA,CAAGvB,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAC,EAEnC,CAAC,EACDvB,CAAAA,CAAE,KAAA,GAAQ,OAAA,CAAQE,CAAAA,EAAK,CACrB8Z,CAAAA,CAAW,OAAA,CAAQ9Z,CAAAA,CAAGF,EAAE,IAAA,CAAKE,CAAC,CAAC,EACjC,CAAC,EACM8Z,CACT,CAEA,SAASF,CAAAA,CAAiB9Z,CAAAA,CAAG,CAC3B,IAAIka,CAAAA,CAAYla,CAAAA,CAAE,OAAM,CAAE,GAAA,CAAIuB,GAAK,CACjC,IAAI4Y,CAAAA,CAAO,EAAC,CACZ,OAAAna,EAAE,QAAA,CAASuB,CAAC,EAAE,OAAA,CAAQrB,CAAAA,EAAK,CACzBia,CAAAA,CAAKja,CAAAA,CAAE,CAAC,CAAA,CAAA,CAAKia,CAAAA,CAAKja,CAAAA,CAAE,CAAC,CAAA,EAAK,CAAA,EAAKF,EAAE,IAAA,CAAKE,CAAC,EAAE,OAC3C,CAAC,CAAA,CACMia,CACT,CAAC,CAAA,CACD,OAAOlO,CAAAA,CAAUjM,CAAAA,CAAE,OAAM,CAAGka,CAAS,CACvC,CAEA,SAASL,EAAmB7Z,CAAAA,CAAG,CAC7B,IAAIka,CAAAA,CAAYla,CAAAA,CAAE,OAAM,CAAE,GAAA,CAAIuB,GAAK,CACjC,IAAI6Y,CAAAA,CAAQ,EAAC,CACb,OAAApa,EAAE,OAAA,CAAQuB,CAAC,EAAE,OAAA,CAAQrB,CAAAA,EAAK,CACxBka,CAAAA,CAAMla,CAAAA,CAAE,CAAC,CAAA,CAAA,CAAKka,CAAAA,CAAMla,CAAAA,CAAE,CAAC,CAAA,EAAK,CAAA,EAAKF,EAAE,IAAA,CAAKE,CAAC,EAAE,OAC7C,CAAC,CAAA,CACMka,CACT,CAAC,CAAA,CACD,OAAOnO,CAAAA,CAAUjM,CAAAA,CAAE,OAAM,CAAGka,CAAS,CACvC,CAMA,SAASV,EAAca,CAAAA,CAAMC,CAAAA,CAAO,CAClC,IAAI/R,CAAAA,CAAI8R,EAAK,CAAA,CACT7R,CAAAA,CAAI6R,EAAK,CAAA,CAITjR,CAAAA,CAAKkR,CAAAA,CAAM,CAAA,CAAI/R,CAAAA,CACfc,CAAAA,CAAKiR,EAAM,CAAA,CAAI9R,CAAAA,CACf3F,EAAIwX,CAAAA,CAAK,KAAA,CAAQ,EACjB1W,CAAAA,CAAI0W,CAAAA,CAAK,MAAA,CAAS,CAAA,CAEtB,GAAI,CAACjR,GAAM,CAACC,CAAAA,CACV,MAAM,IAAI,KAAA,CAAM,2DAA2D,CAAA,CAG7E,IAAIkR,CAAAA,CAAIC,CAAAA,CACR,OAAI,IAAA,CAAK,IAAInR,CAAE,CAAA,CAAIxG,EAAI,IAAA,CAAK,GAAA,CAAIuG,CAAE,CAAA,CAAIzF,CAAAA,EAEhC0F,EAAK,CAAA,GACP1F,CAAAA,CAAI,CAACA,CAAAA,CAAAA,CAEP4W,CAAAA,CAAK5W,EAAIyF,CAAAA,CAAKC,CAAAA,CACdmR,EAAK7W,CAAAA,GAGDyF,CAAAA,CAAK,CAAA,GACPvG,CAAAA,CAAI,CAACA,CAAAA,CAAAA,CAEP0X,EAAK1X,CAAAA,CACL2X,CAAAA,CAAK3X,EAAIwG,CAAAA,CAAKD,CAAAA,CAAAA,CAGT,CAAE,CAAA,CAAGb,CAAAA,CAAIgS,CAAAA,CAAI,CAAA,CAAG/R,CAAAA,CAAIgS,CAAG,CAChC,CAMA,SAASjB,EAAiBvZ,CAAAA,CAAG,CAC3B,IAAImM,CAAAA,CAAWjH,CAAAA,CAAMpD,CAAAA,CAAQ9B,CAAC,CAAA,CAAI,CAAC,EAAE,GAAA,CAAI,IAAM,EAAE,CAAA,CACjD,OAAAA,CAAAA,CAAE,KAAA,EAAM,CAAE,OAAA,CAAQuB,CAAAA,EAAK,CACrB,IAAIK,CAAAA,CAAO5B,CAAAA,CAAE,KAAKuB,CAAC,CAAA,CACfM,EAAOD,CAAAA,CAAK,IAAA,CACZC,CAAAA,GAAS,MAAA,GACXsK,CAAAA,CAAStK,CAAI,EAAED,CAAAA,CAAK,KAAK,EAAIL,CAAAA,EAEjC,CAAC,EACM4K,CACT,CAMA,SAAS7G,CAAAA,CAAetF,CAAAA,CAAG,CACzB,IAAIya,CAAAA,CAAYza,CAAAA,CAAE,OAAM,CAAE,GAAA,CAAIuB,GAAK,CACjC,IAAIM,CAAAA,CAAO7B,CAAAA,CAAE,IAAA,CAAKuB,CAAC,EAAE,IAAA,CACrB,OAAIM,IAAS,MAAA,CACJ,MAAA,CAAO,UAGTA,CACT,CAAC,EACGyS,CAAAA,CAAM6E,CAAAA,CAAkB,KAAK,GAAA,CAAKsB,CAAS,EAC/Cza,CAAAA,CAAE,KAAA,GAAQ,OAAA,CAAQuB,CAAAA,EAAK,CACrB,IAAIK,CAAAA,CAAO5B,CAAAA,CAAE,KAAKuB,CAAC,CAAA,CACf,OAAO,MAAA,CAAOK,CAAAA,CAAM,MAAM,CAAA,GAC5BA,CAAAA,CAAK,IAAA,EAAQ0S,CAAAA,EAEjB,CAAC,EACH,CAEA,SAAS9O,CAAAA,CAAiBxF,EAAG,CAE3B,IAAIya,EAAYza,CAAAA,CAAE,KAAA,EAAM,CAAE,GAAA,CAAIuB,CAAAA,EAAKvB,CAAAA,CAAE,KAAKuB,CAAC,CAAA,CAAE,IAAI,CAAA,CAC7CmZ,CAAAA,CAASvB,EAAkB,IAAA,CAAK,GAAA,CAAKsB,CAAS,CAAA,CAE9CzR,CAAAA,CAAS,GACbhJ,CAAAA,CAAE,KAAA,GAAQ,OAAA,CAAQuB,CAAAA,EAAK,CACrB,IAAIM,CAAAA,CAAO7B,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CAAE,KAAOmZ,CAAAA,CACvB1R,CAAAA,CAAOnH,CAAI,CAAA,GACdmH,CAAAA,CAAOnH,CAAI,CAAA,CAAI,EAAC,CAAA,CAElBmH,CAAAA,CAAOnH,CAAI,CAAA,CAAE,KAAKN,CAAC,EACrB,CAAC,CAAA,CAED,IAAIoU,EAAQ,CAAA,CACRgF,CAAAA,CAAiB3a,CAAAA,CAAE,KAAA,EAAM,CAAE,cAAA,CAC/B,MAAM,IAAA,CAAKgJ,CAAM,EAAE,OAAA,CAAQ,CAACoC,EAAI9K,CAAAA,GAAM,CAChC8K,IAAO,MAAA,EAAa9K,CAAAA,CAAIqa,IAAmB,CAAA,CAC7C,EAAEhF,EACOvK,CAAAA,GAAO,MAAA,EAAauK,GAC7BvK,CAAAA,CAAG,OAAA,CAAQ7J,CAAAA,EAAKvB,CAAAA,CAAE,IAAA,CAAKuB,CAAC,EAAE,IAAA,EAAQoU,CAAK,EAE3C,CAAC,EACH,CAEA,SAAS5T,CAAAA,CAAc/B,CAAAA,CAAGiC,CAAAA,CAAQJ,CAAAA,CAAM8D,CAAAA,CAAO,CAC7C,IAAI/D,CAAAA,CAAO,CACT,KAAA,CAAO,CAAA,CACP,OAAQ,CACV,CAAA,CACA,OAAI,SAAA,CAAU,MAAA,EAAU,CAAA,GACtBA,EAAK,IAAA,CAAOC,CAAAA,CACZD,EAAK,KAAA,CAAQ+D,CAAAA,CAAAA,CAER0T,EAAarZ,CAAAA,CAAG,QAAA,CAAU4B,CAAAA,CAAMK,CAAM,CAC/C,CAEA,SAAS2Y,CAAAA,CAAcC,CAAAA,CAAOC,EAAYC,CAAAA,CAAoB,CAC5D,IAAMC,CAAAA,CAAS,EAAC,CAChB,IAAA,IAAS1a,CAAAA,CAAI,CAAA,CAAGA,EAAIua,CAAAA,CAAM,MAAA,CAAQva,GAAKwa,CAAAA,CAAW,CAChD,IAAMG,CAAAA,CAAQJ,CAAAA,CAAM,KAAA,CAAMva,CAAAA,CAAGA,CAAAA,CAAIwa,CAAS,EAC1CE,CAAAA,CAAO,IAAA,CAAKC,CAAK,EACnB,CACA,OAAOD,CACT,CAEA,IAAMD,CAAAA,CAAqB,KAAA,CAE3B,SAAS5B,EAAkB+B,CAAAA,CAAIC,CAAAA,CAAW,CACxC,GAAGA,CAAAA,CAAU,OAASJ,CAAAA,CAAoB,CACxC,IAAMC,CAAAA,CAASJ,CAAAA,CAAcO,CAAS,CAAA,CACtC,OAAOD,EAAG,KAAA,CAAM,IAAA,CAAMF,EAAO,GAAA,CAAIC,CAAAA,EAASC,CAAAA,CAAG,KAAA,CAAM,IAAA,CAAMD,CAAK,CAAC,CAAC,CAClE,MACE,OAAOC,CAAAA,CAAG,MAAM,IAAA,CAAMC,CAAS,CAEnC,CAEA,SAASrZ,CAAAA,CAAQ9B,EAAG,CAElB,IAAMya,EADQza,CAAAA,CAAE,KAAA,GACQ,GAAA,CAAIuB,CAAAA,EAAK,CAC/B,IAAIM,CAAAA,CAAO7B,CAAAA,CAAE,KAAKuB,CAAC,CAAA,CAAE,KACrB,OAAIM,CAAAA,GAAS,OACJ,MAAA,CAAO,SAAA,CAETA,CACT,CAAC,CAAA,CAED,OAAOsX,CAAAA,CAAkB,IAAA,CAAK,IAAKsB,CAAS,CAC9C,CAOA,SAASd,CAAAA,CAAUyB,CAAAA,CAAYF,CAAAA,CAAI,CACjC,IAAIvP,EAAS,CAAE,GAAA,CAAK,EAAC,CAAG,GAAA,CAAK,EAAG,CAAA,CAChC,OAAAyP,CAAAA,CAAW,OAAA,CAAQC,CAAAA,EAAS,CACtBH,CAAAA,CAAGG,CAAK,EACV1P,CAAAA,CAAO,GAAA,CAAI,KAAK0P,CAAK,CAAA,CAErB1P,CAAAA,CAAO,GAAA,CAAI,IAAA,CAAK0P,CAAK,EAEzB,CAAC,CAAA,CACM1P,CACT,CAMA,SAAS5F,EAAK8E,CAAAA,CAAMqQ,CAAAA,CAAI,CACtB,IAAIzE,CAAAA,CAAQ,KAAK,GAAA,EAAI,CACrB,GAAI,CACF,OAAOyE,GACT,CAAA,OAAE,CACA,OAAA,CAAQ,GAAA,CAAIrQ,CAAAA,CAAO,WAAa,IAAA,CAAK,GAAA,GAAQ4L,CAAAA,CAAAA,CAAS,IAAI,EAC5D,CACF,CAEA,SAASiD,CAAAA,CAAO7O,CAAAA,CAAMqQ,CAAAA,CAAI,CACxB,OAAOA,CAAAA,EACT,CAEA,IAAII,EAAY,CAAA,CAChB,SAASza,CAAAA,CAASoB,CAAAA,CAAQ,CACxB,IAAIsZ,EAAK,EAAED,CAAAA,CACX,OAAOrZ,CAAAA,EAAU,EAAA,CAAKsZ,EACxB,CAEA,SAASrW,CAAAA,CAAMuR,CAAAA,CAAOtR,CAAAA,CAAOqW,CAAAA,CAAO,EAAG,CACjCrW,CAAAA,EAAS,OACXA,CAAAA,CAAQsR,CAAAA,CACRA,EAAQ,CAAA,CAAA,CAGV,IAAIgF,CAAAA,CAAUnb,CAAAA,EAAMA,CAAAA,CAAI6E,CAAAA,CACpBqW,EAAO,CAAA,GACTC,CAAAA,CAAUnb,GAAM6E,CAAAA,CAAQ7E,CAAAA,CAAAA,CAG1B,IAAM4E,CAAAA,CAAQ,EAAC,CACf,IAAA,IAAS5E,CAAAA,CAAImW,CAAAA,CAAOgF,EAAOnb,CAAC,CAAA,CAAGA,GAAKkb,CAAAA,CAClCtW,CAAAA,CAAM,KAAK5E,CAAC,CAAA,CAGd,OAAO4E,CACT,CAEA,SAAS0U,EAAK7K,CAAAA,CAAQ2M,CAAAA,CAAM,CAC1B,IAAMC,CAAAA,CAAO,EAAC,CACd,IAAA,IAAWC,KAAOF,CAAAA,CACZ3M,CAAAA,CAAO6M,CAAG,CAAA,GAAM,MAAA,GAClBD,EAAKC,CAAG,CAAA,CAAI7M,EAAO6M,CAAG,CAAA,CAAA,CAI1B,OAAOD,CACT,CAEA,SAASlC,EAAUnQ,CAAAA,CAAKuS,CAAAA,CAAY,CAClC,IAAIC,CAAAA,CAAOD,EACX,OAAI,OAAOA,CAAAA,EAAe,QAAA,GACxBC,CAAAA,CAAQC,CAAAA,EAAQA,EAAIF,CAAU,CAAA,CAAA,CAGzB,OAAO,OAAA,CAAQvS,CAAG,EAAE,MAAA,CAAO,CAACmB,CAAAA,CAAK,CAAClH,CAAAA,CAAGhC,CAAC,KAC3CkJ,CAAAA,CAAIlH,CAAC,EAAIuY,CAAAA,CAAKva,CAAAA,CAAGgC,CAAC,CAAA,CACXkH,CAAAA,CAAAA,CACN,EAAE,CACP,CAEA,SAASwB,CAAAA,CAAU+P,CAAAA,CAAOC,EAAQ,CAChC,OAAOD,EAAM,MAAA,CAAO,CAACvR,CAAAA,CAAKmR,CAAAA,CAAKtb,CAAAA,IAC7BmK,CAAAA,CAAImR,CAAG,CAAA,CAAIK,CAAAA,CAAO3b,CAAC,CAAA,CACZmK,CAAAA,CAAAA,CACN,EAAE,CACP,CAEA,CAAA,CAAE,CAAC,mBAAA,CAAoB,EAAE,CAAC,CAAA,CAAE,GAAG,CAAC,SAAS9J,EAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CAChEC,CAAAA,CAAO,OAAA,CAAU,QAEjB,EAAE,EAAE,EAAE,EAAA,CAAG,CAAC,SAASa,CAAAA,CAAQb,CAAAA,CAAOD,EAAQ,CA+B1C,IAAIqc,EAAMvb,CAAAA,CAAQ,OAAO,EAEzBb,CAAAA,CAAO,OAAA,CAAU,CACf,KAAA,CAAOoc,CAAAA,CAAI,KAAA,CACX,IAAA,CAAMvb,CAAAA,CAAQ,YAAY,EAC1B,GAAA,CAAKA,CAAAA,CAAQ,WAAW,CAAA,CACxB,OAAA,CAASub,EAAI,OACf,EAEA,CAAA,CAAE,CAAC,OAAA,CAAQ,EAAA,CAAG,YAAY,EAAA,CAAG,YAAA,CAAa,EAAE,CAAC,CAAA,CAAE,GAAG,CAAC,SAASvb,CAAAA,CAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CACnFC,EAAO,OAAA,CAAUqc,CAAAA,CAEjB,SAASA,CAAAA,CAAWnc,CAAAA,CAAG,CACrB,IAAIqB,CAAAA,CAAU,EAAC,CACX+a,CAAAA,CAAQ,GACRC,CAAAA,CAEJ,SAAS/a,EAAIC,CAAAA,CAAG,CACV,OAAO,MAAA,CAAOF,CAAAA,CAASE,CAAC,CAAA,GAC5BF,CAAAA,CAAQE,CAAC,EAAI,IAAA,CACb8a,CAAAA,CAAK,KAAK9a,CAAC,CAAA,CACXvB,EAAE,UAAA,CAAWuB,CAAC,CAAA,CAAE,OAAA,CAAQD,CAAG,CAAA,CAC3BtB,EAAE,YAAA,CAAauB,CAAC,EAAE,OAAA,CAAQD,CAAG,GAC/B,CAEA,OAAAtB,CAAAA,CAAE,KAAA,EAAM,CAAE,OAAA,CAAQ,SAASuB,CAAAA,CAAG,CAC5B8a,EAAO,EAAC,CACR/a,EAAIC,CAAC,CAAA,CACD8a,EAAK,MAAA,EACPD,CAAAA,CAAM,KAAKC,CAAI,EAEnB,CAAC,CAAA,CAEMD,CACT,CAEA,CAAA,CAAE,EAAE,CAAA,CAAE,EAAA,CAAG,CAAC,SAASzb,CAAAA,CAAQb,CAAAA,CAAOD,EAAQ,CAC1CC,CAAAA,CAAO,QAAUwB,CAAAA,CAUjB,SAASA,CAAAA,CAAItB,CAAAA,CAAGoL,CAAAA,CAAIzF,CAAAA,CAAO,CACpB,KAAA,CAAM,OAAA,CAAQyF,CAAE,CAAA,GACnBA,CAAAA,CAAK,CAACA,CAAE,CAAA,CAAA,CAGV,IAAIkR,CAAAA,CAAatc,CAAAA,CAAE,UAAA,GAAeuB,CAAAA,EAAKvB,CAAAA,CAAE,WAAWuB,CAAC,CAAA,CAAIA,GAAKvB,CAAAA,CAAE,SAAA,CAAUuB,CAAC,CAAA,CACvEgb,CAAAA,CAAY5W,CAAAA,GAAU,OAAS6W,CAAAA,CAAeC,CAAAA,CAE9ChS,EAAM,EAAC,CACPpJ,EAAU,EAAC,CACf,OAAA+J,CAAAA,CAAG,OAAA,CAAQ7J,CAAAA,EAAK,CACd,GAAI,CAACvB,EAAE,OAAA,CAAQuB,CAAC,EACd,MAAM,IAAI,KAAA,CAAM,4BAAA,CAA+BA,CAAC,CAAA,CAGlDgb,EAAUhb,CAAAA,CAAG+a,CAAAA,CAAYjb,EAASoJ,CAAG,EACvC,CAAC,CAAA,CAEMA,CACT,CAEA,SAAS+R,CAAAA,CAAajb,CAAAA,CAAG+a,EAAYjb,CAAAA,CAASoJ,CAAAA,CAAK,CAEjD,IAAA,IADIrJ,CAAAA,CAAQ,CAAC,CAACG,CAAAA,CAAG,KAAK,CAAC,CAAA,CAChBH,EAAM,MAAA,CAAS,CAAA,EAAG,CACvB,IAAIiB,CAAAA,CAAOjB,EAAM,GAAA,EAAI,CACjBiB,CAAAA,CAAK,CAAC,CAAA,CACRoI,CAAAA,CAAI,KAAKpI,CAAAA,CAAK,CAAC,CAAC,CAAA,CAEX,MAAA,CAAO,OAAOhB,CAAAA,CAASgB,CAAAA,CAAK,CAAC,CAAC,CAAA,GACjChB,CAAAA,CAAQgB,EAAK,CAAC,CAAC,EAAI,IAAA,CACnBjB,CAAAA,CAAM,KAAK,CAACiB,CAAAA,CAAK,CAAC,CAAA,CAAG,IAAI,CAAC,EAC1Bqa,CAAAA,CAAaJ,CAAAA,CAAWja,EAAK,CAAC,CAAC,EAAGQ,CAAAA,EAAKzB,CAAAA,CAAM,IAAA,CAAK,CAACyB,CAAAA,CAAG,KAAK,CAAC,CAAC,CAAA,EAGnE,CACF,CAEA,SAAS4Z,EAAYlb,CAAAA,CAAG+a,CAAAA,CAAYjb,CAAAA,CAASoJ,CAAAA,CAAK,CAEhD,IAAA,IADIrJ,EAAQ,CAACG,CAAC,EACPH,CAAAA,CAAM,MAAA,CAAS,GAAG,CACvB,IAAIiB,CAAAA,CAAOjB,CAAAA,CAAM,GAAA,EAAI,CAChB,OAAO,MAAA,CAAOC,CAAAA,CAASgB,CAAI,CAAA,GAC9BhB,CAAAA,CAAQgB,CAAI,CAAA,CAAI,IAAA,CAChBoI,CAAAA,CAAI,IAAA,CAAKpI,CAAI,CAAA,CACbqa,EAAaJ,CAAAA,CAAWja,CAAI,EAAGQ,CAAAA,EAAKzB,CAAAA,CAAM,KAAKyB,CAAC,CAAC,GAErD,CACF,CAEA,SAAS6Z,CAAAA,CAAa7B,CAAAA,CAAO8B,EAAU,CAErC,IAAA,IADIC,EAAS/B,CAAAA,CAAM,MAAA,CACZ+B,CAAAA,EAAAA,EACLD,CAAAA,CAAS9B,CAAAA,CAAM+B,CAAM,EAAGA,CAAAA,CAAQ/B,CAAK,EAGvC,OAAOA,CACT,CAEA,CAAA,CAAE,EAAE,CAAA,CAAE,EAAA,CAAG,CAAC,SAASla,CAAAA,CAAQb,CAAAA,CAAOD,EAAQ,CAC1C,IAAIgd,EAAWlc,CAAAA,CAAQ,YAAY,CAAA,CAEnCb,CAAAA,CAAO,OAAA,CAAUgd,CAAAA,CAEjB,SAASA,CAAAA,CAAY9c,CAAAA,CAAG+c,EAAYC,CAAAA,CAAU,CAC5C,OAAOhd,CAAAA,CAAE,KAAA,EAAM,CAAE,MAAA,CAAO,SAASyK,CAAAA,CAAKlJ,EAAG,CACvC,OAAAkJ,EAAIlJ,CAAC,CAAA,CAAIsb,EAAS7c,CAAAA,CAAGuB,CAAAA,CAAGwb,CAAAA,CAAYC,CAAQ,CAAA,CACrCvS,CACT,EAAG,EAAE,CACP,CAEA,CAAA,CAAE,CAAC,YAAA,CAAa,EAAE,CAAC,CAAA,CAAE,EAAA,CAAG,CAAC,SAAS9J,CAAAA,CAAQb,CAAAA,CAAOD,EAAQ,CACzD,IAAIod,EAAgBtc,CAAAA,CAAQ,wBAAwB,CAAA,CAEpDb,CAAAA,CAAO,OAAA,CAAU+c,CAAAA,CAEjB,IAAIK,CAAAA,CAAsB,IAAM,EAEhC,SAASL,CAAAA,CAAS7c,EAAG+O,CAAAA,CAAQ/N,CAAAA,CAAUmc,EAAQ,CAC7C,OAAOC,EAAYpd,CAAAA,CAAG,MAAA,CAAO+O,CAAM,CAAA,CACjC/N,CAAAA,EAAYkc,EACZC,CAAAA,EAAU,SAAS5b,CAAAA,CAAG,CAAE,OAAOvB,CAAAA,CAAE,SAASuB,CAAC,CAAG,CAAC,CACnD,CAEA,SAAS6b,CAAAA,CAAYpd,CAAAA,CAAG+O,CAAAA,CAAQ/N,CAAAA,CAAUmc,CAAAA,CAAQ,CAChD,IAAI/Y,CAAAA,CAAU,GACViZ,CAAAA,CAAK,IAAIJ,EACT1b,CAAAA,CAAGoN,CAAAA,CAEH2O,CAAAA,CAAkB,SAASva,CAAAA,CAAM,CACnC,IAAIF,CAAAA,CAAIE,CAAAA,CAAK,IAAMxB,CAAAA,CAAIwB,CAAAA,CAAK,EAAIA,CAAAA,CAAK,CAAA,CACjC6B,CAAAA,CAASR,CAAAA,CAAQvB,CAAC,CAAA,CAClB4B,EAASzD,CAAAA,CAAS+B,CAAI,EACtBwa,CAAAA,CAAW5O,CAAAA,CAAO,SAAWlK,CAAAA,CAEjC,GAAIA,CAAAA,CAAS,CAAA,CACX,MAAM,IAAI,MAAM,2DAAA,CACe1B,CAAAA,CAAO,YAAc0B,CAAM,CAAA,CAGxD8Y,EAAW3Y,CAAAA,CAAO,QAAA,GACpBA,CAAAA,CAAO,QAAA,CAAW2Y,CAAAA,CAClB3Y,CAAAA,CAAO,YAAcrD,CAAAA,CACrB8b,CAAAA,CAAG,SAASxa,CAAAA,CAAG0a,CAAQ,GAE3B,CAAA,CAQA,IANAvd,CAAAA,CAAE,KAAA,EAAM,CAAE,OAAA,CAAQ,SAAS,CAAA,CAAG,CAC5B,IAAIud,CAAAA,CAAW,CAAA,GAAMxO,EAAS,CAAA,CAAI,MAAA,CAAO,kBACzC3K,CAAAA,CAAQ,CAAC,EAAI,CAAE,QAAA,CAAUmZ,CAAS,CAAA,CAClCF,CAAAA,CAAG,IAAI,CAAA,CAAGE,CAAQ,EACpB,CAAC,CAAA,CAEMF,CAAAA,CAAG,MAAK,CAAI,CAAA,GACjB9b,EAAI8b,CAAAA,CAAG,SAAA,GACP1O,CAAAA,CAASvK,CAAAA,CAAQ7C,CAAC,CAAA,CACdoN,CAAAA,CAAO,QAAA,GAAa,OAAO,iBAAA,CAAA,EAI/BwO,CAAAA,CAAO5b,CAAC,CAAA,CAAE,OAAA,CAAQ+b,CAAe,CAAA,CAGnC,OAAOlZ,CACT,CAEA,CAAA,CAAE,CAAC,yBAAyB,EAAE,CAAC,EAAE,EAAA,CAAG,CAAC,SAASzD,CAAAA,CAAQb,CAAAA,CAAOD,EAAQ,CACrE,IAAI2d,EAAS7c,CAAAA,CAAQ,UAAU,EAE/Bb,CAAAA,CAAO,OAAA,CAAU2d,EAEjB,SAASA,CAAAA,CAAWzd,CAAAA,CAAG,CACrB,OAAOwd,CAAAA,CAAOxd,CAAC,CAAA,CAAE,MAAA,CAAO,SAASqc,CAAAA,CAAM,CACrC,OAAOA,CAAAA,CAAK,MAAA,CAAS,CAAA,EAAMA,CAAAA,CAAK,MAAA,GAAW,CAAA,EAAKrc,EAAE,OAAA,CAAQqc,CAAAA,CAAK,CAAC,CAAA,CAAGA,CAAAA,CAAK,CAAC,CAAC,CAC5E,CAAC,CACH,CAEA,CAAA,CAAE,CAAC,UAAA,CAAW,EAAE,CAAC,CAAA,CAAE,EAAA,CAAG,CAAC,SAAS1b,CAAAA,CAAQb,EAAOD,CAAAA,CAAQ,CACvDC,EAAO,OAAA,CAAU4d,CAAAA,CAEjB,IAAIR,CAAAA,CAAsB,IAAM,EAEhC,SAASQ,CAAAA,CAAc1d,CAAAA,CAAGgB,CAAAA,CAAUmc,CAAAA,CAAQ,CAC1C,OAAOQ,CAAAA,CAAiB3d,CAAAA,CACtBgB,GAAYkc,CAAAA,CACZC,CAAAA,EAAU,SAAS5b,CAAAA,CAAG,CAAE,OAAOvB,CAAAA,CAAE,QAAA,CAASuB,CAAC,CAAG,CAAC,CACnD,CAEA,SAASoc,CAAAA,CAAiB3d,EAAGgB,CAAAA,CAAUmc,CAAAA,CAAQ,CAC7C,IAAI/Y,CAAAA,CAAU,GACVwZ,CAAAA,CAAQ5d,CAAAA,CAAE,OAAM,CAEpB,OAAA4d,EAAM,OAAA,CAAQ,SAASrc,CAAAA,CAAG,CACxB6C,CAAAA,CAAQ7C,CAAC,EAAI,EAAC,CACd6C,EAAQ7C,CAAC,CAAA,CAAEA,CAAC,CAAA,CAAI,CAAE,QAAA,CAAU,CAAE,CAAA,CAC9Bqc,CAAAA,CAAM,QAAQ,SAAS/a,CAAAA,CAAG,CACpBtB,CAAAA,GAAMsB,CAAAA,GACRuB,EAAQ7C,CAAC,CAAA,CAAEsB,CAAC,CAAA,CAAI,CAAE,QAAA,CAAU,OAAO,iBAAkB,CAAA,EAEzD,CAAC,CAAA,CACDsa,CAAAA,CAAO5b,CAAC,CAAA,CAAE,OAAA,CAAQ,SAASwB,CAAAA,CAAM,CAC/B,IAAIF,EAAIE,CAAAA,CAAK,CAAA,GAAMxB,EAAIwB,CAAAA,CAAK,CAAA,CAAIA,EAAK,CAAA,CACjC8a,CAAAA,CAAI7c,EAAS+B,CAAI,CAAA,CACrBqB,EAAQ7C,CAAC,CAAA,CAAEsB,CAAC,CAAA,CAAI,CAAE,SAAUgb,CAAAA,CAAG,WAAA,CAAatc,CAAE,EAChD,CAAC,EACH,CAAC,CAAA,CAEDqc,CAAAA,CAAM,QAAQ,SAASra,CAAAA,CAAG,CACxB,IAAIua,CAAAA,CAAO1Z,CAAAA,CAAQb,CAAC,CAAA,CACpBqa,CAAAA,CAAM,QAAQ,SAAStd,CAAAA,CAAG,CACxB,IAAIyd,CAAAA,CAAO3Z,EAAQ9D,CAAC,CAAA,CACpBsd,CAAAA,CAAM,OAAA,CAAQ,SAASI,CAAAA,CAAG,CACxB,IAAIC,CAAAA,CAAKF,EAAKxa,CAAC,CAAA,CACX2a,EAAKJ,CAAAA,CAAKE,CAAC,CAAA,CACXG,CAAAA,CAAKJ,CAAAA,CAAKC,CAAC,EACXI,CAAAA,CAAcH,CAAAA,CAAG,SAAWC,CAAAA,CAAG,QAAA,CAC/BE,EAAcD,CAAAA,CAAG,QAAA,GACnBA,CAAAA,CAAG,QAAA,CAAWC,CAAAA,CACdD,CAAAA,CAAG,YAAcD,CAAAA,CAAG,WAAA,EAExB,CAAC,EACH,CAAC,EACH,CAAC,CAAA,CAEM9Z,CACT,CAEA,CAAA,CAAE,EAAE,CAAA,CAAE,EAAA,CAAG,CAAC,SAASzD,CAAAA,CAAQb,EAAOD,CAAAA,CAAQ,CAC1CC,CAAAA,CAAO,OAAA,CAAU,CACf,UAAA,CAAYa,EAAQ,cAAc,CAAA,CAClC,SAAUA,CAAAA,CAAQ,YAAY,EAC9B,WAAA,CAAaA,CAAAA,CAAQ,gBAAgB,CAAA,CACrC,UAAA,CAAYA,EAAQ,eAAe,CAAA,CACnC,cAAeA,CAAAA,CAAQ,kBAAkB,EACzC,SAAA,CAAWA,CAAAA,CAAQ,cAAc,CAAA,CACjC,SAAA,CAAWA,CAAAA,CAAQ,aAAa,CAAA,CAChC,QAAA,CAAUA,EAAQ,YAAY,CAAA,CAC9B,KAAMA,CAAAA,CAAQ,QAAQ,CAAA,CACtB,MAAA,CAAQA,CAAAA,CAAQ,UAAU,EAC1B,OAAA,CAASA,CAAAA,CAAQ,WAAW,CAC9B,EAEA,EAAE,CAAC,cAAA,CAAe,EAAA,CAAG,YAAA,CAAa,EAAA,CAAG,gBAAA,CAAiB,GAAG,eAAA,CAAgB,EAAA,CAAG,mBAAmB,EAAA,CAAG,cAAA,CAAe,GAAG,aAAA,CAAc,EAAA,CAAG,YAAA,CAAa,EAAA,CAAG,QAAA,CAAS,EAAA,CAAG,WAAW,EAAA,CAAG,WAAA,CAAY,EAAE,CAAC,CAAA,CAAE,GAAG,CAAC,SAASA,CAAAA,CAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CACpO,IAAIwe,CAAAA,CAAU1d,CAAAA,CAAQ,WAAW,CAAA,CAEjCb,CAAAA,CAAO,QAAUwe,CAAAA,CAEjB,SAASA,CAAAA,CAAUte,CAAAA,CAAG,CACpB,GAAI,CACFqe,CAAAA,CAAQre,CAAC,EACX,CAAA,MAASE,CAAAA,CAAG,CACV,GAAIA,CAAAA,YAAame,CAAAA,CAAQ,cAAA,CACvB,OAAO,MAAA,CAET,MAAMne,CACR,CACA,OAAO,KACT,CAEA,EAAE,CAAC,WAAA,CAAY,EAAE,CAAC,CAAA,CAAE,GAAG,CAAC,SAASS,EAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CACxD,IAAIyB,CAAAA,CAAMX,CAAAA,CAAQ,OAAO,CAAA,CAEzBb,CAAAA,CAAO,QAAUuQ,CAAAA,CAEjB,SAASA,EAAUrQ,CAAAA,CAAGoL,CAAAA,CAAI,CACxB,OAAO9J,CAAAA,CAAItB,CAAAA,CAAGoL,CAAAA,CAAI,MAAM,CAC1B,CAEA,CAAA,CAAE,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAA,CAAG,CAAC,SAASzK,CAAAA,CAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CACpD,IAAIyB,CAAAA,CAAMX,EAAQ,OAAO,CAAA,CAEzBb,EAAO,OAAA,CAAU0X,CAAAA,CAEjB,SAASA,CAAAA,CAASxX,CAAAA,CAAGoL,EAAI,CACvB,OAAO9J,EAAItB,CAAAA,CAAGoL,CAAAA,CAAI,KAAK,CACzB,CAEA,CAAA,CAAE,CAAC,OAAA,CAAQ,EAAE,CAAC,CAAA,CAAE,EAAA,CAAG,CAAC,SAASzK,CAAAA,CAAQb,EAAOD,CAAAA,CAAQ,CACpD,IAAI2D,CAAAA,CAAQ7C,CAAAA,CAAQ,UAAU,EAC1Bsc,CAAAA,CAAgBtc,CAAAA,CAAQ,wBAAwB,CAAA,CAEpDb,CAAAA,CAAO,QAAUye,CAAAA,CAEjB,SAASA,CAAAA,CAAKve,CAAAA,CAAG+c,CAAAA,CAAY,CAC3B,IAAIpR,CAAAA,CAAS,IAAInI,EACbgb,CAAAA,CAAU,GACVnB,CAAAA,CAAK,IAAIJ,EACT1b,CAAAA,CAEJ,SAAS+b,EAAgBva,CAAAA,CAAM,CAC7B,IAAIF,CAAAA,CAAIE,CAAAA,CAAK,IAAMxB,CAAAA,CAAIwB,CAAAA,CAAK,CAAA,CAAIA,CAAAA,CAAK,CAAA,CACjC0b,CAAAA,CAAMpB,EAAG,QAAA,CAASxa,CAAC,EACvB,GAAI4b,CAAAA,GAAQ,OAAW,CACrB,IAAIxZ,CAAAA,CAAa8X,CAAAA,CAAWha,CAAI,CAAA,CAC5BkC,EAAawZ,CAAAA,GACfD,CAAAA,CAAQ3b,CAAC,CAAA,CAAItB,CAAAA,CACb8b,EAAG,QAAA,CAASxa,CAAAA,CAAGoC,CAAU,CAAA,EAE7B,CACF,CAEA,GAAIjF,CAAAA,CAAE,SAAA,KAAgB,CAAA,CACpB,OAAO2L,EAGT3L,CAAAA,CAAE,KAAA,EAAM,CAAE,OAAA,CAAQ,SAASuB,CAAAA,CAAG,CAC5B8b,CAAAA,CAAG,GAAA,CAAI9b,EAAG,MAAA,CAAO,iBAAiB,EAClCoK,CAAAA,CAAO,OAAA,CAAQpK,CAAC,EAClB,CAAC,CAAA,CAGD8b,EAAG,QAAA,CAASrd,CAAAA,CAAE,OAAM,CAAE,CAAC,EAAG,CAAC,CAAA,CAG3B,IAAA,IADI0e,CAAAA,CAAO,KAAA,CACJrB,CAAAA,CAAG,MAAK,CAAI,CAAA,EAAG,CAEpB,GADA9b,CAAAA,CAAI8b,EAAG,SAAA,EAAU,CACb,MAAA,CAAO,MAAA,CAAOmB,CAAAA,CAASjd,CAAC,EAC1BoK,CAAAA,CAAO,OAAA,CAAQpK,EAAGid,CAAAA,CAAQjd,CAAC,CAAC,CAAA,CAAA,KACvB,CAAA,GAAImd,EACT,MAAM,IAAI,MAAM,gCAAA,CAAmC1e,CAAC,EAEpD0e,CAAAA,CAAO,KAAA,CAGT1e,EAAE,SAAA,CAAUuB,CAAC,CAAA,CAAE,OAAA,CAAQ+b,CAAe,EACxC,CAEA,OAAO3R,CACT,CAEA,CAAA,CAAE,CAAC,yBAAyB,EAAA,CAAG,UAAA,CAAW,EAAE,CAAC,CAAA,CAAE,EAAA,CAAG,CAAC,SAAShL,CAAAA,CAAQb,EAAOD,CAAAA,CAAQ,CACnFC,EAAO,OAAA,CAAU0d,CAAAA,CAEjB,SAASA,CAAAA,CAAOxd,CAAAA,CAAG,CACjB,IAAI6M,CAAAA,CAAQ,CAAA,CACRzL,EAAQ,EAAC,CACTC,EAAU,EAAC,CACX+C,CAAAA,CAAU,EAAC,CAEf,SAAS9C,EAAIC,CAAAA,CAAG,CACd,IAAI4B,CAAAA,CAAQ9B,CAAAA,CAAQE,CAAC,CAAA,CAAI,CACvB,OAAA,CAAS,IAAA,CACT,OAAA,CAASsL,CAAAA,CACT,MAAOA,CAAAA,EACT,CAAA,CAYA,GAXAzL,CAAAA,CAAM,IAAA,CAAKG,CAAC,CAAA,CAEZvB,CAAAA,CAAE,UAAA,CAAWuB,CAAC,CAAA,CAAE,OAAA,CAAQ,SAASsB,CAAAA,CAAG,CAC7B,OAAO,MAAA,CAAOxB,CAAAA,CAASwB,CAAC,CAAA,CAGlBxB,CAAAA,CAAQwB,CAAC,CAAA,CAAE,OAAA,GACpBM,CAAAA,CAAM,QAAU,IAAA,CAAK,GAAA,CAAIA,EAAM,OAAA,CAAS9B,CAAAA,CAAQwB,CAAC,CAAA,CAAE,KAAK,IAHxDvB,CAAAA,CAAIuB,CAAC,EACLM,CAAAA,CAAM,OAAA,CAAU,KAAK,GAAA,CAAIA,CAAAA,CAAM,QAAS9B,CAAAA,CAAQwB,CAAC,CAAA,CAAE,OAAO,CAAA,EAI9D,CAAC,EAEGM,CAAAA,CAAM,OAAA,GAAYA,EAAM,KAAA,CAAO,CACjC,IAAIkZ,CAAAA,CAAO,EAAC,CACRxZ,CAAAA,CACJ,GACEA,CAAAA,CAAIzB,EAAM,GAAA,EAAI,CACdC,EAAQwB,CAAC,CAAA,CAAE,QAAU,KAAA,CACrBwZ,CAAAA,CAAK,IAAA,CAAKxZ,CAAC,CAAA,CAAA,MACJtB,CAAAA,GAAMsB,GACfuB,CAAAA,CAAQ,IAAA,CAAKiY,CAAI,EACnB,CACF,CAEA,OAAArc,CAAAA,CAAE,KAAA,EAAM,CAAE,OAAA,CAAQ,SAASuB,EAAG,CACvB,MAAA,CAAO,OAAOF,CAAAA,CAASE,CAAC,GAC3BD,CAAAA,CAAIC,CAAC,EAET,CAAC,CAAA,CAEM6C,CACT,CAEA,CAAA,CAAE,EAAE,CAAA,CAAE,EAAA,CAAG,CAAC,SAASzD,CAAAA,CAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CAC1C,SAASwe,EAAQre,CAAAA,CAAG,CAClB,IAAIqB,CAAAA,CAAU,GACVD,CAAAA,CAAQ,EAAC,CACTgD,CAAAA,CAAU,EAAC,CAEf,SAASua,CAAAA,CAAM/c,CAAAA,CAAM,CACnB,GAAI,MAAA,CAAO,OAAOR,CAAAA,CAAOQ,CAAI,EAC3B,MAAM,IAAIgd,EAGP,MAAA,CAAO,MAAA,CAAOvd,EAASO,CAAI,CAAA,GAC9BR,EAAMQ,CAAI,CAAA,CAAI,IAAA,CACdP,CAAAA,CAAQO,CAAI,CAAA,CAAI,KAChB5B,CAAAA,CAAE,YAAA,CAAa4B,CAAI,CAAA,CAAE,OAAA,CAAQ+c,CAAK,CAAA,CAClC,OAAOvd,CAAAA,CAAMQ,CAAI,CAAA,CACjBwC,CAAAA,CAAQ,KAAKxC,CAAI,CAAA,EAErB,CAIA,GAFA5B,CAAAA,CAAE,OAAM,CAAE,OAAA,CAAQ2e,CAAK,CAAA,CAEnB,MAAA,CAAO,IAAA,CAAKtd,CAAO,CAAA,CAAE,MAAA,GAAWrB,EAAE,SAAA,EAAU,CAC9C,MAAM,IAAI4e,CAAAA,CAGZ,OAAOxa,CACT,CAEA,MAAMwa,CAAAA,SAAuB,KAAM,CACjC,WAAA,EAAc,CACZ,MAAM,GAAG,SAAS,EACpB,CACF,CAEA9e,CAAAA,CAAO,QAAUue,CAAAA,CACjBA,CAAAA,CAAQ,eAAiBO,EAEzB,CAAA,CAAE,EAAE,CAAA,CAAE,EAAA,CAAG,CAAC,SAASje,CAAAA,CAAQb,EAAOD,CAAAA,CAAQ,CAQ1C,MAAMod,CAAc,CAClB,KAAO,EAAC,CACR,WAAA,CAAc,EAAC,CAKf,IAAA,EAAO,CACL,OAAO,IAAA,CAAK,KAAK,MACnB,CAKA,MAAO,CACL,OAAO,KAAK,IAAA,CAAK,GAAA,CAAI,SAAS1U,CAAAA,CAAG,CAAE,OAAOA,CAAAA,CAAE,GAAK,CAAC,CACpD,CAKA,GAAA,CAAIqT,CAAAA,CAAK,CACP,OAAO,OAAO,MAAA,CAAO,IAAA,CAAK,YAAaA,CAAG,CAC5C,CAQA,QAAA,CAASA,CAAAA,CAAK,CACZ,IAAI/O,CAAAA,CAAQ,IAAA,CAAK,YAAY+O,CAAG,CAAA,CAChC,GAAI/O,CAAAA,GAAU,MAAA,CACZ,OAAO,IAAA,CAAK,IAAA,CAAKA,CAAK,CAAA,CAAE,QAE5B,CAMA,KAAM,CACJ,GAAI,KAAK,IAAA,EAAK,GAAM,EAClB,MAAM,IAAI,KAAA,CAAM,iBAAiB,CAAA,CAEnC,OAAO,KAAK,IAAA,CAAK,CAAC,EAAE,GACtB,CAUA,IAAI+O,CAAAA,CAAKiD,CAAAA,CAAU,CACjB,IAAIC,CAAAA,CAAa,IAAA,CAAK,YAEtB,GADAlD,CAAAA,CAAM,OAAOA,CAAG,CAAA,CACZ,CAAC,MAAA,CAAO,MAAA,CAAOkD,CAAAA,CAAYlD,CAAG,CAAA,CAAG,CACnC,IAAImD,CAAAA,CAAM,IAAA,CAAK,KACXlS,CAAAA,CAAQkS,CAAAA,CAAI,OAChB,OAAAD,CAAAA,CAAWlD,CAAG,CAAA,CAAI/O,CAAAA,CAClBkS,CAAAA,CAAI,KAAK,CAAC,GAAA,CAAKnD,EAAK,QAAA,CAAUiD,CAAQ,CAAC,CAAA,CACvC,IAAA,CAAK,UAAUhS,CAAK,CAAA,CACb,IACT,CACA,OAAO,MACT,CAKA,SAAA,EAAY,CACV,IAAA,CAAK,KAAA,CAAM,CAAA,CAAG,IAAA,CAAK,IAAA,CAAK,MAAA,CAAS,CAAC,CAAA,CAClC,IAAIyH,EAAM,IAAA,CAAK,IAAA,CAAK,KAAI,CACxB,OAAA,OAAO,IAAA,CAAK,WAAA,CAAYA,CAAAA,CAAI,GAAG,EAC/B,IAAA,CAAK,QAAA,CAAS,CAAC,CAAA,CACRA,CAAAA,CAAI,GACb,CASA,QAAA,CAASsH,CAAAA,CAAKiD,CAAAA,CAAU,CACtB,IAAIhS,EAAQ,IAAA,CAAK,WAAA,CAAY+O,CAAG,CAAA,CAChC,GAAIiD,EAAW,IAAA,CAAK,IAAA,CAAKhS,CAAK,CAAA,CAAE,QAAA,CAC9B,MAAM,IAAI,KAAA,CAAM,sDAAA,CACF+O,EAAM,QAAA,CAAW,IAAA,CAAK,KAAK/O,CAAK,CAAA,CAAE,QAAA,CAAW,QAAA,CAAWgS,CAAQ,CAAA,CAEhF,KAAK,IAAA,CAAKhS,CAAK,EAAE,QAAA,CAAWgS,CAAAA,CAC5B,KAAK,SAAA,CAAUhS,CAAK,EACtB,CAEA,QAAA,CAASvM,CAAAA,CAAG,CACV,IAAIye,CAAAA,CAAM,KAAK,IAAA,CACXhW,CAAAA,CAAI,EAAIzI,CAAAA,CACRL,CAAAA,CAAI8I,CAAAA,CAAI,CAAA,CACRiW,CAAAA,CAAU1e,CAAAA,CACVyI,EAAIgW,CAAAA,CAAI,MAAA,GACVC,EAAUD,CAAAA,CAAIhW,CAAC,EAAE,QAAA,CAAWgW,CAAAA,CAAIC,CAAO,CAAA,CAAE,QAAA,CAAWjW,EAAIiW,CAAAA,CACpD/e,CAAAA,CAAI8e,EAAI,MAAA,GACVC,CAAAA,CAAUD,EAAI9e,CAAC,CAAA,CAAE,QAAA,CAAW8e,CAAAA,CAAIC,CAAO,CAAA,CAAE,SAAW/e,CAAAA,CAAI+e,CAAAA,CAAAA,CAEtDA,IAAY1e,CAAAA,GACd,IAAA,CAAK,MAAMA,CAAAA,CAAG0e,CAAO,CAAA,CACrB,IAAA,CAAK,QAAA,CAASA,CAAO,IAG3B,CAEA,SAAA,CAAUnS,EAAO,CAIf,IAAA,IAHIkS,EAAM,IAAA,CAAK,IAAA,CACXF,CAAAA,CAAWE,CAAAA,CAAIlS,CAAK,CAAA,CAAE,SACtBvB,CAAAA,CACGuB,CAAAA,GAAU,IACfvB,CAAAA,CAASuB,CAAAA,EAAS,EACd,EAAAkS,CAAAA,CAAIzT,CAAM,CAAA,CAAE,QAAA,CAAWuT,CAAAA,CAAAA,CAAAA,EAG3B,KAAK,KAAA,CAAMhS,CAAAA,CAAOvB,CAAM,CAAA,CACxBuB,CAAAA,CAAQvB,EAEZ,CAEA,KAAA,CAAMhL,CAAAA,CAAG0d,CAAAA,CAAG,CACV,IAAIe,EAAM,IAAA,CAAK,IAAA,CACXD,EAAa,IAAA,CAAK,WAAA,CAClBG,EAAWF,CAAAA,CAAIze,CAAC,CAAA,CAChB4e,CAAAA,CAAWH,CAAAA,CAAIf,CAAC,EACpBe,CAAAA,CAAIze,CAAC,EAAI4e,CAAAA,CACTH,CAAAA,CAAIf,CAAC,CAAA,CAAIiB,CAAAA,CACTH,CAAAA,CAAWI,CAAAA,CAAS,GAAG,CAAA,CAAI5e,EAC3Bwe,CAAAA,CAAWG,CAAAA,CAAS,GAAG,CAAA,CAAIjB,EAC7B,CACF,CAEAle,CAAAA,CAAO,QAAUmd,EAEjB,CAAA,CAAE,EAAE,CAAA,CAAE,GAAG,CAAC,SAAStc,EAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CAG1C,IAAIsf,CAAAA,CAAoB,KACpBC,CAAAA,CAAa,IAAA,CACbC,EAAiB,GAAA,CAYrB,MAAM7b,CAAM,CACV,WAAA,CAAc,IAAA,CACd,aAAA,CAAgB,KAAA,CAChB,WAAA,CAAc,MAGd,MAAA,CAGA,mBAAA,CAAsB,IAAG,CAAA,CAAA,CAGzB,mBAAA,CAAsB,IAAG,CAAA,CAAA,CAGzB,MAAA,CAAS,EAAC,CAGV,GAAA,CAAM,GAGN,MAAA,CAAS,GAGT,IAAA,CAAO,GAGP,KAAA,CAAQ,EAAC,CAGT,SAAA,CAAY,EAAC,CAGb,YAAc,EAAC,CAGf,WAAa,CAAA,CAGb,UAAA,CAAa,EAEb,OAAA,CAEA,SAAA,CAEA,WAAA,CAAYsC,CAAAA,CAAM,CACZA,CAAAA,GACF,KAAK,WAAA,CAAc,MAAA,CAAO,OAAOA,CAAAA,CAAM,UAAU,EAAIA,CAAAA,CAAK,QAAA,CAAW,IAAA,CACrE,IAAA,CAAK,aAAA,CAAgB,MAAA,CAAO,OAAOA,CAAAA,CAAM,YAAY,EAAIA,CAAAA,CAAK,UAAA,CAAa,MAC3E,IAAA,CAAK,WAAA,CAAc,MAAA,CAAO,MAAA,CAAOA,CAAAA,CAAM,UAAU,EAAIA,CAAAA,CAAK,QAAA,CAAW,OAGnE,IAAA,CAAK,WAAA,GAEP,KAAK,OAAA,CAAU,GAGf,IAAA,CAAK,SAAA,CAAY,EAAC,CAClB,IAAA,CAAK,UAAUsZ,CAAU,CAAA,CAAI,EAAC,EAElC,CAOA,UAAA,EAAa,CACX,OAAO,IAAA,CAAK,WACd,CAKA,YAAA,EAAe,CACb,OAAO,IAAA,CAAK,aACd,CAKA,UAAA,EAAa,CACX,OAAO,IAAA,CAAK,WACd,CAKA,QAAA,CAASle,CAAAA,CAAO,CACd,OAAA,IAAA,CAAK,MAAA,CAASA,EACP,IACT,CAKA,KAAA,EAAQ,CACN,OAAO,IAAA,CAAK,MACd,CAYA,mBAAA,CAAoBoe,EAAY,CAC9B,OAAA,IAAA,CAAK,oBAAsBA,CAAAA,CACvB,OAAOA,CAAAA,EAAe,UAAA,GACxB,IAAA,CAAK,mBAAA,CAAsB,IAAMA,CAAAA,CAAAA,CAG5B,IACT,CAMA,SAAA,EAAY,CACV,OAAO,IAAA,CAAK,UACd,CAOA,KAAA,EAAQ,CACN,OAAO,OAAO,IAAA,CAAK,IAAA,CAAK,MAAM,CAChC,CAMA,SAAU,CACR,IAAIC,CAAAA,CAAO,IAAA,CACX,OAAO,IAAA,CAAK,OAAM,CAAE,MAAA,CAAOhe,GAAK,MAAA,CAAO,IAAA,CAAKge,EAAK,GAAA,CAAIhe,CAAC,CAAC,CAAA,CAAE,MAAA,GAAW,CAAC,CACvE,CAMA,KAAA,EAAQ,CACN,IAAIge,CAAAA,CAAO,KACX,OAAO,IAAA,CAAK,OAAM,CAAE,MAAA,CAAOhe,GAAK,MAAA,CAAO,IAAA,CAAKge,EAAK,IAAA,CAAKhe,CAAC,CAAC,CAAA,CAAE,MAAA,GAAW,CAAC,CACxE,CAMA,QAAA,CAAS6J,EAAIiQ,CAAAA,CAAO,CAClB,IAAImE,CAAAA,CAAO,SAAA,CACPD,EAAO,IAAA,CACX,OAAAnU,CAAAA,CAAG,OAAA,CAAQ,SAAS7J,CAAAA,CAAG,CACjBie,CAAAA,CAAK,MAAA,CAAS,EAChBD,CAAAA,CAAK,OAAA,CAAQhe,EAAG8Z,CAAK,CAAA,CAErBkE,CAAAA,CAAK,OAAA,CAAQhe,CAAC,EAElB,CAAC,CAAA,CACM,IACT,CAQA,OAAA,CAAQA,CAAAA,CAAG8Z,EAAO,CAChB,OAAI,MAAA,CAAO,MAAA,CAAO,IAAA,CAAK,MAAA,CAAQ9Z,CAAC,CAAA,EAC1B,SAAA,CAAU,OAAS,CAAA,GACrB,IAAA,CAAK,OAAOA,CAAC,CAAA,CAAI8Z,CAAAA,CAAAA,CAEZ,IAAA,GAGT,IAAA,CAAK,MAAA,CAAO9Z,CAAC,CAAA,CAAI,SAAA,CAAU,OAAS,CAAA,CAAI8Z,CAAAA,CAAQ,KAAK,mBAAA,CAAoB9Z,CAAC,CAAA,CACtE,IAAA,CAAK,WAAA,GACP,IAAA,CAAK,QAAQA,CAAC,CAAA,CAAI6d,EAClB,IAAA,CAAK,SAAA,CAAU7d,CAAC,CAAA,CAAI,EAAC,CACrB,IAAA,CAAK,SAAA,CAAU6d,CAAU,EAAE7d,CAAC,CAAA,CAAI,MAElC,IAAA,CAAK,GAAA,CAAIA,CAAC,CAAA,CAAI,GACd,IAAA,CAAK,MAAA,CAAOA,CAAC,CAAA,CAAI,GACjB,IAAA,CAAK,IAAA,CAAKA,CAAC,CAAA,CAAI,EAAC,CAChB,IAAA,CAAK,KAAA,CAAMA,CAAC,EAAI,EAAC,CACjB,EAAE,IAAA,CAAK,UAAA,CACA,KACT,CAMA,IAAA,CAAKA,CAAAA,CAAG,CACN,OAAO,IAAA,CAAK,OAAOA,CAAC,CACtB,CAKA,OAAA,CAAQA,CAAAA,CAAG,CACT,OAAO,MAAA,CAAO,MAAA,CAAO,IAAA,CAAK,MAAA,CAAQA,CAAC,CACrC,CAQA,UAAA,CAAWA,EAAG,CACZ,IAAIge,EAAO,IAAA,CACX,GAAI,MAAA,CAAO,MAAA,CAAO,IAAA,CAAK,MAAA,CAAQhe,CAAC,CAAA,CAAG,CACjC,IAAIke,CAAAA,CAAavf,CAAAA,EAAKqf,EAAK,UAAA,CAAWA,CAAAA,CAAK,SAAA,CAAUrf,CAAC,CAAC,CAAA,CACvD,OAAO,IAAA,CAAK,MAAA,CAAOqB,CAAC,CAAA,CAChB,IAAA,CAAK,cACP,IAAA,CAAK,2BAAA,CAA4BA,CAAC,CAAA,CAClC,OAAO,IAAA,CAAK,QAAQA,CAAC,CAAA,CACrB,KAAK,QAAA,CAASA,CAAC,EAAE,OAAA,CAAQ,SAASyI,CAAAA,CAAO,CACvCuV,CAAAA,CAAK,SAAA,CAAUvV,CAAK,EACtB,CAAC,EACD,OAAO,IAAA,CAAK,UAAUzI,CAAC,CAAA,CAAA,CAEzB,OAAO,IAAA,CAAK,IAAA,CAAK,IAAIA,CAAC,CAAC,EAAE,OAAA,CAAQke,CAAU,EAC3C,OAAO,IAAA,CAAK,GAAA,CAAIle,CAAC,CAAA,CACjB,OAAO,KAAK,MAAA,CAAOA,CAAC,EACpB,MAAA,CAAO,IAAA,CAAK,KAAK,IAAA,CAAKA,CAAC,CAAC,CAAA,CAAE,OAAA,CAAQke,CAAU,EAC5C,OAAO,IAAA,CAAK,KAAKle,CAAC,CAAA,CAClB,OAAO,IAAA,CAAK,KAAA,CAAMA,CAAC,CAAA,CACnB,EAAE,IAAA,CAAK,WACT,CACA,OAAO,IACT,CAQA,SAAA,CAAUA,EAAG+J,CAAAA,CAAQ,CACnB,GAAI,CAAC,IAAA,CAAK,YACR,MAAM,IAAI,MAAM,2CAA2C,CAAA,CAG7D,GAAIA,CAAAA,GAAW,MAAA,CACbA,CAAAA,CAAS8T,CAAAA,CAAAA,KACJ,CAEL9T,CAAAA,EAAU,GACV,IAAA,IAASoU,CAAAA,CAAWpU,EAAQoU,CAAAA,GAAa,MAAA,CAAWA,EAAW,IAAA,CAAK,MAAA,CAAOA,CAAQ,CAAA,CACjF,GAAIA,CAAAA,GAAane,EACf,MAAM,IAAI,MAAM,UAAA,CAAa+J,CAAAA,CAAQ,iBAAmB/J,CAAAA,CACpD,uBAAuB,CAAA,CAI/B,IAAA,CAAK,OAAA,CAAQ+J,CAAM,EACrB,CAEA,OAAA,IAAA,CAAK,QAAQ/J,CAAC,CAAA,CACd,KAAK,2BAAA,CAA4BA,CAAC,EAClC,IAAA,CAAK,OAAA,CAAQA,CAAC,CAAA,CAAI+J,CAAAA,CAClB,KAAK,SAAA,CAAUA,CAAM,EAAE/J,CAAC,CAAA,CAAI,IAAA,CACrB,IACT,CAEA,2BAAA,CAA4BA,EAAG,CAC7B,OAAO,KAAK,SAAA,CAAU,IAAA,CAAK,QAAQA,CAAC,CAAC,CAAA,CAAEA,CAAC,EAC1C,CAMA,OAAOA,CAAAA,CAAG,CACR,GAAI,IAAA,CAAK,WAAA,CAAa,CACpB,IAAI+J,CAAAA,CAAS,IAAA,CAAK,OAAA,CAAQ/J,CAAC,CAAA,CAC3B,GAAI+J,CAAAA,GAAW8T,CAAAA,CACb,OAAO9T,CAEX,CACF,CAMA,QAAA,CAAS/J,CAAAA,CAAI6d,CAAAA,CAAY,CACvB,GAAI,IAAA,CAAK,YAAa,CACpB,IAAIzd,EAAW,IAAA,CAAK,SAAA,CAAUJ,CAAC,CAAA,CAC/B,GAAII,CAAAA,CACF,OAAO,MAAA,CAAO,IAAA,CAAKA,CAAQ,CAE/B,CAAA,KAAO,IAAIJ,CAAAA,GAAM6d,CAAAA,CACf,OAAO,IAAA,CAAK,KAAA,EAAM,CACb,GAAI,IAAA,CAAK,OAAA,CAAQ7d,CAAC,CAAA,CACvB,OAAO,EAAC,CAEZ,CAOA,aAAaA,CAAAA,CAAG,CACd,IAAIoe,CAAAA,CAAS,IAAA,CAAK,MAAA,CAAOpe,CAAC,CAAA,CAC1B,GAAIoe,EACF,OAAO,MAAA,CAAO,KAAKA,CAAM,CAE7B,CAOA,UAAA,CAAWpe,CAAAA,CAAG,CACZ,IAAIqe,CAAAA,CAAQ,KAAK,KAAA,CAAMre,CAAC,EACxB,GAAIqe,CAAAA,CACF,OAAO,MAAA,CAAO,IAAA,CAAKA,CAAK,CAE5B,CAOA,SAAA,CAAUre,EAAG,CACX,IAAI6Y,EAAQ,IAAA,CAAK,YAAA,CAAa7Y,CAAC,CAAA,CAC/B,GAAI6Y,CAAAA,CAAO,CACT,IAAMyF,CAAAA,CAAQ,IAAI,GAAA,CAAIzF,CAAK,EAC3B,IAAA,IAAS0F,CAAAA,IAAQ,IAAA,CAAK,UAAA,CAAWve,CAAC,CAAA,CAChCse,EAAM,GAAA,CAAIC,CAAI,EAGhB,OAAO,KAAA,CAAM,KAAKD,CAAAA,CAAM,MAAA,EAAQ,CAClC,CACF,CAEA,OAAOte,CAAAA,CAAG,CACR,IAAIwe,CAAAA,CACJ,OAAI,KAAK,UAAA,EAAW,CAClBA,CAAAA,CAAY,IAAA,CAAK,UAAA,CAAWxe,CAAC,EAE7Bwe,CAAAA,CAAY,IAAA,CAAK,UAAUxe,CAAC,CAAA,CAEvBwe,EAAU,MAAA,GAAW,CAC9B,CAQA,WAAA,CAAYC,CAAAA,CAAQ,CAClB,IAAIC,CAAAA,CAAO,IAAI,KAAK,WAAA,CAAY,CAC9B,SAAU,IAAA,CAAK,WAAA,CACf,UAAA,CAAY,IAAA,CAAK,aAAA,CACjB,QAAA,CAAU,KAAK,WACjB,CAAC,EAEDA,CAAAA,CAAK,QAAA,CAAS,KAAK,KAAA,EAAO,EAE1B,IAAIV,CAAAA,CAAO,KACX,MAAA,CAAO,OAAA,CAAQ,KAAK,MAAM,CAAA,CAAE,QAAQ,SAAS,CAAChe,CAAAA,CAAG8Z,CAAK,CAAA,CAAG,CACnD2E,EAAOze,CAAC,CAAA,EACV0e,EAAK,OAAA,CAAQ1e,CAAAA,CAAG8Z,CAAK,EAEzB,CAAC,CAAA,CAED,MAAA,CAAO,MAAA,CAAO,IAAA,CAAK,SAAS,CAAA,CAAE,OAAA,CAAQ,SAASnb,CAAAA,CAAG,CAC5C+f,EAAK,OAAA,CAAQ/f,CAAAA,CAAE,CAAC,CAAA,EAAK+f,CAAAA,CAAK,OAAA,CAAQ/f,EAAE,CAAC,CAAA,EACvC+f,EAAK,OAAA,CAAQ/f,CAAAA,CAAGqf,EAAK,IAAA,CAAKrf,CAAC,CAAC,EAEhC,CAAC,CAAA,CAED,IAAIse,CAAAA,CAAU,GACd,SAAS0B,CAAAA,CAAW3e,EAAG,CACrB,IAAI+J,CAAAA,CAASiU,CAAAA,CAAK,MAAA,CAAOhe,CAAC,EAC1B,OAAI+J,CAAAA,GAAW,QAAa2U,CAAAA,CAAK,OAAA,CAAQ3U,CAAM,CAAA,EAC7CkT,CAAAA,CAAQjd,CAAC,CAAA,CAAI+J,CAAAA,CACNA,CAAAA,EACEA,KAAUkT,CAAAA,CACZA,CAAAA,CAAQlT,CAAM,CAAA,CAEd4U,CAAAA,CAAW5U,CAAM,CAE5B,CAEA,OAAI,IAAA,CAAK,WAAA,EACP2U,CAAAA,CAAK,OAAM,CAAE,OAAA,CAAQ1e,GAAK0e,CAAAA,CAAK,SAAA,CAAU1e,EAAG2e,CAAAA,CAAW3e,CAAC,CAAC,CAAC,CAAA,CAGrD0e,CACT,CAWA,mBAAA,CAAoBX,EAAY,CAC9B,OAAA,IAAA,CAAK,oBAAsBA,CAAAA,CACvB,OAAOA,CAAAA,EAAe,UAAA,GACxB,IAAA,CAAK,mBAAA,CAAsB,IAAMA,CAAAA,CAAAA,CAG5B,IACT,CAMA,SAAA,EAAY,CACV,OAAO,IAAA,CAAK,UACd,CAMA,KAAA,EAAQ,CACN,OAAO,OAAO,MAAA,CAAO,IAAA,CAAK,SAAS,CACrC,CAQA,QAAQlU,CAAAA,CAAIiQ,CAAAA,CAAO,CACjB,IAAIkE,CAAAA,CAAO,IAAA,CACPC,EAAO,SAAA,CACX,OAAApU,EAAG,MAAA,CAAO,SAAS7J,EAAGsB,CAAAA,CAAG,CACvB,OAAI2c,CAAAA,CAAK,MAAA,CAAS,EAChBD,CAAAA,CAAK,OAAA,CAAQhe,EAAGsB,CAAAA,CAAGwY,CAAK,EAExBkE,CAAAA,CAAK,OAAA,CAAQhe,CAAAA,CAAGsB,CAAC,CAAA,CAEZA,CACT,CAAC,CAAA,CACM,IACT,CAQA,OAAA,EAAU,CACR,IAAItB,CAAAA,CAAGsB,CAAAA,CAAGgI,CAAAA,CAAMwQ,CAAAA,CACZ8E,CAAAA,CAAiB,KAAA,CACjBC,EAAO,SAAA,CAAU,CAAC,EAElB,OAAOA,CAAAA,EAAS,UAAYA,CAAAA,GAAS,IAAA,EAAQ,GAAA,GAAOA,CAAAA,EACtD7e,CAAAA,CAAI6e,CAAAA,CAAK,EACTvd,CAAAA,CAAIud,CAAAA,CAAK,EACTvV,CAAAA,CAAOuV,CAAAA,CAAK,KACR,SAAA,CAAU,MAAA,GAAW,IACvB/E,CAAAA,CAAQ,SAAA,CAAU,CAAC,CAAA,CACnB8E,CAAAA,CAAiB,QAGnB5e,CAAAA,CAAI6e,CAAAA,CACJvd,EAAI,SAAA,CAAU,CAAC,CAAA,CACfgI,CAAAA,CAAO,SAAA,CAAU,CAAC,EACd,SAAA,CAAU,MAAA,CAAS,IACrBwQ,CAAAA,CAAQ,SAAA,CAAU,CAAC,CAAA,CACnB8E,CAAAA,CAAiB,IAAA,CAAA,CAAA,CAIrB5e,CAAAA,CAAI,EAAA,CAAKA,CAAAA,CACTsB,EAAI,EAAA,CAAKA,CAAAA,CACLgI,IAAS,MAAA,GACXA,CAAAA,CAAO,GAAKA,CAAAA,CAAAA,CAGd,IAAI3K,CAAAA,CAAImgB,CAAAA,CAAa,IAAA,CAAK,WAAA,CAAa9e,EAAGsB,CAAAA,CAAGgI,CAAI,EACjD,GAAI,MAAA,CAAO,OAAO,IAAA,CAAK,WAAA,CAAa3K,CAAC,CAAA,CACnC,OAAIigB,CAAAA,GACF,KAAK,WAAA,CAAYjgB,CAAC,EAAImb,CAAAA,CAAAA,CAEjB,IAAA,CAGT,GAAIxQ,CAAAA,GAAS,MAAA,EAAa,CAAC,IAAA,CAAK,aAAA,CAC9B,MAAM,IAAI,KAAA,CAAM,mDAAmD,EAKrE,IAAA,CAAK,OAAA,CAAQtJ,CAAC,CAAA,CACd,IAAA,CAAK,OAAA,CAAQsB,CAAC,CAAA,CAEd,IAAA,CAAK,YAAY3C,CAAC,CAAA,CAAIigB,EAAiB9E,CAAAA,CAAQ,IAAA,CAAK,oBAAoB9Z,CAAAA,CAAGsB,CAAAA,CAAGgI,CAAI,CAAA,CAElF,IAAIyF,CAAAA,CAAUgQ,EAAc,IAAA,CAAK,WAAA,CAAa/e,EAAGsB,CAAAA,CAAGgI,CAAI,EAExD,OAAAtJ,CAAAA,CAAI+O,EAAQ,CAAA,CACZzN,CAAAA,CAAIyN,EAAQ,CAAA,CAEZ,MAAA,CAAO,OAAOA,CAAO,CAAA,CACrB,KAAK,SAAA,CAAUpQ,CAAC,CAAA,CAAIoQ,CAAAA,CACpBiQ,CAAAA,CAAqB,IAAA,CAAK,OAAO1d,CAAC,CAAA,CAAGtB,CAAC,CAAA,CACtCgf,CAAAA,CAAqB,KAAK,KAAA,CAAMhf,CAAC,CAAA,CAAGsB,CAAC,CAAA,CACrC,IAAA,CAAK,IAAIA,CAAC,CAAA,CAAE3C,CAAC,CAAA,CAAIoQ,CAAAA,CACjB,KAAK,IAAA,CAAK/O,CAAC,CAAA,CAAErB,CAAC,CAAA,CAAIoQ,CAAAA,CAClB,KAAK,UAAA,EAAA,CACE,IACT,CAMA,IAAA,CAAK/O,CAAAA,CAAGsB,EAAGgI,CAAAA,CAAM,CACf,IAAI3K,CAAAA,CAAK,SAAA,CAAU,MAAA,GAAW,EAC1BsgB,CAAAA,CAAY,IAAA,CAAK,YAAa,SAAA,CAAU,CAAC,CAAC,CAAA,CAC1CH,CAAAA,CAAa,IAAA,CAAK,WAAA,CAAa9e,CAAAA,CAAGsB,CAAAA,CAAGgI,CAAI,CAAA,CAC7C,OAAO,KAAK,WAAA,CAAY3K,CAAC,CAC3B,CAMA,SAAA,EAAY,CACV,IAAM6C,CAAAA,CAAO,IAAA,CAAK,KAAK,GAAG,SAAS,EACnC,OAAI,OAAOA,GAAS,QAAA,CACX,CAAC,KAAA,CAAOA,CAAI,CAAA,CAGdA,CACT,CAMA,OAAA,CAAQxB,CAAAA,CAAGsB,EAAGgI,CAAAA,CAAM,CAClB,IAAI3K,CAAAA,CAAK,SAAA,CAAU,SAAW,CAAA,CAC1BsgB,CAAAA,CAAY,KAAK,WAAA,CAAa,SAAA,CAAU,CAAC,CAAC,CAAA,CAC1CH,EAAa,IAAA,CAAK,WAAA,CAAa9e,CAAAA,CAAGsB,CAAAA,CAAGgI,CAAI,CAAA,CAC7C,OAAO,MAAA,CAAO,MAAA,CAAO,KAAK,WAAA,CAAa3K,CAAC,CAC1C,CAMA,UAAA,CAAWqB,CAAAA,CAAGsB,CAAAA,CAAGgI,CAAAA,CAAM,CACrB,IAAI3K,CAAAA,CAAK,SAAA,CAAU,SAAW,CAAA,CAC1BsgB,CAAAA,CAAY,KAAK,WAAA,CAAa,SAAA,CAAU,CAAC,CAAC,CAAA,CAC1CH,CAAAA,CAAa,KAAK,WAAA,CAAa9e,CAAAA,CAAGsB,EAAGgI,CAAI,CAAA,CACzC9H,EAAO,IAAA,CAAK,SAAA,CAAU7C,CAAC,CAAA,CAC3B,OAAI6C,CAAAA,GACFxB,EAAIwB,CAAAA,CAAK,CAAA,CACTF,EAAIE,CAAAA,CAAK,CAAA,CACT,OAAO,IAAA,CAAK,WAAA,CAAY7C,CAAC,CAAA,CACzB,OAAO,IAAA,CAAK,UAAUA,CAAC,CAAA,CACvBugB,EAAuB,IAAA,CAAK,MAAA,CAAO5d,CAAC,CAAA,CAAGtB,CAAC,CAAA,CACxCkf,CAAAA,CAAuB,IAAA,CAAK,KAAA,CAAMlf,CAAC,CAAA,CAAGsB,CAAC,EACvC,OAAO,IAAA,CAAK,IAAIA,CAAC,CAAA,CAAE3C,CAAC,CAAA,CACpB,OAAO,IAAA,CAAK,KAAKqB,CAAC,CAAA,CAAErB,CAAC,CAAA,CACrB,IAAA,CAAK,cAEA,IACT,CAOA,QAAQqB,CAAAA,CAAGd,CAAAA,CAAG,CACZ,IAAIiL,CAAAA,CAAM,KAAK,GAAA,CAAInK,CAAC,EACpB,GAAImK,CAAAA,CAAK,CACP,IAAIgV,CAAAA,CAAQ,MAAA,CAAO,OAAOhV,CAAG,CAAA,CAC7B,OAAKjL,CAAAA,CAGEigB,CAAAA,CAAM,OAAO3d,CAAAA,EAAQA,CAAAA,CAAK,CAAA,GAAMtC,CAAC,CAAA,CAF/BigB,CAGX,CACF,CAOA,QAAA,CAASnf,EAAGsB,CAAAA,CAAG,CACb,IAAI8d,CAAAA,CAAO,IAAA,CAAK,IAAA,CAAKpf,CAAC,CAAA,CACtB,GAAIof,EAAM,CACR,IAAID,EAAQ,MAAA,CAAO,MAAA,CAAOC,CAAI,CAAA,CAC9B,OAAK9d,EAGE6d,CAAAA,CAAM,MAAA,CAAO3d,GAAQA,CAAAA,CAAK,CAAA,GAAMF,CAAC,CAAA,CAF/B6d,CAGX,CACF,CAOA,SAAA,CAAUnf,CAAAA,CAAGsB,CAAAA,CAAG,CACd,IAAI+d,EAAU,IAAA,CAAK,OAAA,CAAQrf,EAAGsB,CAAC,CAAA,CAC/B,GAAI+d,CAAAA,CACF,OAAOA,CAAAA,CAAQ,MAAA,CAAO,IAAA,CAAK,QAAA,CAASrf,EAAGsB,CAAC,CAAC,CAE7C,CACF,CAEA,SAAS0d,CAAAA,CAAqBM,CAAAA,CAAKtd,CAAAA,CAAG,CAChCsd,CAAAA,CAAItd,CAAC,EACPsd,CAAAA,CAAItd,CAAC,IAELsd,CAAAA,CAAItd,CAAC,EAAI,EAEb,CAEA,SAASkd,CAAAA,CAAuBI,CAAAA,CAAKtd,EAAG,CACjC,EAAEsd,EAAItd,CAAC,CAAA,EAAK,OAAOsd,CAAAA,CAAItd,CAAC,EAC/B,CAEA,SAAS8c,CAAAA,CAAaS,EAAYC,CAAAA,CAAIC,CAAAA,CAAInW,EAAM,CAC9C,IAAI,EAAI,EAAA,CAAKkW,CAAAA,CACTle,CAAAA,CAAI,EAAA,CAAKme,CAAAA,CACb,GAAI,CAACF,CAAAA,EAAc,CAAA,CAAIje,EAAG,CACxB,IAAIwL,EAAM,CAAA,CACV,CAAA,CAAIxL,CAAAA,CACJA,CAAAA,CAAIwL,EACN,CACA,OAAO,CAAA,CAAIgR,CAAAA,CAAiBxc,EAAIwc,CAAAA,EACpBxU,CAAAA,GAAS,OAAYsU,CAAAA,CAAoBtU,CAAAA,CACvD,CAEA,SAASyV,CAAAA,CAAcQ,CAAAA,CAAYC,EAAIC,CAAAA,CAAInW,CAAAA,CAAM,CAC/C,IAAI,CAAA,CAAI,GAAKkW,CAAAA,CACTle,CAAAA,CAAI,EAAA,CAAKme,CAAAA,CACb,GAAI,CAACF,GAAc,CAAA,CAAIje,CAAAA,CAAG,CACxB,IAAIwL,CAAAA,CAAM,EACV,CAAA,CAAIxL,CAAAA,CACJA,CAAAA,CAAIwL,EACN,CACA,IAAIiC,EAAW,CAAE,CAAA,CAAM,EAAGzN,CAAE,CAAA,CAC5B,OAAIgI,CAAAA,GACFyF,CAAAA,CAAQ,IAAA,CAAOzF,CAAAA,CAAAA,CAEVyF,CACT,CAEA,SAASkQ,CAAAA,CAAYM,CAAAA,CAAYxQ,EAAS,CACxC,OAAO+P,EAAaS,CAAAA,CAAYxQ,CAAAA,CAAQ,EAAGA,CAAAA,CAAQ,CAAA,CAAGA,EAAQ,IAAI,CACpE,CAEAxQ,CAAAA,CAAO,OAAA,CAAU0D,EAEjB,CAAA,CAAE,EAAE,CAAA,CAAE,EAAA,CAAG,CAAC,SAAS7C,CAAAA,CAAQb,CAAAA,CAAOD,EAAQ,CAE1CC,CAAAA,CAAO,QAAU,CACf,KAAA,CAAOa,CAAAA,CAAQ,SAAS,CAAA,CACxB,OAAA,CAASA,EAAQ,WAAW,CAC9B,EAEA,CAAA,CAAE,CAAC,UAAU,EAAA,CAAG,WAAA,CAAY,EAAE,CAAC,CAAA,CAAE,EAAA,CAAG,CAAC,SAASA,CAAAA,CAAQb,EAAOD,CAAAA,CAAQ,CACrE,IAAI2D,CAAAA,CAAQ7C,CAAAA,CAAQ,SAAS,CAAA,CAE7Bb,CAAAA,CAAO,OAAA,CAAU,CACf,KAAA,CAAOmhB,CAAAA,CACP,KAAMC,CACR,CAAA,CAMA,SAASD,CAAAA,CAAMjhB,CAAAA,CAAG,CAChB,IAAImhB,CAAAA,CAAO,CACT,QAAS,CACP,QAAA,CAAUnhB,EAAE,UAAA,EAAW,CACvB,WAAYA,CAAAA,CAAE,YAAA,EAAa,CAC3B,QAAA,CAAUA,CAAAA,CAAE,UAAA,EACd,CAAA,CACA,KAAA,CAAOohB,EAAWphB,CAAC,CAAA,CACnB,MAAOqhB,CAAAA,CAAWrhB,CAAC,CACrB,CAAA,CAEA,OAAIA,CAAAA,CAAE,OAAM,GAAM,MAAA,GAChBmhB,EAAK,KAAA,CAAQ,eAAA,CAAgBnhB,EAAE,KAAA,EAAO,GAEjCmhB,CACT,CAEA,SAASC,CAAAA,CAAWphB,CAAAA,CAAG,CACrB,OAAOA,CAAAA,CAAE,OAAM,CAAE,GAAA,CAAI,SAASuB,CAAAA,CAAG,CAC/B,IAAI+f,EAAYthB,CAAAA,CAAE,IAAA,CAAKuB,CAAC,CAAA,CACpB+J,CAAAA,CAAStL,EAAE,MAAA,CAAOuB,CAAC,CAAA,CACnBK,CAAAA,CAAO,CAAE,CAAA,CAAGL,CAAE,CAAA,CAClB,OAAI+f,IAAc,MAAA,GAChB1f,CAAAA,CAAK,MAAQ0f,CAAAA,CAAAA,CAEXhW,CAAAA,GAAW,MAAA,GACb1J,CAAAA,CAAK,MAAA,CAAS0J,CAAAA,CAAAA,CAET1J,CACT,CAAC,CACH,CAEA,SAASyf,CAAAA,CAAWrhB,EAAG,CACrB,OAAOA,CAAAA,CAAE,KAAA,EAAM,CAAE,GAAA,CAAI,SAASE,CAAAA,CAAG,CAC/B,IAAIqhB,CAAAA,CAAYvhB,CAAAA,CAAE,KAAKE,CAAC,CAAA,CACpB6C,CAAAA,CAAO,CAAE,CAAA,CAAG7C,CAAAA,CAAE,EAAG,CAAA,CAAGA,CAAAA,CAAE,CAAE,CAAA,CAC5B,OAAIA,EAAE,IAAA,GAAS,MAAA,GACb6C,CAAAA,CAAK,IAAA,CAAO7C,CAAAA,CAAE,IAAA,CAAA,CAEZqhB,IAAc,MAAA,GAChBxe,CAAAA,CAAK,MAAQwe,CAAAA,CAAAA,CAERxe,CACT,CAAC,CACH,CAYA,SAASme,CAAAA,CAAKC,CAAAA,CAAM,CAClB,IAAInhB,CAAAA,CAAI,IAAIwD,EAAM2d,CAAAA,CAAK,OAAO,EAAE,QAAA,CAASA,CAAAA,CAAK,KAAK,CAAA,CACnD,OAAAA,EAAK,KAAA,CAAM,OAAA,CAAQ,SAAShe,CAAAA,CAAO,CACjCnD,EAAE,OAAA,CAAQmD,CAAAA,CAAM,CAAA,CAAGA,CAAAA,CAAM,KAAK,CAAA,CAC1BA,EAAM,MAAA,EACRnD,CAAAA,CAAE,UAAUmD,CAAAA,CAAM,CAAA,CAAGA,EAAM,MAAM,EAErC,CAAC,CAAA,CACDge,CAAAA,CAAK,KAAA,CAAM,QAAQ,SAAShe,CAAAA,CAAO,CACjCnD,CAAAA,CAAE,OAAA,CAAQ,CAAE,CAAA,CAAGmD,CAAAA,CAAM,CAAA,CAAG,CAAA,CAAGA,CAAAA,CAAM,CAAA,CAAG,KAAMA,CAAAA,CAAM,IAAK,EAAGA,CAAAA,CAAM,KAAK,EACrE,CAAC,CAAA,CACMnD,CACT,CAEA,CAAA,CAAE,CAAC,UAAU,EAAE,CAAC,EAAE,EAAA,CAAG,CAAC,SAASW,CAAAA,CAAQb,CAAAA,CAAOD,CAAAA,CAAQ,CACtDC,CAAAA,CAAO,OAAA,CAAU,QAEjB,CAAA,CAAE,EAAE,CAAC,CAAA,CAAE,EAAC,CAAE,CAAC,CAAC,CAAC,CAAA,CAAE,CAAC,CAChB,CAAC,EAAA,CAAA,CAAA,KC7xIY0hB,EAAAA,CAAiD,CAC5D,GAAI,SAAA,CACJ,EAAA,CAAI,SACN,CAAA,CAUaC,EAAAA,CAAM,CAIjB,OAAA,CAAc,GAEd,SAAA,CAAc,EAAA,CAEd,UAAc,EAAA,CAEd,IAAA,CAAc,GAEd,KAAA,CAAc,EAAA,CAEd,SAAc,CAAA,CAEd,UAAA,CAAc,GAEd,WAAA,CAAc,CAAA,CAEd,YAAc,EAAA,CAEd,QAAA,CAAc,EAChB,CAAA,CASaC,EAAAA,CAAwC,CACnD,YAAa,CACX,EAAA,CAAI,UAAW,EAAA,CAAI,SACrB,EACA,aAAA,CAAe,CACb,EAAA,CAAI,SAAA,CAAW,EAAA,CAAI,SAAA,CACnB,KAAM,SAAA,CAAW,MAAA,CAAQ,UAAW,KAAA,CAAO,SAC7C,EACA,mBAAA,CAAqB,CACnB,EAAA,CAAI,SAAA,CAAW,EAAA,CAAI,SAAA,CACnB,KAAM,SAAA,CAAW,MAAA,CAAQ,UAAW,KAAA,CAAO,SAC7C,EACA,mBAAA,CAAqB,CACnB,EAAA,CAAI,SAAA,CAAW,EAAA,CAAI,SAAA,CACnB,KAAM,SAAA,CAAW,MAAA,CAAQ,UAAW,KAAA,CAAO,SAC7C,EACA,kBAAA,CAAoB,CAClB,EAAA,CAAI,SAAA,CAAW,EAAA,CAAI,SAAA,CACnB,KAAM,SAAA,CAAW,MAAA,CAAQ,UAAW,KAAA,CAAO,SAC7C,EACA,kBAAA,CAAoB,CAClB,EAAA,CAAI,SAAA,CAAW,EAAA,CAAI,SAAA,CACnB,KAAM,SAAA,CAAW,MAAA,CAAQ,UAAW,KAAA,CAAO,SAC7C,EACA,IAAA,CAAQ,CACN,EAAA,CAAI,SAAA,CAAW,EAAA,CAAI,SAAA,CACnB,KAAM,SAAA,CAAW,MAAA,CAAQ,UAAW,KAAA,CAAO,SAC7C,EACA,YAAA,CAAc,CACZ,GAAI,SAAA,CAAW,EAAA,CAAI,UACnB,IAAA,CAAM,SAAA,CAAW,OAAQ,SAAA,CAAW,KAAA,CAAO,SAC7C,CAAA,CACA,OAAA,CAAW,CACT,EAAA,CAAI,SAAA,CAAW,EAAA,CAAI,UACnB,IAAA,CAAM,SAAA,CAAW,OAAQ,SAAA,CAAW,KAAA,CAAO,SAC7C,CAAA,CACA,cAAA,CAAgB,CACd,EAAA,CAAI,SAAA,CAAW,EAAA,CAAI,UACnB,IAAA,CAAM,SAAA,CAAW,OAAQ,SAAA,CAAW,KAAA,CAAO,SAC7C,CAAA,CACA,aAAA,CAAe,CACb,EAAA,CAAI,SAAA,CAAW,EAAA,CAAI,UACnB,IAAA,CAAM,SAAA,CAAW,OAAQ,SAAA,CAAW,KAAA,CAAO,SAC7C,CAAA,CACA,iBAAA,CAAmB,CACjB,EAAA,CAAI,SAAA,CAAW,EAAA,CAAI,UACnB,IAAA,CAAM,SAAA,CAAW,OAAQ,SAAA,CAAW,KAAA,CAAO,SAC7C,CAAA,CACA,gBAAA,CAAkB,CAChB,EAAA,CAAI,SAAA,CAAW,EAAA,CAAI,UACnB,IAAA,CAAM,SAAA,CAAW,OAAQ,SAAA,CAAW,KAAA,CAAO,SAC7C,CAAA,CACA,UAAA,CAAY,CACV,EAAA,CAAI,SAAA,CAAW,EAAA,CAAI,UACnB,IAAA,CAAM,SAAA,CAAW,OAAQ,SAAA,CAAW,KAAA,CAAO,SAC7C,CACF,EA+CO,SAASC,EAAAA,CAAeC,CAAAA,CAAsC,CACnE,IAAMrhB,CAAAA,CAAIqhB,CAAAA,CAAM,QAAU,EAAC,CACrBC,EAAOD,CAAAA,CAAM,IAAA,GAAS,OAGtBE,CAAAA,CAAcC,CAAAA,EAClBH,EAAM,WAAA,EAAa,IAAA,CAAKxhB,GACtB,KAAA,CAAM,OAAA,CAAQA,EAAE,KAAK,CAAA,CAAIA,CAAAA,CAAE,KAAA,CAAM,QAAA,CAAS2hB,CAAK,EAAI3hB,CAAAA,CAAE,KAAA,GAAU2hB,CACjE,CAAA,EAAG,QAAA,EAAU,WAEf,OAAO,CACL,EAAA,CAAIxhB,CAAAA,CAAE,mBAAmB,CAAA,GAAMshB,EAAO,SAAA,CAAY,SAAA,CAAA,CAClD,GAAIthB,CAAAA,CAAE,mBAAmB,IAAMshB,CAAAA,CAAO,SAAA,CAAY,SAAA,CAAA,CAClD,IAAA,CAASthB,CAAAA,CAAE,6BAA6B,GAAK,MAAA,CAC7C,MAAA,CAASA,EAAE,WAAA,EAAkBuhB,CAAAA,CAAW,SAAS,CAAA,EAAK,MAAA,CACtD,KAAA,CAASA,CAAAA,CAAW,SAAS,CAAA,EAAKvhB,EAAE,6BAA6B,CAAA,EAAK,OACtE,OAAA,CAASA,CAAAA,CAAE,4BAA4B,CAAA,EAAK,MAAA,CAC5C,MAAA,CAASA,CAAAA,CAAE,qBAAqB,CAAA,EAAK,MACvC,CACF,CAiBO,SAASyhB,EAAAA,CAAgBC,CAAAA,CAAcC,EAA8B,CAC1E,IAAMC,CAAAA,CAAc,CAClB,CAAA,sDAAA,EAAyD,kBAAA,CAAmBF,CAAI,CAAC,CAAA,yCAAA,CAAA,CACjF,GAAIC,CAAAA,CACA,CAAC,uGAAuG,CAAA,CACxG,EACN,CAAA,CAIME,CAAAA,CAAc;AAAA;AAAA;AAAA,gEAAA,EAG4CX,GAAI,OAAO,CAAA;AAAA,gEAAA,EACXA,GAAI,SAAS,CAAA;AAAA,mDAAA,EAC1BA,GAAI,SAAS,CAAA;AAAA,+DAAA,EACDA,GAAI,IAAI,CAAA;AAAA,iEAAA,EACNA,GAAI,KAAK,CAAA;AAAA,kEAAA,EACRA,GAAI,QAAQ,CAAA;AAAA,iEAAA,EACbA,GAAI,UAAU,CAAA;AAAA;AAAA,mDAAA,EAE5BA,GAAI,WAAW,CAAA;AAAA,mDAAA,EACfA,GAAI,WAAW,CAAA;AAAA,mDAAA,EACfA,EAAAA,CAAI,QAAQ,CAAA,cAAA,CAAA,CAE/D,OAAO,CACL,SAAA,CACA,CAAA,EAAA,EAAKU,EAAY,IAAA,CAAK;AAAA,EAAA,CAAM,CAAC,CAAA,CAAA,CAC7B,CAAA,uBAAA,EAA0BF,CAAI,CAAA,2BAAA,CAAA,CAC9B,GAAIC,EAAc,CAAC,6FAA6F,CAAA,CAAI,GACpH,CAAA,OAAA,EAAUE,CAAW,GACrB,KAAA,CACA,UACF,EAAE,IAAA,CAAK;AAAA,CAAI,CACb,CASO,SAASC,GACdpN,CAAAA,CACApL,CAAAA,CACAyY,EACAC,CAAAA,CACQ,CAER,IAAMC,CAAAA,CAAO,CACX,CAAA,KAAA,EAAQF,CAAAA,CAAO,EAAE,CAAA,CAAA,CACjB,CAAA,KAAA,EAAQA,EAAO,EAAE,CAAA,CAAA,CACjBA,CAAAA,CAAO,IAAA,CAAU,UAAUA,CAAAA,CAAO,IAAI,GAAK,EAAA,CAC3CA,CAAAA,CAAO,OAAU,CAAA,SAAA,EAAYA,CAAAA,CAAO,MAAM,CAAA,CAAA,CAAK,EAAA,CAC/CA,EAAO,KAAA,CAAU,CAAA,QAAA,EAAWA,EAAO,KAAK,CAAA,CAAA,CAAK,GAC7CA,CAAAA,CAAO,OAAA,CAAU,CAAA,UAAA,EAAaA,CAAAA,CAAO,OAAO,CAAA,CAAA,CAAK,EAAA,CACjDA,EAAO,MAAA,CAAU,CAAA,SAAA,EAAYA,EAAO,MAAM,CAAA,CAAA,CAAK,EACjD,CAAA,CAAE,OAAO,OAAO,CAAA,CAAE,KAAK,GAAG,CAAA,CAI1B,OACE,CAAA,qDAAA,EAAwDrN,CAAK,CAAA,CAAA,EAAIpL,CAAM,YAC7DoL,CAAK,CAAA,UAAA,EAAapL,CAAM,CAAA,SAAA,EAAY2Y,CAAI,GAJpCD,CAAAA,CAAc,EAAA,CAAK,uBAI2B,CAAA,EAAA,CAEhE,CC1RO,SAASE,EAAAA,CAAaC,CAAAA,CAA4B,CACvD,IAAMC,CAAAA,CAAQD,EAAK,KAAA,CAAM;AAAA,CAAI,CAAA,CAAE,GAAA,CAAI3Z,CAAAA,EAAKA,CAAAA,CAAE,IAAA,EAAM,CAAA,CAAE,MAAA,CAAOA,CAAAA,EAAKA,CAAAA,CAAE,MAAA,CAAS,CAAA,EAAK,CAACA,CAAAA,CAAE,UAAA,CAAW,IAAI,CAAC,CAAA,CAEjG,GAAI4Z,CAAAA,CAAM,MAAA,GAAW,CAAA,CACnB,MAAM,IAAI,KAAA,CAAM,uBAAuB,CAAA,CAIzC,IAAMC,CAAAA,CAASD,CAAAA,CAAM,CAAC,CAAA,CAGtB,OAAI,0BAAA,CAA2B,IAAA,CAAKC,CAAM,CAAA,CACjCC,EAAAA,CAAkBF,CAAK,CAAA,CAIzBG,EAAAA,CAAeH,CAAK,CAC7B,CAMA,SAASG,EAAAA,CAAeH,CAAAA,CAA+B,CACrD,IAAMI,CAAAA,CAAcJ,CAAAA,CAAM,CAAC,CAAA,CAAG,KAAA,CAAM,8CAA8C,CAAA,CAClF,GAAI,CAACI,CAAAA,CACH,MAAM,IAAI,KAAA,CAAM,CAAA,yBAAA,EAA4BJ,CAAAA,CAAM,CAAC,CAAC,CAAA,+DAAA,CAAiE,CAAA,CAKvH,IAAMhb,CAAAA,CAAsB,CAC1B,SAAA,CAHgBob,CAAAA,CAAY,CAAC,CAAA,CAAG,WAAA,EAAY,CAI5C,KAAA,CAAO,IAAI,GAAA,CACX,KAAA,CAAO,EAAC,CACR,SAAA,CAAW,EAAC,CACZ,SAAA,CAAW,IAAI,GAAA,CACf,gBAAA,CAAkB,IAAI,GAAA,CACtB,UAAA,CAAY,IAAI,GAClB,CAAA,CAGMC,CAAAA,CAAmC,EAAC,CAE1C,IAAA,IAAS1iB,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIqiB,CAAAA,CAAM,MAAA,CAAQriB,CAAAA,EAAAA,CAAK,CACrC,IAAM2iB,CAAAA,CAAON,CAAAA,CAAMriB,CAAC,CAAA,CAGd4iB,CAAAA,CAAgBD,CAAAA,CAAK,KAAA,CAAM,2BAA2B,CAAA,CAC5D,GAAIC,CAAAA,CAAe,CACjB,IAAMrY,CAAAA,CAAOqY,CAAAA,CAAc,CAAC,EACtBC,CAAAA,CAAWD,CAAAA,CAAc,CAAC,CAAA,CAC1BlH,CAAAA,CAAQoH,EAAAA,CAAgBD,CAAQ,CAAA,CACtCxb,CAAAA,CAAM,SAAA,CAAU,GAAA,CAAIkD,CAAAA,CAAMmR,CAAK,CAAA,CAC/B,QACF,CAGA,IAAMqH,CAAAA,CAAmBJ,CAAAA,CAAK,KAAA,CAAM,6BAA6B,CAAA,CACjE,GAAII,CAAAA,CAAkB,CACpB,IAAMC,CAAAA,CAAUD,CAAAA,CAAiB,CAAC,CAAA,CAAG,KAAA,CAAM,GAAG,CAAA,CAAE,GAAA,CAAIE,CAAAA,EAAKA,CAAAA,CAAE,IAAA,EAAM,CAAA,CAC3DC,CAAAA,CAAYH,CAAAA,CAAiB,CAAC,CAAA,CACpC,IAAA,IAAW9H,CAAAA,IAAM+H,CAAAA,CACf3b,CAAAA,CAAM,gBAAA,CAAiB,GAAA,CAAI4T,CAAAA,CAAIiI,CAAS,CAAA,CAE1C,QACF,CAGA,IAAMC,CAAAA,CAAaR,CAAAA,CAAK,KAAA,CAAM,4BAA4B,CAAA,CAC1D,GAAIQ,CAAAA,CAAY,CACd,IAAMH,CAAAA,CAAUG,CAAAA,CAAW,CAAC,CAAA,CAAG,KAAA,CAAM,GAAG,CAAA,CAAE,GAAA,CAAIF,CAAAA,EAAKA,CAAAA,CAAE,IAAA,EAAM,CAAA,CACrDvH,CAAAA,CAAQoH,EAAAA,CAAgBK,CAAAA,CAAW,CAAC,CAAE,CAAA,CAC5C,IAAA,IAAWlI,CAAAA,IAAM+H,CAAAA,CACf3b,CAAAA,CAAM,UAAA,CAAW,GAAA,CAAI4T,CAAAA,CAAI,CAAE,GAAG5T,CAAAA,CAAM,UAAA,CAAW,GAAA,CAAI4T,CAAE,CAAA,CAAG,GAAGS,CAAM,CAAC,CAAA,CAEpE,QACF,CAGA,IAAM0H,CAAAA,CAAWT,CAAAA,CAAK,KAAA,CAAM,oCAAoC,CAAA,CAChE,GAAIS,CAAAA,EAAYV,CAAAA,CAAc,MAAA,CAAS,CAAA,CAAG,CACxCA,CAAAA,CAAcA,CAAAA,CAAc,MAAA,CAAS,CAAC,CAAA,CAAG,SAAA,CAAYU,CAAAA,CAAS,CAAC,CAAA,CAAG,WAAA,EAAY,CAC9E,QACF,CAGA,IAAMC,CAAAA,CAAgBV,CAAAA,CAAK,KAAA,CAAM,mBAAmB,CAAA,CACpD,GAAIU,CAAAA,CAAe,CACjB,IAAMC,CAAAA,CAAOD,CAAAA,CAAc,CAAC,CAAA,CAAG,IAAA,EAAK,CAG9BE,CAAAA,CAAeD,CAAAA,CAAK,KAAA,CAAM,uBAAuB,CAAA,CACnDrI,CAAAA,CACAra,CAAAA,CACA2iB,CAAAA,EACFtI,CAAAA,CAAKsI,CAAAA,CAAa,CAAC,CAAA,CACnB3iB,CAAAA,CAAQ2iB,CAAAA,CAAa,CAAC,CAAA,GAGtB3iB,CAAAA,CAAQ0iB,CAAAA,CACRrI,CAAAA,CAAKqI,CAAAA,CAAK,OAAA,CAAQ,MAAA,CAAQ,GAAG,CAAA,CAAE,OAAA,CAAQ,QAAA,CAAU,EAAE,CAAA,CAAA,CAErD,IAAM1hB,CAAAA,CAAsB,CAAE,EAAA,CAAAqZ,CAAAA,CAAI,KAAA,CAAAra,CAAAA,CAAO,OAAA,CAAS,EAAC,CAAG,QAAA,CAAU,EAAG,CAAA,CACnE8hB,CAAAA,CAAc,IAAA,CAAK9gB,CAAE,CAAA,CACrB,QACF,CAGA,GAAI+gB,CAAAA,GAAS,KAAA,CAAO,CAClB,IAAMa,CAAAA,CAAYd,CAAAA,CAAc,GAAA,EAAI,CAChCc,CAAAA,GACEd,CAAAA,CAAc,MAAA,CAAS,CAAA,CACzBA,CAAAA,CAAcA,CAAAA,CAAc,MAAA,CAAS,CAAC,CAAA,CAAG,QAAA,CAAS,IAAA,CAAKc,CAAS,CAAA,CAEhEnc,CAAAA,CAAM,SAAA,CAAU,IAAA,CAAKmc,CAAS,CAAA,CAAA,CAGlC,QACF,CAGAC,EAAAA,CAAcd,CAAAA,CAAMtb,CAAAA,CAAOqb,CAAa,EAC1C,CAEA,OAAOrb,CACT,CAiBA,SAASkb,EAAAA,CAAkBF,CAAAA,CAA+B,CACxD,IAAMhb,CAAAA,CAAsB,CAC1B,SAAA,CAAW,IAAA,CACX,KAAA,CAAO,IAAI,GAAA,CACX,KAAA,CAAO,EAAC,CACR,SAAA,CAAW,EAAC,CACZ,SAAA,CAAW,IAAI,GAAA,CACf,gBAAA,CAAkB,IAAI,GAAA,CACtB,UAAA,CAAY,IAAI,GAClB,EAGMqc,CAAAA,CAAoC,EAAC,CAEvCC,CAAAA,CAAa,CAAA,CACbC,CAAAA,CAAW,CAAA,CAEf,IAAA,IAAS5jB,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIqiB,CAAAA,CAAM,MAAA,CAAQriB,CAAAA,EAAAA,CAAK,CACrC,IAAM2iB,CAAAA,CAAON,CAAAA,CAAMriB,CAAC,CAAA,CAGdojB,CAAAA,CAAWT,CAAAA,CAAK,KAAA,CAAM,oCAAoC,CAAA,CAChE,GAAIS,CAAAA,CAAU,CACRM,CAAAA,CAAe,MAAA,CAAS,CAAA,CAC1BA,CAAAA,CAAeA,CAAAA,CAAe,MAAA,CAAS,CAAC,CAAA,CAAG,SAAA,CAAYN,CAAAA,CAAS,CAAC,CAAA,CAAG,WAAA,EAAY,CAEhF/b,CAAAA,CAAM,SAAA,CAAY+b,CAAAA,CAAS,CAAC,CAAA,CAAG,WAAA,EAAY,CAE7C,QACF,CAGA,IAAMS,CAAAA,CAAiBlB,CAAAA,CAAK,KAAA,CAAM,4CAA4C,CAAA,CAC9E,GAAIkB,CAAAA,CAAgB,CAClB,IAAMjjB,CAAAA,CAAQijB,CAAAA,CAAe,CAAC,CAAA,EAAKA,CAAAA,CAAe,CAAC,CAAA,CAE7CjiB,CAAAA,CAAsB,CAAE,EAAA,CADnBiiB,CAAAA,CAAe,CAAC,CAAA,CACO,KAAA,CAAAjjB,CAAAA,CAAO,OAAA,CAAS,EAAC,CAAG,QAAA,CAAU,EAAG,CAAA,CACnE8iB,CAAAA,CAAe,IAAA,CAAK9hB,CAAE,CAAA,CACtB,QACF,CAGA,GAAI+gB,CAAAA,GAAS,GAAA,CAAK,CAChB,IAAMa,CAAAA,CAAYE,CAAAA,CAAe,GAAA,EAAI,CACjCF,CAAAA,GACEE,CAAAA,CAAe,MAAA,CAAS,CAAA,CAC1BA,CAAAA,CAAeA,CAAAA,CAAe,MAAA,CAAS,CAAC,CAAA,CAAG,QAAA,CAAS,IAAA,CAAKF,CAAS,CAAA,CAElEnc,CAAAA,CAAM,SAAA,CAAU,IAAA,CAAKmc,CAAS,CAAA,CAAA,CAGlC,QACF,CAGA,IAAMM,CAAAA,CAAkBnB,CAAAA,CAAK,KAAA,CAAM,qCAAqC,CAAA,CACxE,GAAImB,CAAAA,CAAiB,CACnB,IAAMljB,EAAQkjB,CAAAA,CAAgB,CAAC,CAAA,CACzB7I,CAAAA,CAAK6I,CAAAA,CAAgB,CAAC,CAAA,CAC5BC,EAAAA,CAAkB1c,CAAAA,CAAOqc,CAAAA,CAAgB,CAAE,EAAA,CAAAzI,CAAAA,CAAI,KAAA,CAAAra,CAAAA,CAAO,KAAA,CAAO,SAAU,CAAC,CAAA,CACxE,QACF,CAGA,IAAMojB,CAAAA,CAAkBrB,CAAAA,CAAK,KAAA,CAAM,6DAA6D,CAAA,CAChG,GAAIqB,CAAAA,CAAiB,CACnB,IAAIC,CAAAA,CAAWD,CAAAA,CAAgB,CAAC,CAAA,CAC5BE,CAAAA,CAAWF,CAAAA,CAAgB,CAAC,CAAA,CAC1BxZ,CAAAA,CAAYwZ,CAAAA,CAAgB,CAAC,CAAA,EAAG,IAAA,EAAK,EAAK,MAAA,CAG5CC,CAAAA,GAAa,KAAA,EACfN,CAAAA,EAAAA,CACAM,CAAAA,CAAW,CAAA,MAAA,EAASN,CAAAA,CAAa,CAAA,CAAIA,CAAAA,CAAa,EAAE,CAAA,CAAA,CACpDI,EAAAA,CAAkB1c,CAAAA,CAAOqc,CAAAA,CAAgB,CAAE,EAAA,CAAIO,CAAAA,CAAU,KAAA,CAAO,EAAA,CAAI,KAAA,CAAO,aAAc,CAAC,CAAA,EAE1FE,EAAAA,CAAgB9c,CAAAA,CAAOqc,CAAAA,CAAgBO,CAAQ,CAAA,CAG7CC,CAAAA,GAAa,KAAA,EACfN,CAAAA,EAAAA,CACAM,CAAAA,CAAW,CAAA,IAAA,EAAON,CAAAA,CAAW,CAAA,CAAIA,CAAAA,CAAW,EAAE,CAAA,CAAA,CAC9CG,EAAAA,CAAkB1c,CAAAA,CAAOqc,CAAAA,CAAgB,CAAE,EAAA,CAAIQ,CAAAA,CAAU,KAAA,CAAO,EAAA,CAAI,KAAA,CAAO,WAAY,CAAC,CAAA,EAExFC,EAAAA,CAAgB9c,CAAAA,CAAOqc,CAAAA,CAAgBQ,CAAQ,CAAA,CAGjD7c,CAAAA,CAAM,KAAA,CAAM,IAAA,CAAK,CACf,MAAA,CAAQ4c,CAAAA,CACR,MAAA,CAAQC,CAAAA,CACR,KAAA,CAAO1Z,CAAAA,CACP,KAAA,CAAO,OAAA,CACP,aAAA,CAAe,KAAA,CACf,WAAA,CAAa,IACf,CAAC,CAAA,CACD,QACF,CAGA,IAAM4Z,CAAAA,CAAiBzB,CAAAA,CAAK,KAAA,CAAM,uBAAuB,CAAA,CACzD,GAAIyB,CAAAA,CAAgB,CAClB,IAAMnJ,CAAAA,CAAKmJ,CAAAA,CAAe,CAAC,CAAA,CACrBxjB,CAAAA,CAAQwjB,CAAAA,CAAe,CAAC,CAAA,CAAG,IAAA,EAAK,CACtCL,EAAAA,CAAkB1c,CAAAA,CAAOqc,CAAAA,CAAgB,CAAE,EAAA,CAAAzI,CAAAA,CAAI,KAAA,CAAAra,CAAAA,CAAO,KAAA,CAAO,SAAU,CAAC,CAAA,CACxE,QACF,CACF,CAEA,OAAOyG,CACT,CAGA,SAAS0c,EAAAA,CACP1c,CAAAA,CACAqc,CAAAA,CACApiB,CAAAA,CACM,CAKN,GAJc,CAAC+F,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI/F,CAAAA,CAAK,EAAE,CAAA,EAEpC+F,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI/F,CAAAA,CAAK,EAAA,CAAIA,CAAI,CAAA,CAE3BoiB,CAAAA,CAAe,MAAA,CAAS,CAAA,CAAG,CAC7B,IAAMW,CAAAA,CAAUX,CAAAA,CAAeA,CAAAA,CAAe,MAAA,CAAS,CAAC,CAAA,CACnDW,CAAAA,CAAQ,OAAA,CAAQ,QAAA,CAAS/iB,CAAAA,CAAK,EAAE,CAAA,EACnC+iB,CAAAA,CAAQ,OAAA,CAAQ,IAAA,CAAK/iB,CAAAA,CAAK,EAAE,EAEhC,CACF,CAGA,SAAS6iB,EAAAA,CACP9c,CAAAA,CACAqc,CAAAA,CACAzI,CAAAA,CACM,CACN,GAAI,CAAC5T,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI4T,CAAE,CAAA,CACrB8I,EAAAA,CAAkB1c,CAAAA,CAAOqc,CAAAA,CAAgB,CAAE,EAAA,CAAAzI,CAAAA,CAAI,KAAA,CAAOA,CAAAA,CAAI,KAAA,CAAO,SAAU,CAAC,CAAA,CAAA,KAAA,GAGxEyI,CAAAA,CAAe,MAAA,CAAS,CAAA,CAAG,CAC7B,IAAMW,CAAAA,CAAUX,CAAAA,CAAeA,CAAAA,CAAe,MAAA,CAAS,CAAC,CAAA,CACnDW,CAAAA,CAAQ,OAAA,CAAQ,QAAA,CAASpJ,CAAE,CAAA,EAC9BoJ,CAAAA,CAAQ,OAAA,CAAQ,IAAA,CAAKpJ,CAAE,EAE3B,CAEJ,CAOA,SAAS6H,EAAAA,CAAgBD,CAAAA,CAA0C,CACjE,IAAMnH,EAAgC,EAAC,CACvC,IAAA,IAAW4I,CAAAA,IAAQzB,CAAAA,CAAS,KAAA,CAAM,GAAG,CAAA,CAAG,CACtC,IAAM0B,CAAAA,CAAWD,CAAAA,CAAK,OAAA,CAAQ,GAAG,CAAA,CACjC,GAAIC,CAAAA,CAAW,CAAA,CAAG,CAChB,IAAMjJ,CAAAA,CAAMgJ,CAAAA,CAAK,KAAA,CAAM,CAAA,CAAGC,CAAQ,CAAA,CAAE,IAAA,EAAK,CACnC9I,CAAAA,CAAM6I,CAAAA,CAAK,KAAA,CAAMC,CAAAA,CAAW,CAAC,CAAA,CAAE,IAAA,EAAK,CACtCjJ,CAAAA,EAAOG,CAAAA,GACTC,CAAAA,CAAMJ,CAAG,CAAA,CAAIG,CAAAA,EAEjB,CACF,CACA,OAAOC,CACT,CAoBA,IAAM8I,EAAAA,CAAc,kDAAA,CAMdC,EAAAA,CAA4D,CAEhE,CAAE,KAAA,CAAO,4BAAA,CAA8B,KAAA,CAAO,cAAe,CAAA,CAG7D,CAAE,KAAA,CAAO,wBAAA,CAA8B,KAAA,CAAO,SAAU,CAAA,CACxD,CAAE,KAAA,CAAO,wBAAA,CAA8B,KAAA,CAAO,QAAS,CAAA,CACvD,CAAE,KAAA,CAAO,wBAAA,CAA8B,KAAA,CAAO,YAAa,CAAA,CAC3D,CAAE,KAAA,CAAO,wBAAA,CAA8B,KAAA,CAAO,UAAW,CAAA,CAGzD,CAAE,KAAA,CAAO,wBAAA,CAA8B,KAAA,CAAO,WAAY,CAAA,CAC1D,CAAE,KAAA,CAAO,wBAAA,CAA8B,KAAA,CAAO,eAAgB,CAAA,CAG9D,CAAE,KAAA,CAAO,mBAAA,CAA8B,KAAA,CAAO,YAAa,CAAA,CAG3D,CAAE,KAAA,CAAO,wBAAA,CAA8B,KAAA,CAAO,SAAU,CAAA,CAGxD,CAAE,KAAA,CAAO,oBAAA,CAA8B,KAAA,CAAO,WAAY,CAAA,CAC1D,CAAE,KAAA,CAAO,oBAAA,CAA8B,KAAA,CAAO,SAAU,CAAA,CACxD,CAAE,KAAA,CAAO,oBAAA,CAA8B,KAAA,CAAO,SAAU,CAC1D,CAAA,CAGMC,EAAAA,CAAkB,WAAA,CAGlBC,EAAAA,CAAwB,mBAO9B,SAASlB,EAAAA,CACPd,CAAAA,CACAtb,CAAAA,CACAqb,CAAAA,CACM,CACN,IAAIkC,CAAAA,CAAYjC,CAAAA,CAAK,IAAA,EAAK,CAGpBkC,CAAAA,CAAaC,EAAAA,CAAiBF,CAAAA,CAAWvd,CAAAA,CAAOqb,CAAa,CAAA,CACnE,GAAI,CAACmC,CAAAA,EAAcA,CAAAA,CAAW,GAAA,CAAI,MAAA,GAAW,CAAA,CAAG,OAEhDD,CAAAA,CAAYC,CAAAA,CAAW,SAAA,CAAU,IAAA,EAAK,CACtC,IAAIE,CAAAA,CAAeF,CAAAA,CAAW,GAAA,CAG9B,KAAOD,CAAAA,CAAU,MAAA,CAAS,CAAA,EAAG,CAC3B,IAAMI,CAAAA,CAAaJ,CAAAA,CAAU,KAAA,CAAMJ,EAAW,CAAA,CAC9C,GAAI,CAACQ,CAAAA,CAAY,MAEjB,IAAMC,CAAAA,CAAgB,CAAA,CAAQD,CAAAA,CAAW,CAAC,CAAA,CACpCE,CAAAA,CAAUF,CAAAA,CAAW,CAAC,CAAA,CACtBxa,CAAAA,CAAYwa,CAAAA,CAAW,CAAC,CAAA,EAAG,IAAA,EAAK,EAAK,MAAA,CAC3CJ,CAAAA,CAAYA,CAAAA,CAAU,KAAA,CAAMI,CAAAA,CAAW,CAAC,CAAA,CAAE,MAAM,CAAA,CAAE,IAAA,EAAK,CAEvD,IAAMG,CAAAA,CAAQC,EAAAA,CAAiBF,CAAO,CAAA,CAChCG,CAAAA,CAAcH,CAAAA,CAAQ,QAAA,CAAS,GAAG,CAAA,CAGlCI,CAAAA,CAAYR,EAAAA,CAAiBF,CAAAA,CAAWvd,CAAAA,CAAOqb,CAAa,CAAA,CAClE,GAAI,CAAC4C,CAAAA,EAAaA,CAAAA,CAAU,GAAA,CAAI,MAAA,GAAW,CAAA,CAAG,MAE9CV,CAAAA,CAAYU,CAAAA,CAAU,SAAA,CAAU,IAAA,EAAK,CAGrC,IAAA,IAAWrB,CAAAA,IAAYc,CAAAA,CACrB,IAAA,IAAWb,CAAAA,IAAYoB,CAAAA,CAAU,GAAA,CAC/Bje,CAAAA,CAAM,KAAA,CAAM,IAAA,CAAK,CACf,MAAA,CAAQ4c,CAAAA,CACR,MAAA,CAAQC,CAAAA,CACR,KAAA,CAAO1Z,CAAAA,CACP,KAAA,CAAA2a,CAAAA,CACA,aAAA,CAAAF,CAAAA,CACA,WAAA,CAAAI,CACF,CAAC,CAAA,CAILN,CAAAA,CAAeO,CAAAA,CAAU,IAC3B,CACF,CAWA,SAASR,EAAAA,CACP1C,CAAAA,CACA/a,CAAAA,CACAqb,CAAAA,CAC0B,CAC1B,IAAM6C,CAAAA,CAAQC,EAAAA,CAAYpD,CAAAA,CAAM/a,CAAAA,CAAOqb,CAAa,CAAA,CACpD,GAAI,CAAC6C,CAAAA,CAAO,OAAO,IAAA,CAEnB,IAAME,CAAAA,CAAM,CAACF,CAAAA,CAAM,EAAE,CAAA,CACjBX,CAAAA,CAAYW,CAAAA,CAAM,SAAA,CAAU,IAAA,EAAK,CAGrC,KAAOX,CAAAA,CAAU,UAAA,CAAW,GAAG,CAAA,EAAG,CAChCA,CAAAA,CAAYA,CAAAA,CAAU,KAAA,CAAM,CAAC,CAAA,CAAE,IAAA,EAAK,CACpC,IAAMc,CAAAA,CAAOF,EAAAA,CAAYZ,CAAAA,CAAWvd,CAAAA,CAAOqb,CAAa,CAAA,CACxD,GAAI,CAACgD,CAAAA,CAAM,MACXD,CAAAA,CAAI,IAAA,CAAKC,CAAAA,CAAK,EAAE,CAAA,CAChBd,CAAAA,CAAYc,CAAAA,CAAK,SAAA,CAAU,IAAA,GAC7B,CAEA,OAAO,CAAE,GAAA,CAAAD,CAAAA,CAAK,SAAA,CAAAb,CAAU,CAC1B,CAaA,SAASY,EAAAA,CACPpD,CAAAA,CACA/a,CAAAA,CACAqb,CAAAA,CACqB,CACrB,IAAIzH,CAAAA,CAAoB,IAAA,CACpB2J,CAAAA,CAAoBxC,CAAAA,CAGxB,IAAA,GAAW,CAAE,KAAA,CAAAuD,CAAAA,CAAO,KAAA,CAAAC,CAAM,CAAA,GAAKnB,EAAAA,CAAe,CAC5C,IAAMoB,CAAAA,CAAQzD,CAAAA,CAAK,KAAA,CAAMuD,CAAK,CAAA,CAC9B,GAAIE,CAAAA,CAAO,CACT5K,CAAAA,CAAK4K,CAAAA,CAAM,CAAC,CAAA,CACZ,IAAMjlB,CAAAA,CAAQilB,CAAAA,CAAM,CAAC,CAAA,CACrBC,EAAAA,CAAaze,CAAAA,CAAOqb,CAAAA,CAAe,CAAE,EAAA,CAAAzH,CAAAA,CAAI,KAAA,CAAAra,CAAAA,CAAO,KAAA,CAAAglB,CAAM,CAAC,CAAA,CACvDhB,EAAYxC,CAAAA,CAAK,KAAA,CAAMyD,CAAAA,CAAM,CAAC,CAAA,CAAE,MAAM,CAAA,CACtC,KACF,CACF,CAGA,GAAI5K,CAAAA,GAAO,IAAA,CAAM,CACf,IAAM8K,CAAAA,CAAY3D,CAAAA,CAAK,KAAA,CAAMsC,EAAe,CAAA,CACxCqB,CAAAA,GACF9K,CAAAA,CAAK8K,CAAAA,CAAU,CAAC,CAAA,CACX1e,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI4T,CAAE,CAAA,CAGrB+K,EAAAA,CAAgBtD,CAAAA,CAAezH,CAAE,CAAA,CAFjC6K,EAAAA,CAAaze,CAAAA,CAAOqb,CAAAA,CAAe,CAAE,EAAA,CAAAzH,CAAAA,CAAI,KAAA,CAAOA,CAAAA,CAAI,KAAA,CAAO,WAAY,CAAC,CAAA,CAI1E2J,CAAAA,CAAYxC,CAAAA,CAAK,KAAA,CAAM2D,CAAAA,CAAU,CAAC,CAAA,CAAE,MAAM,CAAA,EAE9C,CAEA,GAAI9K,CAAAA,GAAO,IAAA,CAAM,OAAO,IAAA,CAGxB,IAAMgL,CAAAA,CAAarB,CAAAA,CAAU,KAAA,CAAMD,EAAqB,CAAA,CACxD,OAAIsB,CAAAA,GACF5e,CAAAA,CAAM,gBAAA,CAAiB,GAAA,CAAI4T,CAAAA,CAAIgL,CAAAA,CAAW,CAAC,CAAE,CAAA,CAC7CrB,CAAAA,CAAYA,CAAAA,CAAU,KAAA,CAAMqB,CAAAA,CAAW,CAAC,CAAA,CAAE,MAAM,CAAA,CAAA,CAG3C,CAAE,EAAA,CAAAhL,CAAAA,CAAI,SAAA,CAAA2J,CAAU,CACzB,CAGA,SAASkB,EAAAA,CACPze,CAAAA,CACAqb,CAAAA,CACAphB,CAAAA,CACM,CACQ,CAAC+F,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI/F,CAAAA,CAAK,EAAE,CAAA,EAEpC+F,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI/F,CAAAA,CAAK,EAAA,CAAIA,CAAI,CAAA,CAE/B0kB,EAAAA,CAAgBtD,CAAAA,CAAephB,CAAAA,CAAK,EAAE,EACxC,CAGA,SAAS0kB,EAAAA,CAAgBtD,CAAAA,CAAkCwD,CAAAA,CAAsB,CAC/E,GAAIxD,CAAAA,CAAc,MAAA,CAAS,CAAA,CAAG,CAC5B,IAAM2B,EAAU3B,CAAAA,CAAcA,CAAAA,CAAc,MAAA,CAAS,CAAC,CAAA,CACjD2B,CAAAA,CAAQ,OAAA,CAAQ,QAAA,CAAS6B,CAAM,CAAA,EAClC7B,CAAAA,CAAQ,OAAA,CAAQ,IAAA,CAAK6B,CAAM,EAE/B,CACF,CAGA,SAASd,EAAAA,CAAiBe,CAAAA,CAAuB,CAE/C,OADIA,CAAAA,GAAO,MAAA,EACPA,CAAAA,GAAO,KAAA,CAAc,QAAA,CACrBA,CAAAA,GAAO,KAAA,EACPA,CAAAA,GAAO,KAAA,CAAc,OAAA,CAElB,OACT,CC/gBO,IAAMC,EAAAA,CAAwB,CAAE,CAAA,CAAG,CAAA,CAAG,CAAA,CAAG,CAAE,CAAA,CACrCC,EAAAA,CAAwB,CAAE,CAAA,CAAG,CAAA,CAAG,CAAA,CAAG,CAAE,CAAA,CACrCC,EAAAA,CAAwB,CAAE,CAAA,CAAG,CAAA,CAAG,CAAA,CAAG,CAAE,CAAA,CACrCC,EAAAA,CAAwB,CAAE,CAAA,CAAG,CAAA,CAAG,CAAA,CAAG,CAAE,CAAA,CACrCC,EAAAA,CAAwB,CAAE,CAAA,CAAG,CAAA,CAAG,CAAA,CAAG,CAAE,CAAA,CACrCC,EAAAA,CAAwB,CAAE,CAAA,CAAG,CAAA,CAAG,CAAA,CAAG,CAAE,CAAA,CACrCC,EAAAA,CAAwB,CAAE,CAAA,CAAG,CAAA,CAAG,CAAA,CAAG,CAAE,CAAA,CACrCC,EAAAA,CAAwB,CAAE,CAAA,CAAG,CAAA,CAAG,CAAA,CAAG,CAAE,CAAA,CACrCC,EAAAA,CAAwB,CAAE,CAAA,CAAG,CAAA,CAAG,CAAA,CAAG,CAAE,CAAA,CA2F3C,SAASC,EAAAA,CAAgBzmB,CAAAA,CAAcoI,CAAAA,CAAuB,CACnE,OAAOpI,CAAAA,CAAE,CAAA,GAAMoI,CAAAA,CAAE,CAAA,EAAKpI,CAAAA,CAAE,CAAA,GAAMoI,CAAAA,CAAE,CAClC,CAEO,SAASse,EAAAA,CAAmB1mB,CAAAA,CAAiBoI,CAAAA,CAA0B,CAC5E,OAAOpI,CAAAA,CAAE,CAAA,GAAMoI,CAAAA,CAAE,CAAA,EAAKpI,CAAAA,CAAE,CAAA,GAAMoI,CAAAA,CAAE,CAClC,CAGO,SAASue,EAAAA,CAAmB9mB,CAAAA,CAAc+mB,CAAAA,CAA2B,CAC1E,OAAO,CAAE,CAAA,CAAG/mB,CAAAA,CAAE,CAAA,CAAI+mB,CAAAA,CAAI,CAAA,CAAG,CAAA,CAAG/mB,CAAAA,CAAE,CAAA,CAAI+mB,CAAAA,CAAI,CAAE,CAC1C,CAGO,SAASC,EAAAA,CAAQhnB,CAAAA,CAAsB,CAC5C,OAAO,CAAA,EAAGA,CAAAA,CAAE,CAAC,CAAA,CAAA,EAAIA,CAAAA,CAAE,CAAC,CAAA,CACtB,CAGO,IAAMinB,EAAAA,CAA+B,CAAE,IAAA,CAAM,EAAA,CAAI,MAAA,CAAQ,EAAG,CAAA,CC1I5D,SAASC,EAAAA,CAASlf,CAAAA,CAAWC,CAAAA,CAAmB,CACrD,IAAMkf,CAAAA,CAAiB,EAAC,CACxB,IAAA,IAASpnB,CAAAA,CAAI,CAAA,CAAGA,CAAAA,EAAKiI,CAAAA,CAAGjI,CAAAA,EAAAA,CAAK,CAC3B,IAAMqnB,CAAAA,CAAgB,EAAC,CACvB,IAAA,IAAS3J,CAAAA,CAAI,CAAA,CAAGA,CAAAA,EAAKxV,CAAAA,CAAGwV,CAAAA,EAAAA,CACtB2J,CAAAA,CAAI,IAAA,CAAK,GAAG,CAAA,CAEdD,CAAAA,CAAO,IAAA,CAAKC,CAAG,EACjB,CACA,OAAOD,CACT,CAGO,SAASE,EAAAA,CAAW7Y,CAAAA,CAAwB,CACjD,GAAM,CAAC/G,CAAAA,CAAME,CAAI,CAAA,CAAI2f,EAAAA,CAAc9Y,CAAM,CAAA,CACzC,OAAO0Y,EAAAA,CAASzf,CAAAA,CAAME,CAAI,CAC5B,CAGO,SAAS2f,EAAAA,CAAcH,CAAAA,CAAkC,CAC9D,OAAO,CAACA,CAAAA,CAAO,MAAA,CAAS,CAAA,CAAA,CAAIA,CAAAA,CAAO,CAAC,CAAA,EAAG,MAAA,EAAU,CAAA,EAAK,CAAC,CACzD,CAMO,SAASI,EAAAA,CAAaJ,CAAAA,CAAgBK,CAAAA,CAAcC,CAAAA,CAAsB,CAC/E,GAAM,CAACC,CAAAA,CAAOC,CAAK,CAAA,CAAIL,EAAAA,CAAcH,CAAM,CAAA,CACrCS,CAAAA,CAAU,KAAK,GAAA,CAAIJ,CAAAA,CAAME,CAAK,CAAA,CAC9BG,CAAAA,CAAU,IAAA,CAAK,GAAA,CAAIJ,CAAAA,CAAME,CAAK,CAAA,CAC9BG,CAAAA,CAAQZ,EAAAA,CAASU,CAAAA,CAASC,CAAO,CAAA,CACvC,IAAA,IAAS7f,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAI8f,CAAAA,CAAM,MAAA,CAAQ9f,CAAAA,EAAAA,CAChC,IAAA,IAASC,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAI6f,CAAAA,CAAM,CAAC,CAAA,CAAG,MAAA,CAAQ7f,CAAAA,EAAAA,CAChCD,CAAAA,CAAImf,CAAAA,CAAO,MAAA,EAAUlf,CAAAA,CAAIkf,CAAAA,CAAO,CAAC,CAAA,CAAG,MAAA,GACtCW,CAAAA,CAAM9f,CAAC,CAAA,CAAGC,CAAC,CAAA,CAAIkf,CAAAA,CAAOnf,CAAC,CAAA,CAAGC,CAAC,CAAA,CAAA,CAKjC,OAAAkf,CAAAA,CAAO,MAAA,CAAS,CAAA,CAChBA,CAAAA,CAAO,IAAA,CAAK,GAAGW,CAAK,CAAA,CACbX,CACT,CAOA,IAAMY,EAAAA,CAAiB,IAAI,GAAA,CAAI,CAC7B,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QACxE,CAAC,CAAA,CAEM,SAASC,EAAAA,CAAehoB,CAAAA,CAAoB,CACjD,OAAO+nB,EAAAA,CAAe,GAAA,CAAI/nB,CAAC,CAC7B,CAOA,IAAMioB,EAAAA,CAAuD,CAC3D,QAAA,CAAK,CAAE,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAI,CAAA,CAChG,QAAA,CAAK,CAAE,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,SAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAI,CAAA,CAChG,QAAA,CAAK,CAAE,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAI,CAAA,CAChG,QAAA,CAAK,CAAE,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAI,CAAA,CAChG,QAAA,CAAK,CAAE,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAI,CAAA,CAChG,QAAA,CAAK,CAAE,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAI,CAAA,CAChG,QAAA,CAAK,CAAE,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAI,CAAA,CAChG,QAAA,CAAK,CAAE,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,SAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAI,CAAA,CAChG,QAAA,CAAK,CAAE,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAI,CAAA,CAChG,QAAA,CAAK,CAAE,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAI,CAClG,CAAA,CAEO,SAASC,EAAAA,CAAeC,CAAAA,CAAYC,CAAAA,CAAoB,CAC7D,OAAOH,EAAAA,CAAaE,CAAE,CAAA,GAAIC,CAAE,CAAA,EAAKD,CACnC,CAWO,SAASE,EAAAA,CACdC,CAAAA,CACAnO,CAAAA,CACAoO,CAAAA,CAAAA,GACGC,CAAAA,CACK,CACR,GAAI,CAAC/gB,CAAAA,CAAME,CAAI,CAAA,CAAI2f,EAAAA,CAAcgB,CAAI,CAAA,CACrC,IAAA,IAAWG,CAAAA,IAAWD,CAAAA,CAAU,CAC9B,GAAM,CAACE,CAAAA,CAAIC,CAAE,CAAA,CAAIrB,EAAAA,CAAcmB,CAAO,CAAA,CACtChhB,CAAAA,CAAO,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAMihB,CAAAA,CAAKvO,CAAAA,CAAO,CAAC,CAAA,CACnCxS,CAAAA,CAAO,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAMghB,CAAAA,CAAKxO,CAAAA,CAAO,CAAC,EACrC,CAEA,IAAMyO,CAAAA,CAAS1B,EAAAA,CAASzf,CAAAA,CAAME,CAAI,CAAA,CAGlC,IAAA,IAASK,CAAAA,CAAI,CAAA,CAAGA,CAAAA,EAAKP,CAAAA,CAAMO,CAAAA,EAAAA,CACzB,IAAA,IAASC,CAAAA,CAAI,CAAA,CAAGA,CAAAA,EAAKN,CAAAA,CAAMM,CAAAA,EAAAA,CACrBD,CAAAA,CAAIsgB,CAAAA,CAAK,MAAA,EAAUrgB,CAAAA,CAAIqgB,CAAAA,CAAK,CAAC,CAAA,CAAG,MAAA,GAClCM,CAAAA,CAAO5gB,CAAC,CAAA,CAAGC,CAAC,CAAA,CAAIqgB,CAAAA,CAAKtgB,CAAC,CAAA,CAAGC,CAAC,CAAA,CAAA,CAMhC,IAAA,IAAWwgB,CAAAA,IAAWD,CAAAA,CACpB,IAAA,IAASxgB,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIygB,CAAAA,CAAQ,MAAA,CAAQzgB,CAAAA,EAAAA,CAClC,IAAA,IAASC,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIwgB,CAAAA,CAAQ,CAAC,CAAA,CAAG,MAAA,CAAQxgB,CAAAA,EAAAA,CAAK,CAC3C,IAAMjI,CAAAA,CAAIyoB,CAAAA,CAAQzgB,CAAC,CAAA,CAAGC,CAAC,CAAA,CACvB,GAAIjI,CAAAA,GAAM,GAAA,CAAK,CACb,IAAM6oB,CAAAA,CAAK7gB,CAAAA,CAAImS,CAAAA,CAAO,CAAA,CAChB2O,CAAAA,CAAK7gB,CAAAA,CAAIkS,CAAAA,CAAO,CAAA,CAChBiK,CAAAA,CAAUwE,CAAAA,CAAOC,CAAE,CAAA,CAAGC,CAAE,CAAA,CAC1B,CAACP,CAAAA,EAAYP,EAAAA,CAAehoB,CAAC,CAAA,EAAKgoB,EAAAA,CAAe5D,CAAO,CAAA,CAC1DwE,CAAAA,CAAOC,CAAE,CAAA,CAAGC,CAAE,CAAA,CAAIZ,EAAAA,CAAe9D,CAAAA,CAASpkB,CAAC,CAAA,CAE3C4oB,CAAAA,CAAOC,CAAE,CAAA,CAAGC,CAAE,CAAA,CAAI9oB,EAEtB,CACF,CAIJ,OAAO4oB,CACT,CAOO,SAASG,EAAAA,CAAe5B,CAAAA,CAAwB,CACrD,GAAM,CAAC1f,CAAAA,CAAME,CAAI,CAAA,CAAI2f,EAAAA,CAAcH,CAAM,CAAA,CACnC/E,CAAAA,CAAkB,EAAC,CACzB,IAAA,IAASna,CAAAA,CAAI,CAAA,CAAGA,CAAAA,EAAKN,CAAAA,CAAMM,CAAAA,EAAAA,CAAK,CAC9B,IAAIya,CAAAA,CAAO,EAAA,CACX,IAAA,IAAS1a,CAAAA,CAAI,CAAA,CAAGA,CAAAA,EAAKP,CAAAA,CAAMO,CAAAA,EAAAA,CACzB0a,CAAAA,EAAQyE,CAAAA,CAAOnf,CAAC,CAAA,CAAGC,CAAC,CAAA,CAEtBma,CAAAA,CAAM,IAAA,CAAKM,CAAI,EACjB,CACA,OAAON,EAAM,IAAA,CAAK;AAAA,CAAI,CACxB,CAcA,IAAM4G,GAA4C,CAEhD,QAAA,CAAK,SAAK,QAAA,CAAK,QAAA,CACf,QAAA,CAAK,QAAA,CAAK,SAAK,QAAA,CACf,QAAA,CAAK,SAAK,QAAA,CAAK,QAAA,CAEf,IAAK,GAAA,CAAK,CAAA,CAAK,GAAA,CAEf,QAAA,CAAK,SAAK,QAAA,CAAK,QAAA,CACf,SAAK,QAAA,CAAK,QAAA,CAAK,SAEf,QAAA,CAAK,QAAA,CAAK,QAAA,CAAK,QAAA,CAEf,SAAK,QAAA,CAAK,QAAA,CAAK,QACjB,CAAA,CAUO,SAASC,GAAqB9B,CAAAA,CAAwB,CAE3D,IAAA,IAAWC,CAAAA,IAAOD,EAChBC,CAAAA,CAAI,OAAA,GAIN,IAAA,IAAWA,CAAAA,IAAOD,EAChB,IAAA,IAASlf,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAImf,EAAI,MAAA,CAAQnf,CAAAA,EAAAA,CAAK,CACnC,IAAMyQ,CAAAA,CAAUsQ,GAAkB5B,CAAAA,CAAInf,CAAC,CAAE,CAAA,CACrCyQ,IAAS0O,CAAAA,CAAInf,CAAC,EAAIyQ,CAAAA,EACxB,CAGF,OAAOyO,CACT,CAGO,SAAS+B,EAAAA,CAAS/B,CAAAA,CAAgBjR,EAAqBiM,CAAAA,CAAoB,CAChFoF,GAAaJ,CAAAA,CAAQjR,CAAAA,CAAM,EAAIiM,CAAAA,CAAK,MAAA,CAAQjM,CAAAA,CAAM,CAAC,EACnD,IAAA,IAASnW,CAAAA,CAAI,EAAGA,CAAAA,CAAIoiB,CAAAA,CAAK,OAAQpiB,CAAAA,EAAAA,CAC/BonB,CAAAA,CAAOjR,CAAAA,CAAM,CAAA,CAAInW,CAAC,CAAA,CAAGmW,CAAAA,CAAM,CAAC,CAAA,CAAIiM,CAAAA,CAAKpiB,CAAC,EAE1C,CAMO,SAASopB,EAAAA,CACdhC,EACAiC,CAAAA,CACAC,CAAAA,CACM,CACN,IAAI5hB,CAAAA,CAAO,EACPE,CAAAA,CAAO,CAAA,CACX,QAAWrF,CAAAA,IAAK8mB,CAAAA,CAAY,QAAO,CAAG3hB,CAAAA,EAAQnF,EAC9C,IAAA,IAAWc,CAAAA,IAAKimB,EAAU,MAAA,EAAO,CAAG1hB,CAAAA,EAAQvE,CAAAA,CAC5CmkB,GAAaJ,CAAAA,CAAQ1f,CAAAA,CAAO,EAAGE,CAAAA,CAAO,CAAC,EACzC,CC1NO,SAAS2hB,EAAAA,CAAoBC,CAAAA,CAAsBC,EAAiC,CAEzF,IAAMC,EAAU,IAAI,GAAA,CAChBnd,EAAQ,CAAA,CAEZ,IAAA,GAAW,CAAC0O,CAAAA,CAAI0O,CAAK,CAAA,GAAKH,CAAAA,CAAO,MAAO,CACtC,IAAMI,EAAuB,CAG3B,IAAA,CAAM3O,EAEN,YAAA,CAAc0O,CAAAA,CAAM,MACpB,KAAA,CAAApd,CAAAA,CACA,UAAW,IAAA,CACX,YAAA,CAAc,KACd,OAAA,CAAS,IAAA,CACT,KAAA,CAAO,KAAA,CACP,eAAgB,EAAA,CAChB,UAAA,CAAY2a,EACd,CAAA,CACAwC,CAAAA,CAAQ,IAAIzO,CAAAA,CAAI2O,CAAS,CAAA,CACzBrd,CAAAA,GACF,CAEA,IAAM+Q,CAAAA,CAAQ,CAAC,GAAGoM,CAAAA,CAAQ,QAAQ,CAAA,CAG5BtJ,CAAAA,CAAqB,GAC3B,IAAA,IAAWyJ,CAAAA,IAASL,EAAO,KAAA,CAAO,CAChC,IAAMM,CAAAA,CAAOJ,CAAAA,CAAQ,GAAA,CAAIG,CAAAA,CAAM,MAAM,CAAA,CAC/BE,CAAAA,CAAKL,EAAQ,GAAA,CAAIG,CAAAA,CAAM,MAAM,CAAA,CAC/B,CAACC,CAAAA,EAAQ,CAACC,GAEd3J,CAAAA,CAAM,IAAA,CAAK,CACT,IAAA,CAAA0J,CAAAA,CACA,GAAAC,CAAAA,CACA,IAAA,CAAMF,CAAAA,CAAM,KAAA,EAAS,GACrB,IAAA,CAAM,GACN,SAAA,CAAW,GACX,QAAA,CAAU,CAAE,CAAA,CAAG,CAAA,CAAG,EAAG,CAAE,CAAA,CACvB,OAAQ,CAAE,CAAA,CAAG,EAAG,CAAA,CAAG,CAAE,CACvB,CAAC,EACH,CAGA,IAAM/a,CAAAA,CAA6B,EAAC,CACpC,IAAA,IAAWkb,KAAOR,CAAAA,CAAO,SAAA,CACvBS,EAAAA,CAAgBD,CAAAA,CAAK,KAAMN,CAAAA,CAAS5a,CAAS,EAO/Cob,EAAAA,CAAyBV,CAAAA,CAAO,UAAW1a,CAAAA,CAAW4a,CAAe,CAAA,CAGrE,OAAW,CAACxD,CAAAA,CAAQhD,CAAS,CAAA,GAAKsG,CAAAA,CAAO,iBAAkB,CACzD,IAAMloB,CAAAA,CAAOooB,CAAAA,CAAQ,IAAIxD,CAAM,CAAA,CACzBiE,EAAWX,CAAAA,CAAO,SAAA,CAAU,IAAItG,CAAS,CAAA,CAC3C5hB,GAAQ6oB,CAAAA,GACV7oB,CAAAA,CAAK,eAAiB4hB,CAAAA,CACtB5hB,CAAAA,CAAK,WAAa,CAAE,IAAA,CAAM4hB,EAAW,MAAA,CAAQiH,CAAS,CAAA,EAE1D,CAEA,OAAO,CACL,KAAA,CAAA7M,EACA,KAAA,CAAA8C,CAAAA,CACA,OAAQ+G,EAAAA,CAAS,CAAA,CAAG,CAAC,CAAA,CACrB,KAAM,IAAI,GAAA,CACV,YAAa,IAAI,GAAA,CACjB,UAAW,IAAI,GAAA,CACf,SAAA,CAAArY,CAAAA,CACA,OAAA2a,CAAAA,CACA,OAAA,CAAS,EACT,OAAA,CAAS,CACX,CACF,CAQA,SAASQ,GACPD,CAAAA,CACAhf,CAAAA,CACA0e,EACAU,CAAAA,CACe,CACf,IAAMxoB,CAAAA,CAAoB,CACxB,KAAMooB,CAAAA,CAAI,KAAA,CACV,KAAA,CAAO,GACP,MAAA,CAAAhf,CAAAA,CACA,SAAU,EAAC,CACX,KAAM,CAAA,CAAG,IAAA,CAAM,CAAA,CAAG,IAAA,CAAM,EAAG,IAAA,CAAM,CACnC,EAGA,IAAA,IAAWkb,CAAAA,IAAU8D,EAAI,OAAA,CAAS,CAChC,IAAM1oB,CAAAA,CAAOooB,EAAQ,GAAA,CAAIxD,CAAM,EAC3B5kB,CAAAA,EAAMM,CAAAA,CAAG,MAAM,IAAA,CAAKN,CAAI,EAC9B,CAEA8oB,EAAa,IAAA,CAAKxoB,CAAE,EAGpB,IAAA,IAAWyoB,CAAAA,IAAYL,EAAI,QAAA,CAAU,CACnC,IAAMtgB,CAAAA,CAAQugB,GAAgBI,CAAAA,CAAUzoB,CAAAA,CAAI8nB,EAASU,CAAY,CAAA,CACjExoB,EAAG,QAAA,CAAS,IAAA,CAAK8H,CAAK,CAAA,CAKtB,QAAWG,CAAAA,IAAaH,CAAAA,CAAM,MACvB9H,CAAAA,CAAG,KAAA,CAAM,SAASiI,CAAS,CAAA,EAC9BjI,CAAAA,CAAG,KAAA,CAAM,KAAKiI,CAAS,EAG7B,CAEA,OAAOjI,CACT,CAcA,SAASsoB,EAAAA,CACPI,EACAC,CAAAA,CACAb,CAAAA,CACAF,EACM,CAGN,IAAMgB,EAAQ,IAAI,GAAA,CAClBC,GAAWH,CAAAA,CAAkBC,CAAAA,CAAgBC,CAAK,CAAA,CAMlD,IAAME,CAAAA,CAAY,IAAI,IAItB,SAASC,CAAAA,CAAWX,EAA4B,CAC9C,IAAMY,CAAAA,CAAUJ,CAAAA,CAAM,IAAIR,CAAG,CAAA,CAC7B,GAAKY,CAAAA,CAML,CAAA,IAAA,IAAWlhB,KAASsgB,CAAAA,CAAI,QAAA,CACtBW,CAAAA,CAAWjhB,CAAK,EAIlB,IAAA,IAAWwc,CAAAA,IAAU8D,EAAI,OAAA,CAClBU,CAAAA,CAAU,IAAIxE,CAAM,CAAA,EACvBwE,EAAU,GAAA,CAAIxE,CAAAA,CAAQ0E,CAAO,EAAA,CAGnC,CAEA,QAAWZ,CAAAA,IAAOM,CAAAA,CAChBK,EAAWX,CAAG,CAAA,CAKhB,IAAA,IAAWY,CAAAA,IAAWL,EACpBK,CAAAA,CAAQ,KAAA,CAAQA,EAAQ,KAAA,CAAM,MAAA,CAAOtpB,GAAQ,CAE3C,IAAI4kB,CAAAA,CACJ,IAAA,GAAW,CAACjL,CAAAA,CAAIpb,CAAC,IAAK6pB,CAAAA,CACpB,GAAI7pB,IAAMyB,CAAAA,CAAM,CAAE4kB,CAAAA,CAASjL,CAAAA,CAAI,KAAM,CAEvC,GAAI,CAACiL,CAAAA,CAAQ,OAAO,OAEpB,IAAM2E,CAAAA,CAAQH,EAAU,GAAA,CAAIxE,CAAM,EAClC,OAAK2E,CAAAA,CAGEC,GAAiBF,CAAAA,CAASC,CAAK,EAHnB,IAIrB,CAAC,EAEL,CAGA,SAASC,EAAAA,CAAiBC,CAAAA,CAA0Bvc,EAAgC,CAClF,IAAI6V,EAAgC7V,CAAAA,CACpC,KAAO6V,CAAAA,GAAY,IAAA,EAAM,CACvB,GAAIA,CAAAA,GAAY0G,EAAW,OAAO,KAAA,CAClC1G,EAAUA,CAAAA,CAAQ,OACpB,CACA,OAAO,MACT,CAGA,SAASoG,GACPO,CAAAA,CACAC,CAAAA,CACA5f,EACM,CAIN,IAAM6f,EAAiC,EAAC,CACxC,SAASC,CAAAA,CAAQC,CAAAA,CAA8B,CAC7C,IAAA,IAAWxpB,CAAAA,IAAMwpB,EACfF,CAAAA,CAAY,IAAA,CAAKtpB,CAAE,CAAA,CACnBupB,EAAQvpB,CAAAA,CAAG,QAAQ,EAEvB,CACAupB,CAAAA,CAAQH,CAAI,CAAA,CAEZ,IAAA,IAAShrB,CAAAA,CAAI,CAAA,CAAGA,EAAIkrB,CAAAA,CAAY,MAAA,EAAUlrB,EAAIirB,CAAAA,CAAK,MAAA,CAAQjrB,IACzDqL,CAAAA,CAAO,GAAA,CAAI6f,CAAAA,CAAYlrB,CAAC,EAAIirB,CAAAA,CAAKjrB,CAAC,CAAE,EAExC,CCxOA,IAAMqrB,EAAAA,CAAN,KAAc,CACJ,KAAA,CAAkB,GAE1B,IAAI,MAAA,EAAiB,CACnB,OAAO,IAAA,CAAK,MAAM,MACpB,CAEA,IAAA,CAAKC,CAAAA,CAAoB,CACvB,IAAA,CAAK,KAAA,CAAM,KAAKA,CAAI,CAAA,CACpB,KAAK,QAAA,CAAS,IAAA,CAAK,KAAA,CAAM,MAAA,CAAS,CAAC,EACrC,CAEA,KAA0B,CACxB,GAAI,KAAK,KAAA,CAAM,MAAA,GAAW,CAAA,CAAG,OAC7B,IAAM3hB,CAAAA,CAAM,IAAA,CAAK,MAAM,CAAC,CAAA,CAClBiG,EAAO,IAAA,CAAK,KAAA,CAAM,KAAI,CAC5B,OAAI,KAAK,KAAA,CAAM,MAAA,CAAS,IACtB,IAAA,CAAK,KAAA,CAAM,CAAC,CAAA,CAAIA,CAAAA,CAChB,IAAA,CAAK,QAAA,CAAS,CAAC,CAAA,CAAA,CAEVjG,CACT,CAEQ,QAAA,CAAS3J,CAAAA,CAAiB,CAChC,KAAOA,CAAAA,CAAI,CAAA,EAAG,CACZ,IAAMgL,CAAAA,CAAUhL,CAAAA,CAAI,GAAM,CAAA,CAC1B,GAAI,KAAK,KAAA,CAAMA,CAAC,CAAA,CAAG,QAAA,CAAW,KAAK,KAAA,CAAMgL,CAAM,EAAG,QAAA,CAC/C,CAAC,KAAK,KAAA,CAAMhL,CAAC,EAAG,IAAA,CAAK,KAAA,CAAMgL,CAAM,CAAC,CAAA,CAAI,CAAC,IAAA,CAAK,KAAA,CAAMA,CAAM,CAAA,CAAI,IAAA,CAAK,KAAA,CAAMhL,CAAC,CAAE,CAAA,CAC3EA,CAAAA,CAAIgL,OAEJ,KAEJ,CACF,CAEQ,QAAA,CAAShL,CAAAA,CAAiB,CAChC,IAAMH,EAAI,IAAA,CAAK,KAAA,CAAM,OACrB,OAAa,CACX,IAAI0rB,CAAAA,CAAWvrB,CAAAA,CACTwrB,CAAAA,CAAO,CAAA,CAAIxrB,EAAI,CAAA,CACfyrB,CAAAA,CAAQ,EAAIzrB,CAAAA,CAAI,CAAA,CAOtB,GANIwrB,CAAAA,CAAO3rB,CAAAA,EAAK,IAAA,CAAK,KAAA,CAAM2rB,CAAI,CAAA,CAAG,QAAA,CAAW,KAAK,KAAA,CAAMD,CAAQ,EAAG,QAAA,GACjEA,CAAAA,CAAWC,CAAAA,CAAAA,CAETC,CAAAA,CAAQ5rB,GAAK,IAAA,CAAK,KAAA,CAAM4rB,CAAK,CAAA,CAAG,QAAA,CAAW,KAAK,KAAA,CAAMF,CAAQ,CAAA,CAAG,QAAA,GACnEA,EAAWE,CAAAA,CAAAA,CAETF,CAAAA,GAAavrB,EACd,CAAC,IAAA,CAAK,MAAMA,CAAC,CAAA,CAAG,IAAA,CAAK,KAAA,CAAMurB,CAAQ,CAAC,CAAA,CAAI,CAAC,IAAA,CAAK,KAAA,CAAMA,CAAQ,CAAA,CAAI,IAAA,CAAK,MAAMvrB,CAAC,CAAE,EAC/EA,CAAAA,CAAIurB,CAAAA,CAAAA,UAIR,CACF,CACF,EAUO,SAASG,EAAAA,CAAUtrB,CAAAA,CAAcoI,CAAAA,CAAsB,CAC5D,IAAMmjB,CAAAA,CAAO,KAAK,GAAA,CAAIvrB,CAAAA,CAAE,EAAIoI,CAAAA,CAAE,CAAC,CAAA,CACzBojB,CAAAA,CAAO,KAAK,GAAA,CAAIxrB,CAAAA,CAAE,EAAIoI,CAAAA,CAAE,CAAC,EAC/B,OAAImjB,CAAAA,GAAS,CAAA,EAAKC,CAAAA,GAAS,EAClBD,CAAAA,CAAOC,CAAAA,CAETD,EAAOC,CAAAA,CAAO,CACvB,CAOA,IAAMC,EAAAA,CAAyB,CAC7B,CAAE,CAAA,CAAG,EAAG,CAAA,CAAG,CAAE,EACb,CAAE,CAAA,CAAG,GAAI,CAAA,CAAG,CAAE,CAAA,CACd,CAAE,EAAG,CAAA,CAAG,CAAA,CAAG,CAAE,CAAA,CACb,CAAE,EAAG,CAAA,CAAG,CAAA,CAAG,EAAG,CAChB,EAGA,SAASC,EAAAA,CAAaC,EAA8B9rB,CAAAA,CAAuB,CACzE,OAAIA,CAAAA,CAAE,CAAA,CAAI,CAAA,EAAKA,CAAAA,CAAE,EAAI,CAAA,CAAU,KAAA,CACxB,CAAC8rB,CAAAA,CAAK,GAAA,CAAI9E,GAAQhnB,CAAC,CAAC,CAC7B,CAMO,SAAS+rB,GACdD,CAAAA,CACAjC,CAAAA,CACAC,EACoB,CACpB,IAAMhN,EAAK,IAAIsO,EAAAA,CACftO,CAAAA,CAAG,IAAA,CAAK,CAAE,KAAA,CAAO+M,CAAAA,CAAM,SAAU,CAAE,CAAC,EAEpC,IAAMmC,CAAAA,CAAY,IAAI,GAAA,CACtBA,EAAU,GAAA,CAAIhF,EAAAA,CAAQ6C,CAAI,CAAA,CAAG,CAAC,EAE9B,IAAMoC,CAAAA,CAAW,IAAI,GAAA,CAGrB,IAFAA,CAAAA,CAAS,GAAA,CAAIjF,GAAQ6C,CAAI,CAAA,CAAG,IAAI,CAAA,CAEzB/M,CAAAA,CAAG,MAAA,CAAS,CAAA,EAAG,CACpB,IAAMsH,CAAAA,CAAUtH,EAAG,GAAA,EAAI,CAAG,MAE1B,GAAI8J,EAAAA,CAAgBxC,CAAAA,CAAS0F,CAAE,EAAG,CAEhC,IAAM5Z,EAAoB,EAAC,CACvBlQ,EAAsBokB,CAAAA,CAC1B,KAAOpkB,CAAAA,GAAM,IAAA,EACXkQ,EAAK,OAAA,CAAQlQ,CAAC,EACdA,CAAAA,CAAIisB,CAAAA,CAAS,IAAIjF,EAAAA,CAAQhnB,CAAC,CAAC,CAAA,EAAK,KAElC,OAAOkQ,CACT,CAEA,IAAMgc,CAAAA,CAAcF,EAAU,GAAA,CAAIhF,EAAAA,CAAQ5C,CAAO,CAAC,CAAA,CAElD,QAAW2C,CAAAA,IAAO6E,EAAAA,CAAW,CAC3B,IAAMnG,CAAAA,CAAkB,CAAE,CAAA,CAAGrB,CAAAA,CAAQ,CAAA,CAAI2C,CAAAA,CAAI,EAAG,CAAA,CAAG3C,CAAAA,CAAQ,EAAI2C,CAAAA,CAAI,CAAE,EAGrE,GAAI,CAAC8E,EAAAA,CAAaC,CAAAA,CAAMrG,CAAI,CAAA,EAAK,CAACmB,GAAgBnB,CAAAA,CAAMqE,CAAE,EACxD,SAGF,IAAMqC,CAAAA,CAAUD,CAAAA,CAAc,EACxBE,CAAAA,CAAUpF,EAAAA,CAAQvB,CAAI,CAAA,CACtB4G,CAAAA,CAAeL,EAAU,GAAA,CAAII,CAAO,EAE1C,GAAIC,CAAAA,GAAiB,QAAaF,CAAAA,CAAUE,CAAAA,CAAc,CACxDL,CAAAA,CAAU,GAAA,CAAII,EAASD,CAAO,CAAA,CAC9B,IAAM7N,CAAAA,CAAW6N,EAAUV,EAAAA,CAAUhG,CAAAA,CAAMqE,CAAE,CAAA,CAC7ChN,CAAAA,CAAG,KAAK,CAAE,KAAA,CAAO2I,CAAAA,CAAM,QAAA,CAAAnH,CAAS,CAAC,CAAA,CACjC2N,EAAS,GAAA,CAAIG,CAAAA,CAAShI,CAAO,EAC/B,CACF,CACF,CAEA,OAAO,IACT,CAOO,SAASkI,EAAAA,CAAUpc,CAAAA,CAAgC,CACxD,GAAIA,CAAAA,CAAK,QAAU,CAAA,CAAG,OAAOA,EAE7B,IAAMqc,CAAAA,CAAW,IAAI,GAAA,CACjBC,CAAAA,CAAQtc,EAAK,CAAC,CAAA,CACduc,CAAAA,CAAQvc,CAAAA,CAAK,CAAC,CAAA,CAElB,IAAA,IAASwc,EAAM,CAAA,CAAGA,CAAAA,CAAMxc,EAAK,MAAA,CAAQwc,CAAAA,EAAAA,CAAO,CAC1C,IAAMC,EAAQzc,CAAAA,CAAKwc,CAAG,EAChBE,CAAAA,CAASH,CAAAA,CAAM,EAAID,CAAAA,CAAM,CAAA,CACzBK,CAAAA,CAASJ,CAAAA,CAAM,EAAID,CAAAA,CAAM,CAAA,CACzB3jB,EAAK8jB,CAAAA,CAAM,CAAA,CAAIF,EAAM,CAAA,CACrB3jB,CAAAA,CAAK6jB,CAAAA,CAAM,CAAA,CAAIF,EAAM,CAAA,CAGvBG,CAAAA,GAAW/jB,GAAMgkB,CAAAA,GAAW/jB,CAAAA,EAY9ByjB,EAAS,GAAA,CAAIG,CAAAA,CAAM,CAAC,CAAA,CAGtBF,EAAQC,CAAAA,CACRA,CAAAA,CAAQE,EACV,CAEA,OAAOzc,EAAK,MAAA,CAAO,CAAC4c,CAAAA,CAAG/sB,CAAAA,GAAM,CAACwsB,CAAAA,CAAS,GAAA,CAAIxsB,CAAC,CAAC,CAC/C,CCnMO,SAASgtB,EAAAA,CAAYzP,CAAAA,CAAyB,CACnD,OAAIA,CAAAA,GAAM6I,EAAAA,CAAWC,GACjB9I,CAAAA,GAAM8I,EAAAA,CAAaD,GACnB7I,CAAAA,GAAM+I,EAAAA,CAAaC,GACnBhJ,CAAAA,GAAMgJ,EAAAA,CAAcD,GACpB/I,CAAAA,GAAMiJ,EAAAA,CAAmBG,GACzBpJ,CAAAA,GAAMkJ,EAAAA,CAAkBC,GACxBnJ,CAAAA,GAAMmJ,EAAAA,CAAmBD,EAAAA,CACzBlJ,CAAAA,GAAMoJ,GAAkBH,EAAAA,CACrBI,EACT,CAGO,SAASqG,CAAAA,CAAU7sB,EAAcoI,CAAAA,CAAuB,CAC7D,OAAOpI,CAAAA,CAAE,IAAMoI,CAAAA,CAAE,CAAA,EAAKpI,EAAE,CAAA,GAAMoI,CAAAA,CAAE,CAClC,CAMO,SAAS0kB,EAAAA,CAAmBpD,CAAAA,CAAgCC,EAAyC,CAC1G,OAAID,EAAK,CAAA,GAAMC,CAAAA,CAAG,EACTD,CAAAA,CAAK,CAAA,CAAIC,EAAG,CAAA,CAAI1D,EAAAA,CAAOD,GACrB0D,CAAAA,CAAK,CAAA,GAAMC,EAAG,CAAA,CAChBD,CAAAA,CAAK,EAAIC,CAAAA,CAAG,CAAA,CAAIxD,EAAAA,CAAQD,EAAAA,CACtBwD,EAAK,CAAA,CAAIC,CAAAA,CAAG,EACdD,CAAAA,CAAK,CAAA,CAAIC,EAAG,CAAA,CAAIrD,EAAAA,CAAaF,EAAAA,CAE7BsD,CAAAA,CAAK,EAAIC,CAAAA,CAAG,CAAA,CAAIpD,GAAYF,EAEvC,CAOA,SAAS0G,EAAAA,CAAuBC,CAAAA,CAAsE,CACpG,OAAIA,IAAmB,IAAA,CAAa,CAAC7G,GAAOF,EAAAA,CAAMA,EAAAA,CAAME,EAAK,CAAA,CACtD,CAACF,GAAME,EAAAA,CAAOA,EAAAA,CAAOF,EAAI,CAClC,CASO,SAASgH,EAAAA,CACd5qB,CAAAA,CACA2qB,EAC8C,CAC9C,GAAI3qB,CAAAA,CAAK,IAAA,GAASA,EAAK,EAAA,CAAI,OAAO0qB,GAAuBC,CAAc,CAAA,CAEvE,IAAM7P,CAAAA,CAAI2P,EAAAA,CAAmBzqB,CAAAA,CAAK,IAAA,CAAK,UAAYA,CAAAA,CAAK,EAAA,CAAG,SAAU,CAAA,CAEjE6qB,CAAAA,CACAC,EACAC,CAAAA,CACAC,CAAAA,CAEEC,CAAAA,CAAcN,CAAAA,GAAmB,KAClCH,CAAAA,CAAU1P,CAAAA,CAAG+I,EAAI,CAAA,EAAK2G,CAAAA,CAAU1P,EAAGkJ,EAAS,CAAA,EAAKwG,EAAU1P,CAAAA,CAAGoJ,EAAS,EACvEsG,CAAAA,CAAU1P,CAAAA,CAAG6I,EAAE,CAAA,EAAK6G,CAAAA,CAAU1P,EAAGkJ,EAAS,CAAA,EAAKwG,CAAAA,CAAU1P,CAAAA,CAAGiJ,EAAU,CAAA,CAE3E,OAAIyG,EAAU1P,CAAAA,CAAGmJ,EAAU,EACrB0G,CAAAA,GAAmB,IAAA,EACrBE,CAAAA,CAAejH,EAAAA,CAAMkH,EAAuBjH,EAAAA,CAC5CkH,CAAAA,CAAiBjH,GAAOkH,CAAAA,CAAyBrH,EAAAA,GAEjDkH,EAAe/G,EAAAA,CAAOgH,CAAAA,CAAuBnH,EAAAA,CAC7CoH,CAAAA,CAAiBnH,GAAMoH,CAAAA,CAAyBnH,EAAAA,CAAAA,CAEzC2G,EAAU1P,CAAAA,CAAGiJ,EAAU,EAC5B4G,CAAAA,GAAmB,IAAA,EACrBE,EAAelH,EAAAA,CAAImH,CAAAA,CAAuBjH,GAC1CkH,CAAAA,CAAiBjH,EAAAA,CAAOkH,EAAyBpH,EAAAA,GAEjDiH,CAAAA,CAAe/G,GAAOgH,CAAAA,CAAuBlH,EAAAA,CAC7CmH,CAAAA,CAAiBpH,EAAAA,CAAIqH,EAAyBnH,EAAAA,CAAAA,CAEvC2G,CAAAA,CAAU1P,EAAGoJ,EAAS,CAAA,CAC3ByG,IAAmB,IAAA,EACrBE,CAAAA,CAAejH,EAAAA,CAAMkH,CAAAA,CAAuBlH,GAC5CmH,CAAAA,CAAiBlH,EAAAA,CAAMmH,EAAyBrH,EAAAA,GAEhDkH,CAAAA,CAAehH,GAAMiH,CAAAA,CAAuBnH,EAAAA,CAC5CoH,CAAAA,CAAiBnH,EAAAA,CAAMoH,EAAyBlH,EAAAA,CAAAA,CAEzC0G,CAAAA,CAAU1P,EAAGkJ,EAAS,CAAA,CAC3B2G,IAAmB,IAAA,EACrBE,CAAAA,CAAejH,GAAMkH,CAAAA,CAAuBlH,EAAAA,CAC5CmH,EAAiBlH,EAAAA,CAAMmH,CAAAA,CAAyBpH,KAEhDiH,CAAAA,CAAe/G,EAAAA,CAAOgH,EAAuBhH,EAAAA,CAC7CiH,CAAAA,CAAiBpH,EAAAA,CAAIqH,CAAAA,CAAyBlH,IAEvCmH,CAAAA,CACLN,CAAAA,GAAmB,MAAQH,CAAAA,CAAU1P,CAAAA,CAAG+I,EAAI,CAAA,EAC9CgH,CAAAA,CAAejH,EAAAA,CAAMkH,CAAAA,CAAuBlH,GAC5CmH,CAAAA,CAAiBlH,EAAAA,CAAMmH,EAAyBlH,EAAAA,EACvC6G,CAAAA,GAAmB,MAAQH,CAAAA,CAAU1P,CAAAA,CAAG6I,EAAE,CAAA,EACnDkH,EAAe/G,EAAAA,CAAOgH,CAAAA,CAAuBhH,GAC7CiH,CAAAA,CAAiBpH,EAAAA,CAAIqH,EAAyBpH,EAAAA,GAE9CiH,CAAAA,CAAe/P,EAAGgQ,CAAAA,CAAuBP,EAAAA,CAAYzP,CAAC,CAAA,CACtDiQ,CAAAA,CAAiBjQ,EAAGkQ,CAAAA,CAAyBT,EAAAA,CAAYzP,CAAC,CAAA,CAAA,EAI5D+P,CAAAA,CAAe/P,CAAAA,CAAGgQ,CAAAA,CAAuBP,GAAYzP,CAAC,CAAA,CACtDiQ,EAAiBjQ,CAAAA,CAAGkQ,CAAAA,CAAyBT,GAAYzP,CAAC,CAAA,CAAA,CAGrD,CAAC+P,CAAAA,CAAcC,EAAsBC,CAAAA,CAAgBC,CAAsB,CACpF,CAUO,SAASE,GAActmB,CAAAA,CAAmB5E,CAAAA,CAAuB,CACtE,GAAM,CAAC6qB,CAAAA,CAAcC,CAAAA,CAAsBC,EAAgBC,CAAsB,CAAA,CAC/EJ,GAAwB5qB,CAAAA,CAAM4E,CAAAA,CAAM,MAAA,CAAO,cAAc,EAGrDumB,CAAAA,CAAW7G,EAAAA,CAAmBtkB,EAAK,IAAA,CAAK,SAAA,CAAY6qB,CAAY,CAAA,CAChEO,CAAAA,CAAS9G,EAAAA,CAAmBtkB,CAAAA,CAAK,GAAG,SAAA,CAAY8qB,CAAoB,EACtEO,CAAAA,CAAgB9B,EAAAA,CAAQ3kB,EAAM,IAAA,CAAMumB,CAAAA,CAAUC,CAAM,CAAA,CAExD,GAAIC,CAAAA,GAAkB,IAAA,CAAM,CAE1BrrB,CAAAA,CAAK,QAAA,CAAW+qB,EAChB/qB,CAAAA,CAAK,MAAA,CAASgrB,CAAAA,CACdhrB,CAAAA,CAAK,KAAO,EAAC,CACb,MACF,CACAqrB,CAAAA,CAAgBvB,GAAUuB,CAAa,CAAA,CAGvC,IAAMC,CAAAA,CAAUhH,EAAAA,CAAmBtkB,EAAK,IAAA,CAAK,SAAA,CAAY+qB,CAAc,CAAA,CACjEQ,CAAAA,CAAQjH,GAAmBtkB,CAAAA,CAAK,EAAA,CAAG,SAAA,CAAYgrB,CAAsB,EACvEQ,CAAAA,CAAkBjC,EAAAA,CAAQ3kB,EAAM,IAAA,CAAM0mB,CAAAA,CAASC,CAAK,CAAA,CAExD,GAAIC,CAAAA,GAAoB,IAAA,CAAM,CAE5BxrB,CAAAA,CAAK,QAAA,CAAW6qB,EAChB7qB,CAAAA,CAAK,MAAA,CAAS8qB,EACd9qB,CAAAA,CAAK,IAAA,CAAOqrB,CAAAA,CACZ,MACF,CACAG,CAAAA,CAAkB1B,EAAAA,CAAU0B,CAAe,CAAA,CAGvCH,CAAAA,CAAc,QAAUG,CAAAA,CAAgB,MAAA,EAC1CxrB,EAAK,QAAA,CAAW6qB,CAAAA,CAChB7qB,EAAK,MAAA,CAAS8qB,CAAAA,CACd9qB,EAAK,IAAA,CAAOqrB,CAAAA,GAEZrrB,EAAK,QAAA,CAAW+qB,CAAAA,CAChB/qB,CAAAA,CAAK,MAAA,CAASgrB,EACdhrB,CAAAA,CAAK,IAAA,CAAOwrB,GAEhB,CAOO,SAASC,GAAmB7mB,CAAAA,CAAmB5E,CAAAA,CAAuB,CAC3E,GAAIA,EAAK,IAAA,CAAK,MAAA,GAAW,EAAG,OAE5B,IAAM0rB,EAAW1rB,CAAAA,CAAK,IAAA,CAAK,MAAA,CACvB2rB,CAAAA,CAAW3rB,EAAK,IAAA,CAAK,CAAC,EACtB4rB,CAAAA,CAAsC,CAACD,EAAU3rB,CAAAA,CAAK,IAAA,CAAK,CAAC,CAAE,CAAA,CAC9D6rB,EAAkB,CAAA,CAEtB,IAAA,IAAStuB,EAAI,CAAA,CAAGA,CAAAA,CAAIyC,EAAK,IAAA,CAAK,MAAA,CAAQzC,CAAAA,EAAAA,CAAK,CACzC,IAAMkb,CAAAA,CAAOzY,CAAAA,CAAK,KAAKzC,CAAC,CAAA,CAClB2iB,EAA+B,CAACyL,CAAAA,CAAUlT,CAAI,CAAA,CAC9CqT,EAAYC,EAAAA,CAAmBnnB,CAAAA,CAAOsb,CAAI,CAAA,CAEhD,GAAI4L,GAAaJ,CAAAA,CAAU,CACzBE,CAAAA,CAAc1L,CAAAA,CACd,KACF,CAAA,KAAW4L,CAAAA,CAAYD,IACrBA,CAAAA,CAAkBC,CAAAA,CAClBF,EAAc1L,CAAAA,CAAAA,CAEhByL,CAAAA,CAAWlT,EACb,CAGA,IAAMzT,CAAAA,CAAO,IAAA,CAAK,IAAI4mB,CAAAA,CAAY,CAAC,EAAE,CAAA,CAAGA,CAAAA,CAAY,CAAC,CAAA,CAAE,CAAC,CAAA,CAClD3mB,CAAAA,CAAO,KAAK,GAAA,CAAI2mB,CAAAA,CAAY,CAAC,CAAA,CAAE,CAAA,CAAGA,CAAAA,CAAY,CAAC,EAAE,CAAC,CAAA,CAClDI,EAAUhnB,CAAAA,CAAO,IAAA,CAAK,OAAOC,CAAAA,CAAOD,CAAAA,EAAQ,CAAC,CAAA,CAE7C4c,EAAUhd,CAAAA,CAAM,WAAA,CAAY,IAAIonB,CAAO,CAAA,EAAK,EAClDpnB,CAAAA,CAAM,WAAA,CAAY,IAAIonB,CAAAA,CAAS,IAAA,CAAK,IAAIpK,CAAAA,CAAS8J,CAAAA,CAAW,CAAC,CAAC,CAAA,CAE9D1rB,EAAK,SAAA,CAAY,CAAC4rB,CAAAA,CAAY,CAAC,EAAGA,CAAAA,CAAY,CAAC,CAAC,EAClD,CAGA,SAASG,EAAAA,CAAmBnnB,CAAAA,CAAmBsb,CAAAA,CAAsC,CACnF,IAAI+L,CAAAA,CAAQ,CAAA,CACNC,EAAS,IAAA,CAAK,GAAA,CAAIhM,EAAK,CAAC,CAAA,CAAE,CAAA,CAAGA,CAAAA,CAAK,CAAC,CAAA,CAAE,CAAC,EACtCiM,CAAAA,CAAO,IAAA,CAAK,IAAIjM,CAAAA,CAAK,CAAC,EAAE,CAAA,CAAGA,CAAAA,CAAK,CAAC,CAAA,CAAE,CAAC,EAC1C,IAAA,IAAS1a,CAAAA,CAAI0mB,EAAQ1mB,CAAAA,EAAK2mB,CAAAA,CAAM3mB,CAAAA,EAAAA,CAC9BymB,CAAAA,EAASrnB,EAAM,WAAA,CAAY,GAAA,CAAIY,CAAC,CAAA,EAAK,CAAA,CAEvC,OAAOymB,CACT,CCjNO,SAASG,EAAAA,CAAQvtB,EAAiB+F,CAAAA,CAA2B,CAClE,IAAMynB,CAAAA,CAAKxtB,CAAAA,CAAK,UACVknB,CAAAA,CAAWnhB,CAAAA,CAAM,MAAA,CAAO,QAAA,CAG1B9E,EAAI,CAAA,CACR,IAAA,IAASvC,EAAI,CAAA,CAAGA,CAAAA,CAAI,EAAGA,CAAAA,EAAAA,CACrBuC,CAAAA,EAAK8E,EAAM,WAAA,CAAY,GAAA,CAAIynB,EAAG,CAAA,CAAI9uB,CAAC,GAAK,CAAA,CAG1C,IAAIqD,EAAI,CAAA,CACR,IAAA,IAASrD,CAAAA,CAAI,CAAA,CAAGA,EAAI,CAAA,CAAGA,CAAAA,EAAAA,CACrBqD,GAAKgE,CAAAA,CAAM,SAAA,CAAU,IAAIynB,CAAAA,CAAG,CAAA,CAAI9uB,CAAC,CAAA,EAAK,EAGxC,IAAM8pB,CAAAA,CAAqB,CAAE,CAAA,CAAG,CAAA,CAAG,EAAG,CAAE,CAAA,CAClCC,CAAAA,CAAmB,CAAE,EAAGxnB,CAAAA,CAAG,CAAA,CAAGc,CAAE,CAAA,CAChC0rB,CAAAA,CAAM5H,GAAS,IAAA,CAAK,GAAA,CAAI2C,CAAAA,CAAK,CAAA,CAAGC,EAAG,CAAC,CAAA,CAAG,KAAK,GAAA,CAAID,CAAAA,CAAK,EAAGC,CAAAA,CAAG,CAAC,CAAC,CAAA,CAEnE,GAAKvB,CAAAA,CAUE,CAEL,QAASvgB,CAAAA,CAAI6hB,CAAAA,CAAK,EAAI,CAAA,CAAG7hB,CAAAA,CAAI8hB,CAAAA,CAAG,CAAA,CAAG9hB,IAAK8mB,CAAAA,CAAI9mB,CAAC,EAAG6hB,CAAAA,CAAK,CAAC,EAAI,GAAA,CAC1D,IAAA,IAAS7hB,CAAAA,CAAI6hB,CAAAA,CAAK,EAAI,CAAA,CAAG7hB,CAAAA,CAAI8hB,EAAG,CAAA,CAAG9hB,CAAAA,EAAAA,CAAK8mB,EAAI9mB,CAAC,CAAA,CAAG8hB,EAAG,CAAC,CAAA,CAAI,IACxD,IAAA,IAAS7hB,CAAAA,CAAI4hB,EAAK,CAAA,CAAI,CAAA,CAAG5hB,EAAI6hB,CAAAA,CAAG,CAAA,CAAG7hB,CAAAA,EAAAA,CAAK6mB,CAAAA,CAAIjF,EAAK,CAAC,CAAA,CAAG5hB,CAAC,CAAA,CAAI,GAAA,CAC1D,QAASA,CAAAA,CAAI4hB,CAAAA,CAAK,CAAA,CAAI,CAAA,CAAG5hB,EAAI6hB,CAAAA,CAAG,CAAA,CAAG7hB,IAAK6mB,CAAAA,CAAIhF,CAAAA,CAAG,CAAC,CAAA,CAAG7hB,CAAC,CAAA,CAAI,GAAA,CACxD6mB,EAAIjF,CAAAA,CAAK,CAAC,EAAGA,CAAAA,CAAK,CAAC,EAAI,GAAA,CACvBiF,CAAAA,CAAIhF,EAAG,CAAC,CAAA,CAAGD,EAAK,CAAC,CAAA,CAAI,IACrBiF,CAAAA,CAAIjF,CAAAA,CAAK,CAAC,CAAA,CAAGC,CAAAA,CAAG,CAAC,CAAA,CAAI,IACrBgF,CAAAA,CAAIhF,CAAAA,CAAG,CAAC,CAAA,CAAGA,CAAAA,CAAG,CAAC,CAAA,CAAI,IACrB,CAAA,KApBe,CAEb,QAAS9hB,CAAAA,CAAI6hB,CAAAA,CAAK,EAAI,CAAA,CAAG7hB,CAAAA,CAAI8hB,EAAG,CAAA,CAAG9hB,CAAAA,EAAAA,CAAK8mB,CAAAA,CAAI9mB,CAAC,EAAG6hB,CAAAA,CAAK,CAAC,EAAI,QAAA,CAC1D,IAAA,IAAS7hB,EAAI6hB,CAAAA,CAAK,CAAA,CAAI,EAAG7hB,CAAAA,CAAI8hB,CAAAA,CAAG,EAAG9hB,CAAAA,EAAAA,CAAK8mB,CAAAA,CAAI9mB,CAAC,CAAA,CAAG8hB,CAAAA,CAAG,CAAC,CAAA,CAAI,QAAA,CACxD,IAAA,IAAS7hB,CAAAA,CAAI4hB,EAAK,CAAA,CAAI,CAAA,CAAG5hB,EAAI6hB,CAAAA,CAAG,CAAA,CAAG7hB,IAAK6mB,CAAAA,CAAIjF,CAAAA,CAAK,CAAC,CAAA,CAAG5hB,CAAC,CAAA,CAAI,QAAA,CAC1D,QAASA,CAAAA,CAAI4hB,CAAAA,CAAK,EAAI,CAAA,CAAG5hB,CAAAA,CAAI6hB,CAAAA,CAAG,CAAA,CAAG7hB,IAAK6mB,CAAAA,CAAIhF,CAAAA,CAAG,CAAC,CAAA,CAAG7hB,CAAC,EAAI,QAAA,CACxD6mB,CAAAA,CAAIjF,EAAK,CAAC,CAAA,CAAGA,EAAK,CAAC,CAAA,CAAI,SACvBiF,CAAAA,CAAIhF,CAAAA,CAAG,CAAC,CAAA,CAAGD,CAAAA,CAAK,CAAC,CAAA,CAAI,SACrBiF,CAAAA,CAAIjF,CAAAA,CAAK,CAAC,CAAA,CAAGC,CAAAA,CAAG,CAAC,CAAA,CAAI,QAAA,CACrBgF,CAAAA,CAAIhF,CAAAA,CAAG,CAAC,CAAA,CAAGA,CAAAA,CAAG,CAAC,CAAA,CAAI,SACrB,CAaA,IAAMnpB,CAAAA,CAAQU,CAAAA,CAAK,YAAA,CACb0tB,EAAQlF,CAAAA,CAAK,CAAA,CAAI,KAAK,KAAA,CAAMzmB,CAAAA,CAAI,CAAC,CAAA,CACjC4rB,CAAAA,CAAQnF,EAAK,CAAA,CAAI,IAAA,CAAK,MAAMvnB,CAAAA,CAAI,CAAC,EAAI,IAAA,CAAK,IAAA,CAAK3B,EAAM,MAAA,CAAS,CAAC,CAAA,CAAI,CAAA,CACzE,QAASZ,CAAAA,CAAI,CAAA,CAAGA,EAAIY,CAAAA,CAAM,MAAA,CAAQZ,IAChC+uB,CAAAA,CAAIE,CAAAA,CAAQjvB,CAAC,CAAA,CAAGgvB,CAAK,CAAA,CAAIpuB,CAAAA,CAAMZ,CAAC,CAAA,CAGlC,OAAO+uB,CACT,CAgBO,SAASG,EAAAA,CACdC,CAAAA,CACA3G,EACA4G,CAAAA,CAAkB,CAAA,CACV,CAER,IAAIC,CAAAA,CAAe,EACnB,IAAA,IAAWC,CAAAA,IAAWH,EACpB,IAAA,IAAWxM,CAAAA,IAAQ2M,EACjBD,CAAAA,CAAe,IAAA,CAAK,IAAIA,CAAAA,CAAc1M,CAAAA,CAAK,MAAM,CAAA,CAIrD,IAAM4M,CAAAA,CADaF,CAAAA,CAAe,EAAID,CAAAA,CACR,CAAA,CAG1BI,EAAa,CAAA,CACjB,IAAA,IAAWF,KAAWH,CAAAA,CACpBK,CAAAA,EAAc,IAAA,CAAK,GAAA,CAAIF,EAAQ,MAAA,CAAQ,CAAC,EAE1C,IAAMG,CAAAA,CAAcN,EAAS,MAAA,CAAS,CAAA,CAChCO,CAAAA,CAAYF,CAAAA,CAAaC,EAAc,CAAA,CAGvCE,CAAAA,CAAQnH,EAAW,GAAA,CAAM,QAAA,CACzBoH,EAAQpH,CAAAA,CAAW,GAAA,CAAM,SACzBqH,CAAAA,CAAKrH,CAAAA,CAAW,IAAM,QAAA,CACtBsH,CAAAA,CAAKtH,EAAW,GAAA,CAAM,QAAA,CACtB5Z,EAAK4Z,CAAAA,CAAW,GAAA,CAAM,QAAA,CACtB3Z,CAAAA,CAAK2Z,EAAW,GAAA,CAAM,QAAA,CACtBuH,EAAOvH,CAAAA,CAAW,GAAA,CAAM,SACxBwH,CAAAA,CAAOxH,CAAAA,CAAW,GAAA,CAAM,QAAA,CAExBpB,EAASD,EAAAA,CAASoI,CAAAA,CAAW,EAAGG,CAAAA,CAAY,CAAC,EAGnDtI,CAAAA,CAAO,CAAC,CAAA,CAAG,CAAC,EAAIyI,CAAAA,CAChB,IAAA,IAAS5nB,EAAI,CAAA,CAAGA,CAAAA,CAAIsnB,EAAW,CAAA,CAAGtnB,CAAAA,EAAAA,CAAKmf,CAAAA,CAAOnf,CAAC,EAAG,CAAC,CAAA,CAAI0nB,EACvDvI,CAAAA,CAAOmI,CAAAA,CAAW,CAAC,CAAA,CAAG,CAAC,CAAA,CAAIO,CAAAA,CAG3B1I,EAAO,CAAC,CAAA,CAAGsI,EAAY,CAAC,CAAA,CAAI9gB,EAC5B,IAAA,IAAS3G,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIsnB,EAAW,CAAA,CAAGtnB,CAAAA,EAAAA,CAAKmf,EAAOnf,CAAC,CAAA,CAAGynB,EAAY,CAAC,CAAA,CAAIC,CAAAA,CACnEvI,CAAAA,CAAOmI,EAAW,CAAC,CAAA,CAAGG,EAAY,CAAC,CAAA,CAAI7gB,EAGvC,IAAA,IAAS3G,CAAAA,CAAI,EAAGA,CAAAA,CAAIwnB,CAAAA,CAAY,EAAGxnB,CAAAA,EAAAA,CACjCkf,CAAAA,CAAO,CAAC,CAAA,CAAGlf,CAAC,EAAI0nB,CAAAA,CAChBxI,CAAAA,CAAOmI,CAAAA,CAAW,CAAC,EAAGrnB,CAAC,CAAA,CAAI0nB,EAI7B,IAAIK,CAAAA,CAAM,EACV,IAAA,IAAShN,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIkM,EAAS,MAAA,CAAQlM,CAAAA,EAAAA,CAAK,CACxC,IAAMqM,CAAAA,CAAUH,EAASlM,CAAC,CAAA,CACpBZ,CAAAA,CAAQiN,CAAAA,CAAQ,OAAS,CAAA,CAAIA,CAAAA,CAAU,CAAC,EAAE,CAAA,CAGhD,QAAW3M,CAAAA,IAAQN,CAAAA,CAAO,CACxB,IAAMsM,CAAAA,CAAS,EAAIS,CAAAA,CACnB,IAAA,IAASpvB,EAAI,CAAA,CAAGA,CAAAA,CAAI2iB,EAAK,MAAA,CAAQ3iB,CAAAA,EAAAA,CAC/BonB,CAAAA,CAAOuH,CAAAA,CAAS3uB,CAAC,CAAA,CAAGiwB,CAAG,EAAItN,CAAAA,CAAK3iB,CAAC,EAEnCiwB,CAAAA,GACF,CAGA,GAAIhN,CAAAA,CAAIkM,EAAS,MAAA,CAAS,CAAA,CAAG,CAC3B/H,CAAAA,CAAO,CAAC,EAAG6I,CAAG,CAAA,CAAIF,CAAAA,CAClB,IAAA,IAAS9nB,EAAI,CAAA,CAAGA,CAAAA,CAAIsnB,EAAW,CAAA,CAAGtnB,CAAAA,EAAAA,CAAKmf,EAAOnf,CAAC,CAAA,CAAGgoB,CAAG,CAAA,CAAIN,CAAAA,CACzDvI,EAAOmI,CAAAA,CAAW,CAAC,EAAGU,CAAG,CAAA,CAAID,EAC7BC,CAAAA,GACF,CACF,CAEA,OAAO7I,CACT,CAWO,SAAS8I,GACd9I,CAAAA,CACA0C,CAAAA,CACAC,EACAoG,CAAAA,CACAC,CAAAA,CACA5H,CAAAA,CACgB,CAChB,IAAMxB,CAAAA,CAAMkG,EAAAA,CAAmBpD,EAAMC,CAAE,CAAA,CACjCsG,EAA8B,EAAC,CAG/BC,CAAAA,CAAQ9H,CAAAA,CAAW,IAAM,QAAA,CACzB+H,CAAAA,CAAQ/H,EAAW,GAAA,CAAM,QAAA,CACzBgI,EAAShI,CAAAA,CAAW,IAAA,CAAO,QAAA,CAC3BiI,CAAAA,CAASjI,EAAW,GAAA,CAAM,QAAA,CAEhC,GAAIyE,CAAAA,CAAUjG,CAAAA,CAAKZ,EAAE,CAAA,CACnB,IAAA,IAASle,CAAAA,CAAI4hB,CAAAA,CAAK,EAAIqG,CAAAA,CAAYjoB,CAAAA,EAAK6hB,EAAG,CAAA,CAAIqG,CAAAA,CAAUloB,IACtDmoB,CAAAA,CAAY,IAAA,CAAK,CAAE,CAAA,CAAGvG,EAAK,CAAA,CAAG,CAAA,CAAA5hB,CAAE,CAAC,CAAA,CACjCkf,EAAO0C,CAAAA,CAAK,CAAC,CAAA,CAAG5hB,CAAC,EAAIqoB,CAAAA,CAAAA,KAAAA,GAEdtD,CAAAA,CAAUjG,EAAKX,EAAI,CAAA,CAC5B,QAASne,CAAAA,CAAI4hB,CAAAA,CAAK,EAAIqG,CAAAA,CAAYjoB,CAAAA,EAAK6hB,EAAG,CAAA,CAAIqG,CAAAA,CAAUloB,IACtDmoB,CAAAA,CAAY,IAAA,CAAK,CAAE,CAAA,CAAGvG,CAAAA,CAAK,CAAA,CAAG,CAAA,CAAA5hB,CAAE,CAAC,CAAA,CACjCkf,EAAO0C,CAAAA,CAAK,CAAC,EAAG5hB,CAAC,CAAA,CAAIqoB,CAAAA,CAAAA,KAAAA,GAEdtD,CAAAA,CAAUjG,EAAKV,EAAI,CAAA,CAC5B,QAASre,CAAAA,CAAI6hB,CAAAA,CAAK,EAAIqG,CAAAA,CAAYloB,CAAAA,EAAK8hB,CAAAA,CAAG,CAAA,CAAIqG,EAAUnoB,CAAAA,EAAAA,CACtDooB,CAAAA,CAAY,KAAK,CAAE,CAAA,CAAApoB,EAAG,CAAA,CAAG6hB,CAAAA,CAAK,CAAE,CAAC,CAAA,CACjC1C,EAAOnf,CAAC,CAAA,CAAG6hB,EAAK,CAAC,CAAA,CAAIwG,UAEdrD,CAAAA,CAAUjG,CAAAA,CAAKT,EAAK,CAAA,CAC7B,QAASte,CAAAA,CAAI6hB,CAAAA,CAAK,EAAIqG,CAAAA,CAAYloB,CAAAA,EAAK8hB,EAAG,CAAA,CAAIqG,CAAAA,CAAUnoB,CAAAA,EAAAA,CACtDooB,CAAAA,CAAY,KAAK,CAAE,CAAA,CAAApoB,EAAG,CAAA,CAAG6hB,CAAAA,CAAK,CAAE,CAAC,CAAA,CACjC1C,CAAAA,CAAOnf,CAAC,EAAG6hB,CAAAA,CAAK,CAAC,EAAIwG,CAAAA,CAAAA,KAAAA,GAEdrD,CAAAA,CAAUjG,EAAKP,EAAS,CAAA,CACjC,QAASxe,CAAAA,CAAI6hB,CAAAA,CAAK,EAAG5hB,CAAAA,CAAI4hB,CAAAA,CAAK,EAAIqG,CAAAA,CAAYloB,CAAAA,EAAK8hB,EAAG,CAAA,CAAIqG,CAAAA,EAAYloB,CAAAA,EAAK6hB,CAAAA,CAAG,EAAIqG,CAAAA,CAAUnoB,CAAAA,EAAAA,CAAKC,IAC/FmoB,CAAAA,CAAY,IAAA,CAAK,CAAE,CAAA,CAAApoB,CAAAA,CAAG,CAAA,CAAAC,CAAE,CAAC,CAAA,CACzBkf,CAAAA,CAAOnf,CAAC,CAAA,CAAGC,CAAC,EAAIsoB,CAAAA,CAAAA,KAAAA,GAETvD,CAAAA,CAAUjG,CAAAA,CAAKR,EAAU,EAClC,IAAA,IAASve,CAAAA,CAAI6hB,EAAK,CAAA,CAAG5hB,CAAAA,CAAI4hB,EAAK,CAAA,CAAIqG,CAAAA,CAAYloB,CAAAA,EAAK8hB,CAAAA,CAAG,EAAIqG,CAAAA,EAAYloB,CAAAA,EAAK6hB,EAAG,CAAA,CAAIqG,CAAAA,CAAUnoB,IAAKC,CAAAA,EAAAA,CAC/FmoB,CAAAA,CAAY,IAAA,CAAK,CAAE,EAAApoB,CAAAA,CAAG,CAAA,CAAAC,CAAE,CAAC,CAAA,CACzBkf,EAAOnf,CAAC,CAAA,CAAGC,CAAC,CAAA,CAAIuoB,UAETxD,CAAAA,CAAUjG,CAAAA,CAAKL,EAAS,CAAA,CACjC,IAAA,IAAS1e,EAAI6hB,CAAAA,CAAK,CAAA,CAAG5hB,CAAAA,CAAI4hB,CAAAA,CAAK,EAAIqG,CAAAA,CAAYloB,CAAAA,EAAK8hB,EAAG,CAAA,CAAIqG,CAAAA,EAAYloB,GAAK6hB,CAAAA,CAAG,CAAA,CAAIqG,EAAUnoB,CAAAA,EAAAA,CAAKC,CAAAA,EAAAA,CAC/FmoB,EAAY,IAAA,CAAK,CAAE,EAAApoB,CAAAA,CAAG,CAAA,CAAAC,CAAE,CAAC,CAAA,CACzBkf,CAAAA,CAAOnf,CAAC,EAAGC,CAAC,CAAA,CAAIuoB,UAETxD,CAAAA,CAAUjG,CAAAA,CAAKN,EAAU,CAAA,CAClC,IAAA,IAASze,CAAAA,CAAI6hB,CAAAA,CAAK,EAAG5hB,CAAAA,CAAI4hB,CAAAA,CAAK,EAAIqG,CAAAA,CAAYloB,CAAAA,EAAK8hB,EAAG,CAAA,CAAIqG,CAAAA,EAAYloB,CAAAA,EAAK6hB,CAAAA,CAAG,EAAIqG,CAAAA,CAAUnoB,CAAAA,EAAAA,CAAKC,IAC/FmoB,CAAAA,CAAY,IAAA,CAAK,CAAE,CAAA,CAAApoB,CAAAA,CAAG,EAAAC,CAAE,CAAC,EACzBkf,CAAAA,CAAOnf,CAAC,EAAGC,CAAC,CAAA,CAAIsoB,EAIpB,OAAOH,CACT,CAWO,SAASK,GACdrpB,CAAAA,CACA5E,CAAAA,CAC0C,CAC1C,GAAIA,CAAAA,CAAK,KAAK,MAAA,GAAW,CAAA,CAAG,CAC1B,IAAMkuB,EAAQrJ,EAAAA,CAAWjgB,CAAAA,CAAM,MAAM,CAAA,CACrC,OAAO,CAACspB,CAAAA,CAAOA,CAAAA,CAAOA,CAAAA,CAAOA,CAAAA,CAAOA,CAAK,CAC3C,CAEA,IAAMC,CAAAA,CAAcC,EAAAA,CAAexpB,EAAO5E,CAAI,CAAA,CACxC,CAACquB,CAAAA,CAAYC,CAAAA,CAAYC,CAAQ,CAAA,CAAIC,EAAAA,CAAS5pB,EAAO5E,CAAAA,CAAK,IAAI,EAC9DyuB,CAAAA,CAAiBC,EAAAA,CAAa9pB,CAAAA,CAAO5E,CAAAA,CAAK,KAAMsuB,CAAAA,CAAW,CAAC,CAAE,CAAA,CAC9DK,CAAAA,CAAkBC,GACtBhqB,CAAAA,CACA0pB,CAAAA,CAAWA,CAAAA,CAAW,MAAA,CAAS,CAAC,CAAA,CAChCC,CAAAA,CAASA,EAAS,MAAA,CAAS,CAAC,CAC9B,CAAA,CACMM,CAAAA,CAAgBC,EAAAA,CAAYlqB,CAAAA,CAAO5E,EAAK,IAAI,CAAA,CAElD,OAAO,CAACquB,CAAAA,CAAYI,EAAgBE,CAAAA,CAAiBE,CAAAA,CAAeV,CAAW,CACjF,CAMA,SAASK,EAAAA,CACP5pB,CAAAA,CACA8I,EACyC,CACzC,IAAMiX,EAASE,EAAAA,CAAWjgB,CAAAA,CAAM,MAAM,CAAA,CAClCmqB,EAAgBrhB,CAAAA,CAAK,CAAC,EACpB4gB,CAAAA,CAA+B,GAC/BC,CAAAA,CAAwB,EAAC,CAE/B,IAAA,IAAShxB,EAAI,CAAA,CAAGA,CAAAA,CAAImQ,EAAK,MAAA,CAAQnQ,CAAAA,EAAAA,CAAK,CACpC,IAAMyxB,CAAAA,CAAYthB,CAAAA,CAAKnQ,CAAC,EAClB0xB,CAAAA,CAASC,EAAAA,CAAmBtqB,EAAOmqB,CAAa,CAAA,CAChDI,EAASD,EAAAA,CAAmBtqB,CAAAA,CAAOoqB,CAAS,CAAA,CAElD,GAAI3K,GAAmB4K,CAAAA,CAAQE,CAAM,EAAG,CACtCJ,CAAAA,CAAgBC,EAChB,QACF,CAEA,IAAMzK,CAAAA,CAAMkG,GAAmBsE,CAAAA,CAAeC,CAAS,EACjDI,CAAAA,CAAU3B,EAAAA,CAAS9I,EAAQsK,CAAAA,CAAQE,CAAAA,CAAQ,CAAA,CAAG,EAAA,CAAIvqB,EAAM,MAAA,CAAO,QAAQ,EACzEwqB,CAAAA,CAAQ,MAAA,GAAW,GAAGA,CAAAA,CAAQ,IAAA,CAAKH,CAAM,CAAA,CAC7CX,EAAW,IAAA,CAAKc,CAAO,EACvBb,CAAAA,CAAS,IAAA,CAAKhK,CAAG,CAAA,CACjBwK,CAAAA,CAAgBC,EAClB,CAEA,OAAO,CAACrK,CAAAA,CAAQ2J,CAAAA,CAAYC,CAAQ,CACtC,CAMA,SAASG,EAAAA,CACP9pB,CAAAA,CACA8I,CAAAA,CACA2hB,CAAAA,CACQ,CACR,IAAM1K,CAAAA,CAASE,GAAWjgB,CAAAA,CAAM,MAAM,EACtC,GAAIA,CAAAA,CAAM,MAAA,CAAO,QAAA,CAAU,OAAO+f,CAAAA,CAElC,IAAM0C,EAAOgI,CAAAA,CAAU,CAAC,EAClB9K,CAAAA,CAAMkG,EAAAA,CAAmB/c,CAAAA,CAAK,CAAC,EAAIA,CAAAA,CAAK,CAAC,CAAE,CAAA,CAEjD,OAAI8c,EAAUjG,CAAAA,CAAKZ,EAAE,EAAGgB,CAAAA,CAAO0C,CAAAA,CAAK,CAAC,CAAA,CAAGA,CAAAA,CAAK,EAAI,CAAC,CAAA,CAAI,SAC7CmD,CAAAA,CAAUjG,CAAAA,CAAKX,EAAI,CAAA,CAAGe,EAAO0C,CAAAA,CAAK,CAAC,EAAGA,CAAAA,CAAK,CAAA,CAAI,CAAC,CAAA,CAAI,QAAA,CACpDmD,CAAAA,CAAUjG,CAAAA,CAAKV,EAAI,CAAA,CAAGc,CAAAA,CAAO0C,EAAK,CAAA,CAAI,CAAC,EAAGA,CAAAA,CAAK,CAAC,CAAA,CAAI,QAAA,CACpDmD,EAAUjG,CAAAA,CAAKT,EAAK,IAAGa,CAAAA,CAAO0C,CAAAA,CAAK,EAAI,CAAC,CAAA,CAAGA,CAAAA,CAAK,CAAC,EAAI,QAAA,CAAA,CAEvD1C,CACT,CAMA,SAASiK,EAAAA,CACPhqB,EACA0qB,CAAAA,CACAC,CAAAA,CACQ,CACR,IAAM5K,EAASE,EAAAA,CAAWjgB,CAAAA,CAAM,MAAM,CAAA,CACtC,GAAI0qB,EAAS,MAAA,GAAW,CAAA,CAAG,OAAO3K,CAAAA,CAElC,IAAM0C,CAAAA,CAAOiI,CAAAA,CAAS,CAAC,CAAA,CACjBE,CAAAA,CAAUF,EAASA,CAAAA,CAAS,MAAA,CAAS,CAAC,CAAA,CACxC/K,EAAMkG,EAAAA,CAAmBpD,CAAAA,CAAMmI,CAAO,CAAA,CAAA,CACtCF,CAAAA,CAAS,SAAW,CAAA,EAAK9E,CAAAA,CAAUjG,EAAKJ,EAAM,CAAA,IAAGI,EAAMgL,CAAAA,CAAAA,CAE3D,IAAIE,EAEJ,OAAK7qB,CAAAA,CAAM,OAAO,QAAA,CAsBZ4lB,CAAAA,CAAUjG,CAAAA,CAAKZ,EAAE,EAAG8L,CAAAA,CAAO,GAAA,CACtBjF,EAAUjG,CAAAA,CAAKX,EAAI,EAAG6L,CAAAA,CAAO,GAAA,CAC7BjF,CAAAA,CAAUjG,CAAAA,CAAKV,EAAI,CAAA,CAAG4L,CAAAA,CAAO,IAC7BjF,CAAAA,CAAUjG,CAAAA,CAAKT,EAAK,CAAA,CAAG2L,CAAAA,CAAO,GAAA,CAEjCjF,CAAAA,CAAU+E,EAAa5L,EAAE,CAAA,CAAG8L,EAAO,GAAA,CAC9BjF,CAAAA,CAAU+E,EAAa3L,EAAI,CAAA,CAAG6L,EAAO,GAAA,CACrCjF,CAAAA,CAAU+E,EAAa1L,EAAI,CAAA,CAAG4L,EAAO,GAAA,CACrCjF,CAAAA,CAAU+E,EAAazL,EAAK,CAAA,CAAG2L,CAAAA,CAAO,GAAA,CAC1CA,EAAO,GAAA,CA9BVjF,CAAAA,CAAUjG,EAAKZ,EAAE,CAAA,CAAG8L,EAAO,QAAA,CACtBjF,CAAAA,CAAUjG,CAAAA,CAAKX,EAAI,EAAG6L,CAAAA,CAAO,QAAA,CAC7BjF,EAAUjG,CAAAA,CAAKV,EAAI,EAAG4L,CAAAA,CAAO,QAAA,CAC7BjF,CAAAA,CAAUjG,CAAAA,CAAKT,EAAK,CAAA,CAAG2L,CAAAA,CAAO,SAC9BjF,CAAAA,CAAUjG,CAAAA,CAAKR,EAAU,CAAA,CAAG0L,CAAAA,CAAO,SACnCjF,CAAAA,CAAUjG,CAAAA,CAAKP,EAAS,CAAA,CAAGyL,CAAAA,CAAO,SAClCjF,CAAAA,CAAUjG,CAAAA,CAAKN,EAAU,CAAA,CAAGwL,CAAAA,CAAO,QAAA,CACnCjF,CAAAA,CAAUjG,EAAKL,EAAS,CAAA,CAAGuL,EAAO,QAAA,CAGrCjF,CAAAA,CAAU+E,EAAa5L,EAAE,CAAA,CAAG8L,CAAAA,CAAO,QAAA,CAC9BjF,EAAU+E,CAAAA,CAAa3L,EAAI,EAAG6L,CAAAA,CAAO,QAAA,CACrCjF,EAAU+E,CAAAA,CAAa1L,EAAI,CAAA,CAAG4L,CAAAA,CAAO,SACrCjF,CAAAA,CAAU+E,CAAAA,CAAazL,EAAK,CAAA,CAAG2L,CAAAA,CAAO,SACtCjF,CAAAA,CAAU+E,CAAAA,CAAaxL,EAAU,CAAA,CAAG0L,EAAO,QAAA,CAC3CjF,CAAAA,CAAU+E,EAAavL,EAAS,CAAA,CAAGyL,EAAO,QAAA,CAC1CjF,CAAAA,CAAU+E,CAAAA,CAAatL,EAAU,EAAGwL,CAAAA,CAAO,QAAA,CAC3CjF,EAAU+E,CAAAA,CAAarL,EAAS,EAAGuL,CAAAA,CAAO,QAAA,CAC9CA,CAAAA,CAAO,QAAA,CAgBhB9K,EAAO6K,CAAAA,CAAQ,CAAC,EAAGA,CAAAA,CAAQ,CAAC,EAAIC,CAAAA,CACzB9K,CACT,CAMA,SAASmK,GAAYlqB,CAAAA,CAAmB8I,CAAAA,CAA2B,CACjE,IAAMiX,CAAAA,CAASE,GAAWjgB,CAAAA,CAAM,MAAM,EAEtC,IAAA,IAASslB,CAAAA,CAAM,EAAGA,CAAAA,CAAMxc,CAAAA,CAAK,OAAS,CAAA,CAAGwc,CAAAA,EAAAA,CAAO,CAC9C,IAAMwF,CAAAA,CAAQhiB,CAAAA,CAAKwc,CAAG,EAChByF,CAAAA,CAAKT,EAAAA,CAAmBtqB,EAAO8qB,CAAK,CAAA,CACpCE,EAAUnF,EAAAA,CAAmB/c,CAAAA,CAAKwc,CAAAA,CAAM,CAAC,EAAIwF,CAAK,CAAA,CAClDG,EAAUpF,EAAAA,CAAmBiF,CAAAA,CAAOhiB,EAAKwc,CAAAA,CAAM,CAAC,CAAE,CAAA,CAEpD4F,EACClrB,CAAAA,CAAM,MAAA,CAAO,SAiBhBkrB,CAAAA,CAAS,GAAA,CAhBJtF,EAAUoF,CAAAA,CAAS9L,EAAK,GAAK0G,CAAAA,CAAUqF,CAAAA,CAASjM,EAAI,CAAA,EACpD4G,CAAAA,CAAUoF,EAASjM,EAAE,CAAA,EAAK6G,EAAUqF,CAAAA,CAAShM,EAAI,CAAA,CACpDiM,CAAAA,CAAS,SACCtF,CAAAA,CAAUoF,CAAAA,CAAS9L,EAAK,CAAA,EAAK0G,CAAAA,CAAUqF,EAASlM,EAAE,CAAA,EAClD6G,CAAAA,CAAUoF,CAAAA,CAAShM,EAAI,CAAA,EAAK4G,CAAAA,CAAUqF,EAAShM,EAAI,CAAA,CAC7DiM,EAAS,QAAA,CACCtF,CAAAA,CAAUoF,CAAAA,CAAS/L,EAAI,GAAK2G,CAAAA,CAAUqF,CAAAA,CAASjM,EAAI,CAAA,EACnD4G,CAAAA,CAAUoF,EAASjM,EAAE,CAAA,EAAK6G,EAAUqF,CAAAA,CAAS/L,EAAK,EAC5DgM,CAAAA,CAAS,QAAA,CACCtF,EAAUoF,CAAAA,CAAS/L,EAAI,GAAK2G,CAAAA,CAAUqF,CAAAA,CAASlM,EAAE,CAAA,EACjD6G,EAAUoF,CAAAA,CAAShM,EAAI,GAAK4G,CAAAA,CAAUqF,CAAAA,CAAS/L,EAAK,CAAA,CAC9DgM,CAAAA,CAAS,QAAA,CAETA,CAAAA,CAAS,IAMbnL,CAAAA,CAAOgL,CAAAA,CAAG,CAAC,CAAA,CAAGA,CAAAA,CAAG,CAAC,CAAA,CAAIG,EACxB,CAEA,OAAOnL,CACT,CAGA,SAASyJ,GAAexpB,CAAAA,CAAmB5E,CAAAA,CAAyB,CAClE,IAAM2kB,CAAAA,CAASE,EAAAA,CAAWjgB,CAAAA,CAAM,MAAM,CAAA,CACtC,GAAI5E,EAAK,IAAA,CAAK,MAAA,GAAW,EAAG,OAAO2kB,CAAAA,CAEnC,IAAMoL,CAAAA,CAAcC,GAAcprB,CAAAA,CAAO5E,CAAAA,CAAK,SAAS,CAAA,CACvD,OAAAiwB,GAAetL,CAAAA,CAAQoL,CAAAA,CAAa/vB,CAAAA,CAAK,IAAI,EACtC2kB,CACT,CAGA,SAASsL,EAAAA,CAAetL,CAAAA,CAAgBzE,EAAsB/hB,CAAAA,CAAqB,CACjF,GAAI+hB,CAAAA,CAAK,OAAS,CAAA,CAAG,OACrB,IAAMlb,CAAAA,CAAO,IAAA,CAAK,IAAIkb,CAAAA,CAAK,CAAC,EAAG,CAAA,CAAGA,CAAAA,CAAK,CAAC,CAAA,CAAG,CAAC,EACtCjb,CAAAA,CAAO,IAAA,CAAK,IAAIib,CAAAA,CAAK,CAAC,CAAA,CAAG,CAAA,CAAGA,EAAK,CAAC,CAAA,CAAG,CAAC,CAAA,CACtChb,CAAAA,CAAO,KAAK,GAAA,CAAIgb,CAAAA,CAAK,CAAC,CAAA,CAAG,EAAGA,CAAAA,CAAK,CAAC,EAAG,CAAC,CAAA,CACtC/a,EAAO,IAAA,CAAK,GAAA,CAAI+a,CAAAA,CAAK,CAAC,EAAG,CAAA,CAAGA,CAAAA,CAAK,CAAC,CAAA,CAAG,CAAC,EACtC8L,CAAAA,CAAUhnB,CAAAA,CAAO,KAAK,KAAA,CAAA,CAAOC,CAAAA,CAAOD,GAAQ,CAAC,CAAA,CAC7CkrB,EAAUhrB,CAAAA,CAAO,IAAA,CAAK,OAAOC,CAAAA,CAAOD,CAAAA,EAAQ,CAAC,CAAA,CAC7CgnB,EAASF,CAAAA,CAAU,IAAA,CAAK,MAAM7tB,CAAAA,CAAM,MAAA,CAAS,CAAC,CAAA,CACpDuoB,EAAAA,CAAS/B,CAAAA,CAAQ,CAAE,EAAGuH,CAAAA,CAAQ,CAAA,CAAGgE,CAAQ,CAAA,CAAG/xB,CAAK,EACnD,CAOO,SAASgyB,EAAAA,CAAgBhxB,CAAAA,CAAmByF,EAA2B,CAC5E,IAAMsN,EAAQ/S,CAAAA,CAAG,IAAA,CAAOA,EAAG,IAAA,CACrB2H,CAAAA,CAAS3H,EAAG,IAAA,CAAOA,CAAAA,CAAG,KAC5B,GAAI+S,CAAAA,EAAS,GAAKpL,CAAAA,EAAU,CAAA,CAAG,OAAO4d,EAAAA,CAAS,CAAA,CAAG,CAAC,CAAA,CAEnD,IAAM2C,CAAAA,CAAqB,CAAE,EAAG,CAAA,CAAG,CAAA,CAAG,CAAE,CAAA,CAClCC,CAAAA,CAAmB,CAAE,CAAA,CAAGpV,EAAO,CAAA,CAAGpL,CAAO,EACzC6d,CAAAA,CAASD,EAAAA,CAASxS,EAAOpL,CAAM,CAAA,CAErC,GAAKlC,CAAAA,CAAM,OAAO,QAAA,CASX,CACL,QAASY,CAAAA,CAAI6hB,CAAAA,CAAK,EAAI,CAAA,CAAG7hB,CAAAA,CAAI8hB,EAAG,CAAA,CAAG9hB,CAAAA,EAAAA,CAAKmf,EAAOnf,CAAC,CAAA,CAAG6hB,EAAK,CAAC,CAAA,CAAI,IAC7D,IAAA,IAAS7hB,CAAAA,CAAI6hB,CAAAA,CAAK,CAAA,CAAI,EAAG7hB,CAAAA,CAAI8hB,CAAAA,CAAG,EAAG9hB,CAAAA,EAAAA,CAAKmf,CAAAA,CAAOnf,CAAC,CAAA,CAAG8hB,CAAAA,CAAG,CAAC,CAAA,CAAI,IAC3D,IAAA,IAAS7hB,CAAAA,CAAI4hB,EAAK,CAAA,CAAI,CAAA,CAAG5hB,EAAI6hB,CAAAA,CAAG,CAAA,CAAG7hB,CAAAA,EAAAA,CAAKkf,CAAAA,CAAO0C,EAAK,CAAC,CAAA,CAAG5hB,CAAC,CAAA,CAAI,GAAA,CAC7D,QAASA,CAAAA,CAAI4hB,CAAAA,CAAK,EAAI,CAAA,CAAG5hB,CAAAA,CAAI6hB,EAAG,CAAA,CAAG7hB,CAAAA,EAAAA,CAAKkf,EAAO2C,CAAAA,CAAG,CAAC,EAAG7hB,CAAC,CAAA,CAAI,GAAA,CAC3Dkf,CAAAA,CAAO0C,EAAK,CAAC,CAAA,CAAGA,EAAK,CAAC,CAAA,CAAI,IAC1B1C,CAAAA,CAAO2C,CAAAA,CAAG,CAAC,CAAA,CAAGD,EAAK,CAAC,CAAA,CAAI,IACxB1C,CAAAA,CAAO0C,CAAAA,CAAK,CAAC,CAAA,CAAGC,CAAAA,CAAG,CAAC,CAAA,CAAI,IACxB3C,CAAAA,CAAO2C,CAAAA,CAAG,CAAC,CAAA,CAAGA,CAAAA,CAAG,CAAC,CAAA,CAAI,IACxB,MAlB4B,CAC1B,IAAA,IAAS9hB,EAAI6hB,CAAAA,CAAK,CAAA,CAAI,EAAG7hB,CAAAA,CAAI8hB,CAAAA,CAAG,EAAG9hB,CAAAA,EAAAA,CAAKmf,CAAAA,CAAOnf,CAAC,CAAA,CAAG6hB,EAAK,CAAC,CAAA,CAAI,SAC7D,IAAA,IAAS7hB,CAAAA,CAAI6hB,EAAK,CAAA,CAAI,CAAA,CAAG7hB,CAAAA,CAAI8hB,CAAAA,CAAG,EAAG9hB,CAAAA,EAAAA,CAAKmf,CAAAA,CAAOnf,CAAC,CAAA,CAAG8hB,CAAAA,CAAG,CAAC,CAAA,CAAI,QAAA,CAC3D,IAAA,IAAS7hB,CAAAA,CAAI4hB,EAAK,CAAA,CAAI,CAAA,CAAG5hB,EAAI6hB,CAAAA,CAAG,CAAA,CAAG7hB,IAAKkf,CAAAA,CAAO0C,CAAAA,CAAK,CAAC,CAAA,CAAG5hB,CAAC,EAAI,QAAA,CAC7D,IAAA,IAASA,EAAI4hB,CAAAA,CAAK,CAAA,CAAI,EAAG5hB,CAAAA,CAAI6hB,CAAAA,CAAG,CAAA,CAAG7hB,CAAAA,EAAAA,CAAKkf,EAAO2C,CAAAA,CAAG,CAAC,EAAG7hB,CAAC,CAAA,CAAI,SAC3Dkf,CAAAA,CAAO0C,CAAAA,CAAK,CAAC,CAAA,CAAGA,EAAK,CAAC,CAAA,CAAI,SAC1B1C,CAAAA,CAAO2C,CAAAA,CAAG,CAAC,CAAA,CAAGD,CAAAA,CAAK,CAAC,CAAA,CAAI,SACxB1C,CAAAA,CAAO0C,CAAAA,CAAK,CAAC,CAAA,CAAGC,CAAAA,CAAG,CAAC,CAAA,CAAI,QAAA,CACxB3C,CAAAA,CAAO2C,CAAAA,CAAG,CAAC,CAAA,CAAGA,CAAAA,CAAG,CAAC,CAAA,CAAI,SACxB,CAWA,OAAO3C,CACT,CAGO,SAASyL,GAAkBjxB,CAAAA,CAAmByF,CAAAA,CAA2C,CAC9F,IAAMsN,CAAAA,CAAQ/S,EAAG,IAAA,CAAOA,CAAAA,CAAG,IAAA,CACrB2H,CAAAA,CAAS3H,EAAG,IAAA,CAAOA,CAAAA,CAAG,KAC5B,GAAI+S,CAAAA,EAAS,GAAKpL,CAAAA,EAAU,CAAA,CAAG,OAAO,CAAC4d,GAAS,CAAA,CAAG,CAAC,EAAG,CAAE,CAAA,CAAG,EAAG,CAAA,CAAG,CAAE,CAAC,CAAA,CAErE,IAAMC,EAASD,EAAAA,CAASxS,CAAAA,CAAOpL,CAAM,CAAA,CAC/BupB,CAAAA,CAAS,EACXC,CAAAA,CAAS,IAAA,CAAK,KAAA,CAAMpe,CAAAA,CAAQ,CAAC,CAAA,CAAI,IAAA,CAAK,MAAM/S,CAAAA,CAAG,IAAA,CAAK,OAAS,CAAC,CAAA,CAC9DmxB,CAAAA,CAAS,CAAA,GAAGA,EAAS,CAAA,CAAA,CAEzB,IAAA,IAAS/yB,EAAI,CAAA,CAAGA,CAAAA,CAAI4B,EAAG,IAAA,CAAK,MAAA,CAAQ5B,CAAAA,EAAAA,CAC9B+yB,CAAAA,CAAS/yB,EAAI2U,CAAAA,GACfyS,CAAAA,CAAO2L,EAAS/yB,CAAC,CAAA,CAAG8yB,CAAM,CAAA,CAAIlxB,CAAAA,CAAG,KAAK5B,CAAC,CAAA,CAAA,CAI3C,OAAO,CAAConB,CAAAA,CAAQ,CAAE,CAAA,CAAGxlB,CAAAA,CAAG,KAAM,CAAA,CAAGA,CAAAA,CAAG,IAAK,CAAC,CAC5C,CAOA,SAASoxB,GAAqBlkB,CAAAA,CAA6C,CACzE,SAASmkB,CAAAA,CAASrxB,CAAAA,CAA2B,CAC3C,OAAOA,EAAG,MAAA,GAAW,IAAA,CAAO,EAAI,CAAA,CAAIqxB,CAAAA,CAASrxB,EAAG,MAAM,CACxD,CACA,IAAM6L,EAAS,CAAC,GAAGqB,CAAS,CAAA,CAC5B,OAAArB,EAAO,IAAA,CAAK,CAACrN,EAAGoI,CAAAA,GAAMyqB,CAAAA,CAAS7yB,CAAC,CAAA,CAAI6yB,CAAAA,CAASzqB,CAAC,CAAC,CAAA,CACxCiF,CACT,CAcO,SAASylB,EAAAA,CAAU7rB,CAAAA,CAA2B,CACnD,IAAMmhB,CAAAA,CAAWnhB,EAAM,MAAA,CAAO,QAAA,CAGxB8rB,EAAYH,EAAAA,CAAqB3rB,CAAAA,CAAM,SAAS,CAAA,CACtD,QAAWzF,CAAAA,IAAMuxB,CAAAA,CAAW,CAC1B,IAAMC,CAAAA,CAAWR,GAAgBhxB,CAAAA,CAAIyF,CAAK,CAAA,CACpC+S,CAAAA,CAAuB,CAAE,CAAA,CAAGxY,CAAAA,CAAG,KAAM,CAAA,CAAGA,CAAAA,CAAG,IAAK,CAAA,CACtDyF,CAAAA,CAAM,MAAA,CAASihB,EAAAA,CAAcjhB,EAAM,MAAA,CAAQ+S,CAAAA,CAAQoO,EAAU4K,CAAQ,EACvE,CAGA,IAAA,IAAW9xB,CAAAA,IAAQ+F,CAAAA,CAAM,KAAA,CACnB,CAAC/F,CAAAA,CAAK,KAAA,EAASA,EAAK,YAAA,EAAgBA,CAAAA,CAAK,UAC3C+F,CAAAA,CAAM,MAAA,CAASihB,EAAAA,CAAcjhB,CAAAA,CAAM,OAAQ/F,CAAAA,CAAK,YAAA,CAAcknB,EAAUlnB,CAAAA,CAAK,OAAO,EACpFA,CAAAA,CAAK,KAAA,CAAQ,IAAA,CAAA,CAKjB,IAAM+xB,EAAyB,EAAC,CAC1BC,EAA2B,EAAC,CAC5BC,EAA8B,EAAC,CAC/BC,EAA6B,EAAC,CAC9BC,EAA0B,EAAC,CAEjC,QAAWhxB,CAAAA,IAAQ4E,CAAAA,CAAM,MAAO,CAC9B,GAAM,CAACqsB,CAAAA,CAAOC,EAAWC,CAAAA,CAAYC,CAAAA,CAAUC,CAAM,CAAA,CAAIpD,EAAAA,CAAUrpB,EAAO5E,CAAI,CAAA,CAC9E4wB,CAAAA,CAAa,IAAA,CAAKK,CAAK,CAAA,CACvBJ,CAAAA,CAAe,KAAKO,CAAQ,CAAA,CAC5BN,EAAkB,IAAA,CAAKK,CAAU,CAAA,CACjCJ,CAAAA,CAAiB,KAAKG,CAAS,CAAA,CAC/BF,EAAc,IAAA,CAAKK,CAAM,EAC3B,CAGA,IAAMC,EAAqB,CAAE,CAAA,CAAG,EAAG,CAAA,CAAG,CAAE,EACxC1sB,CAAAA,CAAM,MAAA,CAASihB,GAAcjhB,CAAAA,CAAM,MAAA,CAAQ0sB,CAAAA,CAAMvL,CAAAA,CAAU,GAAG6K,CAAY,CAAA,CAC1EhsB,EAAM,MAAA,CAASihB,EAAAA,CAAcjhB,EAAM,MAAA,CAAQ0sB,CAAAA,CAAMvL,CAAAA,CAAU,GAAG8K,CAAc,CAAA,CAC5EjsB,CAAAA,CAAM,OAASihB,EAAAA,CAAcjhB,CAAAA,CAAM,OAAQ0sB,CAAAA,CAAMvL,CAAAA,CAAU,GAAG+K,CAAiB,EAC/ElsB,CAAAA,CAAM,MAAA,CAASihB,GAAcjhB,CAAAA,CAAM,MAAA,CAAQ0sB,EAAMvL,CAAAA,CAAU,GAAGgL,CAAgB,CAAA,CAC9EnsB,CAAAA,CAAM,OAASihB,EAAAA,CAAcjhB,CAAAA,CAAM,OAAQ0sB,CAAAA,CAAMvL,CAAAA,CAAU,GAAGiL,CAAa,CAAA,CAG3E,IAAA,IAAW7xB,CAAAA,IAAMyF,EAAM,SAAA,CAAW,CAChC,GAAIzF,CAAAA,CAAG,KAAA,CAAM,SAAW,CAAA,CAAG,SAC3B,GAAM,CAACgvB,EAAaxW,CAAM,CAAA,CAAIyY,GAAkBjxB,CAAS,EACzDyF,CAAAA,CAAM,MAAA,CAASihB,EAAAA,CAAcjhB,CAAAA,CAAM,OAAQ+S,CAAAA,CAAQoO,CAAAA,CAAUoI,CAAW,EAC1E,CAEA,OAAOvpB,CAAAA,CAAM,MACf,CCjjBO,SAASsqB,GACdtqB,CAAAA,CACApH,CAAAA,CACA+mB,EACc,CACd,IAAMxY,EAEFvO,CAAAA,CAEAgI,CAAAA,CAAI,EACR,IAAA,IAASof,CAAAA,CAAM,EAAGA,CAAAA,CAAM7Y,CAAAA,CAAO,EAAG6Y,CAAAA,EAAAA,CAChCpf,CAAAA,EAAKZ,CAAAA,CAAM,WAAA,CAAY,IAAIggB,CAAG,CAAA,EAAK,EAGrC,IAAInf,CAAAA,CAAI,EACR,IAAA,IAAS+nB,CAAAA,CAAM,EAAGA,CAAAA,CAAMzhB,CAAAA,CAAO,EAAGyhB,CAAAA,EAAAA,CAChC/nB,CAAAA,EAAKb,EAAM,SAAA,CAAU,GAAA,CAAI4oB,CAAG,CAAA,EAAK,CAAA,CAGnC,IAAM+D,CAAAA,CAAO3sB,EAAM,WAAA,CAAY,GAAA,CAAImH,EAAO,CAAC,CAAA,EAAK,EAC1CylB,CAAAA,CAAO5sB,CAAAA,CAAM,SAAA,CAAU,GAAA,CAAImH,EAAO,CAAC,CAAA,EAAK,EAC9C,OAAO,CACL,EAAGvG,CAAAA,CAAI,IAAA,CAAK,KAAA,CAAM+rB,CAAAA,CAAO,CAAC,CAAA,CAAI3sB,CAAAA,CAAM,QACpC,CAAA,CAAGa,CAAAA,CAAI,KAAK,KAAA,CAAM+rB,CAAAA,CAAO,CAAC,CAAA,CAAI5sB,CAAAA,CAAM,OACtC,CACF,CAGO,SAASorB,EAAAA,CAAcprB,CAAAA,CAAmBsb,EAAmC,CAClF,OAAOA,CAAAA,CAAK,GAAA,CAAI1iB,GAAK0xB,EAAAA,CAAmBtqB,CAAAA,CAAOpH,CAAC,CAAC,CACnD,CAWO,SAASi0B,EAAAA,CACd7sB,CAAAA,CACA/F,CAAAA,CACA6yB,EACW,CACX,GAAI9sB,EAAM,IAAA,CAAK,GAAA,CAAI4f,GAAQkN,CAAS,CAAC,CAAA,CAEnC,OAAI9sB,EAAM,MAAA,CAAO,cAAA,GAAmB,KAC3B6sB,EAAAA,CAAkB7sB,CAAAA,CAAO/F,EAAM,CAAE,CAAA,CAAG6yB,EAAU,CAAA,CAAG,CAAA,CAAGA,EAAU,CAAA,CAAI,CAAE,CAAC,CAAA,CAErED,EAAAA,CAAkB7sB,EAAO/F,CAAAA,CAAM,CAAE,CAAA,CAAG6yB,CAAAA,CAAU,EAAI,CAAA,CAAG,CAAA,CAAGA,EAAU,CAAE,CAAC,EAKhF,IAAA,IAASrrB,CAAAA,CAAK,CAAA,CAAGA,CAAAA,CAAK,EAAGA,CAAAA,EAAAA,CACvB,IAAA,IAASC,EAAK,CAAA,CAAGA,CAAAA,CAAK,EAAGA,CAAAA,EAAAA,CAAM,CAC7B,IAAMqrB,CAAAA,CAAsB,CAAE,CAAA,CAAGD,CAAAA,CAAU,EAAIrrB,CAAAA,CAAI,CAAA,CAAGqrB,EAAU,CAAA,CAAIprB,CAAG,EACvE1B,CAAAA,CAAM,IAAA,CAAK,IAAI4f,EAAAA,CAAQmN,CAAQ,EAAG9yB,CAAI,EACxC,CAGF,OAAAA,CAAAA,CAAK,SAAA,CAAY6yB,CAAAA,CACVA,CACT,CAWO,SAASE,GAAehtB,CAAAA,CAAmB/F,CAAAA,CAAuB,CACvE,IAAMwtB,CAAAA,CAAKxtB,CAAAA,CAAK,SAAA,CACV8tB,EAAU/nB,CAAAA,CAAM,MAAA,CAAO,iBAGvBitB,CAAAA,CAAY,CAAC,EAAG,CAAA,CAAIlF,CAAAA,CAAU9tB,CAAAA,CAAK,YAAA,CAAa,OAAQ,CAAC,CAAA,CAEzDizB,EAAa,CAAC,CAAA,CAAG,EAAI,CAAA,CAAInF,CAAAA,CAAS,CAAC,CAAA,CAEzC,IAAA,IAASzC,EAAM,CAAA,CAAGA,CAAAA,CAAM2H,EAAU,MAAA,CAAQ3H,CAAAA,EAAAA,CAAO,CAC/C,IAAM6H,CAAAA,CAAS1F,CAAAA,CAAG,CAAA,CAAInC,EAChBtI,CAAAA,CAAUhd,CAAAA,CAAM,YAAY,GAAA,CAAImtB,CAAM,GAAK,CAAA,CACjDntB,CAAAA,CAAM,WAAA,CAAY,GAAA,CAAImtB,EAAQ,IAAA,CAAK,GAAA,CAAInQ,EAASiQ,CAAAA,CAAU3H,CAAG,CAAE,CAAC,EAClE,CAEA,IAAA,IAASA,EAAM,CAAA,CAAGA,CAAAA,CAAM4H,EAAW,MAAA,CAAQ5H,CAAAA,EAAAA,CAAO,CAChD,IAAM8H,CAAAA,CAAS3F,EAAG,CAAA,CAAInC,CAAAA,CAChBtI,EAAUhd,CAAAA,CAAM,SAAA,CAAU,IAAIotB,CAAM,CAAA,EAAK,EAC/CptB,CAAAA,CAAM,SAAA,CAAU,GAAA,CAAIotB,CAAAA,CAAQ,KAAK,GAAA,CAAIpQ,CAAAA,CAASkQ,EAAW5H,CAAG,CAAE,CAAC,EACjE,CAGA,GAAImC,CAAAA,CAAG,EAAI,CAAA,CAAG,CACZ,IAAMzK,CAAAA,CAAUhd,CAAAA,CAAM,YAAY,GAAA,CAAIynB,CAAAA,CAAG,CAAA,CAAI,CAAC,GAAK,CAAA,CACnDznB,CAAAA,CAAM,YAAY,GAAA,CAAIynB,CAAAA,CAAG,EAAI,CAAA,CAAG,IAAA,CAAK,IAAIzK,CAAAA,CAAShd,CAAAA,CAAM,OAAO,QAAQ,CAAC,EAC1E,CAEA,GAAIynB,EAAG,CAAA,CAAI,CAAA,CAAG,CACZ,IAAI4F,EAAcrtB,CAAAA,CAAM,MAAA,CAAO,SAE3BstB,EAAAA,CAAmCttB,CAAAA,CAAO/F,CAAI,CAAA,GAEhDozB,CAAAA,EAAe,CAAA,CAAA,CAEjB,IAAMrQ,EAAUhd,CAAAA,CAAM,SAAA,CAAU,IAAIynB,CAAAA,CAAG,CAAA,CAAI,CAAC,CAAA,EAAK,CAAA,CACjDznB,CAAAA,CAAM,SAAA,CAAU,IAAIynB,CAAAA,CAAG,CAAA,CAAI,EAAG,IAAA,CAAK,GAAA,CAAIzK,EAASqQ,CAAW,CAAC,EAC9D,CACF,CAGO,SAASE,EAAAA,CAAwBvtB,EAAmB8I,CAAAA,CAAyB,CAClF,QAAWlQ,CAAAA,IAAKkQ,CAAAA,CACT9I,CAAAA,CAAM,WAAA,CAAY,IAAIpH,CAAAA,CAAE,CAAC,GAC5BoH,CAAAA,CAAM,WAAA,CAAY,IAAIpH,CAAAA,CAAE,CAAA,CAAG,IAAA,CAAK,KAAA,CAAMoH,EAAM,MAAA,CAAO,QAAA,CAAW,CAAC,CAAC,CAAA,CAE7DA,EAAM,SAAA,CAAU,GAAA,CAAIpH,CAAAA,CAAE,CAAC,GAC1BoH,CAAAA,CAAM,SAAA,CAAU,IAAIpH,CAAAA,CAAE,CAAA,CAAG,KAAK,KAAA,CAAMoH,CAAAA,CAAM,OAAO,QAAA,CAAW,CAAC,CAAC,EAGpE,CAMA,SAASwtB,EAAAA,CAAoBxtB,CAAAA,CAAmB/F,EAA0B,CACxE,OAAO+F,CAAAA,CAAM,SAAA,CAAU,KAAKzF,CAAAA,EAAMA,CAAAA,CAAG,MAAM,QAAA,CAASN,CAAI,CAAC,CAC3D,CAEA,SAASwzB,EAAAA,CAAgBztB,EAAmB/F,CAAAA,CAAuC,CACjF,QAAWM,CAAAA,IAAMyF,CAAAA,CAAM,UACrB,GAAIzF,CAAAA,CAAG,KAAA,CAAM,QAAA,CAASN,CAAI,CAAA,CAAG,OAAOM,EAEtC,OAAO,IACT,CAOA,SAAS+yB,EAAAA,CAAmCttB,EAAmB/F,CAAAA,CAA0B,CACvF,IAAMyzB,CAAAA,CAASD,EAAAA,CAAgBztB,EAAO/F,CAAI,CAAA,CAC1C,GAAI,CAACyzB,CAAAA,CAAQ,OAAO,MAAA,CAEpB,IAAIC,CAAAA,CAAkB,KAAA,CACtB,QAAWvyB,CAAAA,IAAQ4E,CAAAA,CAAM,MACvB,GAAI5E,CAAAA,CAAK,EAAA,GAAOnB,CAAAA,EACGwzB,GAAgBztB,CAAAA,CAAO5E,CAAAA,CAAK,IAAI,CAAA,GAChCsyB,CAAAA,CAAQ,CACvBC,CAAAA,CAAkB,IAAA,CAClB,KACF,CAIJ,GAAI,CAACA,CAAAA,CAAiB,OAAO,MAAA,CAG7B,IAAA,IAAWC,KAAaF,CAAAA,CAAO,KAAA,CAAO,CACpC,GAAIE,CAAAA,GAAc3zB,GAAQ,CAAC2zB,CAAAA,CAAU,UAAW,SAChD,IAAIC,EAAmB,KAAA,CACvB,IAAA,IAAWzyB,CAAAA,IAAQ4E,CAAAA,CAAM,MACvB,GAAI5E,CAAAA,CAAK,KAAOwyB,CAAAA,EACGH,EAAAA,CAAgBztB,EAAO5E,CAAAA,CAAK,IAAI,CAAA,GAChCsyB,CAAAA,CAAQ,CACvBG,CAAAA,CAAmB,IAAA,CACnB,KACF,CAGJ,GAAIA,GAAoBD,CAAAA,CAAU,SAAA,CAAU,CAAA,CAAI3zB,CAAAA,CAAK,UAAW,CAAA,CAC9D,OAAO,MAEX,CAEA,OAAO,KACT,CAMA,SAAS6zB,EAAAA,CAA6B9tB,CAAAA,CAAmBzF,EAAyB,CAChF,GAAIA,EAAG,KAAA,CAAM,MAAA,GAAW,EAAG,OAE3B,IAAI6F,CAAAA,CAAO,GAAA,CACPE,EAAO,GAAA,CACPD,CAAAA,CAAO,KACPE,CAAAA,CAAO,IAAA,CAGX,QAAW8B,CAAAA,IAAS9H,CAAAA,CAAG,QAAA,CACrBuzB,EAAAA,CAA6B9tB,EAAOqC,CAAK,CAAA,CACrCA,EAAM,KAAA,CAAM,MAAA,CAAS,IACvBjC,CAAAA,CAAO,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAMiC,EAAM,IAAI,CAAA,CAChC/B,EAAO,IAAA,CAAK,GAAA,CAAIA,EAAM+B,CAAAA,CAAM,IAAI,EAChChC,CAAAA,CAAO,IAAA,CAAK,IAAIA,CAAAA,CAAMgC,CAAAA,CAAM,IAAI,CAAA,CAChC9B,CAAAA,CAAO,KAAK,GAAA,CAAIA,CAAAA,CAAM8B,CAAAA,CAAM,IAAI,GAKpC,IAAA,IAAWpI,CAAAA,IAAQM,EAAG,KAAA,CAAO,CAC3B,GAAI,CAACN,CAAAA,CAAK,YAAA,EAAgB,CAACA,EAAK,OAAA,CAAS,SACzC,IAAM8zB,CAAAA,CAAW9zB,CAAAA,CAAK,aAAa,CAAA,CAC7B+zB,CAAAA,CAAW/zB,CAAAA,CAAK,YAAA,CAAa,EAC7Bg0B,CAAAA,CAAWF,CAAAA,CAAW9zB,EAAK,OAAA,CAAQ,MAAA,CAAS,EAC5Ci0B,CAAAA,CAAWF,CAAAA,CAAW/zB,EAAK,OAAA,CAAQ,CAAC,EAAG,MAAA,CAAS,CAAA,CACtDmG,EAAO,IAAA,CAAK,GAAA,CAAIA,EAAM2tB,CAAQ,CAAA,CAC9BztB,CAAAA,CAAO,IAAA,CAAK,IAAIA,CAAAA,CAAM0tB,CAAQ,EAC9B3tB,CAAAA,CAAO,IAAA,CAAK,IAAIA,CAAAA,CAAM4tB,CAAQ,CAAA,CAC9B1tB,CAAAA,CAAO,KAAK,GAAA,CAAIA,CAAAA,CAAM2tB,CAAQ,EAChC,CAEA,IAAMC,CAAAA,CAAkB,CAAA,CAClBC,CAAAA,CAAqB,CAAA,CAC3B7zB,EAAG,IAAA,CAAO6F,CAAAA,CAAO+tB,EACjB5zB,CAAAA,CAAG,IAAA,CAAO+F,EAAO6tB,CAAAA,CAAkBC,CAAAA,CACnC7zB,EAAG,IAAA,CAAO8F,CAAAA,CAAO8tB,EACjB5zB,CAAAA,CAAG,IAAA,CAAOgG,EAAO4tB,EACnB,CAGA,SAASE,EAAAA,CAAsBruB,CAAAA,CAAyB,CAEtD,IAAMsuB,EAAgBtuB,CAAAA,CAAM,SAAA,CAAU,OAAOzF,CAAAA,EAAMA,CAAAA,CAAG,SAAW,IAAA,EAAQA,CAAAA,CAAG,KAAA,CAAM,MAAA,CAAS,CAAC,CAAA,CAE5F,IAAA,IAAS5B,EAAI,CAAA,CAAGA,CAAAA,CAAI21B,EAAc,MAAA,CAAQ31B,CAAAA,EAAAA,CACxC,IAAA,IAAS0d,CAAAA,CAAI1d,EAAI,CAAA,CAAG0d,CAAAA,CAAIiY,EAAc,MAAA,CAAQjY,CAAAA,EAAAA,CAAK,CACjD,IAAMkY,CAAAA,CAAMD,CAAAA,CAAc31B,CAAC,EACrB61B,CAAAA,CAAMF,CAAAA,CAAcjY,CAAC,CAAA,CAGvBkY,CAAAA,CAAI,KAAOC,CAAAA,CAAI,IAAA,EAAQD,CAAAA,CAAI,IAAA,CAAOC,EAAI,IAAA,GACpCD,CAAAA,CAAI,MAAQC,CAAAA,CAAI,IAAA,CAAO,GAAcD,CAAAA,CAAI,IAAA,CAAOC,CAAAA,CAAI,IAAA,CACtDA,EAAI,IAAA,CAAOD,CAAAA,CAAI,KAAO,CAAA,CAAa,CAAA,CAC1BC,EAAI,IAAA,EAAQD,CAAAA,CAAI,IAAA,CAAO,CAAA,EAAcC,EAAI,IAAA,CAAOD,CAAAA,CAAI,OAC7DA,CAAAA,CAAI,IAAA,CAAOC,EAAI,IAAA,CAAO,CAAA,CAAa,IAInCD,CAAAA,CAAI,IAAA,CAAOC,EAAI,IAAA,EAAQD,CAAAA,CAAI,KAAOC,CAAAA,CAAI,IAAA,GACpCD,EAAI,IAAA,EAAQC,CAAAA,CAAI,IAAA,CAAO,CAAA,EAAcD,EAAI,IAAA,CAAOC,CAAAA,CAAI,KACtDA,CAAAA,CAAI,IAAA,CAAOD,EAAI,IAAA,CAAO,CAAA,CAAa,CAAA,CAC1BC,CAAAA,CAAI,MAAQD,CAAAA,CAAI,IAAA,CAAO,GAAcC,CAAAA,CAAI,IAAA,CAAOD,EAAI,IAAA,GAC7DA,CAAAA,CAAI,IAAA,CAAOC,CAAAA,CAAI,KAAO,CAAA,CAAa,CAAA,CAAA,EAGzC,CAEJ,CAEO,SAASC,GAA+BzuB,CAAAA,CAAyB,CACtE,QAAWzF,CAAAA,IAAMyF,CAAAA,CAAM,UACrB8tB,EAAAA,CAA6B9tB,CAAAA,CAAOzF,CAAE,CAAA,CAExC8zB,EAAAA,CAAsBruB,CAAK,EAC7B,CAMO,SAAS0uB,EAAAA,CAA0B1uB,EAAyB,CACjE,GAAIA,EAAM,SAAA,CAAU,MAAA,GAAW,EAAG,OAElC,IAAII,CAAAA,CAAO,CAAA,CACPE,EAAO,CAAA,CACX,IAAA,IAAW/F,KAAMyF,CAAAA,CAAM,SAAA,CACrBI,EAAO,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAM7F,CAAAA,CAAG,IAAI,CAAA,CAC7B+F,CAAAA,CAAO,KAAK,GAAA,CAAIA,CAAAA,CAAM/F,EAAG,IAAI,CAAA,CAG/B,IAAMo0B,CAAAA,CAAU,CAACvuB,EACXwuB,CAAAA,CAAU,CAACtuB,EACjB,GAAI,EAAAquB,IAAY,CAAA,EAAKC,CAAAA,GAAY,CAAA,CAAA,CAEjC,CAAA5uB,EAAM,OAAA,CAAU2uB,CAAAA,CAChB3uB,EAAM,OAAA,CAAU4uB,CAAAA,CAEhB,QAAWr0B,CAAAA,IAAMyF,CAAAA,CAAM,SAAA,CACrBzF,CAAAA,CAAG,MAAQo0B,CAAAA,CACXp0B,CAAAA,CAAG,MAAQq0B,CAAAA,CACXr0B,CAAAA,CAAG,MAAQo0B,CAAAA,CACXp0B,CAAAA,CAAG,IAAA,EAAQq0B,CAAAA,CAGb,QAAW30B,CAAAA,IAAQ+F,CAAAA,CAAM,MACnB/F,CAAAA,CAAK,YAAA,GACPA,EAAK,YAAA,CAAa,CAAA,EAAK00B,EACvB10B,CAAAA,CAAK,YAAA,CAAa,GAAK20B,CAAAA,EAAAA,CAG7B,CAiBO,SAASC,EAAAA,CAAc7uB,CAAAA,CAAyB,CACrD,IAAM2f,CAAAA,CAAM3f,CAAAA,CAAM,MAAA,CAAO,eACnB8uB,CAAAA,CAAoC,IAAI,MAAM,GAAG,CAAA,CAAE,KAAK,CAAC,CAAA,CAGzDC,CAAAA,CAAa,IAAI,IACjBC,CAAAA,CAAyB,GAE/B,IAAA,IAAW/0B,CAAAA,IAAQ+F,EAAM,KAAA,CAAO,CACzB+uB,CAAAA,CAAW,GAAA,CAAI90B,EAAK,IAAI,CAAA,EAC3B+0B,EAAU,IAAA,CAAK/0B,CAAI,EAErB80B,CAAAA,CAAW,GAAA,CAAI90B,EAAK,IAAI,CAAA,CACxB,QAAWoI,CAAAA,IAAS4sB,EAAAA,CAAYjvB,EAAO/F,CAAI,CAAA,CACzC80B,EAAW,GAAA,CAAI1sB,CAAAA,CAAM,IAAI,EAE7B,CAIA,IAAI6sB,CAAAA,CAAmB,MACnBC,CAAAA,CAA4B,KAAA,CAChC,QAAWl1B,CAAAA,IAAQ+0B,CAAAA,CACbxB,EAAAA,CAAoBxtB,CAAAA,CAAO/F,CAAI,CAAA,CAC7Bg1B,EAAAA,CAAYjvB,EAAO/F,CAAI,CAAA,CAAE,OAAS,CAAA,GAAGk1B,CAAAA,CAA4B,IAAA,CAAA,CAErED,CAAAA,CAAmB,KAGvB,IAAME,CAAAA,CAAiBzP,IAAQ,IAAA,EAAQuP,CAAAA,EAAoBC,EAEvDE,CAAAA,CACAC,CAAAA,CAAiC,EAAC,CAElCF,CAAAA,EACFC,EAAoBL,CAAAA,CAAU,MAAA,CAAOx2B,GAAK,CAACg1B,EAAAA,CAAoBxtB,EAAOxH,CAAC,CAAC,CAAA,CACxE82B,CAAAA,CAAoBN,EAAU,MAAA,CAAOx2B,CAAAA,EAAKg1B,GAAoBxtB,CAAAA,CAAOxH,CAAC,CAAC,CAAA,EAEvE62B,CAAAA,CAAoBL,CAAAA,CAItB,IAAA,IAAW/0B,KAAQo1B,CAAAA,CAAmB,CACpC,IAAMvC,CAAAA,CAAuBnN,CAAAA,GAAQ,KACjC,CAAE,CAAA,CAAG,CAAA,CAAG,CAAA,CAAGmP,EAAwB,CAAC,CAAG,EACvC,CAAE,CAAA,CAAGA,EAAwB,CAAC,CAAA,CAAI,EAAG,CAAE,CAAA,CAC3CjC,GAAkB7sB,CAAAA,CAAOA,CAAAA,CAAM,MAAM/F,CAAAA,CAAK,KAAK,EAAI6yB,CAAS,CAAA,CAC5DgC,CAAAA,CAAwB,CAAC,EAAIA,CAAAA,CAAwB,CAAC,EAAK,EAC7D,CAGA,GAAIM,CAAAA,EAAkBE,CAAAA,CAAkB,MAAA,CAAS,CAAA,CAE/C,QAAWr1B,CAAAA,IAAQq1B,CAAAA,CAAmB,CACpC,IAAMxC,CAAAA,CAAuBnN,IAAQ,IAAA,CACjC,CAAE,CAAA,CAAG,CAAA,CAAe,EAAGmP,CAAAA,CAAwB,CAAa,CAAG,CAAA,CAC/D,CAAE,EAAGA,CAAAA,CAAwB,CAAa,CAAA,CAAI,CAAA,CAAG,CAAc,CAAA,CACnEjC,EAAAA,CAAkB7sB,EAAOA,CAAAA,CAAM,KAAA,CAAM/F,EAAK,KAAK,CAAA,CAAI6yB,CAAS,CAAA,CAC5DgC,EAAwB,CAAa,CAAA,CAAIA,EAAwB,CAAa,CAAA,CAAK,EACrF,CAIF,IAAA,IAAW70B,CAAAA,IAAQ+F,CAAAA,CAAM,MAAO,CAC9B,IAAMynB,EAAKxtB,CAAAA,CAAK,SAAA,CACVs1B,EAAa5P,CAAAA,GAAQ,IAAA,CAAO8H,CAAAA,CAAG,CAAA,CAAI,EAAIA,CAAAA,CAAG,CAAA,CAAI,EAChD+H,CAAAA,CAAkBV,CAAAA,CAAwBS,CAAU,CAAA,CAExD,IAAA,IAAWltB,KAAS4sB,EAAAA,CAAYjvB,CAAAA,CAAO/F,CAAI,CAAA,CAAG,CAC5C,GAAIoI,CAAAA,CAAM,SAAA,GAAc,KAAM,SAE9B,IAAMyqB,CAAAA,CAAuBnN,CAAAA,GAAQ,KACjC,CAAE,CAAA,CAAG4P,EAAY,CAAA,CAAGC,CAAgB,EACpC,CAAE,CAAA,CAAGA,CAAAA,CAAiB,CAAA,CAAGD,CAAW,CAAA,CACxC1C,EAAAA,CAAkB7sB,EAAOA,CAAAA,CAAM,KAAA,CAAMqC,EAAM,KAAK,CAAA,CAAIyqB,CAAS,CAAA,CAC7DgC,EAAwBS,CAAU,CAAA,CAAIC,EAAkB,CAAA,CACxDA,CAAAA,CAAkBV,EAAwBS,CAAU,EACtD,CACF,CAGA,IAAA,IAAWt1B,KAAQ+F,CAAAA,CAAM,KAAA,CACvBgtB,GAAehtB,CAAAA,CAAO/F,CAAI,EAI5B,IAAA,IAAWmB,CAAAA,IAAQ4E,CAAAA,CAAM,KAAA,CACvBsmB,GAActmB,CAAAA,CAAO5E,CAAI,EACzBmyB,EAAAA,CAAwBvtB,CAAAA,CAAO5E,EAAK,IAAI,CAAA,CACxCyrB,EAAAA,CAAmB7mB,CAAAA,CAAO5E,CAAI,CAAA,CAIhC,IAAA,IAAWnB,KAAQ+F,CAAAA,CAAM,KAAA,CACvB/F,EAAK,YAAA,CAAeqwB,EAAAA,CAAmBtqB,CAAAA,CAAO/F,CAAAA,CAAK,SAAU,CAAA,CAC7DA,CAAAA,CAAK,QAAUutB,EAAAA,CAAQvtB,CAAAA,CAAM+F,CAAK,CAAA,CAIpC+hB,EAAAA,CAAoB/hB,EAAM,MAAA,CAAQA,CAAAA,CAAM,YAAaA,CAAAA,CAAM,SAAS,EACpEyuB,EAAAA,CAA+BzuB,CAAK,EACpC0uB,EAAAA,CAA0B1uB,CAAK,EACjC,CAOA,SAASyvB,EAAAA,CAAiBzvB,CAAAA,CAAmB/F,EAAsC,CACjF,OAAO+F,EAAM,KAAA,CAAM,MAAA,CAAOzH,CAAAA,EAAKA,CAAAA,CAAE,KAAK,IAAA,GAAS0B,CAAAA,CAAK,IAAI,CAC1D,CAGA,SAASg1B,EAAAA,CAAYjvB,CAAAA,CAAmB/F,CAAAA,CAA8B,CACpE,OAAOw1B,EAAAA,CAAiBzvB,CAAAA,CAAO/F,CAAI,CAAA,CAAE,GAAA,CAAI1B,GAAKA,CAAAA,CAAE,EAAE,CACpD,CC9aO,SAASm3B,GAAqB1U,CAAAA,CAAkC,CACrE,IAAM2U,CAAAA,CAA2B,CAC/B,OAAQ,EAAC,CACT,QAAA,CAAU,GACV,MAAA,CAAQ,GACR,KAAA,CAAO,EACT,CAAA,CAGMC,CAAAA,CAAW,IAAI,GAAA,CAEfC,EAA6G,EAAC,CAEpH,QAAS,CAAA,CAAI,CAAA,CAAG,EAAI7U,CAAAA,CAAM,MAAA,CAAQ,CAAA,EAAA,CAAK,CACrC,IAAMM,CAAAA,CAAON,CAAAA,CAAM,CAAC,CAAA,CAKd8U,CAAAA,CAAaxU,EAAK,KAAA,CAAM,iDAAiD,EAC/E,GAAIwU,CAAAA,CAAY,CACd,IAAM1d,CAAAA,CAAO0d,EAAW,CAAC,CAAA,CACnBlc,EAAKkc,CAAAA,CAAW,CAAC,CAAA,CACjBv2B,CAAAA,CAAQu2B,EAAW,CAAC,CAAA,EAAG,MAAK,EAAKlc,CAAAA,CAClCgc,EAAS,GAAA,CAAIhc,CAAE,CAAA,GAClBgc,CAAAA,CAAS,IAAIhc,CAAE,CAAA,CACf+b,EAAQ,MAAA,CAAO,IAAA,CAAK,CAAE,EAAA,CAAA/b,CAAAA,CAAI,KAAA,CAAAra,CAAAA,CAAO,KAAA6Y,CAAK,CAAC,GAEzC,QACF,CAIA,IAAM2d,CAAAA,CAAYzU,CAAAA,CAAK,MAAM,qDAAqD,CAAA,CAClF,GAAIyU,CAAAA,CAAW,CACb,IAAMC,CAAAA,CAASD,CAAAA,CAAU,CAAC,CAAA,CAAG,WAAA,EAAY,CACnCE,CAAAA,CAAYF,EAAU,CAAC,CAAA,CAAG,MAAK,CAC/BhV,CAAAA,CAAOgV,EAAU,CAAC,CAAA,CAAG,IAAA,EAAK,CAC1BG,EAAeD,CAAAA,CAAU,KAAA,CAAM,GAAG,CAAA,CAAE,GAAA,CAAIrU,GAAKA,CAAAA,CAAE,IAAA,EAAM,CAAA,CAG3D,QAAWuU,CAAAA,IAAOD,CAAAA,CAChBE,GAAYT,CAAAA,CAASC,CAAAA,CAAUO,CAAG,CAAA,CAGpC,IAAIlyB,EAAsC,MAAA,CACtC+xB,CAAAA,GAAW,UAAW/xB,CAAAA,CAAW,MAAA,CAC5B+xB,IAAW,UAAA,GAAY/xB,CAAAA,CAAW,SAE3C0xB,CAAAA,CAAQ,KAAA,CAAM,IAAA,CAAK,CACjB,SAAUO,CAAAA,CACV,IAAA,CAAAnV,EACA,QAAA,CAAA9c,CAAAA,CACA,WAAY0xB,CAAAA,CAAQ,QAAA,CAAS,MAAA,CAAS,CACxC,CAAC,CAAA,CACD,QACF,CAGA,IAAMU,CAAAA,CAAa/U,EAAK,KAAA,CAAM,iDAAiD,CAAA,CAC/E,GAAI+U,EAAY,CACd,IAAMC,EAAYD,CAAAA,CAAW,CAAC,EACxB92B,CAAAA,CAAQ82B,CAAAA,CAAW,CAAC,CAAA,EAAG,MAAK,EAAK,EAAA,CACvCR,EAAW,IAAA,CAAK,CACd,KAAMS,CAAAA,CACN,KAAA,CAAA/2B,CAAAA,CACA,UAAA,CAAYo2B,EAAQ,QAAA,CAAS,MAAA,CAC7B,SAAU,EACZ,CAAC,CAAA,CACD,QACF,CAGA,IAAMY,EAAejV,CAAAA,CAAK,KAAA,CAAM,qBAAqB,CAAA,CACrD,GAAIiV,GAAgBV,CAAAA,CAAW,MAAA,CAAS,CAAA,CAAG,CACzC,IAAMt2B,CAAAA,CAAQg3B,CAAAA,CAAa,CAAC,CAAA,EAAG,IAAA,IAAU,EAAA,CACzCV,CAAAA,CAAWA,EAAW,MAAA,CAAS,CAAC,EAAG,QAAA,CAAS,IAAA,CAAK,CAC/C,KAAA,CAAOF,CAAAA,CAAQ,SAAS,MAAA,CACxB,KAAA,CAAAp2B,CACF,CAAC,EACD,QACF,CAGA,GAAI+hB,CAAAA,GAAS,KAAA,EAASuU,EAAW,MAAA,CAAS,CAAA,CAAG,CAC3C,IAAM1T,EAAY0T,CAAAA,CAAW,GAAA,GAC7BF,CAAAA,CAAQ,MAAA,CAAO,KAAK,CAClB,IAAA,CAAMxT,CAAAA,CAAU,IAAA,CAChB,MAAOA,CAAAA,CAAU,KAAA,CACjB,WAAYA,CAAAA,CAAU,UAAA,CACtB,SAAU,IAAA,CAAK,GAAA,CAAIwT,EAAQ,QAAA,CAAS,MAAA,CAAS,EAAGxT,CAAAA,CAAU,UAAU,EACpE,QAAA,CAAUA,CAAAA,CAAU,QACtB,CAAC,CAAA,CACD,QACF,CAKA,IAAMqU,CAAAA,CAAWlV,CAAAA,CAAK,MACpB,mEACF,CAAA,CACA,GAAIkV,CAAAA,CAAU,CACZ,IAAM/N,CAAAA,CAAO+N,EAAS,CAAC,CAAA,CACjBC,EAAQD,CAAAA,CAAS,CAAC,EAClBE,CAAAA,CAAiBF,CAAAA,CAAS,CAAC,CAAA,CAC3B9N,EAAK8N,CAAAA,CAAS,CAAC,EACfj3B,CAAAA,CAAQi3B,CAAAA,CAAS,CAAC,CAAA,CAAG,IAAA,GAG3BJ,EAAAA,CAAYT,CAAAA,CAASC,EAAUnN,CAAI,CAAA,CACnC2N,GAAYT,CAAAA,CAASC,CAAAA,CAAUlN,CAAE,CAAA,CAGjC,IAAMiO,CAAAA,CAAYF,CAAAA,CAAM,WAAW,IAAI,CAAA,CAAI,SAAW,OAAA,CAEhDG,CAAAA,CAAYH,EAAM,QAAA,CAAS,IAAI,CAAA,EAAKA,CAAAA,CAAM,SAAS,GAAG,CAAA,CAAI,SAAW,MAAA,CAErEI,CAAAA,CAAe,CACnB,IAAA,CAAApO,CAAAA,CACA,EAAA,CAAAC,CAAAA,CACA,MAAAnpB,CAAAA,CACA,SAAA,CAAAo3B,EACA,SAAA,CAAAC,CACF,EAGIF,CAAAA,GAAmB,GAAA,GAAKG,EAAI,QAAA,CAAW,IAAA,CAAA,CACvCH,IAAmB,GAAA,GAAKG,CAAAA,CAAI,WAAa,IAAA,CAAA,CAE7ClB,CAAAA,CAAQ,SAAS,IAAA,CAAKkB,CAAG,CAAA,CACzB,QACF,CAGA,IAAMC,CAAAA,CAAiBxV,EAAK,KAAA,CAC1B,yEACF,EACA,GAAIwV,CAAAA,CAAgB,CAClB,IAAMrO,EAAOqO,CAAAA,CAAe,CAAC,EACvBL,CAAAA,CAAQK,CAAAA,CAAe,CAAC,CAAA,CACxBJ,CAAAA,CAAiBI,CAAAA,CAAe,CAAC,EACjCpO,CAAAA,CAAKoO,CAAAA,CAAe,CAAC,CAAA,CACrBv3B,CAAAA,CAAQu3B,EAAe,CAAC,CAAA,CAAG,MAAK,CAEtCV,EAAAA,CAAYT,EAASC,CAAAA,CAAUnN,CAAI,EACnC2N,EAAAA,CAAYT,CAAAA,CAASC,EAAUlN,CAAE,CAAA,CAEjC,IAAMiO,CAAAA,CAAYF,EAAM,UAAA,CAAW,IAAI,EAAI,QAAA,CAAW,OAAA,CAChDG,EAAYH,CAAAA,CAAM,QAAA,CAAS,IAAI,CAAA,EAAKA,EAAM,QAAA,CAAS,GAAG,EAAI,QAAA,CAAW,MAAA,CAErEI,EAAe,CAAE,IAAA,CAAApO,CAAAA,CAAM,EAAA,CAAAC,EAAI,KAAA,CAAAnpB,CAAAA,CAAO,UAAAo3B,CAAAA,CAAW,SAAA,CAAAC,CAAU,CAAA,CACzDF,CAAAA,GAAmB,MAAKG,CAAAA,CAAI,QAAA,CAAW,MACvCH,CAAAA,GAAmB,GAAA,GAAKG,EAAI,UAAA,CAAa,IAAA,CAAA,CAE7ClB,EAAQ,QAAA,CAAS,IAAA,CAAKkB,CAAG,CAAA,CACzB,QACF,CAKF,CAEA,OAAOlB,CACT,CAGA,SAASS,EAAAA,CAAYT,CAAAA,CAA0BC,CAAAA,CAAuBhc,CAAAA,CAAkB,CACjFgc,CAAAA,CAAS,GAAA,CAAIhc,CAAE,CAAA,GAClBgc,CAAAA,CAAS,IAAIhc,CAAE,CAAA,CACf+b,CAAAA,CAAQ,MAAA,CAAO,KAAK,CAAE,EAAA,CAAA/b,EAAI,KAAA,CAAOA,CAAAA,CAAI,KAAM,aAAc,CAAC,GAE9D,CCrLO,SAASmd,GAAoBhW,CAAAA,CAAcqH,CAAAA,CAA6B,CAC7E,IAAMpH,CAAAA,CAAQD,EAAK,KAAA,CAAM;AAAA,CAAI,CAAA,CAAE,GAAA,CAAI3Z,CAAAA,EAAKA,CAAAA,CAAE,MAAM,CAAA,CAAE,MAAA,CAAOA,CAAAA,EAAKA,EAAE,MAAA,CAAS,CAAA,EAAK,CAACA,CAAAA,CAAE,WAAW,IAAI,CAAC,CAAA,CAC3FuuB,CAAAA,CAAUD,EAAAA,CAAqB1U,CAAK,CAAA,CAE1C,GAAI2U,EAAQ,MAAA,CAAO,MAAA,GAAW,CAAA,CAAG,OAAO,GAExC,IAAMxO,CAAAA,CAAWiB,CAAAA,CAAO,QAAA,CAGlB4O,EAAI7P,CAAAA,CAAW,GAAA,CAAM,QAAA,CACrB8P,CAAAA,CAAI9P,CAAAA,CAAW,GAAA,CAAM,QAAA,CACrB+P,CAAAA,CAAK/P,EAAW,GAAA,CAAM,QAAA,CACtBgQ,CAAAA,CAAKhQ,CAAAA,CAAW,IAAM,QAAA,CACtBiQ,CAAAA,CAAKjQ,CAAAA,CAAW,GAAA,CAAM,SACtBkQ,CAAAA,CAAKlQ,CAAAA,CAAW,GAAA,CAAM,QAAA,CACtBmQ,CAAAA,CAAKnQ,CAAAA,CAAW,GAAA,CAAM,QAAA,CACtBoQ,EAAKpQ,CAAAA,CAAW,GAAA,CAAM,QAAA,CACtBqQ,CAAAA,CAAKrQ,EAAW,GAAA,CAAM,QAAA,CACtBsQ,CAAAA,CAAKtQ,CAAAA,CAAW,IAAM,QAAA,CAItBuQ,CAAAA,CAAW,IAAI,GAAA,CACrB/B,CAAAA,CAAQ,MAAA,CAAO,OAAA,CAAQ,CAAC52B,EAAGJ,CAAAA,GAAM+4B,CAAAA,CAAS,GAAA,CAAI34B,CAAAA,CAAE,GAAIJ,CAAC,CAAC,CAAA,CAEtD,IAAMg5B,EAAS,CAAA,CAETC,CAAAA,CADiBjC,CAAAA,CAAQ,MAAA,CAAO,GAAA,CAAI52B,CAAAA,EAAKA,CAAAA,CAAE,KAAA,CAAM,OAAS,CAAA,CAAI44B,CAAAA,CAAS,CAAC,CAAA,CAC/C,IAAIz2B,CAAAA,EAAK,IAAA,CAAK,IAAA,CAAKA,CAAAA,CAAI,CAAC,CAAC,CAAA,CAClD22B,CAAAA,CAAY,CAAA,CAIZC,CAAAA,CAAwB,IAAI,KAAA,CAAM,IAAA,CAAK,IAAInC,CAAAA,CAAQ,MAAA,CAAO,MAAA,CAAS,CAAA,CAAG,CAAC,CAAC,CAAA,CAAE,IAAA,CAAK,CAAC,EAEtF,IAAA,IAAWkB,CAAAA,IAAOlB,CAAAA,CAAQ,QAAA,CAAU,CAClC,IAAMoC,CAAAA,CAAKL,CAAAA,CAAS,GAAA,CAAIb,EAAI,IAAI,CAAA,CAC1BmB,CAAAA,CAAKN,CAAAA,CAAS,IAAIb,CAAAA,CAAI,EAAE,CAAA,CAC9B,GAAIkB,IAAOC,CAAAA,CAAI,SACf,IAAMC,CAAAA,CAAK,IAAA,CAAK,GAAA,CAAIF,CAAAA,CAAIC,CAAE,EACpBE,CAAAA,CAAK,IAAA,CAAK,GAAA,CAAIH,CAAAA,CAAIC,CAAE,CAAA,CAEpBG,CAAAA,CAAStB,CAAAA,CAAI,KAAA,CAAM,OAAS,CAAA,CAC5BuB,CAAAA,CAAUF,CAAAA,CAAKD,CAAAA,CACfI,CAAAA,CAAS,IAAA,CAAK,IAAA,CAAKF,CAAAA,CAASC,CAAO,CAAA,CACzC,IAAA,IAAS/5B,CAAAA,CAAI45B,CAAAA,CAAI55B,EAAI65B,CAAAA,CAAI75B,CAAAA,EAAAA,CACvBy5B,CAAAA,CAAYz5B,CAAC,EAAI,IAAA,CAAK,GAAA,CAAIy5B,CAAAA,CAAYz5B,CAAC,CAAA,CAAIg6B,CAAM,EAErD,CAGA,IAAMC,CAAAA,CAAgB,CAACV,CAAAA,CAAQ,CAAC,CAAE,CAAA,CAClC,IAAA,IAASj5B,CAAAA,CAAI,CAAA,CAAGA,EAAIg3B,CAAAA,CAAQ,MAAA,CAAO,MAAA,CAAQh3B,CAAAA,EAAAA,CAAK,CAC9C,IAAM45B,CAAAA,CAAM,IAAA,CAAK,IACfX,CAAAA,CAAQj5B,CAAAA,CAAI,CAAC,CAAA,CAAKi5B,EAAQj5B,CAAC,CAAA,CAAK,CAAA,CAChCm5B,CAAAA,CAAYn5B,EAAI,CAAC,CAAA,CAAK,CAAA,CACtB,EACF,CAAA,CACA25B,CAAAA,CAAI35B,CAAC,CAAA,CAAI25B,EAAI35B,CAAAA,CAAI,CAAC,CAAA,CAAK45B,EACzB,CAMA,IAAMC,CAAAA,CAAsB,EAAC,CACvBC,EAAsB,EAAC,CACvBC,CAAAA,CAAc,IAAI,GAAA,CAClBC,CAAAA,CAAY,IAAI,GAAA,CAChBC,EAAU,IAAI,GAAA,CACdC,CAAAA,CAAiG,GAEnGC,CAAAA,CAAOjB,CAAAA,CAEX,IAAA,IAASkB,CAAAA,CAAI,EAAGA,CAAAA,CAAIpD,CAAAA,CAAQ,QAAA,CAAS,MAAA,CAAQoD,CAAAA,EAAAA,CAAK,CAEhD,IAAA,IAAS5xB,CAAAA,CAAI,EAAGA,CAAAA,CAAIwuB,CAAAA,CAAQ,MAAA,CAAO,MAAA,CAAQxuB,IACrCwuB,CAAAA,CAAQ,MAAA,CAAOxuB,CAAC,CAAA,CAAG,aAAe4xB,CAAAA,GACpCD,CAAAA,EAAQ,CAAA,CACRJ,CAAAA,CAAY,IAAIvxB,CAAAA,CAAG2xB,CAAAA,CAAO,CAAC,CAAA,CAAA,CAK/B,QAAS3xB,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIwuB,CAAAA,CAAQ,OAAO,MAAA,CAAQxuB,CAAAA,EAAAA,CACzC,IAAA,IAAS+U,CAAAA,CAAI,EAAGA,CAAAA,CAAIyZ,CAAAA,CAAQ,MAAA,CAAOxuB,CAAC,CAAA,CAAG,QAAA,CAAS,MAAA,CAAQ+U,CAAAA,EAAAA,CAClDyZ,EAAQ,MAAA,CAAOxuB,CAAC,CAAA,CAAG,QAAA,CAAS+U,CAAC,CAAA,CAAG,KAAA,GAAU6c,CAAAA,GAC5CD,CAAAA,EAAQ,EACRF,CAAAA,CAAQ,GAAA,CAAI,CAAA,EAAGzxB,CAAC,CAAA,CAAA,EAAI+U,CAAC,CAAA,CAAA,CAAI4c,CAAI,EAC7BA,CAAAA,EAAQ,CAAA,CAAA,CAKdA,CAAAA,EAAQ,CAAA,CAER,IAAMjC,CAAAA,CAAMlB,CAAAA,CAAQ,QAAA,CAASoD,CAAC,EACflC,CAAAA,CAAI,IAAA,GAASA,CAAAA,CAAI,EAAA,EAI9B4B,CAAAA,CAAUM,CAAC,CAAA,CAAID,CAAAA,CAAO,EACtBN,CAAAA,CAAUO,CAAC,CAAA,CAAID,CAAAA,CACfA,GAAQ,CAAA,GAGRL,CAAAA,CAAUM,CAAC,CAAA,CAAID,EACfN,CAAAA,CAAUO,CAAC,CAAA,CAAID,CAAAA,CAAO,CAAA,CACtBA,CAAAA,EAAQ,CAAA,CAAA,CAIV,IAAA,IAASt6B,EAAI,CAAA,CAAGA,CAAAA,CAAIm3B,CAAAA,CAAQ,KAAA,CAAM,OAAQn3B,CAAAA,EAAAA,CACxC,GAAIm3B,CAAAA,CAAQ,KAAA,CAAMn3B,CAAC,CAAA,CAAG,UAAA,GAAeu6B,CAAAA,CAAG,CACtCD,CAAAA,EAAQ,CAAA,CACR,IAAME,CAAAA,CAAOrD,EAAQ,KAAA,CAAMn3B,CAAC,CAAA,CACtBy6B,CAAAA,CAASD,EAAK,IAAA,CAAK,KAAA,CAAM,KAAK,CAAA,CAC9BE,EAAS,IAAA,CAAK,GAAA,CAAI,GAAGD,CAAAA,CAAO,GAAA,CAAI7xB,CAAAA,EAAKA,CAAAA,CAAE,MAAM,CAAC,CAAA,CAAI,CAAA,CAClD+xB,CAAAA,CAAUF,CAAAA,CAAO,OAAS,CAAA,CAG1BG,CAAAA,CAAO1B,CAAAA,CAAS,GAAA,CAAIsB,EAAK,QAAA,CAAS,CAAC,CAAE,CAAA,EAAK,CAAA,CAC5CK,CAAAA,CACJ,GAAIL,CAAAA,CAAK,WAAa,MAAA,CACpBK,CAAAA,CAAKf,CAAAA,CAAIc,CAAI,EAAKF,CAAAA,CAAS,CAAA,CAAA,KAAA,GAClBF,CAAAA,CAAK,QAAA,GAAa,QAC3BK,CAAAA,CAAKf,CAAAA,CAAIc,CAAI,CAAA,CAAK,UAGdJ,CAAAA,CAAK,QAAA,CAAS,MAAA,EAAU,CAAA,CAAG,CAC7B,IAAMM,CAAAA,CAAQ5B,CAAAA,CAAS,GAAA,CAAIsB,EAAK,QAAA,CAAS,CAAC,CAAE,CAAA,EAAKI,EACjDC,CAAAA,CAAK,IAAA,CAAK,KAAA,CAAA,CAAOf,CAAAA,CAAIc,CAAI,CAAA,CAAKd,CAAAA,CAAIgB,CAAK,GAAM,CAAC,CAAA,CAAI,IAAA,CAAK,KAAA,CAAMJ,EAAS,CAAC,EACzE,CAAA,KACEG,CAAAA,CAAKf,EAAIc,CAAI,CAAA,CAAK,IAAA,CAAK,KAAA,CAAMF,CAAAA,CAAS,CAAC,CAAA,CAG3CG,CAAAA,CAAK,KAAK,GAAA,CAAI,CAAA,CAAGA,CAAE,CAAA,CAEnBR,EAAc,IAAA,CAAK,CAAE,CAAA,CAAGQ,CAAAA,CAAI,EAAGP,CAAAA,CAAM,KAAA,CAAOI,CAAAA,CAAQ,MAAA,CAAQC,CAAAA,CAAS,KAAA,CAAOF,CAAO,CAAC,EACpFH,CAAAA,EAAQK,EACV,CAIF,IAAA,IAAShyB,EAAI,CAAA,CAAGA,CAAAA,CAAIwuB,CAAAA,CAAQ,MAAA,CAAO,OAAQxuB,CAAAA,EAAAA,CACrCwuB,CAAAA,CAAQ,MAAA,CAAOxuB,CAAC,EAAG,QAAA,GAAa4xB,CAAAA,GAClCD,CAAAA,EAAQ,CAAA,CACRH,EAAU,GAAA,CAAIxxB,CAAAA,CAAG2xB,CAAI,CAAA,CACrBA,GAAQ,CAAA,EAGd,CAEAA,CAAAA,EAAQ,CAAA,CACR,IAAMS,CAAAA,CAAUT,CAAAA,CACVU,CAAAA,CAASD,CAAAA,CAAU1B,CAAAA,CAGnB4B,CAAAA,CAASnB,CAAAA,CAAIA,CAAAA,CAAI,OAAS,CAAC,CAAA,EAAK,CAAA,CAChCoB,CAAAA,CAAW9B,EAAQA,CAAAA,CAAQ,MAAA,CAAS,CAAC,CAAA,EAAK,EAC5C+B,CAAAA,CAASF,CAAAA,CAASC,CAAAA,CAAW,CAAA,CAGjC,IAAA,IAASX,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIpD,EAAQ,QAAA,CAAS,MAAA,CAAQoD,CAAAA,EAAAA,CAAK,CAChD,IAAMlC,CAAAA,CAAMlB,CAAAA,CAAQ,QAAA,CAASoD,CAAC,EAC9B,GAAIlC,CAAAA,CAAI,IAAA,GAASA,CAAAA,CAAI,EAAA,CAAI,CACvB,IAAMkB,CAAAA,CAAKL,EAAS,GAAA,CAAIb,CAAAA,CAAI,IAAI,CAAA,CAC1B+C,EAAYtB,CAAAA,CAAIP,CAAE,CAAA,CAAK,CAAA,CAAI,EAAIlB,CAAAA,CAAI,KAAA,CAAM,MAAA,CAC/C8C,CAAAA,CAAS,KAAK,GAAA,CAAIA,CAAAA,CAAQC,CAAAA,CAAY,CAAC,EACzC,CACF,CACA,IAAA,IAAWC,CAAAA,IAAMhB,EACfc,CAAAA,CAAS,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAQE,EAAG,CAAA,CAAIA,CAAAA,CAAG,KAAA,CAAQ,CAAC,CAAA,CAG/C,IAAM9T,CAAAA,CAASD,EAAAA,CAAS6T,EAAQH,CAAAA,CAAS,CAAC,CAAA,CAI1C,SAASM,EAAaC,CAAAA,CAAYC,CAAAA,CAAcz6B,CAAAA,CAAqB,CACnE,IAAM2B,CAAAA,CAAI3B,CAAAA,CAAM,MAAA,CAAS,CAAA,CAAIo4B,CAAAA,CAAS,CAAA,CAChCxN,CAAAA,CAAO4P,CAAAA,CAAK,KAAK,KAAA,CAAM74B,CAAAA,CAAI,CAAC,CAAA,CAElC6kB,EAAOoE,CAAI,CAAA,CAAG6P,CAAI,CAAA,CAAI9C,EACtB,IAAA,IAAStwB,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAI1F,CAAAA,CAAI,CAAA,CAAG0F,CAAAA,EAAAA,CAAKmf,CAAAA,CAAOoE,EAAOvjB,CAAC,CAAA,CAAGozB,CAAI,CAAA,CAAIhD,EAC1DjR,CAAAA,CAAOoE,CAAAA,CAAOjpB,CAAAA,CAAI,CAAC,EAAG84B,CAAI,CAAA,CAAI7C,CAAAA,CAE9BpR,CAAAA,CAAOoE,CAAI,CAAA,CAAG6P,CAAAA,CAAO,CAAC,EAAI/C,CAAAA,CAC1BlR,CAAAA,CAAOoE,CAAAA,CAAOjpB,CAAAA,CAAI,CAAC,CAAA,CAAG84B,CAAAA,CAAO,CAAC,CAAA,CAAI/C,EAClC,IAAMgD,CAAAA,CAAK9P,CAAAA,CAAO,CAAA,CAAIwN,CAAAA,CACtB,IAAA,IAASh5B,CAAAA,CAAI,CAAA,CAAGA,EAAIY,CAAAA,CAAM,MAAA,CAAQZ,CAAAA,EAAAA,CAAKonB,CAAAA,CAAOkU,EAAKt7B,CAAC,CAAA,CAAGq7B,CAAAA,CAAO,CAAC,EAAIz6B,CAAAA,CAAMZ,CAAC,CAAA,CAE1EonB,CAAAA,CAAOoE,CAAI,CAAA,CAAG6P,CAAAA,CAAO,CAAC,EAAI5C,CAAAA,CAC1B,IAAA,IAASxwB,CAAAA,CAAI,CAAA,CAAGA,EAAI1F,CAAAA,CAAI,CAAA,CAAG0F,CAAAA,EAAAA,CAAKmf,CAAAA,CAAOoE,EAAOvjB,CAAC,CAAA,CAAGozB,CAAAA,CAAO,CAAC,CAAA,CAAIhD,CAAAA,CAC9DjR,CAAAA,CAAOoE,CAAAA,CAAOjpB,EAAI,CAAC,CAAA,CAAG84B,CAAAA,CAAO,CAAC,EAAI3C,EACpC,CAIA,IAAA,IAAS14B,CAAAA,CAAI,EAAGA,CAAAA,CAAIg3B,CAAAA,CAAQ,MAAA,CAAO,MAAA,CAAQh3B,IAAK,CAC9C,IAAMiI,CAAAA,CAAI0xB,CAAAA,CAAI35B,CAAC,CAAA,CACf,IAAA,IAASkI,CAAAA,CAAIgxB,CAAAA,CAAWhxB,GAAK0yB,CAAAA,CAAS1yB,CAAAA,EAAAA,CACpCkf,CAAAA,CAAOnf,CAAC,EAAGC,CAAC,CAAA,CAAIowB,EAEpB,CAIA,IAAA,IAASt4B,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIg3B,EAAQ,MAAA,CAAO,MAAA,CAAQh3B,CAAAA,EAAAA,CAAK,CAC9C,IAAMu7B,CAAAA,CAAQvE,CAAAA,CAAQ,MAAA,CAAOh3B,CAAC,EAC9Bm7B,CAAAA,CAAaxB,CAAAA,CAAI35B,CAAC,CAAA,CAAI,CAAA,CAAGu7B,CAAAA,CAAM,KAAK,CAAA,CACpCJ,EAAaxB,CAAAA,CAAI35B,CAAC,CAAA,CAAI46B,CAAAA,CAASW,EAAM,KAAK,CAAA,CAGrC/S,CAAAA,GACHpB,CAAAA,CAAOuS,EAAI35B,CAAC,CAAE,CAAA,CAAGk5B,CAAAA,CAAY,CAAC,CAAA,CAAIP,CAAAA,CAClCvR,CAAAA,CAAOuS,EAAI35B,CAAC,CAAE,CAAA,CAAG46B,CAAO,EAAIhC,CAAAA,EAEhC,CAIA,IAAA,IAASwB,CAAAA,CAAI,EAAGA,CAAAA,CAAIpD,CAAAA,CAAQ,QAAA,CAAS,MAAA,CAAQoD,CAAAA,EAAAA,CAAK,CAChD,IAAMlC,CAAAA,CAAMlB,EAAQ,QAAA,CAASoD,CAAC,CAAA,CACxBhB,CAAAA,CAAKL,EAAS,GAAA,CAAIb,CAAAA,CAAI,IAAI,CAAA,CAC1BmB,EAAKN,CAAAA,CAAS,GAAA,CAAIb,CAAAA,CAAI,EAAE,CAAA,CACxBsD,CAAAA,CAAQ7B,CAAAA,CAAIP,CAAE,EACdqC,CAAAA,CAAM9B,CAAAA,CAAIN,CAAE,CAAA,CACZqC,EAAStC,CAAAA,GAAOC,CAAAA,CAChBsC,CAAAA,CAAWzD,CAAAA,CAAI,YAAc,QAAA,CAC7B0D,CAAAA,CAAW1D,CAAAA,CAAI,SAAA,GAAc,QAAA,CAG7B2D,CAAAA,CAAWF,CAAAA,CAAYnT,CAAAA,CAAW,IAAM,QAAA,CAAO6P,CAAAA,CAErD,GAAIqD,CAAAA,CAAQ,CAKV,IAAMI,CAAAA,CAAKjC,CAAAA,CAAUO,CAAC,EAChB2B,CAAAA,CAAQ,IAAA,CAAK,GAAA,CAAI,CAAA,CAAG,CAAC,CAAA,CAG3B3U,CAAAA,CAAOoU,CAAK,EAAGM,CAAE,CAAA,CAAIjD,CAAAA,CACrB,IAAA,IAAS5wB,EAAIuzB,CAAAA,CAAQ,CAAA,CAAGvzB,CAAAA,CAAIuzB,CAAAA,CAAQO,EAAO9zB,CAAAA,EAAAA,CAAKmf,CAAAA,CAAOnf,CAAC,CAAA,CAAG6zB,CAAE,CAAA,CAAID,CAAAA,CACjEzU,CAAAA,CAAOoU,CAAAA,CAAQO,CAAK,CAAA,CAAGD,CAAE,CAAA,CAAItT,CAAAA,CAAW,IAAM,QAAA,CAG9CpB,CAAAA,CAAOoU,CAAAA,CAAQO,CAAK,EAAGD,CAAAA,CAAK,CAAC,CAAA,CAAIxD,CAAAA,CACjC,IAAMvF,CAAAA,CAASyI,CAAAA,CAAQO,CAAAA,CAAQ,EAC/B,IAAA,IAAS/7B,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIk4B,EAAI,KAAA,CAAM,MAAA,CAAQl4B,CAAAA,EAAAA,CAChC+yB,CAAAA,CAAS/yB,EAAIg7B,CAAAA,GAAQ5T,CAAAA,CAAO2L,CAAAA,CAAS/yB,CAAC,CAAA,CAAG87B,CAAAA,CAAK,CAAC,CAAA,CAAI5D,EAAI,KAAA,CAAMl4B,CAAC,CAAA,CAAA,CAIpE,IAAMg8B,EAAYJ,CAAAA,CAAYpT,CAAAA,CAAW,GAAA,CAAM,QAAA,CAAQA,EAAW,GAAA,CAAM,QAAA,CACxEpB,CAAAA,CAAOoU,CAAK,CAAA,CAAGM,CAAAA,CAAK,CAAC,CAAA,CAAIE,EACzB,IAAA,IAAS/zB,CAAAA,CAAIuzB,CAAAA,CAAQ,CAAA,CAAGvzB,EAAIuzB,CAAAA,CAAQO,CAAAA,CAAO9zB,CAAAA,EAAAA,CAAKmf,CAAAA,CAAOnf,CAAC,CAAA,CAAG6zB,CAAAA,CAAK,CAAC,CAAA,CAAID,CAAAA,CACrEzU,CAAAA,CAAOoU,CAAAA,CAAQO,CAAK,EAAGD,CAAAA,CAAK,CAAC,CAAA,CAAItT,CAAAA,CAAW,IAAM,SACpD,CAAA,KAAO,CAEL,IAAMsK,EAASgH,CAAAA,CAAUM,CAAC,CAAA,CACpB6B,CAAAA,CAASpC,CAAAA,CAAUO,CAAC,CAAA,CACpB8B,CAAAA,CAAcV,EAAQC,CAAAA,CAItBU,CAAAA,CADO,IAAA,CAAK,KAAA,CAAA,CAAOX,EAAQC,CAAAA,EAAO,CAAC,CAAA,CACf,IAAA,CAAK,MAAMvD,CAAAA,CAAI,KAAA,CAAM,MAAA,CAAS,CAAC,CAAA,CACzD,IAAA,IAASl4B,EAAAA,CAAI,CAAA,CAAGA,GAAIk4B,CAAAA,CAAI,KAAA,CAAM,MAAA,CAAQl4B,EAAAA,EAAAA,CAAK,CACzC,IAAMo8B,EAAAA,CAAKD,CAAAA,CAAan8B,EAAAA,CACpBo8B,IAAM,CAAA,EAAKA,EAAAA,CAAKpB,CAAAA,GAAQ5T,CAAAA,CAAOgV,EAAE,CAAA,CAAGtJ,CAAM,CAAA,CAAIoF,EAAI,KAAA,CAAMl4B,EAAC,CAAA,EAC/D,CAGA,GAAIk8B,CAAAA,CAAa,CACf,IAAA,IAASj0B,EAAAA,CAAIuzB,EAAQ,CAAA,CAAGvzB,EAAAA,CAAIwzB,CAAAA,CAAKxzB,EAAAA,EAAAA,CAAKmf,EAAOnf,EAAC,CAAA,CAAGg0B,CAAM,CAAA,CAAIJ,EAE3D,IAAMQ,EAAAA,CAAKT,CAAAA,CAAYpT,CAAAA,CAAW,IAAM,QAAA,CAAQA,CAAAA,CAAW,GAAA,CAAM,QAAA,CACjEpB,EAAOqU,CAAG,CAAA,CAAGQ,CAAM,CAAA,CAAII,GACzB,CAAA,KAAO,CACL,IAAA,IAASp0B,GAAIwzB,CAAAA,CAAM,CAAA,CAAGxzB,EAAAA,CAAIuzB,CAAAA,CAAOvzB,KAAKmf,CAAAA,CAAOnf,EAAC,CAAA,CAAGg0B,CAAM,EAAIJ,CAAAA,CAC3D,IAAMQ,EAAAA,CAAKT,CAAAA,CAAYpT,CAAAA,CAAW,GAAA,CAAM,QAAA,CAAQA,CAAAA,CAAW,IAAM,QAAA,CACjEpB,CAAAA,CAAOqU,CAAG,CAAA,CAAGQ,CAAM,CAAA,CAAII,GACzB,CACF,CACF,CAIA,IAAA,IAAS7zB,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIwuB,CAAAA,CAAQ,MAAA,CAAO,MAAA,CAAQxuB,CAAAA,EAAAA,CAAK,CAC9C,IAAM8zB,CAAAA,CAAQtF,CAAAA,CAAQ,MAAA,CAAOxuB,CAAC,CAAA,CACxB6yB,CAAAA,CAAOtB,CAAAA,CAAY,GAAA,CAAIvxB,CAAC,CAAA,CACxB+zB,CAAAA,CAAOvC,CAAAA,CAAU,GAAA,CAAIxxB,CAAC,CAAA,CAC5B,GAAI6yB,CAAAA,GAAS,MAAA,EAAakB,IAAS,MAAA,CAAW,SAG9C,IAAIC,CAAAA,CAAQxB,EACRyB,CAAAA,CAAQ,CAAA,CACZ,IAAA,IAASrC,CAAAA,CAAIkC,EAAM,UAAA,CAAYlC,CAAAA,EAAKkC,CAAAA,CAAM,QAAA,EACpC,EAAAlC,CAAAA,EAAKpD,CAAAA,CAAQ,QAAA,CAAS,QADwBoD,CAAAA,EAAAA,CAAK,CAEvD,IAAMlC,CAAAA,CAAMlB,EAAQ,QAAA,CAASoD,CAAC,CAAA,CACxB36B,CAAAA,CAAIs5B,EAAS,GAAA,CAAIb,CAAAA,CAAI,IAAI,CAAA,EAAK,CAAA,CAC9Bp4B,CAAAA,CAAIi5B,CAAAA,CAAS,GAAA,CAAIb,EAAI,EAAE,CAAA,EAAK,CAAA,CAClCsE,CAAAA,CAAQ,KAAK,GAAA,CAAIA,CAAAA,CAAO7C,CAAAA,CAAI,IAAA,CAAK,IAAIl6B,CAAAA,CAAGK,CAAC,CAAC,CAAE,CAAA,CAC5C28B,CAAAA,CAAQ,IAAA,CAAK,GAAA,CAAIA,EAAO9C,CAAAA,CAAI,IAAA,CAAK,GAAA,CAAIl6B,CAAAA,CAAGK,CAAC,CAAC,CAAE,EAC9C,CAEA,IAAM48B,CAAAA,CAAQ,IAAA,CAAK,GAAA,CAAI,CAAA,CAAGF,EAAQ,CAAC,CAAA,CAC7BG,CAAAA,CAAS,IAAA,CAAK,IAAI3B,CAAAA,CAAS,CAAA,CAAGyB,CAAAA,CAAQ,CAAC,EAG7CrV,CAAAA,CAAOsV,CAAK,CAAA,CAAGrB,CAAI,EAAI9C,CAAAA,CACvB,IAAA,IAAStwB,CAAAA,CAAIy0B,CAAAA,CAAQ,CAAA,CAAGz0B,CAAAA,CAAI00B,CAAAA,CAAQ10B,CAAAA,EAAAA,CAAKmf,EAAOnf,CAAC,CAAA,CAAGozB,CAAI,CAAA,CAAIhD,EAC5DjR,CAAAA,CAAOuV,CAAM,CAAA,CAAGtB,CAAI,EAAI7C,CAAAA,CAExB,IAAMoE,CAAAA,CAAWN,CAAAA,CAAM,KAAA,CAAQ,CAAA,EAAGA,CAAAA,CAAM,IAAI,KAAKA,CAAAA,CAAM,KAAK,CAAA,CAAA,CAAA,CAAMA,CAAAA,CAAM,KACxE,IAAA,IAASt8B,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAI48B,EAAS,MAAA,EAAUF,CAAAA,CAAQ,CAAA,CAAI18B,CAAAA,CAAI28B,CAAAA,CAAQ38B,CAAAA,EAAAA,CAC7DonB,CAAAA,CAAOsV,CAAAA,CAAQ,EAAI18B,CAAC,CAAA,CAAGq7B,CAAI,CAAA,CAAIuB,EAAS58B,CAAC,CAAA,CAI3ConB,CAAAA,CAAOsV,CAAK,EAAGH,CAAI,CAAA,CAAI9D,CAAAA,CACvB,IAAA,IAASxwB,CAAAA,CAAIy0B,CAAAA,CAAQ,CAAA,CAAGz0B,CAAAA,CAAI00B,EAAQ10B,CAAAA,EAAAA,CAAKmf,CAAAA,CAAOnf,CAAC,CAAA,CAAGs0B,CAAI,CAAA,CAAIlE,CAAAA,CAC5DjR,CAAAA,CAAOuV,CAAM,EAAGJ,CAAI,CAAA,CAAI7D,CAAAA,CAGxB,IAAA,IAASxwB,CAAAA,CAAImzB,CAAAA,CAAO,CAAA,CAAGnzB,CAAAA,CAAIq0B,EAAMr0B,CAAAA,EAAAA,CAC/Bkf,CAAAA,CAAOsV,CAAK,CAAA,CAAGx0B,CAAC,CAAA,CAAIowB,CAAAA,CACpBlR,CAAAA,CAAOuV,CAAM,EAAGz0B,CAAC,CAAA,CAAIowB,CAAAA,CAIvB,IAAA,IAAS/a,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAI+e,CAAAA,CAAM,SAAS,MAAA,CAAQ/e,CAAAA,EAAAA,CAAK,CAC9C,IAAMsf,EAAK5C,CAAAA,CAAQ,GAAA,CAAI,CAAA,EAAGzxB,CAAC,IAAI+U,CAAC,CAAA,CAAE,CAAA,CAClC,GAAIsf,CAAAA,GAAO,MAAA,CAAW,SACtB,IAAMC,EAAWC,CAAAA,EAAU,CAC3B3V,CAAAA,CAAOsV,CAAK,EAAGG,CAAE,CAAA,CAAIhE,CAAAA,CACrB,IAAA,IAAS5wB,EAAIy0B,CAAAA,CAAQ,CAAA,CAAGz0B,CAAAA,CAAI00B,CAAAA,CAAQ10B,IAAKmf,CAAAA,CAAOnf,CAAC,CAAA,CAAG40B,CAAE,EAAIC,CAAAA,CAC1D1V,CAAAA,CAAOuV,CAAM,CAAA,CAAGE,CAAE,CAAA,CAAI/D,CAAAA,CAEtB,IAAMkE,CAAAA,CAASV,EAAM,QAAA,CAAS/e,CAAC,CAAA,CAAG,KAAA,CAClC,GAAIyf,CAAAA,CAAQ,CACV,IAAMC,EAAO,CAAA,CAAA,EAAID,CAAM,CAAA,CAAA,CAAA,CACvB,IAAA,IAASh9B,EAAI,CAAA,CAAGA,CAAAA,CAAIi9B,CAAAA,CAAK,MAAA,EAAUP,EAAQ,CAAA,CAAI18B,CAAAA,CAAI28B,CAAAA,CAAQ38B,CAAAA,EAAAA,CACzDonB,CAAAA,CAAOsV,CAAAA,CAAQ,CAAA,CAAI18B,CAAC,EAAG68B,CAAE,CAAA,CAAII,CAAAA,CAAKj9B,CAAC,EAEvC,CACF,CACF,CAIA,IAAA,IAAWk7B,KAAMhB,CAAAA,CAAe,CAE9B1S,EAAAA,CAAaJ,CAAAA,CAAQ8T,CAAAA,CAAG,CAAA,CAAIA,CAAAA,CAAG,KAAA,CAAOA,EAAG,CAAA,CAAIA,CAAAA,CAAG,MAAM,CAAA,CAEtD9T,EAAO8T,CAAAA,CAAG,CAAC,CAAA,CAAGA,CAAAA,CAAG,CAAC,CAAA,CAAI3C,CAAAA,CACtB,IAAA,IAAStwB,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIizB,CAAAA,CAAG,KAAA,CAAQ,EAAGjzB,CAAAA,EAAAA,CAAKmf,CAAAA,CAAO8T,CAAAA,CAAG,CAAA,CAAIjzB,CAAC,CAAA,CAAGizB,CAAAA,CAAG,CAAC,CAAA,CAAI7C,EACjEjR,CAAAA,CAAO8T,CAAAA,CAAG,CAAA,CAAIA,CAAAA,CAAG,KAAA,CAAQ,CAAC,CAAA,CAAGA,CAAAA,CAAG,CAAC,CAAA,CAAI1C,CAAAA,CAErC,IAAA,IAAS/vB,CAAAA,CAAI,EAAGA,CAAAA,CAAIyyB,CAAAA,CAAG,KAAA,CAAM,MAAA,CAAQzyB,IAAK,CACxC,IAAMy0B,CAAAA,CAAKhC,CAAAA,CAAG,CAAA,CAAI,CAAA,CAAIzyB,CAAAA,CACtB2e,CAAAA,CAAO8T,EAAG,CAAC,CAAA,CAAGgC,CAAE,CAAA,CAAI5E,EACpBlR,CAAAA,CAAO8T,CAAAA,CAAG,CAAA,CAAIA,CAAAA,CAAG,MAAQ,CAAC,CAAA,CAAGgC,CAAE,CAAA,CAAI5E,CAAAA,CACnC,IAAA,IAASt4B,CAAAA,CAAI,CAAA,CAAGA,EAAIk7B,CAAAA,CAAG,KAAA,CAAMzyB,CAAC,CAAA,CAAG,OAAQzI,CAAAA,EAAAA,CACvConB,CAAAA,CAAO8T,CAAAA,CAAG,CAAA,CAAI,EAAIl7B,CAAC,CAAA,CAAGk9B,CAAE,CAAA,CAAIhC,EAAG,KAAA,CAAMzyB,CAAC,CAAA,CAAGzI,CAAC,EAE9C,CAEA,IAAMm9B,CAAAA,CAAKjC,CAAAA,CAAG,EAAIA,CAAAA,CAAG,MAAA,CAAS,CAAA,CAC9B9T,CAAAA,CAAO8T,EAAG,CAAC,CAAA,CAAGiC,CAAE,CAAA,CAAI1E,CAAAA,CACpB,IAAA,IAASxwB,CAAAA,CAAI,CAAA,CAAGA,EAAIizB,CAAAA,CAAG,KAAA,CAAQ,CAAA,CAAGjzB,CAAAA,EAAAA,CAAKmf,EAAO8T,CAAAA,CAAG,CAAA,CAAIjzB,CAAC,CAAA,CAAGk1B,CAAE,CAAA,CAAI9E,CAAAA,CAC/DjR,CAAAA,CAAO8T,CAAAA,CAAG,CAAA,CAAIA,CAAAA,CAAG,KAAA,CAAQ,CAAC,EAAGiC,CAAE,CAAA,CAAIzE,EACrC,CAEA,OAAO1P,EAAAA,CAAe5B,CAAM,CAAA,CAG5B,SAAS2V,GAAoB,CAC3B,OAAOvU,CAAAA,CAAW,GAAA,CAAM,QAC1B,CACF,CCzXO,SAAS4U,GAAkB/a,CAAAA,CAA+B,CAC/D,IAAM2U,CAAAA,CAAwB,CAC5B,OAAA,CAAS,EAAC,CACV,aAAA,CAAe,EAAC,CAChB,UAAA,CAAY,EACd,CAAA,CAGMqG,CAAAA,CAAW,IAAI,GAAA,CAEjBC,EAA0C,IAAA,CAE1CC,CAAAA,CAAiC,IAAA,CACjCC,CAAAA,CAAa,EAEjB,IAAA,IAASx9B,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIqiB,EAAM,MAAA,CAAQriB,CAAAA,EAAAA,CAAK,CACrC,IAAM2iB,CAAAA,CAAON,CAAAA,CAAMriB,CAAC,CAAA,CAGpB,GAAIu9B,CAAAA,EAAgBC,CAAAA,CAAa,CAAA,CAAG,CAClC,GAAI7a,CAAAA,GAAS,GAAA,CAAK,CAChB6a,CAAAA,EAAAA,CACIA,IAAe,CAAA,GACjBD,CAAAA,CAAe,IAAA,CAAA,CAEjB,QACF,CAGA,IAAME,CAAAA,CAAa9a,CAAAA,CAAK,MAAM,aAAa,CAAA,CAC3C,GAAI8a,CAAAA,CAAY,CACdF,CAAAA,CAAa,UAAA,CAAaE,CAAAA,CAAW,CAAC,EACtC,QACF,CAGA,IAAMC,CAAAA,CAASC,EAAAA,CAAYhb,CAAI,CAAA,CAC3B+a,CAAAA,GACEA,EAAO,QAAA,CACTH,CAAAA,CAAa,OAAA,CAAQ,IAAA,CAAKG,EAAO,MAAM,CAAA,CAEvCH,CAAAA,CAAa,UAAA,CAAW,KAAKG,CAAAA,CAAO,MAAM,CAAA,CAAA,CAG9C,QACF,CAGA,IAAME,CAAAA,CAAUjb,CAAAA,CAAK,KAAA,CAAM,0BAA0B,CAAA,CACrD,GAAIib,CAAAA,CAAS,CACXN,EAAmB,CAAE,IAAA,CAAMM,CAAAA,CAAQ,CAAC,EAAI,QAAA,CAAU,EAAG,CAAA,CACrD,QACF,CAGA,GAAIjb,CAAAA,GAAS,KAAO2a,CAAAA,CAAkB,CACpCtG,CAAAA,CAAQ,UAAA,CAAW,KAAKsG,CAAgB,CAAA,CACxCA,CAAAA,CAAmB,IAAA,CACnB,QACF,CAGA,IAAMO,CAAAA,CAAkBlb,CAAAA,CAAK,KAAA,CAAM,sCAAsC,CAAA,CACzE,GAAIkb,EAAiB,CACnB,IAAM5iB,CAAAA,CAAK4iB,CAAAA,CAAgB,CAAC,CAAA,CACtBC,CAAAA,CAAUD,CAAAA,CAAgB,CAAC,EAC3BE,CAAAA,CAAMC,EAAAA,CAAYX,CAAAA,CAAUpiB,CAAE,CAAA,CAChC6iB,CAAAA,GACFC,CAAAA,CAAI,KAAA,CAAQ,GAAG9iB,CAAE,CAAA,CAAA,EAAI6iB,CAAO,CAAA,CAAA,CAAA,CAAA,CAE9BP,EAAeQ,CAAAA,CACfP,CAAAA,CAAa,CAAA,CACTF,CAAAA,EACFA,EAAiB,QAAA,CAAS,IAAA,CAAKriB,CAAE,CAAA,CAEnC,QACF,CAGA,IAAMgjB,CAAAA,CAAiBtb,CAAAA,CAAK,MAAM,oCAAoC,CAAA,CACtE,GAAIsb,CAAAA,CAAgB,CAClB,IAAMhjB,CAAAA,CAAKgjB,CAAAA,CAAe,CAAC,EACrBH,CAAAA,CAAUG,CAAAA,CAAe,CAAC,CAAA,CAC1BF,CAAAA,CAAMC,EAAAA,CAAYX,CAAAA,CAAUpiB,CAAE,EAChC6iB,CAAAA,GACFC,CAAAA,CAAI,KAAA,CAAQ,CAAA,EAAG9iB,CAAE,CAAA,CAAA,EAAI6iB,CAAO,CAAA,CAAA,CAAA,CAAA,CAE1BR,CAAAA,EACFA,EAAiB,QAAA,CAAS,IAAA,CAAKriB,CAAE,CAAA,CAEnC,QACF,CAGA,IAAMijB,CAAAA,CAAmBvb,EAAK,KAAA,CAAM,wCAAwC,CAAA,CAC5E,GAAIub,EAAkB,CACpB,IAAMH,CAAAA,CAAMC,EAAAA,CAAYX,EAAUa,CAAAA,CAAiB,CAAC,CAAE,CAAA,CACtDH,CAAAA,CAAI,UAAA,CAAaG,CAAAA,CAAiB,CAAC,EACnC,QACF,CAGA,IAAMC,CAAAA,CAAkBxb,EAAK,KAAA,CAAM,qBAAqB,CAAA,CACxD,GAAIwb,EAAiB,CAEnB,IAAM7a,CAAAA,CAAO6a,CAAAA,CAAgB,CAAC,CAAA,CAC9B,GAAI,CAAC7a,CAAAA,CAAK,MAAM,qCAAqC,CAAA,CAAG,CACtD,IAAMya,EAAMC,EAAAA,CAAYX,CAAAA,CAAUc,CAAAA,CAAgB,CAAC,CAAE,CAAA,CAC/CT,CAAAA,CAASC,EAAAA,CAAYra,CAAI,CAAA,CAC3Boa,CAAAA,GACEA,CAAAA,CAAO,QAAA,CACTK,EAAI,OAAA,CAAQ,IAAA,CAAKL,CAAAA,CAAO,MAAM,EAE9BK,CAAAA,CAAI,UAAA,CAAW,IAAA,CAAKL,CAAAA,CAAO,MAAM,CAAA,CAAA,CAGrC,QACF,CACF,CAMA,IAAMU,CAAAA,CAAMC,EAAAA,CAAkB1b,CAAI,EAClC,GAAIyb,CAAAA,CAAK,CAEPJ,EAAAA,CAAYX,EAAUe,CAAAA,CAAI,IAAI,CAAA,CAC9BJ,EAAAA,CAAYX,EAAUe,CAAAA,CAAI,EAAE,CAAA,CAC5BpH,CAAAA,CAAQ,aAAA,CAAc,IAAA,CAAKoH,CAAG,CAAA,CAC9B,QACF,CACF,CAEA,OAAApH,CAAAA,CAAQ,QAAU,CAAC,GAAGqG,CAAAA,CAAS,MAAA,EAAQ,CAAA,CAChCrG,CACT,CAGA,SAASgH,EAAAA,CAAYX,CAAAA,CAAkCpiB,CAAAA,CAAuB,CAC5E,IAAI8iB,CAAAA,CAAMV,CAAAA,CAAS,GAAA,CAAIpiB,CAAE,EACzB,OAAK8iB,CAAAA,GACHA,CAAAA,CAAM,CAAE,GAAA9iB,CAAAA,CAAI,KAAA,CAAOA,CAAAA,CAAI,UAAA,CAAY,EAAC,CAAG,OAAA,CAAS,EAAG,CAAA,CACnDoiB,CAAAA,CAAS,GAAA,CAAIpiB,CAAAA,CAAI8iB,CAAG,CAAA,CAAA,CAEfA,CACT,CAGA,SAASJ,GAAYhb,CAAAA,CAAiE,CACpF,IAAM2b,CAAAA,CAAU3b,CAAAA,CAAK,IAAA,EAAK,CAAE,OAAA,CAAQ,KAAM,EAAE,CAAA,CAC5C,GAAI,CAAC2b,EAAS,OAAO,IAAA,CAGrB,IAAIC,CAAAA,CAAwC,GACxCjb,CAAAA,CAAOgb,CAAAA,CACP,UAAA,CAAW,IAAA,CAAKhb,CAAI,CAAA,GACtBib,CAAAA,CAAajb,CAAAA,CAAK,CAAC,CAAA,CACnBA,CAAAA,CAAOA,CAAAA,CAAK,KAAA,CAAM,CAAC,CAAA,CAAE,IAAA,EAAK,CAAA,CAI5B,IAAMkb,EAAclb,CAAAA,CAAK,KAAA,CAAM,gCAAgC,CAAA,CAC/D,GAAIkb,CAAAA,CAAa,CACf,IAAMj0B,CAAAA,CAAOi0B,EAAY,CAAC,CAAA,CAAG,IAAA,EAAK,CAC5B/kB,EAAO+kB,CAAAA,CAAY,CAAC,CAAA,EAAG,IAAA,GAEvBC,CAAAA,CAAWl0B,CAAAA,CAAK,QAAA,CAAS,GAAG,CAAA,EAAK+Y,CAAAA,CAAK,QAAA,CAAS,GAAG,EAClDob,CAAAA,CAAan0B,CAAAA,CAAK,QAAA,CAAS,GAAG,GAAK+Y,CAAAA,CAAK,QAAA,CAAS,GAAG,CAAA,CAC1D,OAAO,CACL,MAAA,CAAQ,CACN,UAAA,CAAAib,CAAAA,CACA,IAAA,CAAMh0B,CAAAA,CAAK,OAAA,CAAQ,QAAS,EAAE,CAAA,CAC9B,IAAA,CAAMkP,CAAAA,EAAQ,OACd,QAAA,CAAAglB,CAAAA,CACA,UAAA,CAAAC,CACF,EACA,QAAA,CAAU,IACZ,CACF,CAIA,IAAMpvB,CAAAA,CAAQgU,CAAAA,CAAK,KAAA,CAAM,KAAK,CAAA,CAC1B/Y,CAAAA,CACAkP,CAAAA,CAEAnK,CAAAA,CAAM,QAAU,CAAA,EAElBmK,CAAAA,CAAOnK,CAAAA,CAAM,CAAC,EACd/E,CAAAA,CAAO+E,CAAAA,CAAM,KAAA,CAAM,CAAC,CAAA,CAAE,IAAA,CAAK,GAAG,CAAA,EAE9B/E,EAAO+E,CAAAA,CAAM,CAAC,CAAA,EAAKgU,CAAAA,CAGrB,IAAMmb,CAAAA,CAAWl0B,CAAAA,CAAK,QAAA,CAAS,GAAG,EAC5Bm0B,CAAAA,CAAan0B,CAAAA,CAAK,QAAA,CAAS,GAAG,CAAA,CAEpC,OAAO,CACL,MAAA,CAAQ,CACN,UAAA,CAAAg0B,CAAAA,CACA,IAAA,CAAMh0B,CAAAA,CAAK,QAAQ,OAAA,CAAS,EAAE,CAAA,CAC9B,IAAA,CAAMkP,GAAQ,MAAA,CACd,QAAA,CAAAglB,CAAAA,CACA,UAAA,CAAAC,CACF,CAAA,CACA,QAAA,CAAU,KACZ,CACF,CAGA,SAASL,EAAAA,CAAkB1b,CAAAA,CAAwC,CAGjE,IAAMkD,CAAAA,CAAQlD,CAAAA,CAAK,KAAA,CACjB,wIACF,CAAA,CACA,GAAI,CAACkD,CAAAA,CAAO,OAAO,IAAA,CAEnB,IAAMiE,CAAAA,CAAOjE,EAAM,CAAC,CAAA,CACd8Y,CAAAA,CAAkB9Y,CAAAA,CAAM,CAAC,CAAA,EAAK,MAAA,CAC9BiS,CAAAA,CAAQjS,CAAAA,CAAM,CAAC,CAAA,CAAG,IAAA,EAAK,CACvB+Y,CAAAA,CAAgB/Y,EAAM,CAAC,CAAA,EAAK,MAAA,CAC5BkE,CAAAA,CAAKlE,EAAM,CAAC,CAAA,CACZjlB,CAAAA,CAAQilB,CAAAA,CAAM,CAAC,CAAA,EAAG,IAAA,EAAK,EAAK,MAAA,CAE5B2D,EAASqV,EAAAA,CAAW/G,CAAK,CAAA,CAC/B,OAAKtO,CAAAA,CAEE,CAAE,IAAA,CAAAM,CAAAA,CAAM,GAAAC,CAAAA,CAAI,IAAA,CAAMP,CAAAA,CAAO,IAAA,CAAM,SAAUA,CAAAA,CAAO,QAAA,CAAU,KAAA,CAAA5oB,CAAAA,CAAO,gBAAA+9B,CAAAA,CAAiB,aAAA,CAAAC,CAAc,CAAA,CAFnF,IAGtB,CAOA,SAASC,EAAAA,CAAW/G,EAA2E,CAC7F,OAAQA,CAAAA,EACN,KAAK,MAAA,CAAQ,OAAO,CAAE,IAAA,CAAM,cAAgB,QAAA,CAAU,MAAO,CAAA,CAC7D,KAAK,MAAA,CAAQ,OAAO,CAAE,IAAA,CAAM,cAAgB,QAAA,CAAU,MAAO,CAAA,CAC7D,KAAK,MAAQ,OAAO,CAAE,IAAA,CAAM,aAAA,CAAgB,SAAU,MAAO,CAAA,CAC7D,KAAK,KAAA,CAAQ,OAAO,CAAE,IAAA,CAAM,aAAA,CAAgB,SAAU,IAAK,CAAA,CAC3D,KAAK,KAAA,CAAQ,OAAO,CAAE,IAAA,CAAM,aAAA,CAAgB,QAAA,CAAU,MAAO,CAAA,CAC7D,KAAK,KAAA,CAAQ,OAAO,CAAE,IAAA,CAAM,aAAA,CAAgB,QAAA,CAAU,IAAK,CAAA,CAC3D,KAAK,KAAA,CAAQ,OAAO,CAAE,IAAA,CAAM,aAAA,CAAgB,QAAA,CAAU,IAAK,EAC3D,KAAK,KAAA,CAAQ,OAAO,CAAE,IAAA,CAAM,YAAA,CAAgB,QAAA,CAAU,IAAK,EAC3D,KAAK,MAAA,CAAQ,OAAO,CAAE,KAAM,aAAA,CAAgB,QAAA,CAAU,IAAK,CAAA,CAC3D,KAAK,IAAA,CAAQ,OAAO,CAAE,IAAA,CAAM,aAAA,CAAgB,QAAA,CAAU,IAAK,CAAA,CAC3D,QAAa,OAAO,IACtB,CACF,CC7PA,SAASgH,EAAAA,CAAa1E,CAAAA,CAAwB,CAC5C,IAAM2E,EAAM3E,CAAAA,CAAE,UAAA,EAAc,EAAA,CACtB3gB,CAAAA,CAAO2gB,EAAE,IAAA,CAAO,CAAA,EAAA,EAAKA,CAAAA,CAAE,IAAI,GAAK,EAAA,CACtC,OAAO,CAAA,EAAG2E,CAAG,GAAG3E,CAAAA,CAAE,IAAI,CAAA,EAAG3gB,CAAI,EAC/B,CAGA,SAASulB,EAAAA,CAAmBjB,CAAAA,CAA4B,CAEtD,IAAMzb,CAAAA,CAAmB,GACrByb,CAAAA,CAAI,UAAA,EAAYzb,CAAAA,CAAO,IAAA,CAAK,KAAKyb,CAAAA,CAAI,UAAU,CAAA,EAAA,CAAI,CAAA,CACvDzb,EAAO,IAAA,CAAKyb,CAAAA,CAAI,KAAK,CAAA,CAGrB,IAAMz7B,CAAAA,CAAQy7B,CAAAA,CAAI,UAAA,CAAW,IAAIe,EAAY,CAAA,CAGvCG,CAAAA,CAAUlB,CAAAA,CAAI,QAAQ,GAAA,CAAIe,EAAY,CAAA,CAG5C,OAAIx8B,EAAM,MAAA,GAAW,CAAA,EAAK28B,CAAAA,CAAQ,MAAA,GAAW,CAAA,CAAU,CAAC3c,CAAM,CAAA,CAE1D2c,EAAQ,MAAA,GAAW,CAAA,CAAU,CAAC3c,CAAAA,CAAQhgB,CAAK,CAAA,CAExC,CAACggB,CAAAA,CAAQhgB,CAAAA,CAAO28B,CAAO,CAChC,CAmBA,SAASC,EAAAA,CAAazlB,EAAwB0lB,CAAAA,CAAoC,CAEhF,OAAO,CAAE,KAAA1lB,CAAAA,CAAM,QAAA,CAAA0lB,CAAAA,CAAU,MAAA,CADV1lB,IAAS,YAAA,EAAgBA,CAAAA,GAAS,aACjB,CAClC,CAOA,SAAS2lB,EAAAA,CACP3lB,CAAAA,CACA+O,CAAAA,CACA6W,CAAAA,CACQ,CACR,OAAQ5lB,CAAAA,EACN,KAAK,aAAA,CACL,KAAK,aAAA,CAGH,OAAI4lB,CAAAA,GAAc,MAAA,CAET7W,CAAAA,CAAW,GAAA,CAAM,SACf6W,CAAAA,GAAc,IAAA,CAEhB7W,CAAAA,CAAW,GAAA,CAAM,QAAA,CACf6W,CAAAA,GAAc,MAAA,CAEhB7W,CAAAA,CAAW,IAAM,QAAA,CAGjBA,CAAAA,CAAW,GAAA,CAAM,QAAA,CAE5B,KAAK,aAAA,CAEH,OAAOA,CAAAA,CAAW,GAAA,CAAM,SAC1B,KAAK,aAAA,CAEH,OAAOA,CAAAA,CAAW,GAAA,CAAM,QAAA,CAC1B,KAAK,aAAA,CACL,KAAK,YAAA,CAEH,OAAI6W,CAAAA,GAAc,MAAA,CACT7W,EAAW,GAAA,CAAM,QAAA,CACf6W,CAAAA,GAAc,IAAA,CAChB7W,EAAW,GAAA,CAAM,QAAA,CACf6W,CAAAA,GAAc,MAAA,CAChB7W,EAAW,GAAA,CAAM,QAAA,CAGjBA,CAAAA,CAAW,GAAA,CAAM,QAE9B,CACF,CAqBO,SAAS8W,EAAAA,CAAiBld,EAAcqH,CAAAA,CAA6B,CAC1E,IAAMpH,CAAAA,CAAQD,EAAK,KAAA,CAAM;AAAA,CAAI,CAAA,CAAE,GAAA,CAAI3Z,CAAAA,EAAKA,CAAAA,CAAE,IAAA,EAAM,CAAA,CAAE,MAAA,CAAOA,CAAAA,EAAKA,CAAAA,CAAE,MAAA,CAAS,CAAA,EAAK,CAACA,CAAAA,CAAE,UAAA,CAAW,IAAI,CAAC,CAAA,CAC3FuuB,CAAAA,CAAUoG,GAAkB/a,CAAK,CAAA,CAEvC,GAAI2U,CAAAA,CAAQ,OAAA,CAAQ,MAAA,GAAW,EAAG,OAAO,EAAA,CAEzC,IAAMxO,CAAAA,CAAWiB,CAAAA,CAAO,QAAA,CAClB8V,EAAO,CAAA,CACPC,CAAAA,CAAO,CAAA,CAGPC,CAAAA,CAAgB,IAAI,GAAA,CACpBC,EAAY,IAAI,GAAA,CAChBC,CAAAA,CAAY,IAAI,GAAA,CAEtB,IAAA,IAAW5B,CAAAA,IAAO/G,CAAAA,CAAQ,OAAA,CAAS,CACjC,IAAM7H,CAAAA,CAAW6P,EAAAA,CAAmBjB,CAAG,EACvC0B,CAAAA,CAAc,GAAA,CAAI1B,CAAAA,CAAI,EAAA,CAAI5O,CAAQ,CAAA,CAGlC,IAAIyQ,CAAAA,CAAW,CAAA,CACf,IAAA,IAAWtQ,CAAAA,IAAWH,CAAAA,CACpB,IAAA,IAAWxM,KAAQ2M,CAAAA,CAASsQ,CAAAA,CAAW,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAUjd,CAAAA,CAAK,MAAM,CAAA,CAEvE,IAAMkd,CAAAA,CAAOD,CAAAA,CAAW,CAAA,CAEpBpQ,CAAAA,CAAa,EACjB,IAAA,IAAWF,CAAAA,IAAWH,CAAAA,CAAUK,CAAAA,EAAc,IAAA,CAAK,GAAA,CAAIF,EAAQ,MAAA,CAAQ,CAAC,CAAA,CACxE,IAAMwQ,CAAAA,CAAOtQ,CAAAA,EAAcL,EAAS,MAAA,CAAS,CAAA,CAAA,CAAK,CAAA,CAElDuQ,CAAAA,CAAU,GAAA,CAAI3B,CAAAA,CAAI,EAAA,CAAI8B,CAAI,CAAA,CAC1BF,CAAAA,CAAU,GAAA,CAAI5B,CAAAA,CAAI,EAAA,CAAI+B,CAAI,EAC5B,CAWA,IAAMC,CAAAA,CAAY,IAAI,GAAA,CACtB,IAAA,IAAWhC,KAAO/G,CAAAA,CAAQ,OAAA,CAAS+I,CAAAA,CAAU,GAAA,CAAIhC,CAAAA,CAAI,EAAA,CAAIA,CAAG,CAAA,CAE5D,IAAM7f,CAAAA,CAAU,IAAI,GAAA,CACd7c,CAAAA,CAAW,IAAI,GAAA,CAErB,IAAA,IAAW+8B,CAAAA,IAAOpH,CAAAA,CAAQ,aAAA,CAAe,CAKvC,IAAMgJ,CAAAA,CAAiB5B,CAAAA,CAAI,IAAA,GAAS,aAAA,EAAiBA,CAAAA,CAAI,IAAA,GAAS,cAC5D6B,CAAAA,CAAWD,CAAAA,EAAkB5B,CAAAA,CAAI,QAAA,GAAa,IAAA,CAAOA,CAAAA,CAAI,GAAKA,CAAAA,CAAI,IAAA,CAClE8B,CAAAA,CAAUF,CAAAA,EAAkB5B,CAAAA,CAAI,QAAA,GAAa,IAAA,CAAOA,CAAAA,CAAI,IAAA,CAAOA,CAAAA,CAAI,EAAA,CAEpElgB,CAAAA,CAAQ,GAAA,CAAIgiB,CAAO,GAAGhiB,CAAAA,CAAQ,GAAA,CAAIgiB,CAAAA,CAAS,IAAI,GAAK,CAAA,CACzDhiB,EAAQ,GAAA,CAAIgiB,CAAO,CAAA,CAAG,GAAA,CAAID,CAAQ,CAAA,CAC7B5+B,EAAS,GAAA,CAAI4+B,CAAQ,CAAA,EAAG5+B,CAAAA,CAAS,GAAA,CAAI4+B,CAAAA,CAAU,IAAI,GAAK,CAAA,CAC7D5+B,CAAAA,CAAS,GAAA,CAAI4+B,CAAQ,CAAA,CAAG,GAAA,CAAIC,CAAO,EACrC,CAMA,IAAMC,CAAAA,CAAQ,IAAI,GAAA,CAEZC,EADQpJ,CAAAA,CAAQ,OAAA,CAAQ,MAAA,CAAO/2B,CAAAA,EAAK,CAACie,CAAAA,CAAQ,IAAIje,CAAAA,CAAE,EAAE,CAAA,EAAKie,CAAAA,CAAQ,GAAA,CAAIje,CAAAA,CAAE,EAAE,CAAA,CAAG,IAAA,GAAS,CAAC,CAAA,CAC/D,GAAA,CAAIA,CAAAA,EAAKA,CAAAA,CAAE,EAAE,CAAA,CAC3C,IAAA,IAAWgb,CAAAA,IAAMmlB,CAAAA,CAAOD,CAAAA,CAAM,GAAA,CAAIllB,EAAI,CAAC,CAAA,CAEvC,IAAMolB,CAAAA,CAAWrJ,CAAAA,CAAQ,OAAA,CAAQ,OAAS,CAAA,CACtCsJ,CAAAA,CAAK,CAAA,CACT,KAAOA,CAAAA,CAAKF,CAAAA,CAAM,QAAQ,CACxB,IAAMnlB,CAAAA,CAAKmlB,CAAAA,CAAME,CAAAA,EAAI,CAAA,CACfC,EAAWl/B,CAAAA,CAAS,GAAA,CAAI4Z,CAAE,CAAA,CAChC,GAAKslB,CAAAA,CACL,QAAWL,CAAAA,IAAWK,CAAAA,CAAU,CAC9B,IAAMC,CAAAA,CAAAA,CAAYL,CAAAA,CAAM,IAAIllB,CAAE,CAAA,EAAK,CAAA,EAAK,CAAA,CACpCulB,CAAAA,CAAWH,CAAAA,EAAAA,CACX,CAACF,CAAAA,CAAM,GAAA,CAAID,CAAO,CAAA,EAAKC,CAAAA,CAAM,GAAA,CAAID,CAAO,EAAKM,CAAAA,IAC/CL,CAAAA,CAAM,GAAA,CAAID,CAAAA,CAASM,CAAQ,CAAA,CAC3BJ,EAAM,IAAA,CAAKF,CAAO,CAAA,EAEtB,CACF,CAGA,IAAA,IAAWnC,KAAO/G,CAAAA,CAAQ,OAAA,CACnBmJ,CAAAA,CAAM,GAAA,CAAIpC,CAAAA,CAAI,EAAE,GAAGoC,CAAAA,CAAM,GAAA,CAAIpC,CAAAA,CAAI,EAAA,CAAI,CAAC,CAAA,CAK7C,IAAM0C,CAAAA,CAAW,IAAA,CAAK,GAAA,CAAQ,GAAGN,CAAAA,CAAM,MAAA,GAAW,CAAC,CAAA,CAC7CO,CAAAA,CAA0B,KAAA,CAAM,IAAA,CAAK,CAAE,OAAQD,CAAAA,CAAW,CAAE,CAAA,CAAG,IAAM,EAAE,CAAA,CAC7E,IAAA,IAAW1C,CAAAA,IAAO/G,CAAAA,CAAQ,OAAA,CACxB0J,CAAAA,CAAYP,CAAAA,CAAM,GAAA,CAAIpC,EAAI,EAAE,CAAE,CAAA,CAAG,IAAA,CAAKA,CAAAA,CAAI,EAAE,EAI9C,IAAM4C,CAAAA,CAAS,IAAI,GAAA,CACfC,CAAAA,CAAW,CAAA,CAEf,QAASC,CAAAA,CAAK,CAAA,CAAGA,CAAAA,EAAMJ,CAAAA,CAAUI,CAAAA,EAAAA,CAAM,CACrC,IAAMC,CAAAA,CAAQJ,CAAAA,CAAYG,CAAE,CAAA,CAC5B,GAAIC,CAAAA,CAAM,SAAW,CAAA,CAAG,SAExB,IAAIC,CAAAA,CAAW,CAAA,CACXC,CAAAA,CAAO,EAEX,IAAA,IAAW/lB,CAAAA,IAAM6lB,CAAAA,CAAO,CACtB,IAAM/C,CAAAA,CAAMgC,EAAU,GAAA,CAAI9kB,CAAE,CAAA,CACtB1Y,CAAAA,CAAIm9B,CAAAA,CAAU,GAAA,CAAIzkB,CAAE,CAAA,CACpB5X,CAAAA,CAAIs8B,CAAAA,CAAU,GAAA,CAAI1kB,CAAE,CAAA,CAC1B0lB,CAAAA,CAAO,IAAI1lB,CAAAA,CAAI,CACb,GAAA,CAAA8iB,CAAAA,CACA,QAAA,CAAU0B,CAAAA,CAAc,IAAIxkB,CAAE,CAAA,CAC9B,CAAA,CAAG8lB,CAAAA,CACH,CAAA,CAAGH,CAAAA,CACH,MAAOr+B,CAAAA,CACP,MAAA,CAAQc,CACV,CAAC,CAAA,CACD09B,CAAAA,EAAYx+B,CAAAA,CAAIg9B,CAAAA,CAChByB,CAAAA,CAAO,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAM39B,CAAC,EACzB,CAEAu9B,CAAAA,EAAYI,CAAAA,CAAOxB,EACrB,CAGA,IAAIxE,CAAAA,CAAS,EACTH,CAAAA,CAAS,CAAA,CACb,IAAA,IAAW1yB,CAAAA,IAAKw4B,CAAAA,CAAO,MAAA,GACrB3F,CAAAA,CAAS,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAQ7yB,CAAAA,CAAE,CAAA,CAAIA,CAAAA,CAAE,KAAK,CAAA,CACvC0yB,CAAAA,CAAS,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAQ1yB,CAAAA,CAAE,EAAIA,CAAAA,CAAE,MAAM,CAAA,CAI1C6yB,CAAAA,EAAU,CAAA,CACVH,CAAAA,EAAU,EAEV,IAAMzT,CAAAA,CAASD,EAAAA,CAAS6T,CAAAA,CAAS,CAAA,CAAGH,CAAAA,CAAS,CAAC,CAAA,CAG9C,IAAA,IAAW1yB,CAAAA,IAAKw4B,CAAAA,CAAO,MAAA,EAAO,CAAG,CAC/B,IAAMM,CAAAA,CAAY/R,EAAAA,CAAa/mB,CAAAA,CAAE,QAAA,CAAUqgB,CAAQ,EAEnD,IAAA,IAAS0Y,CAAAA,CAAK,CAAA,CAAGA,CAAAA,CAAKD,CAAAA,CAAU,MAAA,CAAQC,IACtC,IAAA,IAAS/D,CAAAA,CAAK,CAAA,CAAGA,CAAAA,CAAK8D,CAAAA,CAAU,CAAC,EAAG,MAAA,CAAQ9D,CAAAA,EAAAA,CAAM,CAChD,IAAMgE,CAAAA,CAAKF,CAAAA,CAAUC,CAAE,CAAA,CAAG/D,CAAE,CAAA,CAC5B,GAAIgE,CAAAA,GAAO,GAAA,CAAK,CACd,IAAM/F,CAAAA,CAAKjzB,CAAAA,CAAE,CAAA,CAAI+4B,CAAAA,CACXE,CAAAA,CAAKj5B,CAAAA,CAAE,EAAIg1B,CAAAA,CACb/B,CAAAA,CAAKJ,CAAAA,EAAUoG,CAAAA,CAAKvG,CAAAA,GACtBzT,CAAAA,CAAOgU,CAAE,CAAA,CAAGgG,CAAE,CAAA,CAAID,CAAAA,EAEtB,CACF,CAEJ,CAGA,IAAM9I,CAAAA,CAAI7P,CAAAA,CAAW,GAAA,CAAM,QAAA,CACrB8P,CAAAA,CAAI9P,EAAW,GAAA,CAAM,QAAA,CACrB6Y,CAAAA,CAAQ7Y,CAAAA,CAAW,GAAA,CAAM,QAAA,CACzB8Y,EAAQ9Y,CAAAA,CAAW,GAAA,CAAM,QAAA,CAE/B,IAAA,IAAW4V,CAAAA,IAAOpH,CAAAA,CAAQ,cAAe,CACvC,IAAMuK,CAAAA,CAAQZ,CAAAA,CAAO,GAAA,CAAIvC,CAAAA,CAAI,IAAI,CAAA,CAC3BoD,CAAAA,CAAMb,CAAAA,CAAO,GAAA,CAAIvC,CAAAA,CAAI,EAAE,CAAA,CAC7B,GAAI,CAACmD,CAAAA,EAAS,CAACC,CAAAA,CAAK,SAEpB,IAAMC,EAASvC,EAAAA,CAAad,CAAAA,CAAI,IAAA,CAAMA,CAAAA,CAAI,QAAQ,CAAA,CAC5CsD,EAAQD,CAAAA,CAAO,MAAA,CAASJ,CAAAA,CAAQhJ,CAAAA,CAChCsJ,CAAAA,CAAQF,CAAAA,CAAO,OAASH,CAAAA,CAAQhJ,CAAAA,CAGhCsJ,CAAAA,CAASL,CAAAA,CAAM,CAAA,CAAI,IAAA,CAAK,MAAMA,CAAAA,CAAM,KAAA,CAAQ,CAAC,CAAA,CAC7CM,CAAAA,CAASN,CAAAA,CAAM,EAAIA,CAAAA,CAAM,MAAA,CAAS,CAAA,CAClCO,CAAAA,CAAON,CAAAA,CAAI,CAAA,CAAI,KAAK,KAAA,CAAMA,CAAAA,CAAI,KAAA,CAAQ,CAAC,CAAA,CACvCO,CAAAA,CAAOP,CAAAA,CAAI,CAAA,CAKjB,GAAIK,CAAAA,CAASE,CAAAA,CAAM,CAEjB,IAAMC,CAAAA,CAAOH,EAAS,IAAA,CAAK,KAAA,CAAA,CAAOE,CAAAA,CAAOF,CAAAA,EAAU,CAAC,CAAA,CAGpD,QAAS35B,CAAAA,CAAI25B,CAAAA,CAAS,CAAA,CAAG35B,CAAAA,EAAK85B,CAAAA,CAAM95B,CAAAA,EAAAA,CAC9BA,EAAI2yB,CAAAA,GAAQzT,CAAAA,CAAOwa,CAAM,CAAA,CAAG15B,CAAC,CAAA,CAAIy5B,CAAAA,CAAAA,CAIvC,GAAIC,CAAAA,GAAWE,CAAAA,CAAM,CACnB,IAAM1F,CAAAA,CAAK,IAAA,CAAK,IAAIwF,CAAAA,CAAQE,CAAI,CAAA,CAC1BG,CAAAA,CAAK,IAAA,CAAK,GAAA,CAAIL,EAAQE,CAAI,CAAA,CAChC,IAAA,IAAS75B,CAAAA,CAAIm0B,CAAAA,CAAIn0B,CAAAA,EAAKg6B,EAAIh6B,CAAAA,EAAAA,CACpBA,CAAAA,CAAI+yB,CAAAA,EAAUgH,CAAAA,CAAOnH,CAAAA,GAAQzT,CAAAA,CAAOnf,CAAC,CAAA,CAAG+5B,CAAI,CAAA,CAAIN,CAAAA,CAAAA,CAGlD,CAAClZ,CAAAA,EAAYwZ,CAAAA,CAAOnH,IAClB+G,CAAAA,CAASE,CAAAA,EACX1a,CAAAA,CAAOwa,CAAM,CAAA,CAAGI,CAAI,EAAI,QAAA,CACxB5a,CAAAA,CAAO0a,CAAI,CAAA,CAAGE,CAAI,CAAA,CAAI,WAEtB5a,CAAAA,CAAOwa,CAAM,CAAA,CAAGI,CAAI,CAAA,CAAI,QAAA,CACxB5a,EAAO0a,CAAI,CAAA,CAAGE,CAAI,CAAA,CAAI,QAAA,CAAA,EAG5B,CAGA,QAAS95B,CAAAA,CAAI85B,CAAAA,CAAO,CAAA,CAAG95B,CAAAA,CAAI65B,CAAAA,CAAM75B,CAAAA,EAAAA,CAC3BA,EAAI2yB,CAAAA,GAAQzT,CAAAA,CAAO0a,CAAI,CAAA,CAAG55B,CAAC,CAAA,CAAIy5B,GAIrC,GAAIF,CAAAA,CAAO,QAAA,GAAa,IAAA,CAAM,CAE5B,IAAMS,CAAAA,CAAa9C,EAAAA,CAAeqC,CAAAA,CAAO,IAAA,CAAMjZ,CAAAA,CAAU,MAAM,CAAA,CACzDO,CAAAA,CAAKgZ,EAAO,CAAA,CAClB,GAAIhZ,CAAAA,EAAM,CAAA,EAAKA,CAAAA,CAAK8R,CAAAA,CAClB,QAAS76B,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIkiC,CAAAA,CAAW,MAAA,CAAQliC,CAAAA,EAAAA,CAAK,CAC1C,IAAM8oB,CAAAA,CAAKgZ,CAAAA,CAAO,IAAA,CAAK,KAAA,CAAMI,CAAAA,CAAW,MAAA,CAAS,CAAC,CAAA,CAAIliC,CAAAA,CAClD8oB,CAAAA,EAAM,CAAA,EAAKA,CAAAA,CAAKkS,CAAAA,GAAQ5T,EAAO0B,CAAE,CAAA,CAAGC,CAAE,CAAA,CAAImZ,CAAAA,CAAWliC,CAAC,GAC5D,CAEJ,CACA,GAAIyhC,CAAAA,CAAO,QAAA,GAAa,MAAA,CAAQ,CAE9B,IAAMS,CAAAA,CAAa9C,EAAAA,CAAeqC,CAAAA,CAAO,IAAA,CAAMjZ,CAAAA,CAAU,MAAM,CAAA,CACzDO,CAAAA,CAAK8Y,CAAAA,CAAS,CAAA,CACpB,GAAI9Y,CAAAA,CAAK8R,CAAAA,CACP,QAAS76B,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIkiC,CAAAA,CAAW,MAAA,CAAQliC,CAAAA,EAAAA,CAAK,CAC1C,IAAM8oB,CAAAA,CAAK8Y,CAAAA,CAAS,IAAA,CAAK,KAAA,CAAMM,CAAAA,CAAW,OAAS,CAAC,CAAA,CAAIliC,CAAAA,CACpD8oB,CAAAA,EAAM,CAAA,EAAKA,CAAAA,CAAKkS,IAAQ5T,CAAAA,CAAO0B,CAAE,CAAA,CAAGC,CAAE,CAAA,CAAImZ,CAAAA,CAAWliC,CAAC,CAAA,EAC5D,CAEJ,CACF,CAAA,KAAA,GAAWwhC,CAAAA,CAAI,CAAA,CAAIA,EAAI,MAAA,CAAS,CAAA,CAAID,CAAAA,CAAM,CAAA,CAAG,CAE3C,IAAMY,EAASZ,CAAAA,CAAM,CAAA,CACfa,CAAAA,CAAOZ,CAAAA,CAAI,CAAA,CAAIA,CAAAA,CAAI,MAAA,CAAS,CAAA,CAC5BQ,CAAAA,CAAOI,CAAAA,CAAO,IAAA,CAAK,KAAA,CAAA,CAAOD,CAAAA,CAASC,CAAAA,EAAQ,CAAC,CAAA,CAElD,IAAA,IAASl6B,CAAAA,CAAIi6B,CAAAA,CAAS,CAAA,CAAGj6B,CAAAA,EAAK85B,EAAM95B,CAAAA,EAAAA,CAC9BA,CAAAA,EAAK,CAAA,EAAKA,CAAAA,CAAI2yB,CAAAA,GAAQzT,CAAAA,CAAOwa,CAAM,CAAA,CAAG15B,CAAC,CAAA,CAAIy5B,CAAAA,CAAAA,CAGjD,GAAIC,CAAAA,GAAWE,CAAAA,CAAM,CACnB,IAAM1F,CAAAA,CAAK,IAAA,CAAK,GAAA,CAAIwF,CAAAA,CAAQE,CAAI,EAC1BG,CAAAA,CAAK,IAAA,CAAK,GAAA,CAAIL,CAAAA,CAAQE,CAAI,CAAA,CAChC,QAAS75B,CAAAA,CAAIm0B,CAAAA,CAAIn0B,CAAAA,EAAKg6B,CAAAA,CAAIh6B,CAAAA,EAAAA,CACpBA,CAAAA,CAAI+yB,GAAUgH,CAAAA,EAAQ,CAAA,EAAKA,CAAAA,CAAOnH,CAAAA,GAAQzT,CAAAA,CAAOnf,CAAC,CAAA,CAAG+5B,CAAI,CAAA,CAAIN,CAAAA,CAAAA,CAE/D,CAAClZ,CAAAA,EAAYwZ,CAAAA,EAAQ,CAAA,EAAKA,EAAOnH,CAAAA,GAC/B+G,CAAAA,CAASE,CAAAA,EACX1a,CAAAA,CAAOwa,CAAM,CAAA,CAAGI,CAAI,CAAA,CAAI,QAAA,CACxB5a,CAAAA,CAAO0a,CAAI,CAAA,CAAGE,CAAI,EAAI,QAAA,GAEtB5a,CAAAA,CAAOwa,CAAM,CAAA,CAAGI,CAAI,CAAA,CAAI,SACxB5a,CAAAA,CAAO0a,CAAI,CAAA,CAAGE,CAAI,CAAA,CAAI,QAAA,CAAA,EAG5B,CAEA,IAAA,IAAS95B,CAAAA,CAAI85B,CAAAA,CAAO,CAAA,CAAG95B,CAAAA,CAAIk6B,CAAAA,CAAMl6B,IAC3BA,CAAAA,EAAK,CAAA,EAAKA,CAAAA,CAAI2yB,CAAAA,GAAQzT,CAAAA,CAAO0a,CAAI,EAAG55B,CAAC,CAAA,CAAIy5B,CAAAA,CAAAA,CAI/C,GAAIF,CAAAA,CAAO,QAAA,GAAa,MAAA,CAAQ,CAE9B,IAAMS,CAAAA,CAAa9C,EAAAA,CAAeqC,CAAAA,CAAO,IAAA,CAAMjZ,CAAAA,CAAU,IAAI,CAAA,CACvDO,CAAAA,CAAKoZ,CAAAA,CAAS,CAAA,CACpB,GAAIpZ,CAAAA,EAAM,GAAKA,CAAAA,CAAK8R,CAAAA,CAClB,IAAA,IAAS76B,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIkiC,EAAW,MAAA,CAAQliC,CAAAA,EAAAA,CAAK,CAC1C,IAAM8oB,CAAAA,CAAK8Y,CAAAA,CAAS,KAAK,KAAA,CAAMM,CAAAA,CAAW,MAAA,CAAS,CAAC,CAAA,CAAIliC,CAAAA,CACpD8oB,GAAM,CAAA,EAAKA,CAAAA,CAAKkS,CAAAA,GAAQ5T,CAAAA,CAAO0B,CAAE,CAAA,CAAGC,CAAE,CAAA,CAAImZ,CAAAA,CAAWliC,CAAC,CAAA,EAC5D,CAEJ,CACA,GAAIyhC,CAAAA,CAAO,QAAA,GAAa,IAAA,CAAM,CAK5B,IAAMY,CAAAA,CADiBZ,CAAAA,CAAO,IAAA,GAAS,aAAA,EAAiBA,CAAAA,CAAO,IAAA,GAAS,aAAA,CACrC,MAAA,CAAS,IAAA,CACtCS,EAAa9C,EAAAA,CAAeqC,CAAAA,CAAO,IAAA,CAAMjZ,CAAAA,CAAU6Z,CAAS,CAAA,CAC5DtZ,EAAKqZ,CAAAA,CAAO,CAAA,CAClB,GAAIrZ,CAAAA,CAAK8R,CAAAA,CACP,IAAA,IAAS76B,EAAI,CAAA,CAAGA,CAAAA,CAAIkiC,CAAAA,CAAW,MAAA,CAAQliC,CAAAA,EAAAA,CAAK,CAC1C,IAAM8oB,CAAAA,CAAKgZ,CAAAA,CAAO,IAAA,CAAK,KAAA,CAAMI,CAAAA,CAAW,MAAA,CAAS,CAAC,CAAA,CAAIliC,CAAAA,CAClD8oB,CAAAA,EAAM,CAAA,EAAKA,CAAAA,CAAKkS,CAAAA,GAAQ5T,EAAO0B,CAAE,CAAA,CAAGC,CAAE,CAAA,CAAImZ,CAAAA,CAAWliC,CAAC,GAC5D,CAEJ,CACF,CAAA,KAAO,CAEL,IAAMsiC,CAAAA,CAAU,IAAA,CAAK,GAAA,CAAIT,CAAAA,CAAQL,CAAAA,CAAI,CAAA,CAAIA,CAAAA,CAAI,MAAA,CAAS,CAAC,EAAI,CAAA,CAC3Dha,EAAAA,CAAaJ,CAAAA,CAAQ4T,CAAAA,CAAQsH,CAAAA,CAAU,CAAC,EAGxC,IAAA,IAASp6B,CAAAA,CAAI25B,CAAAA,CAAS,CAAA,CAAG35B,CAAAA,EAAKo6B,CAAAA,CAASp6B,IACrCkf,CAAAA,CAAOwa,CAAM,CAAA,CAAG15B,CAAC,CAAA,CAAIy5B,CAAAA,CAGvB,IAAMvF,CAAAA,CAAK,IAAA,CAAK,GAAA,CAAIwF,CAAAA,CAAQE,CAAI,CAAA,CAC1BG,CAAAA,CAAK,KAAK,GAAA,CAAIL,CAAAA,CAAQE,CAAI,CAAA,CAChC,IAAA,IAAS75B,CAAAA,CAAIm0B,EAAIn0B,CAAAA,EAAKg6B,CAAAA,CAAIh6B,CAAAA,EAAAA,CACxBmf,CAAAA,CAAOnf,CAAC,CAAA,CAAGq6B,CAAO,CAAA,CAAIZ,CAAAA,CAGxB,IAAA,IAASx5B,CAAAA,CAAIo6B,CAAAA,CAAU,CAAA,CAAGp6B,CAAAA,EAAKs5B,CAAAA,CAAI,CAAA,CAAIA,CAAAA,CAAI,MAAA,CAAQt5B,CAAAA,EAAAA,CACjDkf,CAAAA,CAAO0a,CAAI,EAAG55B,CAAC,CAAA,CAAIy5B,CAAAA,CAIrB,GAAIF,CAAAA,CAAO,QAAA,GAAa,OAAQ,CAE9B,IAAMS,CAAAA,CAAa9C,EAAAA,CAAeqC,CAAAA,CAAO,IAAA,CAAMjZ,EAAU,MAAM,CAAA,CACzDO,CAAAA,CAAK8Y,CAAAA,CAAS,CAAA,CACpB,GAAI9Y,EAAK8R,CAAAA,CACP,IAAA,IAAS76B,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIkiC,CAAAA,CAAW,OAAQliC,CAAAA,EAAAA,CAAK,CAC1C,IAAM8oB,CAAAA,CAAK8Y,CAAAA,CAAS,IAAA,CAAK,MAAMM,CAAAA,CAAW,MAAA,CAAS,CAAC,CAAA,CAAIliC,CAAAA,CACpD8oB,CAAAA,EAAM,GAAKA,CAAAA,CAAKkS,CAAAA,GAAQ5T,CAAAA,CAAO0B,CAAE,CAAA,CAAGC,CAAE,CAAA,CAAImZ,CAAAA,CAAWliC,CAAC,CAAA,EAC5D,CAEJ,CACA,GAAIyhC,CAAAA,CAAO,WAAa,IAAA,CAAM,CAE5B,IAAMS,CAAAA,CAAa9C,EAAAA,CAAeqC,CAAAA,CAAO,KAAMjZ,CAAAA,CAAU,IAAI,CAAA,CACvDO,CAAAA,CAAKyY,CAAAA,CAAI,CAAA,CAAIA,EAAI,MAAA,CACvB,GAAIzY,CAAAA,CAAK8R,CAAAA,CACP,IAAA,IAAS76B,CAAAA,CAAI,EAAGA,CAAAA,CAAIkiC,CAAAA,CAAW,MAAA,CAAQliC,CAAAA,EAAAA,CAAK,CAC1C,IAAM8oB,EAAKgZ,CAAAA,CAAO,IAAA,CAAK,KAAA,CAAMI,CAAAA,CAAW,MAAA,CAAS,CAAC,EAAIliC,CAAAA,CAClD8oB,CAAAA,EAAM,CAAA,EAAKA,CAAAA,CAAKkS,CAAAA,GAAQ5T,CAAAA,CAAO0B,CAAE,CAAA,CAAGC,CAAE,CAAA,CAAImZ,CAAAA,CAAWliC,CAAC,CAAA,EAC5D,CAEJ,CACF,CAIA,GAAIo+B,CAAAA,CAAI,KAAA,CAAO,CACb,IAAMmE,EAAc,CAAA,CAAA,EAAInE,CAAAA,CAAI,KAAK,CAAA,CAAA,CAAA,CAC3BoE,CAAAA,CAAO,IAAA,CAAK,OAAOZ,CAAAA,CAASE,CAAAA,EAAQ,CAAC,CAAA,CAEvCE,CAAAA,CACJ,GAAIH,EAASE,CAAAA,CAEXC,CAAAA,CAAO,IAAA,CAAK,KAAA,CAAA,CAAOH,CAAAA,CAAS,CAAA,CAAIE,EAAO,CAAA,EAAK,CAAC,CAAA,CAAA,KAAA,GACpCP,CAAAA,CAAI,CAAA,CAAIA,CAAAA,CAAI,OAAS,CAAA,CAAID,CAAAA,CAAM,CAAA,CAAG,CAE3C,IAAMa,CAAAA,CAAOZ,EAAI,CAAA,CAAIA,CAAAA,CAAI,MAAA,CAAS,CAAA,CAClCQ,CAAAA,CAAO,IAAA,CAAK,OAAOI,CAAAA,CAAO,CAAA,CAAIb,CAAAA,CAAM,CAAA,CAAI,CAAA,EAAK,CAAC,EAChD,CAAA,KAEES,CAAAA,CAAO,IAAA,CAAK,GAAA,CAAIH,CAAAA,CAAQL,CAAAA,CAAI,CAAA,CAAIA,EAAI,MAAA,CAAS,CAAC,CAAA,CAAI,CAAA,CAEpD,IAAMrF,CAAAA,CAAaqG,EAAO,IAAA,CAAK,KAAA,CAAMD,CAAAA,CAAY,MAAA,CAAS,CAAC,CAAA,CAE3D,QAASviC,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIuiC,CAAAA,CAAY,MAAA,CAAQviC,CAAAA,EAAAA,CAAK,CAC3C,IAAMo8B,CAAAA,CAAKD,CAAAA,CAAan8B,CAAAA,CACpBo8B,CAAAA,EAAM,CAAA,EAAKA,CAAAA,CAAKpB,GAAUgH,CAAAA,EAAQ,CAAA,EAAKA,CAAAA,CAAOnH,CAAAA,GAChDzT,CAAAA,CAAOgV,CAAE,EAAG4F,CAAI,CAAA,CAAIO,CAAAA,CAAYviC,CAAC,CAAA,EAErC,CACF,CACF,CAEA,OAAOgpB,EAAAA,CAAe5B,CAAM,CAC9B,CCxeO,SAASqb,EAAAA,CAAepgB,CAAAA,CAA4B,CACzD,IAAM2U,CAAAA,CAAqB,CACzB,QAAA,CAAU,EAAC,CACX,aAAA,CAAe,EACjB,CAAA,CAGM0L,CAAAA,CAAY,IAAI,GAAA,CAElBC,CAAAA,CAAiC,IAAA,CAErC,IAAA,IAAS,CAAA,CAAI,CAAA,CAAG,EAAItgB,CAAAA,CAAM,MAAA,CAAQ,CAAA,EAAA,CAAK,CACrC,IAAMM,CAAAA,CAAON,EAAM,CAAC,CAAA,CAGpB,GAAIsgB,CAAAA,CAAe,CACjB,GAAIhgB,IAAS,GAAA,CAAK,CAChBggB,CAAAA,CAAgB,IAAA,CAChB,QACF,CAGA,IAAMC,CAAAA,CAAOC,EAAAA,CAAelgB,CAAI,CAAA,CAC5BigB,CAAAA,EACFD,CAAAA,CAAc,WAAW,IAAA,CAAKC,CAAI,CAAA,CAEpC,QACF,CAGA,IAAME,CAAAA,CAAmBngB,CAAAA,CAAK,KAAA,CAAM,cAAc,CAAA,CAClD,GAAImgB,CAAAA,CAAkB,CACpB,IAAM7nB,CAAAA,CAAK6nB,CAAAA,CAAiB,CAAC,CAAA,CAE7BH,CAAAA,CADeI,EAAAA,CAAaL,EAAWznB,CAAE,CAAA,CAEzC,QACF,CAGA,IAAMmjB,CAAAA,CAAM4E,GAAsBrgB,CAAI,CAAA,CACtC,GAAIyb,CAAAA,CAAK,CAEP2E,EAAAA,CAAaL,EAAWtE,CAAAA,CAAI,OAAO,CAAA,CACnC2E,EAAAA,CAAaL,CAAAA,CAAWtE,CAAAA,CAAI,OAAO,CAAA,CACnCpH,CAAAA,CAAQ,aAAA,CAAc,IAAA,CAAKoH,CAAG,CAAA,CAC9B,QACF,CACF,CAEA,OAAApH,CAAAA,CAAQ,QAAA,CAAW,CAAC,GAAG0L,CAAAA,CAAU,MAAA,EAAQ,CAAA,CAClC1L,CACT,CAGA,SAAS+L,EAAAA,CAAaL,CAAAA,CAAkCznB,CAAAA,CAAsB,CAC5E,IAAIgoB,CAAAA,CAASP,CAAAA,CAAU,IAAIznB,CAAE,CAAA,CAC7B,OAAKgoB,CAAAA,GACHA,CAAAA,CAAS,CAAE,GAAAhoB,CAAAA,CAAI,KAAA,CAAOA,CAAAA,CAAI,UAAA,CAAY,EAAG,EACzCynB,CAAAA,CAAU,GAAA,CAAIznB,CAAAA,CAAIgoB,CAAM,CAAA,CAAA,CAEnBA,CACT,CAGA,SAASJ,EAAAA,CAAelgB,CAAAA,CAAkC,CAExD,IAAMkD,CAAAA,CAAQlD,EAAK,KAAA,CAAM,6BAA6B,CAAA,CACtD,GAAI,CAACkD,CAAAA,CAAO,OAAO,IAAA,CAEnB,IAAMpM,CAAAA,CAAOoM,CAAAA,CAAM,CAAC,CAAA,CACdtb,EAAOsb,CAAAA,CAAM,CAAC,CAAA,CACdvC,CAAAA,CAAOuC,CAAAA,CAAM,CAAC,CAAA,EAAG,IAAA,EAAK,EAAK,EAAA,CAG3BzK,CAAAA,CAA4B,EAAC,CAC/B8nB,CAAAA,CAGEC,EAAe7f,CAAAA,CAAK,KAAA,CAAM,WAAW,CAAA,CACvC6f,CAAAA,GACFD,CAAAA,CAAUC,EAAa,CAAC,CAAA,CAAA,CAI1B,IAAMC,CAAAA,CAAqB9f,CAAAA,CAAK,OAAA,CAAQ,UAAW,EAAE,CAAA,CAAE,IAAA,EAAK,CAC5D,IAAA,IAAW+f,CAAAA,IAAQD,CAAAA,CAAmB,KAAA,CAAM,KAAK,CAAA,CAAG,CAClD,IAAME,CAAAA,CAAQD,CAAAA,CAAK,aAAY,CAAA,CAC3BC,CAAAA,GAAU,IAAA,EAAQA,CAAAA,GAAU,IAAA,EAAQA,CAAAA,GAAU,OAChDloB,CAAAA,CAAK,IAAA,CAAKkoB,CAA2B,EAEzC,CAEA,OAAO,CAAE,IAAA,CAAA7pB,CAAAA,CAAM,IAAA,CAAAlP,CAAAA,CAAM,IAAA,CAAA6Q,CAAAA,CAAM,OAAA,CAAA8nB,CAAQ,CACrC,CAYA,SAASF,EAAAA,CAAsBrgB,CAAAA,CAAqC,CAElE,IAAMkD,CAAAA,CAAQlD,CAAAA,CAAK,KAAA,CAAM,0DAA0D,CAAA,CACnF,GAAI,CAACkD,CAAAA,CAAO,OAAO,IAAA,CAEnB,IAAM0d,CAAAA,CAAU1d,CAAAA,CAAM,CAAC,CAAA,CACjB2d,CAAAA,CAAiB3d,CAAAA,CAAM,CAAC,CAAA,CACxB4d,CAAAA,CAAU5d,EAAM,CAAC,CAAA,CACjBjlB,CAAAA,CAAQilB,CAAAA,CAAM,CAAC,CAAA,CAAG,MAAK,CAGvB6d,CAAAA,CAAYF,CAAAA,CAAe,KAAA,CAAM,gCAAgC,CAAA,CACvE,GAAI,CAACE,CAAAA,CAAW,OAAO,IAAA,CAEvB,IAAMC,CAAAA,CAAUD,EAAU,CAAC,CAAA,CACrB1L,CAAAA,CAAY0L,CAAAA,CAAU,CAAC,CAAA,CACvBE,CAAAA,CAAWF,CAAAA,CAAU,CAAC,CAAA,CAEtBG,CAAAA,CAAeC,EAAAA,CAAiBH,CAAO,CAAA,CACvCI,EAAeD,EAAAA,CAAiBF,CAAQ,CAAA,CACxCI,CAAAA,CAAchM,CAAAA,GAAc,IAAA,CAElC,OAAI,CAAC6L,CAAAA,EAAgB,CAACE,CAAAA,CAAqB,IAAA,CAEpC,CAAE,QAAAR,CAAAA,CAAS,OAAA,CAAAE,CAAAA,CAAS,YAAA,CAAAI,CAAAA,CAAc,YAAA,CAAAE,CAAAA,CAAc,KAAA,CAAAnjC,CAAAA,CAAO,WAAA,CAAAojC,CAAY,CAC5E,CAGA,SAASF,GAAiBG,CAAAA,CAAiC,CAEzD,IAAMx2B,CAAAA,CAASw2B,CAAAA,CAAI,KAAA,CAAM,EAAE,CAAA,CAAE,IAAA,EAAK,CAAE,IAAA,CAAK,EAAE,CAAA,CAG3C,OAAIx2B,CAAAA,GAAW,IAAA,CAAa,KAAA,CAExBA,CAAAA,GAAW,IAAA,CAAa,UAAA,CAExBA,CAAAA,GAAW,IAAA,EAAQA,CAAAA,GAAW,IAAA,CAAa,MAAA,CAE3CA,CAAAA,GAAW,IAAA,EAAQA,CAAAA,GAAW,KAAa,WAAA,CAExC,IACT,CC3JA,SAASy2B,EAAAA,CAAgBtB,CAAAA,CAA2B,CAElD,OAAO,CAAA,EADQA,CAAAA,CAAK,IAAA,CAAK,MAAA,CAAS,CAAA,CAAIA,EAAK,IAAA,CAAK,IAAA,CAAK,GAAG,CAAA,CAAI,GAAA,CAAM,KAClD,GAAGA,CAAAA,CAAK,IAAI,CAAA,CAAA,EAAIA,CAAAA,CAAK,IAAI,CAAA,CAC3C,CAGA,SAASuB,EAAAA,CAAoBlB,CAAAA,CAA8B,CACzD,IAAM3gB,CAAAA,CAAS,CAAC2gB,CAAAA,CAAO,KAAK,CAAA,CACtB3gC,CAAAA,CAAQ2gC,CAAAA,CAAO,UAAA,CAAW,IAAIiB,EAAe,CAAA,CACnD,OAAI5hC,CAAAA,CAAM,MAAA,GAAW,CAAA,CAAU,CAACggB,CAAM,CAAA,CAC/B,CAACA,CAAAA,CAAQhgB,CAAK,CACvB,CAgBA,SAAS8hC,EAAAA,CAAkBC,CAAAA,CAAmB7b,CAAAA,CAA2B,CACvE,GAAIA,CAAAA,CACF,OAAQ6b,CAAAA,EACN,KAAK,KAAA,CAAa,OAAO,IAAA,CACzB,KAAK,UAAA,CAAa,OAAO,IAAA,CACzB,KAAK,MAAA,CAAa,OAAO,IAAA,CACzB,KAAK,WAAA,CAAa,OAAO,IAC3B,CAAA,KAEA,OAAQA,CAAAA,EACN,KAAK,KAAA,CAAa,OAAO,QAAA,CACzB,KAAK,UAAA,CAAa,OAAO,SAAA,CACzB,KAAK,MAAA,CAAa,OAAO,QAAA,CACzB,KAAK,YAAa,OAAO,SAC3B,CAEJ,CAwBO,SAASC,EAAAA,CAAcliB,CAAAA,CAAcqH,CAAAA,CAA6B,CACvE,IAAMpH,CAAAA,CAAQD,CAAAA,CAAK,KAAA,CAAM;AAAA,CAAI,CAAA,CAAE,IAAI3Z,CAAAA,EAAKA,CAAAA,CAAE,MAAM,CAAA,CAAE,MAAA,CAAOA,CAAAA,EAAKA,CAAAA,CAAE,MAAA,CAAS,GAAK,CAACA,CAAAA,CAAE,UAAA,CAAW,IAAI,CAAC,CAAA,CAC3FuuB,EAAUyL,EAAAA,CAAepgB,CAAK,CAAA,CAEpC,GAAI2U,CAAAA,CAAQ,QAAA,CAAS,SAAW,CAAA,CAAG,OAAO,EAAA,CAE1C,IAAMxO,CAAAA,CAAWiB,CAAAA,CAAO,SAClB8V,CAAAA,CAAO,CAAA,CACPC,CAAAA,CAAO,CAAA,CAGP+E,CAAAA,CAAiB,IAAI,IACrBC,CAAAA,CAAa,IAAI,GAAA,CACjBC,CAAAA,CAAa,IAAI,GAAA,CAEvB,QAAWC,CAAAA,IAAO1N,CAAAA,CAAQ,QAAA,CAAU,CAClC,IAAM7H,CAAAA,CAAWgV,GAAoBO,CAAG,CAAA,CACxCH,CAAAA,CAAe,GAAA,CAAIG,CAAAA,CAAI,EAAA,CAAIvV,CAAQ,CAAA,CAEnC,IAAIyQ,CAAAA,CAAW,CAAA,CACf,IAAA,IAAWtQ,CAAAA,IAAWH,EACpB,IAAA,IAAWxM,CAAAA,IAAQ2M,CAAAA,CAASsQ,CAAAA,CAAW,IAAA,CAAK,GAAA,CAAIA,EAAUjd,CAAAA,CAAK,MAAM,CAAA,CAEvE,IAAMkd,CAAAA,CAAOD,CAAAA,CAAW,EAEpBpQ,CAAAA,CAAa,CAAA,CACjB,IAAA,IAAWF,CAAAA,IAAWH,CAAAA,CAAUK,CAAAA,EAAc,KAAK,GAAA,CAAIF,CAAAA,CAAQ,MAAA,CAAQ,CAAC,CAAA,CACxE,IAAMwQ,EAAOtQ,CAAAA,EAAcL,CAAAA,CAAS,MAAA,CAAS,CAAA,CAAA,CAAK,CAAA,CAElDqV,CAAAA,CAAW,IAAIE,CAAAA,CAAI,EAAA,CAAI7E,CAAI,CAAA,CAC3B4E,CAAAA,CAAW,GAAA,CAAIC,EAAI,EAAA,CAAI5E,CAAI,EAC7B,CAKA,IAAM6E,EAAY,IAAA,CAAK,GAAA,CAAI,CAAA,CAAG,IAAA,CAAK,IAAA,CAAK,IAAA,CAAK,KAAK3N,CAAAA,CAAQ,QAAA,CAAS,MAAM,CAAC,CAAC,CAAA,CAErE2J,EAAS,IAAI,GAAA,CACfI,CAAAA,CAAW,CAAA,CACXH,CAAAA,CAAW,CAAA,CACXgE,EAAU,CAAA,CACVC,CAAAA,CAAW,CAAA,CAEf,IAAA,IAAWH,CAAAA,IAAO1N,CAAAA,CAAQ,SAAU,CAClC,IAAMz0B,CAAAA,CAAIiiC,CAAAA,CAAW,GAAA,CAAIE,CAAAA,CAAI,EAAE,CAAA,CACzBrhC,CAAAA,CAAIohC,CAAAA,CAAW,GAAA,CAAIC,CAAAA,CAAI,EAAE,EAE3BG,CAAAA,EAAYF,CAAAA,GAEd/D,CAAAA,EAAYgE,CAAAA,CAAUpF,CAAAA,CACtBuB,CAAAA,CAAW,EACX6D,CAAAA,CAAU,CAAA,CACVC,CAAAA,CAAW,CAAA,CAAA,CAGblE,CAAAA,CAAO,GAAA,CAAI+D,EAAI,EAAA,CAAI,CACjB,MAAA,CAAQA,CAAAA,CACR,QAAA,CAAUH,CAAAA,CAAe,IAAIG,CAAAA,CAAI,EAAE,CAAA,CACnC,CAAA,CAAG3D,CAAAA,CACH,CAAA,CAAGH,EACH,KAAA,CAAOr+B,CAAAA,CACP,MAAA,CAAQc,CACV,CAAC,CAAA,CAED09B,GAAYx+B,CAAAA,CAAIg9B,CAAAA,CAChBqF,CAAAA,CAAU,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAASvhC,CAAC,CAAA,CAC7BwhC,CAAAA,GACF,CAGA,IAAI7J,CAAAA,CAAS,CAAA,CACTH,EAAS,CAAA,CACb,IAAA,IAAW1yB,CAAAA,IAAKw4B,CAAAA,CAAO,MAAA,EAAO,CAC5B3F,EAAS,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAQ7yB,CAAAA,CAAE,CAAA,CAAIA,CAAAA,CAAE,KAAK,CAAA,CACvC0yB,CAAAA,CAAS,KAAK,GAAA,CAAIA,CAAAA,CAAQ1yB,EAAE,CAAA,CAAIA,CAAAA,CAAE,MAAM,CAAA,CAE1C6yB,CAAAA,EAAU,CAAA,CACVH,GAAU,CAAA,CAEV,IAAMzT,CAAAA,CAASD,EAAAA,CAAS6T,CAAAA,CAAS,CAAA,CAAGH,EAAS,CAAC,CAAA,CAG9C,IAAA,IAAW1yB,CAAAA,IAAKw4B,CAAAA,CAAO,MAAA,GAAU,CAC/B,IAAMM,CAAAA,CAAY/R,EAAAA,CAAa/mB,CAAAA,CAAE,QAAA,CAAUqgB,CAAQ,CAAA,CACnD,IAAA,IAAS0Y,CAAAA,CAAK,CAAA,CAAGA,CAAAA,CAAKD,CAAAA,CAAU,OAAQC,CAAAA,EAAAA,CACtC,IAAA,IAAS/D,CAAAA,CAAK,CAAA,CAAGA,CAAAA,CAAK8D,CAAAA,CAAU,CAAC,CAAA,CAAG,MAAA,CAAQ9D,CAAAA,EAAAA,CAAM,CAChD,IAAMgE,CAAAA,CAAKF,EAAUC,CAAE,CAAA,CAAG/D,CAAE,CAAA,CAC5B,GAAIgE,CAAAA,GAAO,IAAK,CACd,IAAM/F,CAAAA,CAAKjzB,CAAAA,CAAE,CAAA,CAAI+4B,CAAAA,CACXE,EAAKj5B,CAAAA,CAAE,CAAA,CAAIg1B,CAAAA,CACb/B,CAAAA,CAAKJ,CAAAA,EAAUoG,CAAAA,CAAKvG,IACtBzT,CAAAA,CAAOgU,CAAE,CAAA,CAAGgG,CAAE,CAAA,CAAID,CAAAA,EAEtB,CACF,CAEJ,CAGA,IAAM9I,CAAAA,CAAI7P,CAAAA,CAAW,GAAA,CAAM,SACrB8P,CAAAA,CAAI9P,CAAAA,CAAW,GAAA,CAAM,QAAA,CACrB6Y,CAAAA,CAAQ7Y,CAAAA,CAAW,IAAM,QAAA,CACzB8Y,CAAAA,CAAQ9Y,CAAAA,CAAW,GAAA,CAAM,QAAA,CAE/B,IAAA,IAAW4V,KAAOpH,CAAAA,CAAQ,aAAA,CAAe,CACvC,IAAM8N,CAAAA,CAAKnE,CAAAA,CAAO,IAAIvC,CAAAA,CAAI,OAAO,EAC3B2G,CAAAA,CAAKpE,CAAAA,CAAO,IAAIvC,CAAAA,CAAI,OAAO,CAAA,CACjC,GAAI,CAAC0G,CAAAA,EAAM,CAACC,CAAAA,CAAI,SAEhB,IAAMrD,CAAAA,CAAQtD,CAAAA,CAAI,WAAA,CAAc/F,EAAIgJ,CAAAA,CAC9BM,CAAAA,CAAQvD,CAAAA,CAAI,WAAA,CAAc9F,CAAAA,CAAIgJ,CAAAA,CAK9B0D,EAAOF,CAAAA,CAAG,CAAA,CAAI,IAAA,CAAK,KAAA,CAAMA,CAAAA,CAAG,KAAA,CAAQ,CAAC,CAAA,CACrCG,CAAAA,CAAOH,CAAAA,CAAG,CAAA,CAAI,IAAA,CAAK,KAAA,CAAMA,EAAG,MAAA,CAAS,CAAC,CAAA,CACtCI,CAAAA,CAAOH,CAAAA,CAAG,CAAA,CAAI,KAAK,KAAA,CAAMA,CAAAA,CAAG,KAAA,CAAQ,CAAC,CAAA,CACrCI,CAAAA,CAAOJ,EAAG,CAAA,CAAI,IAAA,CAAK,KAAA,CAAMA,CAAAA,CAAG,MAAA,CAAS,CAAC,EAK5C,GAFgB,IAAA,CAAK,GAAA,CAAIE,CAAAA,CAAOE,CAAI,CAAA,CAAI,KAAK,GAAA,CAAIL,CAAAA,CAAG,MAAA,CAAQC,CAAAA,CAAG,MAAM,CAAA,CAExD,CAEX,GAAM,CAACvZ,CAAAA,CAAMC,CAAK,CAAA,CAAIuZ,CAAAA,CAAOE,EAAO,CAACJ,CAAAA,CAAIC,CAAE,CAAA,CAAI,CAACA,CAAAA,CAAID,CAAE,CAAA,CAChD,CAACM,CAAAA,CAAUC,CAAS,CAAA,CAAIL,CAAAA,CAAOE,EACjC,CAAC9G,CAAAA,CAAI,YAAA,CAAcA,CAAAA,CAAI,YAAY,CAAA,CACnC,CAACA,CAAAA,CAAI,YAAA,CAAcA,CAAAA,CAAI,YAAY,CAAA,CAEjCzP,CAAAA,CAASnD,EAAK,CAAA,CAAIA,CAAAA,CAAK,MACvBoD,CAAAA,CAAOnD,CAAAA,CAAM,EAAI,CAAA,CACjB6Z,CAAAA,CAAQ9Z,CAAAA,CAAK,CAAA,CAAI,IAAA,CAAK,KAAA,CAAMA,EAAK,MAAA,CAAS,CAAC,CAAA,CAGjD,IAAA,IAASvjB,CAAAA,CAAI0mB,CAAAA,CAAQ1mB,GAAK2mB,CAAAA,CAAM3mB,CAAAA,EAAAA,CAC1BA,CAAAA,CAAI+yB,CAAAA,GAAQ5T,CAAAA,CAAOnf,CAAC,EAAGq9B,CAAK,CAAA,CAAI5D,CAAAA,CAAAA,CAItC,IAAM6D,CAAAA,CAAYnB,EAAAA,CAAkBgB,EAAU5c,CAAQ,CAAA,CACtD,IAAA,IAASxoB,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIulC,EAAU,MAAA,CAAQvlC,CAAAA,EAAAA,CAAK,CACzC,IAAM8oB,CAAAA,CAAK6F,CAAAA,CAAS3uB,EAChB8oB,CAAAA,CAAKkS,CAAAA,GAAQ5T,CAAAA,CAAO0B,CAAE,CAAA,CAAGwc,CAAK,EAAIC,CAAAA,CAAUvlC,CAAC,CAAA,EACnD,CAEA,IAAMwlC,CAAAA,CAAapB,GAAkBiB,CAAAA,CAAW7c,CAAQ,CAAA,CACxD,IAAA,IAASxoB,CAAAA,CAAI,CAAA,CAAGA,EAAIwlC,CAAAA,CAAW,MAAA,CAAQxlC,CAAAA,EAAAA,CAAK,CAC1C,IAAM8oB,CAAAA,CAAK8F,EAAO4W,CAAAA,CAAW,MAAA,CAAS,CAAA,CAAIxlC,CAAAA,CACtC8oB,CAAAA,EAAM,CAAA,EAAKA,EAAKkS,CAAAA,GAAQ5T,CAAAA,CAAO0B,CAAE,CAAA,CAAGwc,CAAK,CAAA,CAAIE,EAAWxlC,CAAC,CAAA,EAC/D,CAIA,GAAIo+B,CAAAA,CAAI,KAAA,CAAO,CACb,IAAMqH,CAAAA,CAAS,IAAA,CAAK,KAAA,CAAA,CAAO9W,CAAAA,CAASC,CAAAA,EAAQ,CAAC,CAAA,CACvCuN,CAAAA,CAAa,IAAA,CAAK,GAAA,CAAIxN,CAAAA,CAAQ8W,CAAAA,CAAS,KAAK,KAAA,CAAMrH,CAAAA,CAAI,MAAM,MAAA,CAAS,CAAC,CAAC,CAAA,CACvEtL,CAAAA,CAASwS,CAAAA,CAAQ,CAAA,CACvB,GAAIxS,CAAAA,EAAU,EACZ,IAAA,IAAS9yB,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIo+B,CAAAA,CAAI,KAAA,CAAM,OAAQp+B,CAAAA,EAAAA,CAAK,CACzC,IAAMo8B,CAAAA,CAAKD,CAAAA,CAAan8B,CAAAA,CACpBo8B,GAAMzN,CAAAA,EAAUyN,CAAAA,EAAMxN,CAAAA,EAAQwN,CAAAA,CAAKpB,CAAAA,GACrC5T,CAAAA,CAAOgV,CAAE,CAAA,CAAGtJ,CAAM,CAAA,CAAIsL,CAAAA,CAAI,KAAA,CAAMp+B,CAAC,GAErC,CAEJ,CACF,CAAA,KAAO,CAEL,GAAM,CAACsjC,EAAOoC,CAAK,CAAA,CAAIT,CAAAA,CAAOE,CAAAA,CAAO,CAACL,CAAAA,CAAIC,CAAE,CAAA,CAAI,CAACA,CAAAA,CAAID,CAAE,CAAA,CACjD,CAACa,EAAWC,CAAS,CAAA,CAAIX,CAAAA,CAAOE,CAAAA,CAClC,CAAC/G,CAAAA,CAAI,aAAcA,CAAAA,CAAI,YAAY,CAAA,CACnC,CAACA,CAAAA,CAAI,YAAA,CAAcA,EAAI,YAAY,CAAA,CAEjCyH,CAAAA,CAASvC,CAAAA,CAAM,CAAA,CAAIA,CAAAA,CAAM,OACzBwC,CAAAA,CAAOJ,CAAAA,CAAM,CAAA,CAAI,CAAA,CACjBK,CAAAA,CAAQzC,CAAAA,CAAM,EAAI,IAAA,CAAK,KAAA,CAAMA,CAAAA,CAAM,KAAA,CAAQ,CAAC,CAAA,CAGlD,QAASp7B,CAAAA,CAAI29B,CAAAA,CAAQ39B,CAAAA,EAAK49B,CAAAA,CAAM59B,CAAAA,EAAAA,CAC1BA,CAAAA,CAAI2yB,IAAQzT,CAAAA,CAAO2e,CAAK,CAAA,CAAG79B,CAAC,CAAA,CAAIy5B,CAAAA,CAAAA,CAItC,IAAMqE,CAAAA,CAAUN,CAAAA,CAAM,EAAI,IAAA,CAAK,KAAA,CAAMA,EAAM,KAAA,CAAQ,CAAC,CAAA,CACpD,GAAIK,CAAAA,GAAUC,CAAAA,CAAS,CACrB,IAAMhE,CAAAA,CAAO,IAAA,CAAK,KAAA,CAAA,CAAO6D,CAAAA,CAASC,CAAAA,EAAQ,CAAC,CAAA,CAErC1J,CAAAA,CAAK,IAAA,CAAK,GAAA,CAAI2J,CAAAA,CAAOC,CAAO,EAC5B/D,CAAAA,CAAK,IAAA,CAAK,GAAA,CAAI8D,CAAAA,CAAOC,CAAO,CAAA,CAClC,QAAS/9B,CAAAA,CAAIm0B,CAAAA,CAAIn0B,CAAAA,EAAKg6B,CAAAA,CAAIh6B,CAAAA,EAAAA,CACpBA,CAAAA,CAAI+yB,GAAUgH,CAAAA,CAAOnH,CAAAA,GAAQzT,CAAAA,CAAOnf,CAAC,CAAA,CAAG+5B,CAAI,EAAIN,CAAAA,CAAAA,CAGtD,IAAA,IAASx5B,CAAAA,CAAI85B,CAAAA,CAAO,CAAA,CAAG95B,CAAAA,EAAK49B,EAAM59B,CAAAA,EAAAA,CAC5BA,CAAAA,CAAI2yB,CAAAA,GAAQzT,CAAAA,CAAO4e,CAAO,CAAA,CAAG99B,CAAC,CAAA,CAAIy5B,CAAAA,EAE1C,CAIA,IAAMsE,CAAAA,CAAa7B,EAAAA,CAAkBuB,EAAWnd,CAAQ,CAAA,CACxD,GAAIqd,CAAAA,CAAShL,CAAAA,CACX,IAAA,IAAS76B,EAAI,CAAA,CAAGA,CAAAA,CAAIimC,CAAAA,CAAW,MAAA,CAAQjmC,CAAAA,EAAAA,CAAK,CAC1C,IAAM8oB,CAAAA,CAAKid,CAAAA,CAAQ,IAAA,CAAK,KAAA,CAAME,CAAAA,CAAW,MAAA,CAAS,CAAC,CAAA,CAAIjmC,CAAAA,CACnD8oB,CAAAA,EAAM,CAAA,EAAKA,CAAAA,CAAKkS,CAAAA,GAAQ5T,EAAO0B,CAAE,CAAA,CAAG+c,CAAM,CAAA,CAAII,CAAAA,CAAWjmC,CAAC,GAChE,CAGF,IAAM6nB,CAAAA,CAAUke,CAAAA,GAAUC,CAAAA,CAAUA,CAAAA,CAAUD,EACxCG,CAAAA,CAAa9B,EAAAA,CAAkBwB,EAAWpd,CAAQ,CAAA,CACxD,GAAIsd,CAAAA,EAAQ,CAAA,EAAKA,CAAAA,CAAOjL,CAAAA,CACtB,IAAA,IAAS76B,CAAAA,CAAI,EAAGA,CAAAA,CAAIkmC,CAAAA,CAAW,MAAA,CAAQlmC,CAAAA,EAAAA,CAAK,CAC1C,IAAM8oB,EAAKjB,CAAAA,CAAU,IAAA,CAAK,KAAA,CAAMqe,CAAAA,CAAW,MAAA,CAAS,CAAC,EAAIlmC,CAAAA,CACrD8oB,CAAAA,EAAM,CAAA,EAAKA,CAAAA,CAAKkS,CAAAA,GAAQ5T,CAAAA,CAAO0B,CAAE,CAAA,CAAGgd,CAAI,CAAA,CAAII,CAAAA,CAAWlmC,CAAC,CAAA,EAC9D,CAKF,GAAIo+B,CAAAA,CAAI,KAAA,CAAO,CACb,IAAM4D,CAAAA,CAAO,KAAK,KAAA,CAAA,CAAO6D,CAAAA,CAASC,CAAAA,EAAQ,CAAC,CAAA,CACrC/S,CAAAA,CAASgT,EAAQ,CAAA,CACvB,GAAI/D,CAAAA,EAAQ,CAAA,CACV,IAAA,IAAShiC,CAAAA,CAAI,EAAGA,CAAAA,CAAIo+B,CAAAA,CAAI,KAAA,CAAM,MAAA,CAAQp+B,CAAAA,EAAAA,CAAK,CACzC,IAAMo8B,CAAAA,CAAKrJ,CAAAA,CAAS/yB,CAAAA,CAChBo8B,CAAAA,EAAM,CAAA,GACR5U,EAAAA,CAAaJ,EAAQgV,CAAAA,CAAK,CAAA,CAAG4F,CAAAA,CAAO,CAAC,CAAA,CACrC5a,CAAAA,CAAOgV,CAAE,CAAA,CAAG4F,CAAI,CAAA,CAAI5D,CAAAA,CAAI,KAAA,CAAMp+B,CAAC,GAEnC,CAEJ,CACF,CACF,CAEA,OAAOgpB,EAAAA,CAAe5B,CAAM,CAC9B,CC5RA,SAAS+e,EAAAA,CAAkB/jB,CAAAA,CAAyD,CAClF,IAAM0P,CAAAA,CAAY1P,CAAAA,CAAK,IAAA,EAAK,CAAE,KAAA,CAAM;AAAA,CAAI,CAAA,CAAE,CAAC,CAAA,EAAG,IAAA,EAAK,CAAE,WAAA,EAAY,EAAK,EAAA,CAEtE,OAAI,sBAAA,CAAuB,IAAA,CAAK0P,CAAS,CAAA,CAAU,WAC/C,mBAAA,CAAoB,IAAA,CAAKA,CAAS,CAAA,CAAU,OAAA,CAC5C,gBAAA,CAAiB,IAAA,CAAKA,CAAS,CAAA,CAAU,IAAA,CAGtC,WACT,CA4BO,SAASsU,EAAAA,CACdhkB,EACAikB,CAAAA,CAA8B,EAAC,CACvB,CACR,IAAM5c,CAAAA,CAAsB,CAC1B,QAAA,CAAU4c,CAAAA,CAAQ,QAAA,EAAY,KAAA,CAC9B,QAAA,CAAUA,CAAAA,CAAQ,QAAA,EAAY,EAC9B,QAAA,CAAUA,CAAAA,CAAQ,QAAA,EAAY,CAAA,CAC9B,gBAAA,CAAkBA,CAAAA,CAAQ,gBAAA,EAAoB,CAAA,CAC9C,cAAA,CAAgB,IAClB,CAAA,CAIA,OAFoBF,EAAAA,CAAkB/jB,CAAI,GAGxC,KAAK,UAAA,CACH,OAAOgW,EAAAA,CAAoBhW,CAAAA,CAAMqH,CAAM,CAAA,CAEzC,KAAK,OAAA,CACH,OAAO6V,EAAAA,CAAiBld,CAAAA,CAAMqH,CAAM,EAEtC,KAAK,IAAA,CACH,OAAO6a,EAAAA,CAAcliB,CAAAA,CAAMqH,CAAM,CAAA,CAGnC,QAAS,CAEP,IAAMD,CAAAA,CAASrH,EAAAA,CAAaC,CAAI,CAAA,CAK5BoH,EAAO,SAAA,GAAc,IAAA,EAAQA,CAAAA,CAAO,SAAA,GAAc,IAAA,CACpDC,CAAAA,CAAO,cAAA,CAAiB,IAAA,CAExBA,CAAAA,CAAO,cAAA,CAAiB,IAAA,CAG1B,IAAMpiB,CAAAA,CAAQkiB,EAAAA,CAAoBC,EAAQC,CAAM,CAAA,CAChD,OAAAyM,EAAAA,CAAc7uB,CAAK,CAAA,CACnB6rB,EAAAA,CAAU7rB,CAAK,CAAA,CAIXmiB,CAAAA,CAAO,SAAA,GAAc,IAAA,EACvBN,EAAAA,CAAqB7hB,CAAAA,CAAM,MAAM,CAAA,CAG5B2hB,EAAAA,CAAe3hB,CAAAA,CAAM,MAAM,CACpC,CACF,CACF,CCjIA,IAAAi/B,EAAAA,CAAkB,EAAA,CAAA,EAAA,EAAA,CAAA,CCQX,SAASC,EAAAA,CAAkBnkB,CAAAA,CAAcokB,EAAkBC,CAAAA,CAA4B,CAG5F,IAAMC,CAAAA,CAAaD,CAAAA,EAAc,GAAA,CAAM,GAAA,CAAOA,CAAAA,EAAc,GAAA,CAAM,GAAA,CAAO,GAAA,CACzE,OAAOrkB,CAAAA,CAAK,MAAA,CAASokB,EAAWE,CAClC,CAGO,SAASC,EAAAA,CAAsBvkB,CAAAA,CAAcokB,CAAAA,CAA0B,CAK5E,OAAOpkB,CAAAA,CAAK,MAAA,CAASokB,CAAAA,CAAW,EAClC,CAGO,IAMMI,CAAAA,CAAa,CAExB,SAAA,CAAW,EAAA,CAEX,SAAA,CAAW,EAAA,CAEX,WAAA,CAAa,EACf,CAAA,CAGaC,GAAe,CAC1B,SAAA,CAAW,GAAA,CACX,SAAA,CAAW,GAAA,CACX,WAAA,CAAa,GACf,CAAA,CAQaC,EAAAA,CAA2B,CAAA,CAG3BC,EAAAA,CAAe,CAE1B,UAAA,CAAY,EAAA,CAEZ,SAAU,EAAA,CAEV,YAAA,CAAc,EAChB,CAAA,CAGaC,EAAAA,CAAgB,CAC3B,QAAA,CAAU,CAAA,CACV,QAAA,CAAU,GAAA,CACV,SAAA,CAAW,GACb,CAAA,CAaaC,EAAAA,CAAsB,SAGtBC,EAAAA,CAAa,CACxB,KAAA,CAAO,CAAA,CACP,MAAA,CAAQ,GACV,ECrEO,SAASC,EAAAA,CAAgB/L,CAAAA,CAAYgG,CAAAA,CAAYzsB,CAAAA,CAAepL,CAAAA,CAAuB,CAC5F,OAAO,CAAE,CAAA,CAAG6xB,CAAAA,CAAKzmB,CAAAA,CAAQ,CAAA,CAAG,CAAA,CAAGysB,CAAAA,CAAK73B,CAAAA,CAAS,CAAE,CACjD,CAeO,SAAS69B,EAAAA,CACdptB,CAAAA,CACAohB,EACAgG,CAAAA,CACAiG,CAAAA,CACAC,CAAAA,CACO,CACP,IAAMx+B,CAAAA,CAAKkR,CAAAA,CAAM,CAAA,CAAIohB,CAAAA,CACfryB,CAAAA,CAAKiR,CAAAA,CAAM,CAAA,CAAIonB,CAAAA,CAErB,GAAI,KAAK,GAAA,CAAIt4B,CAAE,CAAA,CAAI,EAAA,EAAO,IAAA,CAAK,GAAA,CAAIC,CAAE,CAAA,CAAI,EAAA,CAAK,OAAOiR,CAAAA,CAErD,IAAMutB,CAAAA,CAAQ,CAAA,EAAK,KAAK,GAAA,CAAIz+B,CAAE,CAAA,CAAIu+B,CAAAA,CAAK,IAAA,CAAK,GAAA,CAAIt+B,CAAE,CAAA,CAAIu+B,CAAAA,CAAAA,CACtD,OAAO,CAAE,CAAA,CAAGlM,CAAAA,CAAKmM,CAAAA,CAAQz+B,EAAI,CAAA,CAAGs4B,CAAAA,CAAKmG,CAAAA,CAAQx+B,CAAG,CAClD,CAcO,SAASy+B,EAAAA,CACdxtB,CAAAA,CACAohB,CAAAA,CACAgG,CAAAA,CACAzhC,CAAAA,CACO,CACP,IAAMmJ,EAAKkR,CAAAA,CAAM,CAAA,CAAIohB,CAAAA,CACfryB,CAAAA,CAAKiR,CAAAA,CAAM,CAAA,CAAIonB,CAAAA,CACfqG,CAAAA,CAAO,IAAA,CAAK,IAAA,CAAK3+B,CAAAA,CAAKA,CAAAA,CAAKC,CAAAA,CAAKA,CAAE,EAExC,GAAI0+B,CAAAA,CAAO,EAAA,CAAK,OAAOztB,CAAAA,CACvB,IAAMutB,CAAAA,CAAQ5nC,CAAAA,CAAI8nC,CAAAA,CAClB,OAAO,CAAE,CAAA,CAAGrM,CAAAA,CAAKmM,CAAAA,CAAQz+B,EAAI,CAAA,CAAGs4B,CAAAA,CAAKmG,CAAAA,CAAQx+B,CAAG,CAClD,CAkBO,SAAS2+B,EAAAA,CAAiBC,CAAAA,CAAiBC,CAAAA,CAAgB,IAAA,CAAe,CAC/E,GAAID,CAAAA,CAAO,OAAS,CAAA,CAAG,OAAOA,CAAAA,CAE9B,IAAMt8B,CAAAA,CAAkB,CAACs8B,CAAAA,CAAO,CAAC,CAAE,CAAA,CAEnC,IAAA,IAAS3nC,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAI2nC,EAAO,MAAA,CAAQ3nC,CAAAA,EAAAA,CAAK,CACtC,IAAM8B,CAAAA,CAAOuJ,CAAAA,CAAOA,CAAAA,CAAO,MAAA,CAAS,CAAC,CAAA,CAC/BtJ,CAAAA,CAAO4lC,CAAAA,CAAO3nC,CAAC,CAAA,CAEf8I,EAAK,IAAA,CAAK,GAAA,CAAI/G,CAAAA,CAAK,CAAA,CAAID,CAAAA,CAAK,CAAC,CAAA,CAC7BiH,CAAAA,CAAK,IAAA,CAAK,GAAA,CAAIhH,CAAAA,CAAK,CAAA,CAAID,CAAAA,CAAK,CAAC,EAGnC,GAAIgH,CAAAA,CAAK,CAAA,EAAKC,CAAAA,CAAK,CAAA,CAAG,CACpBsC,CAAAA,CAAO,IAAA,CAAKtJ,CAAI,CAAA,CAChB,QACF,CAKI6lC,CAAAA,CACFv8B,CAAAA,CAAO,KAAK,CAAE,CAAA,CAAGvJ,CAAAA,CAAK,CAAA,CAAG,CAAA,CAAGC,CAAAA,CAAK,CAAE,CAAC,CAAA,CAEpCsJ,CAAAA,CAAO,IAAA,CAAK,CAAE,CAAA,CAAGtJ,CAAAA,CAAK,EAAG,CAAA,CAAGD,CAAAA,CAAK,CAAE,CAAC,CAAA,CAEtCuJ,CAAAA,CAAO,IAAA,CAAKtJ,CAAI,EAClB,CAKA,OAAO8lC,EAAAA,CAAgBx8B,CAAM,CAC/B,CAGA,SAASw8B,EAAAA,CAAgBC,CAAAA,CAAuB,CAC9C,GAAIA,CAAAA,CAAI,MAAA,CAAS,CAAA,CAAG,OAAOA,CAAAA,CAC3B,IAAMC,CAAAA,CAAe,CAACD,CAAAA,CAAI,CAAC,CAAE,CAAA,CAC7B,IAAA,IAAS9nC,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAI8nC,CAAAA,CAAI,MAAA,CAAS,CAAA,CAAG9nC,CAAAA,EAAAA,CAAK,CACvC,IAAMI,CAAAA,CAAI2nC,CAAAA,CAAIA,CAAAA,CAAI,MAAA,CAAS,CAAC,CAAA,CACtBv/B,CAAAA,CAAIs/B,CAAAA,CAAI9nC,CAAC,CAAA,CACTC,CAAAA,CAAI6nC,CAAAA,CAAI9nC,CAAAA,CAAI,CAAC,CAAA,CAEbgoC,CAAAA,CAAQ,IAAA,CAAK,GAAA,CAAI5nC,EAAE,CAAA,CAAIoI,CAAAA,CAAE,CAAC,CAAA,CAAI,CAAA,EAAK,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAE,CAAA,CAAIvI,CAAAA,CAAE,CAAC,CAAA,CAAI,CAAA,CACzDgoC,CAAAA,CAAQ,KAAK,GAAA,CAAI7nC,CAAAA,CAAE,CAAA,CAAIoI,CAAAA,CAAE,CAAC,CAAA,CAAI,CAAA,EAAK,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAE,CAAA,CAAIvI,CAAAA,CAAE,CAAC,CAAA,CAAI,EAC3D+nC,CAAAA,EAASC,CAAAA,EACbF,CAAAA,CAAI,IAAA,CAAKv/B,CAAC,EACZ,CACA,OAAAu/B,CAAAA,CAAI,IAAA,CAAKD,CAAAA,CAAIA,CAAAA,CAAI,MAAA,CAAS,CAAC,CAAE,CAAA,CACtBC,CACT,CA0CO,SAASG,EAAAA,CACdP,CAAAA,CACAQ,CAAAA,CACAC,CAAAA,CACS,CACT,GAAIT,CAAAA,CAAO,MAAA,CAAS,CAAA,CAAG,OAAOA,EAC9B,IAAMt8B,CAAAA,CAASs8B,CAAAA,CAAO,GAAA,CAAIx/B,CAAAA,GAAM,CAAE,GAAGA,CAAE,CAAA,CAAE,CAAA,CAGzC,GAAIigC,CAAAA,CAAY,CACd,IAAMx4B,EAAOvE,CAAAA,CAAO,MAAA,CAAS,CAAA,CAE7B,GAAIs8B,CAAAA,CAAO,MAAA,GAAW,CAAA,CAAG,CAGvB,IAAMpiB,CAAAA,CAAQla,CAAAA,CAAO,CAAC,CAAA,CAChBtJ,CAAAA,CAAOsJ,EAAOuE,CAAI,CAAA,CAClB9G,CAAAA,CAAK,IAAA,CAAK,GAAA,CAAI/G,CAAAA,CAAK,CAAA,CAAIwjB,CAAAA,CAAM,CAAC,CAAA,CAGpC,GAFW,IAAA,CAAK,GAAA,CAAIxjB,CAAAA,CAAK,EAAIwjB,CAAAA,CAAM,CAAC,CAAA,EAE1Bzc,CAAAA,CAAI,CAGZ,IAAMu/B,CAAAA,CADkBtmC,CAAAA,CAAK,CAAA,CAAIwjB,CAAAA,CAAM,CAAA,CAEnC6iB,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,GAC3BA,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,CAC/B/8B,CAAAA,CAAOuE,CAAI,CAAA,CAAI,CAAE,CAAA,CAAG7N,CAAAA,CAAK,CAAA,CAAG,CAAA,CAAGsmC,CAAM,EACvC,MAAO,CAGL,IAAMC,CAAAA,CADmBvmC,CAAAA,CAAK,CAAA,CAAIwjB,CAAAA,CAAM,CAAA,CAEpC6iB,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,CAC3BA,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,GAC/B/8B,CAAAA,CAAOuE,CAAI,CAAA,CAAI,CAAE,CAAA,CAAG04B,CAAAA,CAAO,CAAA,CAAGvmC,CAAAA,CAAK,CAAE,EACvC,CACF,CAAA,KAAO,CAEL,IAAMD,EAAOuJ,CAAAA,CAAOuE,CAAAA,CAAO,CAAC,CAAA,CACtB7N,CAAAA,CAAOsJ,CAAAA,CAAOuE,CAAI,CAAA,CAClB9G,CAAAA,CAAK,IAAA,CAAK,GAAA,CAAI/G,CAAAA,CAAK,CAAA,CAAID,CAAAA,CAAK,CAAC,CAAA,CAC7BiH,CAAAA,CAAK,IAAA,CAAK,GAAA,CAAIhH,CAAAA,CAAK,CAAA,CAAID,CAAAA,CAAK,CAAC,CAAA,CAI7BymC,CAAAA,CAAuBx/B,CAAAA,CAAK,CAAA,EAAKD,CAAAA,EAAM,CAAA,CACvC0/B,EAAqB1/B,CAAAA,CAAK,CAAA,EAAKC,CAAAA,EAAM,CAAA,CACrC0/B,CAAAA,CAAwB,CAACF,CAAAA,EAAwB,CAACC,CAAAA,EAAsBz/B,CAAAA,CAAKD,CAAAA,CAC7E4/B,CAAAA,CAAsB,CAACH,CAAAA,EAAwB,CAACC,CAAAA,EAAsB1/B,CAAAA,CAAKC,CAAAA,CAEjF,GAAIw/B,CAAAA,CAAsB,CAGxB,IAAMD,CAAAA,CADmBvmC,CAAAA,CAAK,CAAA,CAAID,CAAAA,CAAK,CAAA,CAEnCsmC,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,CAC3BA,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,CAC/B/8B,CAAAA,CAAOuE,CAAI,CAAA,CAAI,CAAE,CAAA,CAAG04B,CAAAA,CAAO,CAAA,CAAGF,CAAAA,CAAW,EAAG,CAAA,CAC5C/8B,EAAOuE,CAAAA,CAAO,CAAC,CAAA,CAAI,CAAE,GAAG9N,CAAAA,CAAM,CAAA,CAAGsmC,CAAAA,CAAW,EAAG,EACjD,CAAA,KAAA,GAAWI,CAAAA,CAAoB,CAG7B,IAAMH,EADkBtmC,CAAAA,CAAK,CAAA,CAAID,CAAAA,CAAK,CAAA,CAElCsmC,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,CAC3BA,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,CAC/B/8B,CAAAA,CAAOuE,CAAI,EAAI,CAAE,CAAA,CAAGw4B,CAAAA,CAAW,EAAA,CAAI,CAAA,CAAGC,CAAM,CAAA,CAC5Ch9B,CAAAA,CAAOuE,CAAAA,CAAO,CAAC,CAAA,CAAI,CAAE,GAAG9N,CAAAA,CAAM,EAAGsmC,CAAAA,CAAW,EAAG,EACjD,CAAA,KAAA,GAAWK,CAAAA,CAAuB,CAGhC,IAAMH,CAAAA,CADmBvmC,CAAAA,CAAK,CAAA,CAAID,CAAAA,CAAK,CAAA,CAEnCsmC,CAAAA,CAAW,EAAA,CAAKA,EAAW,EAAA,CAC3BA,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,CAG7BtmC,CAAAA,CAAK,CAAA,EAAKsmC,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,EACrCtmC,CAAAA,CAAK,CAAA,EAAKsmC,CAAAA,CAAW,GAAKA,CAAAA,CAAW,EAAA,CAGrC/8B,CAAAA,CAAOuE,CAAI,CAAA,CAAI,CAAE,CAAA,CAAG04B,CAAAA,CAAO,CAAA,CAAGxmC,CAAAA,CAAK,CAAE,CAAA,EAErCuJ,CAAAA,CAAOuE,CAAI,EAAI,CAAE,CAAA,CAAG04B,CAAAA,CAAO,CAAA,CAAGF,CAAAA,CAAW,EAAG,CAAA,CAC5C/8B,CAAAA,CAAOuE,CAAAA,CAAO,CAAC,CAAA,CAAI,CAAE,GAAG9N,CAAAA,CAAM,EAAGsmC,CAAAA,CAAW,EAAG,CAAA,EAEnD,CAAA,KAAA,GAAWM,CAAAA,CAAqB,CAG9B,IAAML,CAAAA,CADkBtmC,CAAAA,CAAK,CAAA,CAAID,CAAAA,CAAK,CAAA,CAElCsmC,CAAAA,CAAW,EAAA,CAAKA,EAAW,EAAA,CAC3BA,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,CAG7BtmC,CAAAA,CAAK,CAAA,EAAKsmC,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,EACrCtmC,CAAAA,CAAK,CAAA,EAAKsmC,CAAAA,CAAW,GAAKA,CAAAA,CAAW,EAAA,CAGrC/8B,CAAAA,CAAOuE,CAAI,CAAA,CAAI,CAAE,CAAA,CAAG9N,CAAAA,CAAK,CAAA,CAAG,CAAA,CAAGumC,CAAM,CAAA,EAErCh9B,CAAAA,CAAOuE,CAAI,EAAI,CAAE,CAAA,CAAGw4B,CAAAA,CAAW,EAAA,CAAI,CAAA,CAAGC,CAAM,CAAA,CAC5Ch9B,CAAAA,CAAOuE,CAAAA,CAAO,CAAC,CAAA,CAAI,CAAE,GAAG9N,CAAAA,CAAM,EAAGsmC,CAAAA,CAAW,EAAG,CAAA,EAEnD,CACF,CACF,CAGA,GAAID,CAAAA,EAAcR,CAAAA,CAAO,MAAA,EAAU,CAAA,CAAG,CAEpC,IAAMpiB,CAAAA,CAAQla,EAAO,CAAC,CAAA,CAChBqa,CAAAA,CAAOra,CAAAA,CAAO,CAAC,CAAA,CACfvC,CAAAA,CAAK,IAAA,CAAK,GAAA,CAAI4c,CAAAA,CAAK,CAAA,CAAIH,CAAAA,CAAM,CAAC,CAAA,CAC9Bxc,EAAK,IAAA,CAAK,GAAA,CAAI2c,CAAAA,CAAK,CAAA,CAAIH,CAAAA,CAAM,CAAC,CAAA,CAI9BgjB,CAAAA,CAAuBx/B,CAAAA,CAAK,CAAA,EAAKD,CAAAA,EAAM,CAAA,CACvC0/B,CAAAA,CAAqB1/B,CAAAA,CAAK,GAAKC,CAAAA,EAAM,CAAA,CACrC0/B,CAAAA,CAAwB,CAACF,CAAAA,EAAwB,CAACC,CAAAA,EAAsBz/B,CAAAA,CAAKD,CAAAA,CAC7E4/B,CAAAA,CAAsB,CAACH,CAAAA,EAAwB,CAACC,CAAAA,EAAsB1/B,CAAAA,CAAKC,CAAAA,CAEjF,GAAIw/B,CAAAA,CAAsB,CAGxB,IAAMD,CAAAA,CADc5iB,CAAAA,CAAK,CAAA,CAAIH,CAAAA,CAAM,CAAA,CAE/B4iB,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,CAC3BA,CAAAA,CAAW,GAAKA,CAAAA,CAAW,EAAA,CAC/B98B,CAAAA,CAAO,CAAC,CAAA,CAAI,CAAE,CAAA,CAAGi9B,CAAAA,CAAO,CAAA,CAAGH,CAAAA,CAAW,EAAG,CAAA,CACzC98B,CAAAA,CAAO,CAAC,EAAI,CAAE,GAAGA,CAAAA,CAAO,CAAC,CAAA,CAAI,CAAA,CAAG88B,CAAAA,CAAW,EAAG,EAChD,CAAA,KAAA,GAAWK,CAAAA,CAAoB,CAG7B,IAAMH,CAAAA,CADe3iB,EAAK,CAAA,CAAIH,CAAAA,CAAM,CAAA,CAEhC4iB,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,CAC3BA,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,CAC/B98B,CAAAA,CAAO,CAAC,CAAA,CAAI,CAAE,CAAA,CAAG88B,CAAAA,CAAW,EAAA,CAAI,CAAA,CAAGE,CAAM,CAAA,CACzCh9B,CAAAA,CAAO,CAAC,CAAA,CAAI,CAAE,GAAGA,CAAAA,CAAO,CAAC,CAAA,CAAI,EAAG88B,CAAAA,CAAW,EAAG,EAChD,CAAA,KAAA,GAAWM,CAAAA,CAAuB,CAGhC,IAAMH,CAAAA,CADc5iB,CAAAA,CAAK,CAAA,CAAIH,CAAAA,CAAM,CAAA,CAE/B4iB,CAAAA,CAAW,EAAA,CAAKA,EAAW,EAAA,CAC3BA,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,CAG7BziB,CAAAA,CAAK,CAAA,EAAKyiB,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,EACrCziB,CAAAA,CAAK,CAAA,EAAKyiB,CAAAA,CAAW,GAAKA,CAAAA,CAAW,EAAA,CAGrC98B,CAAAA,CAAO,CAAC,CAAA,CAAI,CAAE,CAAA,CAAGi9B,CAAAA,CAAO,CAAA,CAAG5iB,CAAAA,CAAK,CAAE,CAAA,EAElCra,CAAAA,CAAO,CAAC,EAAI,CAAE,CAAA,CAAGi9B,CAAAA,CAAO,CAAA,CAAGH,CAAAA,CAAW,EAAG,CAAA,CACzC98B,CAAAA,CAAO,CAAC,CAAA,CAAI,CAAE,GAAGA,CAAAA,CAAO,CAAC,EAAI,CAAA,CAAG88B,CAAAA,CAAW,EAAG,CAAA,EAElD,CAAA,KAAA,GAAWO,CAAAA,CAAqB,CAG9B,IAAML,CAAAA,CADe3iB,CAAAA,CAAK,CAAA,CAAIH,CAAAA,CAAM,CAAA,CAEhC4iB,CAAAA,CAAW,GAAKA,CAAAA,CAAW,EAAA,CAC3BA,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,CAG7BziB,CAAAA,CAAK,CAAA,EAAKyiB,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,EACrCziB,CAAAA,CAAK,CAAA,EAAKyiB,EAAW,EAAA,CAAKA,CAAAA,CAAW,EAAA,CAGrC98B,CAAAA,CAAO,CAAC,CAAA,CAAI,CAAE,CAAA,CAAGqa,CAAAA,CAAK,CAAA,CAAG,CAAA,CAAG2iB,CAAM,CAAA,EAElCh9B,CAAAA,CAAO,CAAC,CAAA,CAAI,CAAE,CAAA,CAAG88B,CAAAA,CAAW,EAAA,CAAI,CAAA,CAAGE,CAAM,CAAA,CACzCh9B,CAAAA,CAAO,CAAC,CAAA,CAAI,CAAE,GAAGA,CAAAA,CAAO,CAAC,CAAA,CAAI,CAAA,CAAG88B,CAAAA,CAAW,EAAG,CAAA,EAElD,CACF,CAEA,OAAO98B,CACT,CFnWA,IAAMs9B,EAAAA,CAAkB,IAAI,GAAA,CAAI,CAAC,QAAA,CAAU,cAAA,CAAgB,aAAA,CAAe,WAAW,CAAC,CAAA,CAIhFC,EAAAA,CAAkB,IAAI,GAAA,CAAI,CAAC,SAAA,CAAW,QAAA,CAAU,cAAA,CAAgB,aAAA,CAAe,WAAW,CAAC,CAAA,CAoB3F1nB,EAAAA,CAA+F,CACnG,IAAA,CAAM,OAAA,CACN,OAAA,CAAS,EAAA,CACT,WAAA,CAAa,EAAA,CACb,YAAA,CAAc,EAChB,CAAA,CAqCA,SAAS2nB,EAAAA,CACPjnC,CAAAA,CACAyF,CAAAA,CACA7B,CAAAA,CACqB,CACrB,IAAMsjC,CAAAA,CAAO,IAAI,EAAA,CAAAC,OAAAA,CAAM,QAAA,CAAS,KAAA,CAAM,CAAE,QAAA,CAAU,IAAA,CAAM,QAAA,CAAU,IAAK,CAAC,CAAA,CACxED,CAAAA,CAAK,QAAA,CAAS,CACZ,OAAA,CAASE,EAAAA,CAAiBpnC,CAAAA,CAAG,SAAU,CAAA,CACvC,SAAA,CAAW,QAAA,CACX,OAAA,CAAS4D,CAAAA,CAAK,YACd,OAAA,CAASA,CAAAA,CAAK,YAAA,CAEd,OAAA,CAAS,EAAA,CACT,OAAA,CAAS,EACX,CAAC,CAAA,CACDsjC,CAAAA,CAAK,mBAAA,CAAoB,KAAO,EAAC,CAAE,EAGnC,IAAM9lB,CAAAA,CAAU,IAAI,GAAA,CACpBA,CAAAA,CAAQ,GAAA,CAAIphB,CAAAA,CAAG,EAAE,CAAA,CACjBqnC,EAAAA,CAAuBrnC,CAAAA,CAAIohB,CAAO,CAAA,CAGlC,IAAA,IAAWkD,KAAUtkB,CAAAA,CAAG,OAAA,CAAS,CAC/B,IAAMN,CAAAA,CAAO+F,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI6e,CAAM,CAAA,CACnC,GAAI5kB,CAAAA,CAAM,CACR,IAAM8U,EAAO8yB,EAAAA,CAAiBhjB,CAAAA,CAAQ5kB,CAAAA,CAAK,KAAA,CAAOA,CAAAA,CAAK,KAAK,CAAA,CAC5DwnC,CAAAA,CAAK,OAAA,CAAQ5iB,CAAAA,CAAQ,CAAE,KAAA,CAAO5kB,CAAAA,CAAK,KAAA,CAAO,MAAO8U,CAAAA,CAAK,KAAA,CAAO,MAAA,CAAQA,CAAAA,CAAK,MAAO,CAAC,EACpF,CACF,CAGA,IAAA,IAAW1M,CAAAA,IAAS9H,CAAAA,CAAG,QAAA,CACrBunC,EAAAA,CAAmBL,EAAMp/B,CAAAA,CAAOrC,CAAK,CAAA,CAIvC,IAAM+hC,CAAAA,CAAsB,IAAI,GAAA,CAChC,IAAA,IAASppC,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIqH,CAAAA,CAAM,KAAA,CAAM,MAAA,CAAQrH,IAAK,CAC3C,IAAMyC,CAAAA,CAAO4E,CAAAA,CAAM,KAAA,CAAMrH,CAAC,CAAA,CAC1B,GAAIgjB,CAAAA,CAAQ,GAAA,CAAIvgB,CAAAA,CAAK,MAAM,CAAA,EAAKugB,CAAAA,CAAQ,IAAIvgB,CAAAA,CAAK,MAAM,CAAA,CAAG,CACxD2mC,CAAAA,CAAoB,GAAA,CAAIppC,CAAC,CAAA,CACzB,IAAMwK,CAAAA,CAAqC,CAAE,MAAA,CAAQxK,CAAE,CAAA,CACnDyC,EAAK,KAAA,GACP+H,CAAAA,CAAU,KAAA,CAAQ/H,CAAAA,CAAK,KAAA,CACvB+H,CAAAA,CAAU,KAAA,CAAQ+7B,EAAAA,CAAkB9jC,CAAAA,CAAK,KAAA,CAAOmkC,CAAAA,CAAW,SAAA,CAAWC,EAAAA,CAAa,SAAS,EAAI,CAAA,CAChGr8B,CAAAA,CAAU,MAAA,CAASo8B,CAAAA,CAAW,SAAA,CAAY,CAAA,CAC1Cp8B,CAAAA,CAAU,QAAA,CAAW,GAAA,CAAA,CAEvBs+B,CAAAA,CAAK,OAAA,CAAQrmC,CAAAA,CAAK,MAAA,CAAQA,CAAAA,CAAK,OAAQ+H,CAAS,EAClD,CACF,CAGA,EAAA,CAAAu+B,OAAAA,CAAM,MAAA,CAAOD,CAAI,CAAA,CAGjB,IAAMlB,CAAAA,CAAgBhmC,CAAAA,CAAG,SAAA,GAAc,IAAA,EAAQA,EAAG,SAAA,GAAc,IAAA,EAAQA,CAAAA,CAAG,SAAA,GAAc,IAAA,CAGnFynC,CAAAA,CAAoB,IAAI,GAAA,CAC9B,IAAA,IAAW3/B,CAAAA,IAAS9H,CAAAA,CAAG,QAAA,CACrB0nC,EAAAA,CAAsB5/B,CAAAA,CAAO2/B,CAAiB,CAAA,CAIhD,IAAM/rB,CAAAA,CAA0B,EAAC,CACjC,IAAA,IAAW4I,CAAAA,IAAU4iB,CAAAA,CAAK,KAAA,EAAM,CAAG,CACjC,GAAIO,CAAAA,CAAkB,GAAA,CAAInjB,CAAM,CAAA,CAAG,SACnC,IAAMyD,CAAAA,CAAQtiB,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI6e,CAAM,CAAA,CACpC,GAAI,CAACyD,CAAAA,CAAO,SACZ,IAAM4f,CAAAA,CAAYT,CAAAA,CAAK,IAAA,CAAK5iB,CAAM,CAAA,CAClC,GAAI,CAACqjB,CAAAA,CAAW,SAChB,IAAMC,CAAAA,CAAUrC,EAAAA,CAAgBoC,CAAAA,CAAU,CAAA,CAAGA,CAAAA,CAAU,CAAA,CAAGA,EAAU,KAAA,CAAOA,CAAAA,CAAU,MAAM,CAAA,CAC3FjsB,CAAAA,CAAM,IAAA,CAAK,CACT,EAAA,CAAI4I,CAAAA,CACJ,KAAA,CAAOyD,CAAAA,CAAM,KAAA,CACb,KAAA,CAAOA,CAAAA,CAAM,MACb,CAAA,CAAG6f,CAAAA,CAAQ,CAAA,CACX,CAAA,CAAGA,CAAAA,CAAQ,CAAA,CACX,KAAA,CAAOD,CAAAA,CAAU,KAAA,CACjB,MAAA,CAAQA,CAAAA,CAAU,MAAA,CAClB,WAAA,CAAaE,EAAAA,CAAiBpiC,EAAO6e,CAAM,CAC7C,CAAC,EACH,CAGA,IAAM9F,CAAAA,CAA0B0oB,CAAAA,CAAK,KAAA,EAAM,CAAE,GAAA,CAAI94B,CAAAA,EAAW,CAC1D,IAAM05B,EAAYZ,CAAAA,CAAK,IAAA,CAAK94B,CAAO,CAAA,CAC7B25B,CAAAA,CAAetiC,CAAAA,CAAM,KAAA,CAAMqiC,CAAAA,CAAU,MAAgB,CAAA,CACrDE,CAAAA,CAAqBF,CAAAA,CAAU,MAAA,EAAU,GAK/C,GAAIE,CAAAA,CAAU,MAAA,CAAS,CAAA,CAAG,CACxB,IAAMC,CAAAA,CAAWxiC,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI2I,CAAAA,CAAQ,CAAC,CAAA,EAAG,KAAA,CAC7C,GAAI65B,CAAAA,GAAa,SAAA,CAAW,CAC1B,IAAMC,CAAAA,CAAKhB,CAAAA,CAAK,IAAA,CAAK94B,CAAAA,CAAQ,CAAC,CAAA,CAC9B45B,CAAAA,CAAU,CAAC,CAAA,CAAIxC,EAAAA,CAAsBwC,EAAU,CAAC,CAAA,CAAIE,CAAAA,CAAG,CAAA,CAAGA,CAAAA,CAAG,CAAA,CAAGA,CAAAA,CAAG,KAAA,CAAQ,CAAA,CAAGA,CAAAA,CAAG,MAAA,CAAS,CAAC,EAC7F,CAAA,KAAA,GAAWD,GAAYlB,EAAAA,CAAgB,GAAA,CAAIkB,CAAQ,CAAA,CAAG,CACpD,IAAMC,CAAAA,CAAKhB,CAAAA,CAAK,IAAA,CAAK94B,CAAAA,CAAQ,CAAC,CAAA,CAC9B45B,CAAAA,CAAU,CAAC,EAAIpC,EAAAA,CAAqBoC,CAAAA,CAAU,CAAC,CAAA,CAAIE,CAAAA,CAAG,CAAA,CAAGA,CAAAA,CAAG,CAAA,CAAG,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAG,KAAA,CAAOA,CAAAA,CAAG,MAAM,EAAI,CAAC,EAClG,CACA,IAAMC,CAAAA,CAAW1iC,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI2I,CAAAA,CAAQ,CAAC,CAAA,EAAG,KAAA,CAC7C,GAAI+5B,CAAAA,GAAa,UAAW,CAC1B,IAAMC,CAAAA,CAAKlB,CAAAA,CAAK,IAAA,CAAK94B,CAAAA,CAAQ,CAAC,CAAA,CACxBJ,CAAAA,CAAOg6B,CAAAA,CAAU,MAAA,CAAS,CAAA,CAChCA,CAAAA,CAAUh6B,CAAI,EAAIw3B,EAAAA,CAAsBwC,CAAAA,CAAUh6B,CAAI,CAAA,CAAIo6B,CAAAA,CAAG,CAAA,CAAGA,CAAAA,CAAG,CAAA,CAAGA,CAAAA,CAAG,KAAA,CAAQ,CAAA,CAAGA,CAAAA,CAAG,MAAA,CAAS,CAAC,EACnG,CAAA,KAAA,GAAWD,CAAAA,EAAYpB,EAAAA,CAAgB,GAAA,CAAIoB,CAAQ,CAAA,CAAG,CACpD,IAAMC,CAAAA,CAAKlB,CAAAA,CAAK,IAAA,CAAK94B,CAAAA,CAAQ,CAAC,CAAA,CACxBJ,EAAOg6B,CAAAA,CAAU,MAAA,CAAS,CAAA,CAChCA,CAAAA,CAAUh6B,CAAI,CAAA,CAAI43B,EAAAA,CAAqBoC,CAAAA,CAAUh6B,CAAI,CAAA,CAAIo6B,CAAAA,CAAG,CAAA,CAAGA,CAAAA,CAAG,CAAA,CAAG,KAAK,GAAA,CAAIA,CAAAA,CAAG,KAAA,CAAOA,CAAAA,CAAG,MAAM,CAAA,CAAI,CAAC,EACxG,CACF,CAEA,IAAMC,CAAAA,CAAcvC,EAAAA,CAAiBkC,CAAAA,CAAWhC,CAAa,CAAA,CAIvDiC,CAAAA,CAAWxiC,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI2I,CAAAA,CAAQ,CAAC,CAAA,EAAG,KAAA,CACvC+5B,CAAAA,CAAW1iC,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI2I,CAAAA,CAAQ,CAAC,GAAG,KAAA,CACvCk6B,CAAAA,CAAWL,CAAAA,EAAY,CAACjB,EAAAA,CAAgB,GAAA,CAAIiB,CAAQ,CAAA,EAAM,CAACA,CAAAA,CAAAA,CAC5D,IAAM,CAAE,IAAMC,CAAAA,CAAKhB,EAAK,IAAA,CAAK94B,CAAAA,CAAQ,CAAC,CAAA,CAAG,OAAO85B,CAAAA,CAAK,CAAE,EAAA,CAAIA,CAAAA,CAAG,CAAA,CAAG,EAAA,CAAIA,CAAAA,CAAG,CAAA,CAAG,EAAA,CAAIA,EAAG,KAAA,CAAQ,CAAA,CAAG,EAAA,CAAIA,CAAAA,CAAG,MAAA,CAAS,CAAE,CAAA,CAAI,IAAK,CAAA,GAAG,CAC5H,IAAA,CACEK,CAAAA,CAAWJ,CAAAA,EAAY,CAACnB,GAAgB,GAAA,CAAImB,CAAQ,CAAA,EAAM,CAACA,CAAAA,CAAAA,CAC5D,IAAM,CAAE,IAAMC,CAAAA,CAAKlB,CAAAA,CAAK,IAAA,CAAK94B,CAAAA,CAAQ,CAAC,CAAA,CAAG,OAAOg6B,CAAAA,CAAK,CAAE,EAAA,CAAIA,CAAAA,CAAG,CAAA,CAAG,EAAA,CAAIA,CAAAA,CAAG,CAAA,CAAG,EAAA,CAAIA,CAAAA,CAAG,KAAA,CAAQ,CAAA,CAAG,EAAA,CAAIA,CAAAA,CAAG,OAAS,CAAE,CAAA,CAAI,IAAK,CAAA,GAAG,CAC5H,IAAA,CACErC,CAAAA,CAASO,EAAAA,CAAqB+B,CAAAA,CAAaC,CAAAA,CAASC,CAAO,CAAA,CAE7DC,CAAAA,CACJ,OAAIT,EAAa,KAAA,EAASD,CAAAA,CAAU,CAAA,EAAK,IAAA,EAAQA,CAAAA,CAAU,CAAA,EAAK,IAAA,GAC9DU,CAAAA,CAAgB,CAAE,CAAA,CAAGV,CAAAA,CAAU,CAAA,CAAG,CAAA,CAAGA,CAAAA,CAAU,CAAE,CAAA,CAAA,CAG5C,CACL,MAAA,CAAQC,CAAAA,CAAa,MAAA,CACrB,MAAA,CAAQA,CAAAA,CAAa,MAAA,CACrB,KAAA,CAAOA,CAAAA,CAAa,KAAA,CACpB,KAAA,CAAOA,CAAAA,CAAa,KAAA,CACpB,cAAeA,CAAAA,CAAa,aAAA,CAC5B,WAAA,CAAaA,CAAAA,CAAa,WAAA,CAC1B,MAAA,CAAAhC,CAAAA,CACA,aAAA,CAAAyC,CACF,CACF,CAAC,CAAA,CAGKC,CAAAA,CAA4BzoC,CAAAA,CAAG,SAAS,GAAA,CAAI8H,CAAAA,EAAS4gC,EAAAA,CAAaxB,CAAAA,CAAMp/B,CAAK,CAAC,CAAA,CAE9E6gC,CAAAA,CAAYzB,CAAAA,CAAK,KAAA,EAAM,CAC7B,OAAO,CACL,EAAA,CAAIlnC,EAAG,EAAA,CACP,KAAA,CAAOA,CAAAA,CAAG,KAAA,CACV,KAAA,CAAO2oC,CAAAA,CAAU,KAAA,EAAS,GAAA,CAC1B,MAAA,CAAQA,CAAAA,CAAU,MAAA,EAAU,GAAA,CAC5B,KAAA,CAAAjtB,CAAAA,CACA,MAAA8C,CAAAA,CACA,MAAA,CAAAiqB,CAAAA,CACA,OAAA,CAAArnB,CAAAA,CACA,mBAAA,CAAAomB,CACF,CACF,CAQA,eAAsB1jC,EAAAA,CACpB2B,CAAAA,CACAg/B,CAAAA,CAAyB,GACC,CAC1B,IAAM7gC,CAAAA,CAAO,CAAE,GAAG0b,EAAAA,CAAU,GAAGmlB,CAAQ,CAAA,CAUjCmE,CAAAA,CAAc,IAAI,GAAA,CACxB,IAAA,IAAW5oC,CAAAA,IAAMyF,EAAM,SAAA,CACjBzF,CAAAA,CAAG,SAAA,EAAaA,CAAAA,CAAG,SAAA,GAAcyF,CAAAA,CAAM,SAAA,EACzCmjC,CAAAA,CAAY,GAAA,CAAI5oC,CAAAA,CAAG,EAAA,CAAIinC,EAAAA,CAAyBjnC,CAAAA,CAAIyF,CAAAA,CAAO7B,CAAI,CAAC,CAAA,CAQpE,IAAM9F,CAAAA,CAAI,IAAI,EAAA,CAAAqpC,OAAAA,CAAM,QAAA,CAAS,KAAA,CAAM,CAAE,QAAA,CAAU,IAAA,CAAM,QAAA,CAAU,IAAK,CAAC,CAAA,CACrErpC,CAAAA,CAAE,QAAA,CAAS,CACT,OAAA,CAASspC,EAAAA,CAAiB3hC,CAAAA,CAAM,SAAS,CAAA,CACzC,SAAA,CAAW,QAAA,CACX,OAAA,CAAS7B,CAAAA,CAAK,WAAA,CACd,OAAA,CAASA,EAAK,YAAA,CACd,OAAA,CAASA,CAAAA,CAAK,OAAA,CACd,OAAA,CAASA,CAAAA,CAAK,OAChB,CAAC,CAAA,CACD9F,CAAAA,CAAE,mBAAA,CAAoB,KAAO,EAAC,CAAE,EAOhC,IAAM+qC,CAAAA,CAAkB,IAAI,GAAA,CAC5B,IAAA,IAAW7oC,CAAAA,IAAMyF,CAAAA,CAAM,SAAA,CACrBojC,CAAAA,CAAgB,GAAA,CAAI7oC,CAAAA,CAAG,EAAE,CAAA,CACzBqnC,EAAAA,CAAuBrnC,EAAI6oC,CAAe,CAAA,CAI5C,IAAA,GAAW,CAACxvB,CAAAA,CAAI3Z,CAAI,CAAA,GAAK+F,CAAAA,CAAM,KAAA,CAC7B,GAAI,CAACojC,CAAAA,CAAgB,GAAA,CAAIxvB,CAAE,EAAG,CAC5B,IAAM7E,CAAAA,CAAO8yB,EAAAA,CAAiBjuB,CAAAA,CAAI3Z,CAAAA,CAAK,KAAA,CAAOA,CAAAA,CAAK,KAAK,CAAA,CACxD5B,CAAAA,CAAE,OAAA,CAAQub,CAAAA,CAAI,CAAE,MAAO3Z,CAAAA,CAAK,KAAA,CAAO,KAAA,CAAO8U,CAAAA,CAAK,KAAA,CAAO,MAAA,CAAQA,CAAAA,CAAK,MAAO,CAAC,EAC7E,CAKF,IAAA,IAAWxU,CAAAA,IAAMyF,CAAAA,CAAM,UACrB,GAAImjC,CAAAA,CAAY,GAAA,CAAI5oC,CAAAA,CAAG,EAAE,CAAA,CAAG,CAC1B,IAAM8oC,CAAAA,CAAKF,CAAAA,CAAY,GAAA,CAAI5oC,CAAAA,CAAG,EAAE,CAAA,CAChClC,EAAE,OAAA,CAAQkC,CAAAA,CAAG,EAAA,CAAI,CAAE,KAAA,CAAO8oC,CAAAA,CAAG,KAAA,CAAO,MAAA,CAAQA,CAAAA,CAAG,MAAO,CAAC,EACzD,CAAA,KACEvB,EAAAA,CAAmBzpC,EAAGkC,CAAAA,CAAIyF,CAAK,CAAA,CAQnC,IAAMsjC,CAAAA,CAAoB,IAAI,GAAA,CACxBC,CAAAA,CAAmB,IAAI,GAAA,CAC7B,IAAA,IAAWhpC,CAAAA,IAAMyF,CAAAA,CAAM,SAAA,CAChBmjC,EAAY,GAAA,CAAI5oC,CAAAA,CAAG,EAAE,CAAA,EACxBipC,EAAAA,CAAuBjpC,CAAAA,CAAI+oC,CAAAA,CAAmBC,CAAgB,CAAA,CAOlE,IAAA,GAAW,CAACE,CAAAA,CAAMJ,CAAE,CAAA,GAAKF,EACvB,IAAA,IAAWtkB,CAAAA,IAAUwkB,CAAAA,CAAG,OAAA,CACtBC,CAAAA,CAAkB,GAAA,CAAIzkB,CAAAA,CAAQ4kB,CAAI,CAAA,CAClCF,CAAAA,CAAiB,GAAA,CAAI1kB,CAAAA,CAAQ4kB,CAAI,CAAA,CAMrC,IAAMC,CAAAA,CAAqB,IAAI,GAAA,CAC/B,IAAA,IAAWL,CAAAA,IAAMF,CAAAA,CAAY,MAAA,EAAO,CAClC,IAAA,IAAW7d,CAAAA,IAAO+d,CAAAA,CAAG,mBAAA,CAAqBK,CAAAA,CAAmB,GAAA,CAAIpe,CAAG,CAAA,CAUtE,IAAMqe,CAAAA,CAAoB,IAAI,GAAA,CAE9B,IAAA,IAAShrC,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIqH,CAAAA,CAAM,KAAA,CAAM,MAAA,CAAQrH,CAAAA,EAAAA,CAAK,CAC3C,GAAI+qC,CAAAA,CAAmB,GAAA,CAAI/qC,CAAC,CAAA,CAAG,SAE/B,IAAMyC,CAAAA,CAAO4E,CAAAA,CAAM,KAAA,CAAMrH,CAAC,CAAA,CACpByO,CAAAA,CAASm8B,CAAAA,CAAiB,GAAA,CAAInoC,EAAK,MAAM,CAAA,EAAKA,CAAAA,CAAK,MAAA,CACnD+L,CAAAA,CAASm8B,CAAAA,CAAkB,GAAA,CAAIloC,CAAAA,CAAK,MAAM,CAAA,EAAKA,CAAAA,CAAK,MAAA,CACpD+H,CAAAA,CAAqC,CAAE,OAAQxK,CAAE,CAAA,CACnDyC,CAAAA,CAAK,KAAA,GACP+H,CAAAA,CAAU,KAAA,CAAQ/H,CAAAA,CAAK,KAAA,CACvB+H,CAAAA,CAAU,KAAA,CAAQ+7B,EAAAA,CAAkB9jC,CAAAA,CAAK,KAAA,CAAOmkC,CAAAA,CAAW,SAAA,CAAWC,EAAAA,CAAa,SAAS,CAAA,CAAI,CAAA,CAChGr8B,CAAAA,CAAU,MAAA,CAASo8B,CAAAA,CAAW,SAAA,CAAY,CAAA,CAC1Cp8B,CAAAA,CAAU,QAAA,CAAW,GAAA,CAAA,CAIlBwgC,CAAAA,CAAkB,GAAA,CAAIx8B,CAAM,IAC/BhE,CAAAA,CAAU,MAAA,CAAS,CAAA,CACnBwgC,CAAAA,CAAkB,GAAA,CAAIx8B,CAAM,CAAA,CAAA,CAG9B9O,CAAAA,CAAE,OAAA,CAAQ+O,CAAAA,CAAQD,CAAAA,CAAQhE,CAAS,EACrC,CAKA,GAAI,CACF,EAAA,CAAAu+B,OAAAA,CAAM,MAAA,CAAOrpC,CAAC,EAChB,CAAA,MAASurC,CAAAA,CAAK,CACZ,IAAMC,CAAAA,CAAUD,CAAAA,YAAe,KAAA,CAAQA,CAAAA,CAAI,QAAU,MAAA,CAAOA,CAAG,CAAA,CAC/D,MAAM,IAAI,KAAA,CAAM,CAAA,qBAAA,EAAwBC,CAAO,CAAA,CAAE,CACnD,CAKA,OAAOC,EAAAA,CAAuBzrC,CAAAA,CAAG2H,EAAO7B,CAAAA,CAAK,OAAA,CAASglC,CAAW,CACnE,CAOA,SAASxB,EAAAA,CAAiBhiB,CAAAA,CAAwC,CAChE,OAAQA,CAAAA,EACN,KAAK,IAAA,CAAM,OAAO,IAAA,CAClB,KAAK,IAAA,CAAM,OAAO,IAAA,CAClB,KAAK,IAAA,CAAM,OAAO,IAAA,CAGlB,QAAS,OAAO,IAClB,CACF,CAGA,SAASkiB,EAAAA,CAAiBjuB,CAAAA,CAAYra,CAAAA,CAAeglB,CAAAA,CAAkD,CAGrG,IAAIjR,CAAAA,CAFc4xB,EAAAA,CAAkB3lC,CAAAA,CAAOgmC,CAAAA,CAAW,SAAA,CAAWC,EAAAA,CAAa,SAAS,CAAA,CAE/DE,GAAa,UAAA,CAAa,CAAA,CAC9Cx9B,CAAAA,CAASq9B,CAAAA,CAAW,SAAA,CAAYG,EAAAA,CAAa,QAAA,CAAW,CAAA,CAG5D,GAAInhB,CAAAA,GAAU,SAAA,CAAW,CACvB,IAAMwlB,CAAAA,CAAO,KAAK,GAAA,CAAIz2B,CAAAA,CAAOpL,CAAM,CAAA,CAAIw9B,EAAAA,CAAa,YAAA,CACpDpyB,CAAAA,CAAQy2B,CAAAA,CACR7hC,CAAAA,CAAS6hC,EACX,CAIA,GAAIxlB,CAAAA,GAAU,QAAA,EAAYA,IAAU,cAAA,CAAgB,CAClD,IAAMylB,CAAAA,CAAW,IAAA,CAAK,IAAA,CAAK,IAAA,CAAK,IAAA,CAAK12B,CAAAA,CAAQA,CAAAA,CAAQpL,CAAAA,CAASA,CAAM,CAAC,CAAA,CAAI,EACzEoL,CAAAA,CAAQiR,CAAAA,GAAU,cAAA,CAAiBylB,CAAAA,CAAW,EAAA,CAAKA,CAAAA,CACnD9hC,CAAAA,CAASoL,EACX,CAGA,OAAIiR,CAAAA,GAAU,SAAA,GACZjR,CAAAA,EAASoyB,EAAAA,CAAa,aAIpBnhB,CAAAA,GAAU,WAAA,EAAeA,CAAAA,GAAU,eAAA,IACrCjR,CAAAA,EAASoyB,EAAAA,CAAa,UAAA,CAAA,CAIpBnhB,CAAAA,GAAU,YAAA,GACZjR,CAAAA,EAAS,EAAA,CAAA,CAIPiR,CAAAA,GAAU,UAAA,GACZrc,CAAAA,EAAU,KAIRqc,CAAAA,GAAU,aAAA,EAAiBA,CAAAA,GAAU,WAAA,IACvCjR,CAAAA,CAAQ,EAAA,CACRpL,CAAAA,CAAS,EAAA,CAAA,CAIXoL,CAAAA,CAAQ,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAO,EAAE,CAAA,CAC1BpL,EAAS,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAQ,EAAE,CAAA,CAErB,CAAE,KAAA,CAAAoL,CAAAA,CAAO,MAAA,CAAApL,CAAO,CACzB,CASA,SAAS4/B,EAAAA,CACPzpC,EACAkC,CAAAA,CACAyF,CAAAA,CACA44B,CAAAA,CACM,CAKNvgC,CAAAA,CAAE,OAAA,CAAQkC,CAAAA,CAAG,EAAA,CAAI,CAAE,KAAA,CAAOA,CAAAA,CAAG,KAAM,CAAC,CAAA,CAGhCq+B,GACFvgC,CAAAA,CAAE,SAAA,CAAUkC,CAAAA,CAAG,EAAA,CAAIq+B,CAAQ,CAAA,CAI7B,IAAA,IAAW/Z,CAAAA,IAAUtkB,CAAAA,CAAG,OAAA,CAAS,CAC/B,IAAMN,CAAAA,CAAO+F,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI6e,CAAM,CAAA,CACnC,GAAI5kB,CAAAA,CAAM,CACR,IAAM8U,CAAAA,CAAO8yB,EAAAA,CAAiBhjB,CAAAA,CAAQ5kB,CAAAA,CAAK,KAAA,CAAOA,CAAAA,CAAK,KAAK,CAAA,CAC5D5B,EAAE,OAAA,CAAQwmB,CAAAA,CAAQ,CAAE,KAAA,CAAO5kB,CAAAA,CAAK,KAAA,CAAO,KAAA,CAAO8U,CAAAA,CAAK,KAAA,CAAO,MAAA,CAAQA,CAAAA,CAAK,MAAO,CAAC,CAAA,CAC/E1W,EAAE,SAAA,CAAUwmB,CAAAA,CAAQtkB,CAAAA,CAAG,EAAE,EAC3B,CACF,CAGA,IAAA,IAAW8H,CAAAA,IAAS9H,CAAAA,CAAG,QAAA,CACrBunC,EAAAA,CAAmBzpC,CAAAA,CAAGgK,CAAAA,CAAOrC,EAAOzF,CAAAA,CAAG,EAAE,EAE7C,CAUA,SAASipC,EAAAA,CACPjpC,CAAAA,CACA0pC,CAAAA,CACAC,CAAAA,CACM,CAGN,IAAA,IAAW7hC,CAAAA,IAAS9H,CAAAA,CAAG,QAAA,CACrBipC,GAAuBnhC,CAAAA,CAAO4hC,CAAAA,CAAUC,CAAO,CAAA,CAIjD,IAAMC,CAAAA,CAAW,CAAC,GAAG5pC,CAAAA,CAAG,OAAA,CAAS,GAAGA,CAAAA,CAAG,QAAA,CAAS,GAAA,CAAI,GAAK,CAAA,CAAE,EAAE,CAAC,CAAA,CAE9D,GAAI4pC,CAAAA,CAAS,MAAA,GAAW,CAAA,CAAG,CAKzBF,CAAAA,CAAS,GAAA,CAAI1pC,CAAAA,CAAG,EAAA,CAAIA,CAAAA,CAAG,EAAE,CAAA,CACzB2pC,CAAAA,CAAQ,GAAA,CAAI3pC,CAAAA,CAAG,EAAA,CAAIA,CAAAA,CAAG,EAAE,CAAA,CACxB,MACF,CAGA,IAAM6pC,CAAAA,CAAaD,CAAAA,CAAS,CAAC,EACvBE,CAAAA,CAAYF,CAAAA,CAASA,CAAAA,CAAS,MAAA,CAAS,CAAC,CAAA,CAC9CF,CAAAA,CAAS,GAAA,CAAI1pC,CAAAA,CAAG,EAAA,CAAI0pC,CAAAA,CAAS,GAAA,CAAIG,CAAU,CAAA,EAAKA,CAAU,CAAA,CAC1DF,CAAAA,CAAQ,GAAA,CAAI3pC,CAAAA,CAAG,EAAA,CAAI2pC,CAAAA,CAAQ,GAAA,CAAIG,CAAS,CAAA,EAAKA,CAAS,EACxD,CAOA,SAASjC,EAAAA,CAAiBpiC,EAAqB6e,CAAAA,CAAoD,CACjG,IAAMhD,CAAAA,CAAY7b,CAAAA,CAAM,gBAAA,CAAiB,GAAA,CAAI6e,CAAM,CAAA,CAC7CylB,CAAAA,CAAazoB,CAAAA,CAAY7b,CAAAA,CAAM,SAAA,CAAU,GAAA,CAAI6b,CAAS,CAAA,CAAI,MAAA,CAC1D0oB,CAAAA,CAAcvkC,CAAAA,CAAM,UAAA,CAAW,GAAA,CAAI6e,CAAM,CAAA,CAC/C,GAAI,EAAA,CAACylB,CAAAA,EAAc,CAACC,CAAAA,CAAAA,CAEpB,OAAO,CAAE,GAAGD,CAAAA,CAAY,GAAGC,CAAY,CACzC,CAGA,SAAS3C,EAAAA,CAAuBrnC,CAAAA,CAAqBmmC,CAAAA,CAAwB,CAC3E,IAAA,IAAW9sB,CAAAA,IAAMrZ,CAAAA,CAAG,QAClBmmC,CAAAA,CAAI,GAAA,CAAI9sB,CAAE,CAAA,CAEZ,IAAA,IAAWvR,CAAAA,IAAS9H,CAAAA,CAAG,QAAA,CACrBqnC,EAAAA,CAAuBv/B,CAAAA,CAAOq+B,CAAG,EAErC,CAMA,SAASoD,GACPzrC,CAAAA,CACA2H,CAAAA,CACA+nB,CAAAA,CACAob,CAAAA,CACiB,CACjB,IAAMltB,CAAAA,CAA0B,EAAC,CAC3B+sB,CAAAA,CAA4B,EAAC,CAG7BwB,CAAAA,CAAc,IAAI,IACxB,IAAA,IAAWjqC,CAAAA,IAAMyF,CAAAA,CAAM,SAAA,CACrBiiC,EAAAA,CAAsB1nC,CAAAA,CAAIiqC,CAAW,CAAA,CAIvC,IAAMC,CAAAA,CAAqB,IAAI,GAAA,CAC/B,GAAItB,CAAAA,CACF,QAAWE,CAAAA,IAAMF,CAAAA,CAAY,MAAA,EAAO,CAClC,IAAA,IAAWtkB,CAAAA,IAAUwkB,CAAAA,CAAG,OAAA,CAASoB,CAAAA,CAAmB,GAAA,CAAI5lB,CAAM,CAAA,CAKlE,IAAA,IAAWA,CAAAA,IAAUxmB,CAAAA,CAAE,KAAA,EAAM,CAAG,CAC9B,GAAImsC,CAAAA,CAAY,GAAA,CAAI3lB,CAAM,CAAA,CAAG,SAE7B,IAAMyD,CAAAA,CAAQtiB,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI6e,CAAM,EACpC,GAAI,CAACyD,CAAAA,CAAO,SAEZ,IAAM4f,CAAAA,CAAY7pC,CAAAA,CAAE,IAAA,CAAKwmB,CAAM,CAAA,CAC/B,GAAI,CAACqjB,CAAAA,CAAW,SAEhB,IAAMC,CAAAA,CAAUrC,EAAAA,CAAgBoC,CAAAA,CAAU,CAAA,CAAGA,CAAAA,CAAU,CAAA,CAAGA,CAAAA,CAAU,KAAA,CAAOA,CAAAA,CAAU,MAAM,CAAA,CAE3FjsB,CAAAA,CAAM,IAAA,CAAK,CACT,GAAI4I,CAAAA,CACJ,KAAA,CAAOyD,CAAAA,CAAM,KAAA,CACb,KAAA,CAAOA,CAAAA,CAAM,KAAA,CACb,CAAA,CAAG6f,CAAAA,CAAQ,CAAA,CACX,CAAA,CAAGA,CAAAA,CAAQ,CAAA,CACX,KAAA,CAAOD,EAAU,KAAA,CACjB,MAAA,CAAQA,CAAAA,CAAU,MAAA,CAClB,WAAA,CAAaE,EAAAA,CAAiBpiC,CAAAA,CAAO6e,CAAM,CAC7C,CAAC,EACH,CAIA,IAAA,IAAWtkB,CAAAA,IAAMyF,EAAM,SAAA,CACrBgjC,CAAAA,CAAO,IAAA,CAAKC,EAAAA,CAAa5qC,CAAAA,CAAGkC,CAAE,CAAC,CAAA,CAIjC,IAAMgmC,CAAAA,CAAgBvgC,CAAAA,CAAM,SAAA,GAAc,IAAA,EAAQA,CAAAA,CAAM,YAAc,IAAA,EAAQA,CAAAA,CAAM,SAAA,GAAc,IAAA,CAG5F+Y,CAAAA,CAA0B1gB,CAAAA,CAAE,KAAA,EAAM,CAAE,GAAA,CAAIsQ,CAAAA,EAAW,CACvD,IAAM05B,CAAAA,CAAYhqC,CAAAA,CAAE,KAAKsQ,CAAO,CAAA,CAE1B25B,CAAAA,CAAetiC,CAAAA,CAAM,KAAA,CAAMqiC,CAAAA,CAAU,MAAgB,CAAA,CACrDE,CAAAA,CAAqBF,CAAAA,CAAU,MAAA,EAAU,EAAC,CAKhD,GAAIE,EAAU,MAAA,CAAS,CAAA,CAAG,CACxB,IAAMC,CAAAA,CAAWxiC,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI2I,CAAAA,CAAQ,CAAC,CAAA,EAAG,KAAA,CAC7C,GAAI65B,CAAAA,GAAa,UAAW,CAC1B,IAAMC,CAAAA,CAAKpqC,CAAAA,CAAE,IAAA,CAAKsQ,CAAAA,CAAQ,CAAC,CAAA,CAC3B45B,CAAAA,CAAU,CAAC,CAAA,CAAIxC,EAAAA,CAAsBwC,CAAAA,CAAU,CAAC,EAAIE,CAAAA,CAAG,CAAA,CAAGA,CAAAA,CAAG,CAAA,CAAGA,CAAAA,CAAG,KAAA,CAAQ,CAAA,CAAGA,CAAAA,CAAG,MAAA,CAAS,CAAC,EAC7F,CAAA,KAAA,GAAWD,CAAAA,EAAYlB,EAAAA,CAAgB,IAAIkB,CAAQ,CAAA,CAAG,CACpD,IAAMC,CAAAA,CAAKpqC,CAAAA,CAAE,IAAA,CAAKsQ,CAAAA,CAAQ,CAAC,CAAA,CAC3B45B,CAAAA,CAAU,CAAC,CAAA,CAAIpC,EAAAA,CAAqBoC,EAAU,CAAC,CAAA,CAAIE,CAAAA,CAAG,CAAA,CAAGA,CAAAA,CAAG,CAAA,CAAG,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAG,KAAA,CAAOA,CAAAA,CAAG,MAAM,CAAA,CAAI,CAAC,EAClG,CACA,IAAMC,CAAAA,CAAW1iC,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI2I,CAAAA,CAAQ,CAAC,CAAA,EAAG,KAAA,CAC7C,GAAI+5B,CAAAA,GAAa,SAAA,CAAW,CAC1B,IAAMC,CAAAA,CAAKtqC,CAAAA,CAAE,IAAA,CAAKsQ,CAAAA,CAAQ,CAAC,CAAA,CACrBJ,CAAAA,CAAOg6B,CAAAA,CAAU,MAAA,CAAS,CAAA,CAChCA,CAAAA,CAAUh6B,CAAI,CAAA,CAAIw3B,EAAAA,CAAsBwC,EAAUh6B,CAAI,CAAA,CAAIo6B,CAAAA,CAAG,CAAA,CAAGA,CAAAA,CAAG,CAAA,CAAGA,CAAAA,CAAG,KAAA,CAAQ,CAAA,CAAGA,CAAAA,CAAG,MAAA,CAAS,CAAC,EACnG,CAAA,KAAA,GAAWD,CAAAA,EAAYpB,EAAAA,CAAgB,GAAA,CAAIoB,CAAQ,CAAA,CAAG,CACpD,IAAMC,CAAAA,CAAKtqC,CAAAA,CAAE,IAAA,CAAKsQ,CAAAA,CAAQ,CAAC,CAAA,CACrBJ,CAAAA,CAAOg6B,CAAAA,CAAU,MAAA,CAAS,EAChCA,CAAAA,CAAUh6B,CAAI,CAAA,CAAI43B,EAAAA,CAAqBoC,CAAAA,CAAUh6B,CAAI,CAAA,CAAIo6B,CAAAA,CAAG,CAAA,CAAGA,CAAAA,CAAG,CAAA,CAAG,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAG,MAAOA,CAAAA,CAAG,MAAM,CAAA,CAAI,CAAC,EACxG,CACF,CAGA,IAAMC,CAAAA,CAAcvC,EAAAA,CAAiBkC,CAAAA,CAAWhC,CAAa,CAAA,CAIvDmE,CAAAA,CAAkB1kC,EAAM,KAAA,CAAM,GAAA,CAAI2I,CAAAA,CAAQ,CAAC,CAAA,EAAG,KAAA,CAC9Cg8B,CAAAA,CAAkB3kC,CAAAA,CAAM,KAAA,CAAM,GAAA,CAAI2I,CAAAA,CAAQ,CAAC,CAAA,EAAG,KAAA,CAC9Ck6B,EAAW6B,CAAAA,EAAmB,CAACnD,EAAAA,CAAgB,GAAA,CAAImD,CAAe,CAAA,EAAM,CAACA,CAAAA,CAAAA,CAC1E,IAAM,CAAE,IAAMjC,CAAAA,CAAKpqC,CAAAA,CAAE,IAAA,CAAKsQ,EAAQ,CAAC,CAAA,CAAG,OAAO85B,CAAAA,CAAK,CAAE,EAAA,CAAIA,CAAAA,CAAG,CAAA,CAAG,EAAA,CAAIA,CAAAA,CAAG,CAAA,CAAG,EAAA,CAAIA,CAAAA,CAAG,KAAA,CAAQ,EAAG,EAAA,CAAIA,CAAAA,CAAG,MAAA,CAAS,CAAE,CAAA,CAAI,IAAK,CAAA,GAAG,CACzH,IAAA,CACEK,CAAAA,CAAW6B,CAAAA,EAAmB,CAACpD,EAAAA,CAAgB,GAAA,CAAIoD,CAAe,CAAA,EAAM,CAACA,CAAAA,CAAAA,CAC1E,IAAM,CAAE,IAAMhC,CAAAA,CAAKtqC,CAAAA,CAAE,IAAA,CAAKsQ,CAAAA,CAAQ,CAAC,CAAA,CAAG,OAAOg6B,CAAAA,CAAK,CAAE,EAAA,CAAIA,CAAAA,CAAG,CAAA,CAAG,EAAA,CAAIA,CAAAA,CAAG,CAAA,CAAG,EAAA,CAAIA,CAAAA,CAAG,KAAA,CAAQ,CAAA,CAAG,EAAA,CAAIA,CAAAA,CAAG,MAAA,CAAS,CAAE,EAAI,IAAK,CAAA,GAAG,CACzH,IAAA,CACErC,CAAAA,CAASO,EAAAA,CAAqB+B,CAAAA,CAAaC,CAAAA,CAASC,CAAO,CAAA,CAG7DC,CAAAA,CACJ,OAAIT,CAAAA,CAAa,KAAA,EAASD,EAAU,CAAA,EAAK,IAAA,EAAQA,CAAAA,CAAU,CAAA,EAAK,IAAA,GAC9DU,CAAAA,CAAgB,CAAE,CAAA,CAAGV,CAAAA,CAAU,CAAA,CAAG,CAAA,CAAGA,CAAAA,CAAU,CAAE,CAAA,CAAA,CAG5C,CACL,MAAA,CAAQC,CAAAA,CAAa,MAAA,CACrB,MAAA,CAAQA,CAAAA,CAAa,MAAA,CACrB,KAAA,CAAOA,CAAAA,CAAa,KAAA,CACpB,KAAA,CAAOA,CAAAA,CAAa,KAAA,CACpB,aAAA,CAAeA,CAAAA,CAAa,cAC5B,WAAA,CAAaA,CAAAA,CAAa,WAAA,CAC1B,MAAA,CAAAhC,CAAAA,CACA,aAAA,CAAAyC,CACF,CACF,CAAC,CAAA,CASD,GAAII,CAAAA,EAAeA,CAAAA,CAAY,IAAA,CAAO,EAAG,CAEvC,IAAMyB,CAAAA,CAAkB,IAAI,GAAA,CAC5B,IAAA,IAAWpsC,CAAAA,IAAKyd,CAAAA,CACd2uB,CAAAA,CAAgB,GAAA,CAAIpsC,CAAAA,CAAE,EAAA,CAAI,CAAE,EAAA,CAAIA,EAAE,CAAA,CAAIA,CAAAA,CAAE,KAAA,CAAQ,CAAA,CAAG,EAAA,CAAIA,CAAAA,CAAE,CAAA,CAAIA,CAAAA,CAAE,MAAA,CAAS,CAAE,CAAC,CAAA,CAG7E,IAAA,GAAW,CAACirC,EAAMJ,CAAE,CAAA,GAAKF,CAAAA,CAAa,CAEpC,IAAM0B,CAAAA,CAAcxsC,CAAAA,CAAE,IAAA,CAAKorC,CAAI,CAAA,CAC/B,GAAI,CAACoB,CAAAA,CAAa,SAClB,IAAM1C,CAAAA,CAAUrC,EAAAA,CAAgB+E,CAAAA,CAAY,CAAA,CAAGA,CAAAA,CAAY,CAAA,CAAGA,CAAAA,CAAY,KAAA,CAAOA,CAAAA,CAAY,MAAM,CAAA,CAGnG,IAAA,IAAWC,CAAAA,IAAUzB,CAAAA,CAAG,KAAA,CAAO,CAC7B,IAAM0B,CAAAA,CAAW,CACf,GAAGD,CAAAA,CACH,CAAA,CAAGA,CAAAA,CAAO,CAAA,CAAI3C,CAAAA,CAAQ,CAAA,CACtB,CAAA,CAAG2C,CAAAA,CAAO,CAAA,CAAI3C,CAAAA,CAAQ,CACxB,CAAA,CACAlsB,CAAAA,CAAM,IAAA,CAAK8uB,CAAQ,CAAA,CACnBH,CAAAA,CAAgB,GAAA,CAAIG,CAAAA,CAAS,EAAA,CAAI,CAC/B,EAAA,CAAIA,CAAAA,CAAS,CAAA,CAAIA,CAAAA,CAAS,MAAQ,CAAA,CAClC,EAAA,CAAIA,CAAAA,CAAS,CAAA,CAAIA,CAAAA,CAAS,MAAA,CAAS,CACrC,CAAC,EACH,CAGA,IAAA,IAAWC,CAAAA,IAAU3B,CAAAA,CAAG,KAAA,CACtBtqB,EAAM,IAAA,CAAK,CACT,GAAGisB,CAAAA,CACH,MAAA,CAAQA,CAAAA,CAAO,MAAA,CAAO,GAAA,CAAIlkC,CAAAA,GAAM,CAAE,CAAA,CAAGA,CAAAA,CAAE,CAAA,CAAIqhC,CAAAA,CAAQ,EAAG,CAAA,CAAGrhC,CAAAA,CAAE,CAAA,CAAIqhC,CAAAA,CAAQ,CAAE,CAAA,CAAE,CAAA,CAC3E,aAAA,CAAe6C,CAAAA,CAAO,aAAA,CAClB,CAAE,CAAA,CAAGA,CAAAA,CAAO,aAAA,CAAc,EAAI7C,CAAAA,CAAQ,CAAA,CAAG,CAAA,CAAG6C,CAAAA,CAAO,aAAA,CAAc,CAAA,CAAI7C,CAAAA,CAAQ,CAAE,CAAA,CAC/E,MACN,CAAC,CAAA,CAIH,IAAM1I,CAAAA,CAAQwL,GAAcjC,CAAAA,CAAQS,CAAI,CAAA,CACpChK,CAAAA,EAAS4J,CAAAA,CAAG,MAAA,CAAO,MAAA,CAAS,CAAA,GAC9B5J,CAAAA,CAAM,QAAA,CAAW4J,CAAAA,CAAG,MAAA,CAAO,GAAA,CAAI7/B,CAAAA,EAAM0hC,GAAY1hC,CAAAA,CAAI2+B,CAAAA,CAAQ,CAAA,CAAGA,CAAAA,CAAQ,CAAC,CAAC,CAAA,EAE9E,CAMA,IAAA,IAAW/mC,CAAAA,IAAQ2d,CAAAA,CAAO,CAExB,GAAI0rB,CAAAA,CAAmB,IAAIrpC,CAAAA,CAAK,MAAM,CAAA,EAAKqpC,CAAAA,CAAmB,GAAA,CAAIrpC,CAAAA,CAAK,MAAM,CAAA,CAAG,SAEhF,IAAI+pC,CAAAA,CAAW,KAAA,CAGf,GAAIV,CAAAA,CAAmB,IAAIrpC,CAAAA,CAAK,MAAM,CAAA,CAAG,CACvC,IAAMuQ,CAAAA,CAAMi5B,CAAAA,CAAgB,GAAA,CAAIxpC,CAAAA,CAAK,MAAM,CAAA,CACvCuQ,CAAAA,EAAOvQ,CAAAA,CAAK,MAAA,CAAO,OAAS,CAAA,GAC9BA,CAAAA,CAAK,MAAA,CAAO,CAAC,CAAA,CAAI,CAAE,CAAA,CAAGuQ,CAAAA,CAAI,EAAA,CAAI,CAAA,CAAGA,CAAAA,CAAI,EAAG,CAAA,CACxCw5B,CAAAA,CAAW,MAEf,CAGA,GAAIV,CAAAA,CAAmB,GAAA,CAAIrpC,CAAAA,CAAK,MAAM,CAAA,CAAG,CACvC,IAAMuQ,CAAAA,CAAMi5B,CAAAA,CAAgB,GAAA,CAAIxpC,CAAAA,CAAK,MAAM,EACvCuQ,CAAAA,EAAOvQ,CAAAA,CAAK,MAAA,CAAO,MAAA,CAAS,CAAA,GAC9BA,CAAAA,CAAK,MAAA,CAAOA,CAAAA,CAAK,MAAA,CAAO,MAAA,CAAS,CAAC,CAAA,CAAI,CAAE,CAAA,CAAGuQ,EAAI,EAAA,CAAI,CAAA,CAAGA,CAAAA,CAAI,EAAG,CAAA,CAC7Dw5B,CAAAA,CAAW,IAAA,EAEf,CAGIA,CAAAA,GACF/pC,CAAAA,CAAK,MAAA,CAASilC,EAAAA,CAAiBjlC,CAAAA,CAAK,MAAA,CAAQmlC,CAAa,CAAA,EAE7D,CACF,CAaA,IAAM6E,CAAAA,CAAe7F,CAAAA,CAAW,WAAA,CAAc,EAAA,CAC9C8F,EAAAA,CAAuBrC,CAAAA,CAAQoC,CAAY,CAAA,CAI3C,IAAME,CAAAA,CAAaC,EAAAA,CAAiBvC,CAAM,CAAA,CACpCwC,CAAAA,CAAQ,CACZ,GAAGvvB,CAAAA,CAAM,GAAA,CAAIzd,CAAAA,EAAKA,CAAAA,CAAE,CAAC,CAAA,CACrB,GAAG8sC,CAAAA,CAAW,GAAA,CAAI,CAAA,EAAK,EAAE,CAAC,CAC5B,CAAA,CACMG,CAAAA,CAAcD,CAAAA,CAAM,MAAA,CAAS,CAAA,CAAI,IAAA,CAAK,GAAA,CAAI,GAAGA,CAAK,CAAA,CAAIzd,CAAAA,CACxD2d,CAAAA,CAAartC,EAAE,KAAA,EAAM,CAAE,KAAA,EAAS,GAAA,CAChCstC,CAAAA,CAActtC,CAAAA,CAAE,KAAA,EAAM,CAAE,MAAA,EAAU,GAAA,CAEtC,GAAIotC,CAAAA,CAAc1d,CAAAA,CAAS,CACzB,IAAMrmB,CAAAA,CAAKqmB,CAAAA,CAAU0d,CAAAA,CACrB,IAAA,IAAWjtC,CAAAA,IAAKyd,CAAAA,CAAOzd,CAAAA,CAAE,CAAA,EAAKkJ,CAAAA,CAC9B,IAAA,IAAWnJ,CAAAA,IAAKwgB,CAAAA,CAAO,CACrB,IAAA,IAAWjY,KAAKvI,CAAAA,CAAE,MAAA,CAAQuI,CAAAA,CAAE,CAAA,EAAKY,CAAAA,CAC7BnJ,CAAAA,CAAE,aAAA,GAAeA,CAAAA,CAAE,aAAA,CAAc,CAAA,EAAKmJ,CAAAA,EAC5C,CACA,IAAA,IAAWkkC,CAAAA,IAAMN,EAAYM,CAAAA,CAAG,CAAA,EAAKlkC,CAAAA,CACrCikC,CAAAA,EAAejkC,EACjB,CAGA,IAAMmkC,CAAAA,CAAY,IAAA,CAAK,GAAA,CACrB,GAAG5vB,CAAAA,CAAM,GAAA,CAAIzd,CAAAA,EAAKA,EAAE,CAAA,CAAIA,CAAAA,CAAE,MAAM,CAAA,CAChC,GAAG8sC,CAAAA,CAAW,GAAA,CAAI,CAAA,EAAK,CAAA,CAAE,CAAA,CAAI,CAAA,CAAE,MAAM,CAAA,CACrC,GAAGvsB,EAAM,OAAA,CAAQxgB,CAAAA,EAAKA,CAAAA,CAAE,MAAA,CAAO,GAAA,CAAIuI,CAAAA,EAAKA,CAAAA,CAAE,CAAC,CAAC,CAC9C,CAAA,CACA,OAAI+kC,CAAAA,CAAY9d,CAAAA,CAAU4d,IACxBA,CAAAA,CAAcE,CAAAA,CAAY9d,CAAAA,CAAAA,CAGrB,CACL,KAAA,CAAO2d,CAAAA,CACP,MAAA,CAAQC,CAAAA,CACR,KAAA,CAAA1vB,CAAAA,CACA,KAAA,CAAA8C,CAAAA,CACA,MAAA,CAAAiqB,CACF,CACF,CAOA,SAASC,EAAAA,CACP5qC,CAAAA,CACAkC,CAAAA,CACiB,CACjB,IAAM2nC,CAAAA,CAAY7pC,CAAAA,CAAE,IAAA,CAAKkC,CAAAA,CAAG,EAAE,CAAA,CACxB4nC,CAAAA,CAAUD,EACZpC,EAAAA,CAAgBoC,CAAAA,CAAU,CAAA,CAAGA,CAAAA,CAAU,CAAA,CAAGA,CAAAA,CAAU,KAAA,CAAOA,CAAAA,CAAU,MAAM,CAAA,CAC3E,CAAE,CAAA,CAAG,CAAA,CAAG,CAAA,CAAG,CAAE,CAAA,CAEjB,OAAO,CACL,EAAA,CAAI3nC,CAAAA,CAAG,EAAA,CACP,KAAA,CAAOA,CAAAA,CAAG,KAAA,CACV,CAAA,CAAG4nC,CAAAA,CAAQ,CAAA,CACX,CAAA,CAAGA,CAAAA,CAAQ,EACX,KAAA,CAAOD,CAAAA,EAAW,KAAA,EAAS,CAAA,CAC3B,MAAA,CAAQA,CAAAA,EAAW,MAAA,EAAU,CAAA,CAC7B,QAAA,CAAU3nC,CAAAA,CAAG,QAAA,CAAS,GAAA,CAAI8H,CAAAA,EAAS4gC,EAAAA,CAAa5qC,EAAGgK,CAAK,CAAC,CAC3D,CACF,CAcA,SAASgjC,EAAAA,CAAuBrC,CAAAA,CAA2BoC,CAAAA,CAA4B,CACrF,IAAA,IAAW3L,CAAAA,IAASuJ,CAAAA,CAClB8C,EAAAA,CAAqBrM,EAAO2L,CAAY,EAE5C,CAUA,SAASU,EAAAA,CAAqBrM,CAAAA,CAAwB2L,CAAAA,CAA4B,CAEhF,IAAA,IAAW/iC,CAAAA,IAASo3B,CAAAA,CAAM,QAAA,CACxBqM,EAAAA,CAAqBzjC,CAAAA,CAAO+iC,CAAY,CAAA,CAK1C,GAAI3L,CAAAA,CAAM,QAAA,CAAS,MAAA,CAAS,CAAA,CAAG,CAC7B,IAAIn5B,CAAAA,CAAOm5B,CAAAA,CAAM,CAAA,CACbl5B,CAAAA,CAAOk5B,CAAAA,CAAM,CAAA,CAAIA,CAAAA,CAAM,MAAA,CAC3B,IAAA,IAAWp3B,CAAAA,IAASo3B,CAAAA,CAAM,QAAA,CACxBn5B,CAAAA,CAAO,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAM+B,CAAAA,CAAM,CAAC,CAAA,CAC7B9B,CAAAA,CAAO,IAAA,CAAK,GAAA,CAAIA,EAAM8B,CAAAA,CAAM,CAAA,CAAIA,CAAAA,CAAM,MAAM,CAAA,CAE9Co3B,CAAAA,CAAM,MAAA,CAASl5B,CAAAA,CAAOD,CAAAA,CACtBm5B,CAAAA,CAAM,CAAA,CAAIn5B,EACZ,CAMA,GAAIm5B,EAAM,KAAA,CAAO,CACf,IAAMsM,CAAAA,CAAYX,CAAAA,CAAe3F,EAAAA,CACjChG,CAAAA,CAAM,CAAA,EAAKsM,CAAAA,CACXtM,CAAAA,CAAM,MAAA,EAAUsM,EAClB,CACF,CAGA,SAASR,EAAAA,CAAiBvC,CAAAA,CAA8C,CACtE,IAAMh/B,CAAAA,CAA4B,EAAC,CACnC,IAAA,IAAW3L,CAAAA,IAAK2qC,CAAAA,CACdh/B,CAAAA,CAAO,IAAA,CAAK3L,CAAC,CAAA,CACb2L,EAAO,IAAA,CAAK,GAAGuhC,EAAAA,CAAiBltC,CAAAA,CAAE,QAAQ,CAAC,CAAA,CAE7C,OAAO2L,CACT,CAGA,SAASihC,EAAAA,CAAcjC,CAAAA,CAA2BpvB,CAAAA,CAAyC,CACzF,IAAA,IAAWvb,CAAAA,IAAK2qC,CAAAA,CAAQ,CACtB,GAAI3qC,CAAAA,CAAE,EAAA,GAAOub,CAAAA,CAAI,OAAOvb,CAAAA,CACxB,IAAM2tC,CAAAA,CAAQf,EAAAA,CAAc5sC,CAAAA,CAAE,SAAUub,CAAE,CAAA,CAC1C,GAAIoyB,CAAAA,CAAO,OAAOA,CACpB,CAEF,CAGA,SAASd,EAAAA,CAAYzL,CAAAA,CAAwBh4B,CAAAA,CAAYC,CAAAA,CAA6B,CACpF,OAAO,CACL,GAAG+3B,CAAAA,CACH,CAAA,CAAGA,CAAAA,CAAM,CAAA,CAAIh4B,CAAAA,CACb,CAAA,CAAGg4B,CAAAA,CAAM,CAAA,CAAI/3B,CAAAA,CACb,QAAA,CAAU+3B,CAAAA,CAAM,QAAA,CAAS,IAAI7gC,CAAAA,EAAKssC,EAAAA,CAAYtsC,CAAAA,CAAG6I,CAAAA,CAAIC,CAAE,CAAC,CAC1D,CACF,CAGA,SAASugC,EAAAA,CAAsB1nC,CAAAA,CAAqBmmC,CAAAA,CAAwB,CAC1EA,EAAI,GAAA,CAAInmC,CAAAA,CAAG,EAAE,CAAA,CACb,IAAA,IAAW8H,CAAAA,IAAS9H,CAAAA,CAAG,QAAA,CACrB0nC,EAAAA,CAAsB5/B,CAAAA,CAAOq+B,CAAG,EAEpC,CGh5BO,SAASuF,GACdjmC,CAAAA,CACA2a,CAAAA,CACAL,CAAAA,CAAe,OAAA,CACfM,CAAAA,CAAuB,KAAA,CACf,CACR,IAAM3S,CAAAA,CAAkB,EAAC,CAGzBA,CAAAA,CAAM,IAAA,CAAKyS,EAAAA,CAAW1a,EAAM,KAAA,CAAOA,CAAAA,CAAM,MAAA,CAAQ2a,CAAAA,CAAQC,CAAW,CAAC,CAAA,CACrE3S,CAAAA,CAAM,IAAA,CAAKoS,EAAAA,CAAgBC,CAAAA,CAAM,KAAK,CAAC,CAAA,CACvCrS,EAAM,IAAA,CAAK,QAAQ,CAAA,CACnBA,CAAAA,CAAM,IAAA,CAAKi+B,EAAAA,EAAiB,CAAA,CAC5Bj+B,CAAAA,CAAM,IAAA,CAAK,SAAS,CAAA,CAGpB,IAAA,IAAWwxB,CAAAA,IAASz5B,EAAM,MAAA,CACxBiI,CAAAA,CAAM,IAAA,CAAKk+B,EAAAA,CAAY1M,CAAW,CAAC,CAAA,CAIrC,IAAA,IAAWr+B,CAAAA,IAAQ4E,CAAAA,CAAM,KAAA,CACvBiI,CAAAA,CAAM,IAAA,CAAKm+B,GAAWhrC,CAAI,CAAC,CAAA,CAI7B,IAAA,IAAWA,CAAAA,IAAQ4E,CAAAA,CAAM,KAAA,CACnB5E,CAAAA,CAAK,KAAA,EACP6M,CAAAA,CAAM,IAAA,CAAKo+B,EAAAA,CAAgBjrC,CAAU,CAAC,CAAA,CAK1C,IAAA,IAAWnB,CAAAA,IAAQ+F,CAAAA,CAAM,KAAA,CACvBiI,CAAAA,CAAM,IAAA,CAAKq+B,EAAAA,CAAgBrsC,CAAI,CAAC,CAAA,CAIlC,IAAA,IAAWA,CAAAA,IAAQ+F,CAAAA,CAAM,KAAA,CACvBiI,CAAAA,CAAM,IAAA,CAAKs+B,EAAAA,CAAgBtsC,CAAU,CAAC,CAAA,CAGxC,OAAAgO,CAAAA,CAAM,IAAA,CAAK,QAAQ,CAAA,CAEZA,CAAAA,CAAM,IAAA,CAAK;AAAA,CAAI,CACxB,CAWA,SAASi+B,EAAAA,EAA0B,CACjC,IAAMhrC,CAAAA,CAAI2kC,GAAW,KAAA,CACf7jC,CAAAA,CAAI6jC,GAAW,MAAA,CACrB,OAEE,yCAAyC3kC,CAAC,CAAA,gBAAA,EAAmBc,CAAC,CAAA,QAAA,EAAWd,CAAC,CAAA,QAAA,EAAWc,CAAAA,CAAI,CAAC,CAAA;AAAA,0BAAA,EAC3Dd,CAAC,CAAA,CAAA,EAAIc,CAAAA,CAAI,CAAC,OAAOA,CAAC,CAAA;AAAA;AAAA,4CAAA,EAGAd,CAAC,CAAA,gBAAA,EAAmBc,CAAC,CAAA,iBAAA,EAAoBA,EAAI,CAAC,CAAA;AAAA,qBAAA,EACrEd,CAAC,CAAA,MAAA,EAASc,CAAAA,CAAI,CAAC,CAAA,EAAA,EAAKd,CAAC,IAAIc,CAAC,CAAA;AAAA,WAAA,CAGxD,CAMA,SAASmqC,EAAAA,CAAY1M,EAAwBnf,CAAAA,CAAsB,CACjE,IAAM8qB,CAAAA,CAAe7F,CAAAA,CAAW,YAAc,EAAA,CACxCt3B,CAAAA,CAAkB,EAAC,CAGzBA,CAAAA,CAAM,KACJ,CAAA,SAAA,EAAYwxB,CAAAA,CAAM,CAAC,CAAA,KAAA,EAAQA,CAAAA,CAAM,CAAC,CAAA,SAAA,EAAYA,CAAAA,CAAM,KAAK,CAAA,UAAA,EAAaA,CAAAA,CAAM,MAAM,CAAA,qFAAA,EACIkG,EAAAA,CAAc,QAAQ,CAAA,IAAA,CAC9G,CAAA,CAGA13B,EAAM,IAAA,CACJ,CAAA,SAAA,EAAYwxB,EAAM,CAAC,CAAA,KAAA,EAAQA,EAAM,CAAC,CAAA,SAAA,EAAYA,EAAM,KAAK,CAAA,UAAA,EAAa2L,CAAY,CAAA,oFAAA,EACGzF,GAAc,QAAQ,CAAA,IAAA,CAC7G,EAGA13B,CAAAA,CAAM,IAAA,CACJ,YAAYwxB,CAAAA,CAAM,CAAA,CAAI,EAAE,CAAA,KAAA,EAAQA,CAAAA,CAAM,EAAI2L,CAAAA,CAAe,CAAC,SACnDxF,EAAmB,CAAA,aAAA,EAAgBL,EAAW,WAAW,CAAA,eAAA,EAAkBC,GAAa,WAAW,CAAA,0BAAA,EAC/EgH,GAAU/M,CAAAA,CAAM,KAAK,CAAC,CAAA,OAAA,CACnD,CAAA,CAGA,QAAWp3B,CAAAA,IAASo3B,CAAAA,CAAM,SACxBxxB,CAAAA,CAAM,IAAA,CAAKk+B,GAAY9jC,CAAW,CAAC,CAAA,CAGrC,OAAO4F,EAAM,IAAA,CAAK;AAAA,CAAI,CACxB,CAMA,SAASm+B,EAAAA,CAAWhrC,CAAAA,CAA8B,CAChD,GAAIA,CAAAA,CAAK,MAAA,CAAO,MAAA,CAAS,CAAA,CAAG,OAAO,EAAA,CAEnC,IAAMwN,CAAAA,CAAW69B,EAAAA,CAAqBrrC,CAAAA,CAAK,MAAM,CAAA,CAC3CsrC,CAAAA,CAAYtrC,CAAAA,CAAK,KAAA,GAAU,QAAA,CAAW,yBAAA,CAA4B,EAAA,CAClEurC,CAAAA,CAAcvrC,CAAAA,CAAK,KAAA,GAAU,OAAA,CAAUukC,EAAAA,CAAc,SAAA,CAAY,CAAA,CAAIA,EAAAA,CAAc,SAAA,CAGrFiH,CAAAA,CAAU,EAAA,CACd,OAAIxrC,CAAAA,CAAK,WAAA,GAAawrC,CAAAA,EAAW,+BAAA,CAAA,CAC7BxrC,CAAAA,CAAK,aAAA,GAAewrC,CAAAA,EAAW,uCAAA,CAAA,CAGjC,CAAA,kBAAA,EAAqBh+B,CAAQ,CAAA,kDAAA,EACZ+9B,CAAW,CAAA,CAAA,EAAID,CAAS,CAAA,EAAGE,CAAO,CAAA,GAAA,CAEvD,CAGA,SAASH,EAAAA,CAAqBnG,CAAAA,CAAyB,CACrD,OAAOA,CAAAA,CAAO,GAAA,CAAIx/B,CAAAA,EAAK,CAAA,EAAGA,CAAAA,CAAE,CAAC,CAAA,CAAA,EAAIA,CAAAA,CAAE,CAAC,CAAA,CAAE,CAAA,CAAE,IAAA,CAAK,GAAG,CAClD,CAEA,SAASulC,EAAAA,CAAgBjrC,CAAAA,CAAsBkf,CAAAA,CAAsB,CAGnE,IAAMusB,CAAAA,CAAMzrC,CAAAA,CAAK,aAAA,EAAiB0rC,EAAAA,CAAa1rC,CAAAA,CAAK,MAAM,CAAA,CACpD7B,CAAAA,CAAQ6B,CAAAA,CAAK,KAAA,CACb2rC,CAAAA,CAAY7H,EAAAA,CAAkB3lC,CAAAA,CAAOgmC,CAAAA,CAAW,SAAA,CAAWC,EAAAA,CAAa,SAAS,CAAA,CACjFzX,CAAAA,CAAU,CAAA,CAGVif,CAAAA,CAAUD,CAAAA,CAAYhf,CAAAA,CAAU,CAAA,CAChCkf,CAAAA,CAAW1H,CAAAA,CAAW,SAAA,CAAYxX,CAAAA,CAAU,CAAA,CAElD,OACE,CAAA,SAAA,EAAY8e,CAAAA,CAAI,CAAA,CAAIG,CAAAA,CAAU,CAAC,CAAA,KAAA,EAAQH,CAAAA,CAAI,CAAA,CAAII,CAAAA,CAAW,CAAC,CAAA,SAAA,EACjDD,CAAO,CAAA,UAAA,EAAaC,CAAQ,CAAA;AAAA,SAAA,EAE1BJ,CAAAA,CAAI,CAAC,CAAA,KAAA,EAAQA,CAAAA,CAAI,CAAC,CAAA,2BAAA,EAA8BjH,EAAmB,CAAA,aAAA,EACjEL,CAAAA,CAAW,SAAS,CAAA,eAAA,EAAkBC,EAAAA,CAAa,SAAS,+BAC7CgH,EAAAA,CAAUjtC,CAAK,CAAC,CAAA,OAAA,CAEjD,CAGA,SAASutC,EAAAA,CAAaxG,CAAAA,CAAwB,CAC5C,GAAIA,CAAAA,CAAO,MAAA,GAAW,CAAA,CAAG,OAAO,CAAE,CAAA,CAAG,CAAA,CAAG,EAAG,CAAE,CAAA,CAC7C,GAAIA,CAAAA,CAAO,MAAA,GAAW,CAAA,CAAG,OAAOA,CAAAA,CAAO,CAAC,CAAA,CAGxC,IAAI4G,CAAAA,CAAc,CAAA,CAClB,IAAA,IAASvuC,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAI2nC,EAAO,MAAA,CAAQ3nC,CAAAA,EAAAA,CACjCuuC,CAAAA,EAAe9G,EAAAA,CAAKE,CAAAA,CAAO3nC,CAAAA,CAAI,CAAC,CAAA,CAAI2nC,EAAO3nC,CAAC,CAAE,CAAA,CAIhD,IAAI4kB,EAAY2pB,CAAAA,CAAc,CAAA,CAC9B,IAAA,IAASvuC,CAAAA,CAAI,EAAGA,CAAAA,CAAI2nC,CAAAA,CAAO,MAAA,CAAQ3nC,CAAAA,EAAAA,CAAK,CACtC,IAAMwuC,CAAAA,CAAS/G,EAAAA,CAAKE,EAAO3nC,CAAAA,CAAI,CAAC,CAAA,CAAI2nC,CAAAA,CAAO3nC,CAAC,CAAE,CAAA,CAC9C,GAAI4kB,GAAa4pB,CAAAA,CAAQ,CACvB,IAAM1uC,CAAAA,CAAI8kB,CAAAA,CAAY4pB,CAAAA,CACtB,OAAO,CACL,EAAG7G,CAAAA,CAAO3nC,CAAAA,CAAI,CAAC,CAAA,CAAG,EAAIF,CAAAA,EAAK6nC,CAAAA,CAAO3nC,CAAC,CAAA,CAAG,EAAI2nC,CAAAA,CAAO3nC,CAAAA,CAAI,CAAC,CAAA,CAAG,CAAA,CAAA,CACzD,CAAA,CAAG2nC,CAAAA,CAAO3nC,CAAAA,CAAI,CAAC,CAAA,CAAG,CAAA,CAAIF,CAAAA,EAAK6nC,CAAAA,CAAO3nC,CAAC,CAAA,CAAG,CAAA,CAAI2nC,CAAAA,CAAO3nC,EAAI,CAAC,CAAA,CAAG,CAAA,CAC3D,CACF,CACA4kB,CAAAA,EAAa4pB,EACf,CAEA,OAAO7G,CAAAA,CAAOA,CAAAA,CAAO,MAAA,CAAS,CAAC,CACjC,CAEA,SAASF,EAAAA,CAAKrnC,CAAAA,CAAUoI,EAAkB,CACxC,OAAO,IAAA,CAAK,IAAA,CAAA,CAAMA,CAAAA,CAAE,CAAA,CAAIpI,CAAAA,CAAE,CAAA,GAAM,GAAKoI,CAAAA,CAAE,CAAA,CAAIpI,CAAAA,CAAE,CAAA,GAAM,CAAC,CACtD,CAMA,SAASutC,GAAgBrsC,CAAAA,CAA8B,CACrD,GAAM,CAAE,CAAA,CAAA2G,CAAAA,CAAG,CAAA,CAAAC,CAAAA,CAAG,MAAAyM,CAAAA,CAAO,MAAA,CAAApL,CAAAA,CAAQ,KAAA,CAAAqc,CAAAA,CAAO,WAAA,CAAA6oB,CAAY,CAAA,CAAIntC,EAK9CotC,CAAAA,CAAOb,EAAAA,CAAUY,CAAAA,EAAa,IAAA,EAAQ,mBAAmB,CAAA,CACzDE,CAAAA,CAASd,EAAAA,CAAUY,GAAa,MAAA,EAAU,qBAAqB,CAAA,CAC/DG,CAAAA,CAAKf,EAAAA,CAAUY,CAAAA,GAAc,cAAc,CAAA,EAAK,OAAOzH,EAAAA,CAAc,QAAQ,CAAC,CAAA,CAEpF,OAAQphB,CAAAA,EACN,KAAK,UACH,OAAOipB,EAAAA,CAAc5mC,CAAAA,CAAGC,CAAAA,CAAGyM,EAAOpL,CAAAA,CAAQmlC,CAAAA,CAAMC,CAAAA,CAAQC,CAAE,EAC5D,KAAK,SAAA,CACH,OAAOE,EAAAA,CAAkB7mC,CAAAA,CAAGC,CAAAA,CAAGyM,CAAAA,CAAOpL,CAAAA,CAAQmlC,EAAMC,CAAAA,CAAQC,CAAE,CAAA,CAChE,KAAK,SAAA,CACH,OAAOG,EAAAA,CAAc9mC,CAAAA,CAAGC,EAAGyM,CAAAA,CAAOpL,CAAAA,CAAQmlC,CAAAA,CAAMC,CAAAA,CAAQC,CAAE,CAAA,CAC5D,KAAK,QAAA,CACH,OAAOI,EAAAA,CAAa/mC,CAAAA,CAAGC,CAAAA,CAAGyM,CAAAA,CAAOpL,EAAQmlC,CAAAA,CAAMC,CAAAA,CAAQC,CAAE,CAAA,CAC3D,KAAK,YAAA,CACH,OAAOK,EAAAA,CAAiBhnC,CAAAA,CAAGC,CAAAA,CAAGyM,CAAAA,CAAOpL,CAAAA,CAAQmlC,CAAAA,CAAMC,EAAQC,CAAE,CAAA,CAC/D,KAAK,cAAA,CACH,OAAOM,EAAAA,CAAmBjnC,CAAAA,CAAGC,CAAAA,CAAGyM,EAAOpL,CAAAA,CAAQmlC,CAAAA,CAAMC,CAAAA,CAAQC,CAAE,CAAA,CACjE,KAAK,SAAA,CACH,OAAOO,GAAclnC,CAAAA,CAAGC,CAAAA,CAAGyM,CAAAA,CAAOpL,CAAAA,CAAQmlC,EAAMC,CAAAA,CAAQC,CAAE,CAAA,CAC5D,KAAK,WACH,OAAOQ,EAAAA,CAAennC,CAAAA,CAAGC,CAAAA,CAAGyM,CAAAA,CAAOpL,CAAAA,CAAQmlC,CAAAA,CAAMC,CAAAA,CAAQC,CAAE,CAAA,CAC7D,KAAK,YAAA,CACH,OAAOS,EAAAA,CAAiBpnC,CAAAA,CAAGC,CAAAA,CAAGyM,CAAAA,CAAOpL,EAAQmlC,CAAAA,CAAMC,CAAAA,CAAQC,CAAE,CAAA,CAC/D,KAAK,WAAA,CACH,OAAOU,EAAAA,CAAgBrnC,EAAGC,CAAAA,CAAGyM,CAAAA,CAAOpL,CAAAA,CAAQmlC,CAAAA,CAAMC,CAAAA,CAAQC,CAAE,CAAA,CAC9D,KAAK,gBACH,OAAOW,EAAAA,CAAmBtnC,CAAAA,CAAGC,CAAAA,CAAGyM,CAAAA,CAAOpL,CAAAA,CAAQmlC,CAAAA,CAAMC,CAAAA,CAAQC,CAAE,CAAA,CACjE,KAAK,aAAA,CACH,OAAOY,EAAAA,CAAiBvnC,CAAAA,CAAGC,CAAAA,CAAGyM,CAAAA,CAAOpL,CAAM,CAAA,CAC7C,KAAK,WAAA,CACH,OAAOkmC,EAAAA,CAAexnC,CAAAA,CAAGC,CAAAA,CAAGyM,CAAAA,CAAOpL,CAAM,CAAA,CAE3C,QACE,OAAOmmC,EAAAA,CAAWznC,EAAGC,CAAAA,CAAGyM,CAAAA,CAAOpL,CAAAA,CAAQmlC,CAAAA,CAAMC,EAAQC,CAAE,CAC3D,CACF,CAIA,SAASc,EAAAA,CAAWznC,CAAAA,CAAWC,CAAAA,CAAW3F,EAAWc,CAAAA,CAAWqrC,CAAAA,CAAcC,CAAAA,CAAgBC,CAAAA,CAAoB,CAChH,OACE,CAAA,SAAA,EAAY3mC,CAAC,QAAQC,CAAC,CAAA,SAAA,EAAY3F,CAAC,CAAA,UAAA,EAAac,CAAC,CAAA,sBAAA,EAC1BqrC,CAAI,CAAA,UAAA,EAAaC,CAAM,CAAA,gBAAA,EAAmBC,CAAE,CAAA,IAAA,CAEvE,CAEA,SAASE,EAAAA,CAAkB7mC,CAAAA,CAAWC,CAAAA,CAAW3F,CAAAA,CAAWc,EAAWqrC,CAAAA,CAAcC,CAAAA,CAAgBC,CAAAA,CAAoB,CACvH,OACE,CAAA,SAAA,EAAY3mC,CAAC,CAAA,KAAA,EAAQC,CAAC,CAAA,SAAA,EAAY3F,CAAC,CAAA,UAAA,EAAac,CAAC,CAAA,sBAAA,EAC1BqrC,CAAI,CAAA,UAAA,EAAaC,CAAM,mBAAmBC,CAAE,CAAA,IAAA,CAEvE,CAEA,SAASG,EAAAA,CAAc9mC,CAAAA,CAAWC,CAAAA,CAAW3F,CAAAA,CAAWc,EAAWqrC,CAAAA,CAAcC,CAAAA,CAAgBC,CAAAA,CAAoB,CACnH,IAAMjvC,CAAAA,CAAI0D,CAAAA,CAAI,CAAA,CACd,OACE,YAAY4E,CAAC,CAAA,KAAA,EAAQC,CAAC,CAAA,SAAA,EAAY3F,CAAC,CAAA,UAAA,EAAac,CAAC,CAAA,MAAA,EAC1C1D,CAAC,CAAA,MAAA,EAASA,CAAC,CAAA,QAAA,EAAW+uC,CAAI,CAAA,UAAA,EAAaC,CAAM,CAAA,gBAAA,EAAmBC,CAAE,MAE7E,CAEA,SAASI,EAAAA,CAAa/mC,CAAAA,CAAWC,CAAAA,CAAW3F,CAAAA,CAAWc,CAAAA,CAAWqrC,CAAAA,CAAcC,EAAgBC,CAAAA,CAAoB,CAClH,IAAMxT,CAAAA,CAAKnzB,EAAI1F,CAAAA,CAAI,CAAA,CACb6+B,CAAAA,CAAKl5B,CAAAA,CAAI7E,EAAI,CAAA,CACb1D,CAAAA,CAAI,IAAA,CAAK,GAAA,CAAI4C,CAAAA,CAAGc,CAAC,CAAA,CAAI,CAAA,CAC3B,OACE,CAAA,YAAA,EAAe+3B,CAAE,CAAA,MAAA,EAASgG,CAAE,CAAA,KAAA,EAAQzhC,CAAC,CAAA,QAAA,EAC5B+uC,CAAI,aAAaC,CAAM,CAAA,gBAAA,EAAmBC,CAAE,CAAA,IAAA,CAEzD,CAEA,SAASC,EAAAA,CAAc5mC,CAAAA,CAAWC,EAAW3F,CAAAA,CAAWc,CAAAA,CAAWqrC,CAAAA,CAAcC,CAAAA,CAAgBC,EAAoB,CACnH,IAAMxT,CAAAA,CAAKnzB,CAAAA,CAAI1F,EAAI,CAAA,CACb6+B,CAAAA,CAAKl5B,CAAAA,CAAI7E,CAAAA,CAAI,CAAA,CACbgkC,CAAAA,CAAK9kC,CAAAA,CAAI,CAAA,CACT+kC,EAAKjkC,CAAAA,CAAI,CAAA,CAQf,OACE,CAAA,iBAAA,EARa,CACb,CAAA,EAAG+3B,CAAE,CAAA,CAAA,EAAIgG,EAAKkG,CAAE,CAAA,CAAA,CAChB,CAAA,EAAGlM,CAAAA,CAAKiM,CAAE,CAAA,CAAA,EAAIjG,CAAE,CAAA,CAAA,CAChB,GAAGhG,CAAE,CAAA,CAAA,EAAIgG,CAAAA,CAAKkG,CAAE,GAChB,CAAA,EAAGlM,CAAAA,CAAKiM,CAAE,CAAA,CAAA,EAAIjG,CAAE,CAAA,CAClB,CAAA,CAAE,IAAA,CAAK,GAAG,CAGkB,CAAA,QAAA,EAAWsN,CAAI,CAAA,UAAA,EAAaC,CAAM,CAAA,gBAAA,EAAmBC,CAAE,CAAA,IAAA,CAErF,CAKA,SAASK,EAAAA,CAAiBhnC,CAAAA,CAAWC,CAAAA,CAAW3F,EAAWc,CAAAA,CAAWqrC,CAAAA,CAAcC,CAAAA,CAAgBC,CAAAA,CAAoB,CAEtH,OACE,CAAA,SAAA,EAAY3mC,CAAC,QAAQC,CAAC,CAAA,SAAA,EAAY3F,CAAC,CAAA,UAAA,EAAac,CAAC,CAAA,sBAAA,EAC1BqrC,CAAI,CAAA,UAAA,EAAaC,CAAM,mBAAmBC,CAAE,CAAA;AAAA,UAAA,EACpD3mC,CAAAA,CAAI,CAAK,CAAA,MAAA,EAASC,CAAC,CAAA,MAAA,EAASD,CAAAA,CAAI,CAAK,CAAA,MAAA,EAASC,CAAAA,CAAI7E,CAAC,CAAA,UAAA,EACvDsrC,CAAM,mBAAmBC,CAAE,CAAA;AAAA,UAAA,EACvB3mC,CAAAA,CAAI1F,CAAAA,CAAI,CAAK,CAAA,MAAA,EAAS2F,CAAC,CAAA,MAAA,EAASD,CAAAA,CAAI1F,CAAAA,CAAI,CAAK,CAAA,MAAA,EAAS2F,CAAAA,CAAI7E,CAAC,CAAA,UAAA,EAC/DsrC,CAAM,CAAA,gBAAA,EAAmBC,CAAE,CAAA,IAAA,CAE1C,CAGA,SAASM,EAAAA,CAAmBjnC,CAAAA,CAAWC,CAAAA,CAAW3F,CAAAA,CAAWc,CAAAA,CAAWqrC,CAAAA,CAAcC,CAAAA,CAAgBC,CAAAA,CAAoB,CACxH,IAAMxT,CAAAA,CAAKnzB,CAAAA,CAAI1F,CAAAA,CAAI,CAAA,CACb6+B,CAAAA,CAAKl5B,CAAAA,CAAI7E,CAAAA,CAAI,CAAA,CACbssC,CAAAA,CAAS,IAAA,CAAK,GAAA,CAAIptC,CAAAA,CAAGc,CAAC,CAAA,CAAI,CAAA,CAC1BusC,CAAAA,CAASD,CAAAA,CAAS,CAAA,CACxB,OACE,CAAA,YAAA,EAAevU,CAAE,CAAA,MAAA,EAASgG,CAAE,CAAA,KAAA,EAAQuO,CAAM,CAAA,QAAA,EACjCjB,CAAI,CAAA,UAAA,EAAaC,CAAM,CAAA,gBAAA,EAAmBC,CAAE,CAAA;AAAA,YAAA,EACpCxT,CAAE,CAAA,MAAA,EAASgG,CAAE,CAAA,KAAA,EAAQwO,CAAM,CAAA,QAAA,EACnClB,CAAI,CAAA,UAAA,EAAaC,CAAM,CAAA,gBAAA,EAAmBC,CAAE,CAAA,IAAA,CAEzD,CAGA,SAASO,EAAAA,CAAclnC,CAAAA,CAAWC,CAAAA,CAAW3F,CAAAA,CAAWc,CAAAA,CAAWqrC,CAAAA,CAAcC,CAAAA,CAAgBC,CAAAA,CAAoB,CACnH,IAAMiB,CAAAA,CAAQxsC,CAAAA,CAAI,CAAA,CAUlB,OAAO,oBATQ,CACb,CAAA,EAAG4E,CAAAA,CAAI4nC,CAAK,CAAA,CAAA,EAAI3nC,CAAC,CAAA,CAAA,CACjB,CAAA,EAAGD,CAAAA,CAAI1F,CAAAA,CAAIstC,CAAK,CAAA,CAAA,EAAI3nC,CAAC,CAAA,CAAA,CACrB,GAAGD,CAAAA,CAAI1F,CAAC,CAAA,CAAA,EAAI2F,CAAAA,CAAI7E,CAAAA,CAAI,CAAC,CAAA,CAAA,CACrB,CAAA,EAAG4E,CAAAA,CAAI1F,CAAAA,CAAIstC,CAAK,CAAA,CAAA,EAAI3nC,CAAAA,CAAI7E,CAAC,GACzB,CAAA,EAAG4E,CAAAA,CAAI4nC,CAAK,CAAA,CAAA,EAAI3nC,CAAAA,CAAI7E,CAAC,CAAA,CAAA,CACrB,CAAA,EAAG4E,CAAC,CAAA,CAAA,EAAIC,CAAAA,CAAI7E,CAAAA,CAAI,CAAC,CAAA,CACnB,EAAE,IAAA,CAAK,GAAG,CAEuB,CAAA,QAAA,EAAWqrC,CAAI,CAAA,UAAA,EAAaC,CAAM,CAAA,gBAAA,EAAmBC,CAAE,CAAA,IAAA,CAC1F,CAKA,SAASQ,EAAAA,CAAennC,CAAAA,CAAWC,EAAW3F,CAAAA,CAAWc,CAAAA,CAAWqrC,CAAAA,CAAcC,CAAAA,CAAgBC,CAAAA,CAAoB,CAEpH,IAAMxT,CAAAA,CAAKnzB,CAAAA,CAAI1F,CAAAA,CAAI,CAAA,CACbutC,CAAAA,CAAU5nC,CAAAA,CAAI,CAAA,CACd6nC,EAAQ1sC,CAAAA,CAAI,EAAA,CAElB,OAEE,CAAA,SAAA,EAAY4E,CAAC,CAAA,KAAA,EAAQ6nC,CAAO,CAAA,SAAA,EAAYvtC,CAAC,CAAA,UAAA,EAAawtC,CAAK,CAAA,QAAA,EAClDrB,CAAI,CAAA;AAAA,UAAA,EAEEzmC,CAAC,CAAA,MAAA,EAAS6nC,CAAO,CAAA,MAAA,EAAS7nC,CAAC,CAAA,MAAA,EAAS6nC,CAAAA,CAAUC,CAAK,CAAA,UAAA,EAAapB,CAAM,CAAA,gBAAA,EAAmBC,CAAE,CAAA;AAAA,UAAA,EAC3F3mC,CAAAA,CAAI1F,CAAC,CAAA,MAAA,EAASutC,CAAO,CAAA,MAAA,EAAS7nC,CAAAA,CAAI1F,CAAC,CAAA,MAAA,EAASutC,CAAAA,CAAUC,CAAK,CAAA,UAAA,EAAapB,CAAM,mBAAmBC,CAAE,CAAA;AAAA,aAAA,EAEhGxT,CAAE,CAAA,MAAA,EAASlzB,CAAAA,CAAI7E,CAAAA,CAAI,CAAE,CAAA,MAAA,EAASd,CAAAA,CAAI,CAAC,CAAA,eAAA,EAC5CmsC,CAAI,CAAA,UAAA,EAAaC,CAAM,mBAAmBC,CAAE,CAAA;AAAA,aAAA,EAEnCxT,CAAE,CAAA,MAAA,EAAS0U,CAAO,CAAA,MAAA,EAASvtC,CAAAA,CAAI,CAAC,CAAA,eAAA,EACzCmsC,CAAI,CAAA,UAAA,EAAaC,CAAM,CAAA,gBAAA,EAAmBC,CAAE,CAAA,IAAA,CAEzD,CAGA,SAASS,EAAAA,CAAiBpnC,CAAAA,CAAWC,CAAAA,CAAW3F,CAAAA,CAAWc,CAAAA,CAAWqrC,CAAAA,CAAcC,CAAAA,CAAgBC,CAAAA,CAAoB,CAUtH,OAAO,CAAA,iBAAA,EARQ,CACb,CAAA,EAAG3mC,CAAAA,CAAI,EAAM,CAAA,CAAA,EAAIC,CAAC,CAAA,CAAA,CAClB,CAAA,EAAGD,CAAAA,CAAI1F,CAAC,CAAA,CAAA,EAAI2F,CAAC,CAAA,CAAA,CACb,CAAA,EAAGD,CAAAA,CAAI1F,CAAC,CAAA,CAAA,EAAI2F,CAAAA,CAAI7E,CAAC,CAAA,CAAA,CACjB,CAAA,EAAG4E,CAAAA,CAAI,EAAM,CAAA,CAAA,EAAIC,CAAAA,CAAI7E,CAAC,CAAA,CAAA,CACtB,CAAA,EAAG4E,CAAC,CAAA,CAAA,EAAIC,CAAAA,CAAI7E,CAAAA,CAAI,CAAC,CAAA,CACnB,CAAA,CAAE,IAAA,CAAK,GAAG,CAEuB,CAAA,QAAA,EAAWqrC,CAAI,CAAA,UAAA,EAAaC,CAAM,CAAA,gBAAA,EAAmBC,CAAE,CAAA,IAAA,CAC1F,CAGA,SAASU,EAAAA,CAAgBrnC,CAAAA,CAAWC,CAAAA,CAAW3F,CAAAA,CAAWc,CAAAA,CAAWqrC,CAAAA,CAAcC,CAAAA,CAAgBC,CAAAA,CAAoB,CACrH,IAAMiB,CAAAA,CAAQttC,CAAAA,CAAI,GAAA,CAQlB,OAAO,CAAA,iBAAA,EAPQ,CACb,CAAA,EAAG0F,CAAAA,CAAI4nC,CAAK,CAAA,CAAA,EAAI3nC,CAAC,CAAA,CAAA,CACjB,CAAA,EAAGD,CAAAA,CAAI1F,CAAAA,CAAIstC,CAAK,CAAA,CAAA,EAAI3nC,CAAC,CAAA,CAAA,CACrB,CAAA,EAAGD,CAAAA,CAAI1F,CAAC,CAAA,CAAA,EAAI2F,CAAAA,CAAI7E,CAAC,CAAA,CAAA,CACjB,CAAA,EAAG4E,CAAC,CAAA,CAAA,EAAIC,CAAAA,CAAI7E,CAAC,CAAA,CACf,CAAA,CAAE,IAAA,CAAK,GAAG,CAEuB,CAAA,QAAA,EAAWqrC,CAAI,CAAA,UAAA,EAAaC,CAAM,CAAA,gBAAA,EAAmBC,CAAE,CAAA,IAAA,CAC1F,CAGA,SAASW,EAAAA,CAAmBtnC,CAAAA,CAAWC,CAAAA,CAAW3F,CAAAA,CAAWc,CAAAA,CAAWqrC,CAAAA,CAAcC,CAAAA,CAAgBC,CAAAA,CAAoB,CACxH,IAAMiB,CAAAA,CAAQttC,CAAAA,CAAI,GAAA,CAQlB,OAAO,CAAA,iBAAA,EAPQ,CACb,CAAA,EAAG0F,CAAC,CAAA,CAAA,EAAIC,CAAC,CAAA,CAAA,CACT,CAAA,EAAGD,CAAAA,CAAI1F,CAAC,CAAA,CAAA,EAAI2F,CAAC,CAAA,CAAA,CACb,CAAA,EAAGD,CAAAA,CAAI1F,CAAAA,CAAIstC,CAAK,CAAA,CAAA,EAAI3nC,CAAAA,CAAI7E,CAAC,CAAA,CAAA,CACzB,CAAA,EAAG4E,CAAAA,CAAI4nC,CAAK,CAAA,CAAA,EAAI3nC,CAAAA,CAAI7E,CAAC,CAAA,CACvB,CAAA,CAAE,IAAA,CAAK,GAAG,CAEuB,CAAA,QAAA,EAAWqrC,CAAI,CAAA,UAAA,EAAaC,CAAM,CAAA,gBAAA,EAAmBC,CAAE,CAAA,IAAA,CAC1F,CAKA,SAASY,EAAAA,CAAiBvnC,CAAAA,CAAWC,CAAAA,CAAW3F,CAAAA,CAAWc,CAAAA,CAAmB,CAC5E,IAAM+3B,CAAAA,CAAKnzB,CAAAA,CAAI1F,CAAAA,CAAI,CAAA,CACb6+B,CAAAA,CAAKl5B,CAAAA,CAAI7E,CAAAA,CAAI,CAAA,CACb1D,CAAAA,CAAI,IAAA,CAAK,GAAA,CAAI4C,CAAAA,CAAGc,CAAC,CAAA,CAAI,CAAA,CAAI,CAAA,CAC/B,OAAO,CAAA,YAAA,EAAe+3B,CAAE,CAAA,MAAA,EAASgG,CAAE,CAAA,KAAA,EAAQzhC,CAAC,CAAA,sCAAA,CAC9C,CAGA,SAAS8vC,EAAAA,CAAexnC,CAAAA,CAAWC,CAAAA,CAAW3F,CAAAA,CAAWc,CAAAA,CAAmB,CAC1E,IAAM+3B,CAAAA,CAAKnzB,CAAAA,CAAI1F,CAAAA,CAAI,CAAA,CACb6+B,CAAAA,CAAKl5B,CAAAA,CAAI7E,CAAAA,CAAI,CAAA,CACbssC,CAAAA,CAAS,IAAA,CAAK,GAAA,CAAIptC,CAAAA,CAAGc,CAAC,CAAA,CAAI,CAAA,CAAI,CAAA,CAC9BusC,CAAAA,CAASD,CAAAA,CAAS,CAAA,CACxB,OACE,CAAA,YAAA,EAAevU,CAAE,CAAA,MAAA,EAASgG,CAAE,CAAA,KAAA,EAAQuO,CAAM,CAAA,kDAAA,EACS3I,EAAAA,CAAc,QAAA,CAAW,CAAC,CAAA;AAAA,YAAA,EAC5D5L,CAAE,CAAA,MAAA,EAASgG,CAAE,CAAA,KAAA,EAAQwO,CAAM,CAAA,sCAAA,CAEhD,CAMA,SAAShC,EAAAA,CAAgBtsC,EAAsBqgB,CAAAA,CAAsB,CAEnE,GAAA,CAAIrgB,CAAAA,CAAK,QAAU,aAAA,EAAiBA,CAAAA,CAAK,KAAA,GAAU,WAAA,GAC7C,CAACA,CAAAA,CAAK,KAAA,CAAO,OAAO,GAG1B,IAAM85B,CAAAA,CAAK95B,CAAAA,CAAK,CAAA,CAAIA,EAAK,KAAA,CAAQ,CAAA,CAC3B8/B,CAAAA,CAAK9/B,CAAAA,CAAK,EAAIA,CAAAA,CAAK,MAAA,CAAS,CAAA,CAG5B0uC,CAAAA,CAAYnC,EAAAA,CAAUvsC,CAAAA,CAAK,WAAA,EAAa,KAAA,EAAS,cAAc,CAAA,CAErE,OACE,CAAA,SAAA,EAAY85B,CAAE,QAAQgG,CAAE,CAAA,2BAAA,EAA8B6F,EAAmB,CAAA,aAAA,EAC3DL,EAAW,SAAS,CAAA,eAAA,EAAkBC,EAAAA,CAAa,SAAS,WACjEmJ,CAAS,CAAA,EAAA,EAAKnC,EAAAA,CAAUvsC,CAAAA,CAAK,KAAK,CAAC,CAAA,OAAA,CAEhD,CAOA,SAASusC,GAAUzrB,CAAAA,CAAsB,CACvC,OAAOA,CAAAA,CACJ,QAAQ,IAAA,CAAM,OAAO,CAAA,CACrB,OAAA,CAAQ,IAAA,CAAM,MAAM,CAAA,CACpB,OAAA,CAAQ,KAAM,MAAM,CAAA,CACpB,OAAA,CAAQ,IAAA,CAAM,QAAQ,CAAA,CACtB,OAAA,CAAQ,IAAA,CAAM,OAAO,CAC1B,CCldA,IAAM6tB,EAAAA,CAAM,CAEV,OAAA,CAAS,EAAA,CAET,QAAA,CAAU,GAAA,CAEV,YAAa,EAAA,CAEb,SAAA,CAAW,EAAA,CAEX,SAAA,CAAW,GAEX,gBAAA,CAAkB,EAAA,CAElB,iBAAA,CAAmB,EAAA,CAEnB,gBAAiB,EAAA,CAEjB,SAAA,CAAW,EAAA,CACX,WAAA,CAAa,EAAA,CACb,cAAA,CAAgB,CAAA,CAEhB,gBAAA,CAAkB,GAElB,YAAA,CAAc,EAAA,CAEd,SAAA,CAAW,GAAA,CACX,YAAa,CAAA,CACb,OAAA,CAAS,EACX,CAAA,CAMO,SAASC,EAAAA,CACdlZ,CAAAA,CACAmZ,CAAAA,CAA0B,GACC,CAC3B,GAAInZ,CAAAA,CAAQ,MAAA,CAAO,SAAW,CAAA,CAC5B,OAAO,CAAE,KAAA,CAAO,EAAG,MAAA,CAAQ,CAAA,CAAG,MAAA,CAAQ,GAAI,SAAA,CAAW,EAAC,CAAG,QAAA,CAAU,EAAC,CAAG,WAAA,CAAa,GAAI,MAAA,CAAQ,EAAC,CAAG,KAAA,CAAO,EAAG,CAAA,CAIhH,IAAMoZ,CAAAA,CAAcpZ,EAAQ,MAAA,CAAO,GAAA,CAAI52B,CAAAA,EAAK,CAC1C,IAAMiwC,CAAAA,CAAQ9J,EAAAA,CAAkBnmC,CAAAA,CAAE,MAAOwmC,CAAAA,CAAW,SAAA,CAAWC,EAAAA,CAAa,SAAS,EACrF,OAAO,IAAA,CAAK,GAAA,CAAIwJ,CAAAA,CAAQJ,GAAI,SAAA,CAAY,CAAA,CAAG,EAAE,CAC/C,CAAC,CAAA,CAGKK,CAAAA,CAAyB,GAC3BvP,CAAAA,CAAWkP,EAAAA,CAAI,OAAA,CAAUG,CAAAA,CAAY,CAAC,CAAA,CAAK,CAAA,CAC/C,IAAA,IAASpwC,CAAAA,CAAI,EAAGA,CAAAA,CAAIg3B,CAAAA,CAAQ,MAAA,CAAO,MAAA,CAAQh3B,IAAK,CAC9C,GAAIA,CAAAA,CAAI,CAAA,CAAG,CACT,IAAMuwC,CAAAA,CAAS,IAAA,CAAK,GAAA,CAAIN,GAAI,QAAA,CAAA,CAAWG,CAAAA,CAAYpwC,CAAAA,CAAI,CAAC,EAAKowC,CAAAA,CAAYpwC,CAAC,CAAA,EAAM,CAAA,CAAI,EAAE,CAAA,CACtF+gC,CAAAA,EAAYwP,EACd,CACAD,CAAAA,CAAa,IAAA,CAAKvP,CAAQ,EAC5B,CAGA,IAAMyP,CAAAA,CAAa,IAAI,GAAA,CACvB,QAASxwC,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAIg3B,CAAAA,CAAQ,OAAO,MAAA,CAAQh3B,CAAAA,EAAAA,CACzCwwC,CAAAA,CAAW,GAAA,CAAIxZ,EAAQ,MAAA,CAAOh3B,CAAC,CAAA,CAAG,EAAA,CAAIA,CAAC,CAAA,CAIzC,IAAMywC,CAAAA,CAASR,EAAAA,CAAI,QACbS,CAAAA,CAA4B1Z,CAAAA,CAAQ,MAAA,CAAO,GAAA,CAAI,CAAC52B,CAAAA,CAAGJ,CAAAA,IAAO,CAC9D,GAAII,CAAAA,CAAE,EAAA,CACN,KAAA,CAAOA,CAAAA,CAAE,MACT,IAAA,CAAMA,CAAAA,CAAE,IAAA,CACR,CAAA,CAAGkwC,EAAatwC,CAAC,CAAA,CACjB,CAAA,CAAGywC,CAAAA,CACH,MAAOL,CAAAA,CAAYpwC,CAAC,CAAA,CACpB,MAAA,CAAQiwC,GAAI,WACd,CAAA,CAAE,CAAA,CAGEU,CAAAA,CAAWF,EAASR,EAAAA,CAAI,WAAA,CAAcA,EAAAA,CAAI,SAAA,CACxCW,EAAgC,EAAC,CAMjCC,CAAAA,CAAmB,IAAI,GAAA,CAC7B,IAAA,IAAWvU,CAAAA,IAAStF,CAAAA,CAAQ,OAAQ,CAElC,IAAMl1B,CAAAA,CAAO+uC,CAAAA,CAAiB,IAAIvU,CAAAA,CAAM,UAAU,CAAA,EAAK,CAAA,CACvDuU,EAAiB,GAAA,CAAIvU,CAAAA,CAAM,UAAA,CAAY,IAAA,CAAK,GAAA,CAAIx6B,CAAAA,CAAMmuC,EAAAA,CAAI,gBAAgB,CAAC,CAAA,CAG3E,IAAA,IAAWa,CAAAA,IAAOxU,CAAAA,CAAM,SAAU,CAChC,IAAMyU,CAAAA,CAAUF,CAAAA,CAAiB,IAAIC,CAAAA,CAAI,KAAK,CAAA,EAAK,CAAA,CACnDD,CAAAA,CAAiB,GAAA,CAAIC,CAAAA,CAAI,KAAA,CAAO,KAAK,GAAA,CAAIC,CAAAA,CAASd,EAAAA,CAAI,YAAY,CAAC,EACrE,CACF,CAGA,IAAMe,EAAmB,IAAI,GAAA,CACvBC,CAAAA,CAA4B,GAElC,IAAA,IAASC,CAAAA,CAAS,CAAA,CAAGA,CAAAA,CAASla,EAAQ,QAAA,CAAS,MAAA,CAAQka,CAAAA,EAAAA,CAAU,CAC/D,IAAMhZ,CAAAA,CAAMlB,CAAAA,CAAQ,QAAA,CAASka,CAAM,EAC7BC,CAAAA,CAAUX,CAAAA,CAAW,GAAA,CAAItY,CAAAA,CAAI,IAAI,CAAA,EAAK,CAAA,CACtCkZ,CAAAA,CAAQZ,EAAW,GAAA,CAAItY,CAAAA,CAAI,EAAE,CAAA,EAAK,EAClCwD,CAAAA,CAASxD,CAAAA,CAAI,IAAA,GAASA,CAAAA,CAAI,GAG1BmZ,CAAAA,CAAQR,CAAAA,CAAiB,GAAA,CAAIK,CAAM,CAAA,EAAK,CAAA,CAC1CG,CAAAA,CAAQ,CAAA,GAAGV,GAAYU,CAAAA,CAAAA,CAE3B,IAAMC,CAAAA,CAAKhB,CAAAA,CAAaa,CAAO,CAAA,CACzBI,CAAAA,CAAKjB,CAAAA,CAAac,CAAK,EAqB7B,GAnBAR,CAAAA,CAAS,IAAA,CAAK,CACZ,IAAA,CAAM1Y,CAAAA,CAAI,IAAA,CACV,EAAA,CAAIA,EAAI,EAAA,CACR,KAAA,CAAOA,CAAAA,CAAI,KAAA,CACX,UAAWA,CAAAA,CAAI,SAAA,CACf,SAAA,CAAWA,CAAAA,CAAI,UACf,EAAA,CAAAoZ,CAAAA,CAAI,EAAA,CAAAC,CAAAA,CACJ,EAAGZ,CAAAA,CACH,MAAA,CAAAjV,CACF,CAAC,EAGGxD,CAAAA,CAAI,QAAA,GACD8Y,CAAAA,CAAiB,GAAA,CAAI9Y,EAAI,EAAE,CAAA,EAC9B8Y,CAAAA,CAAiB,GAAA,CAAI9Y,EAAI,EAAA,CAAI,EAAE,CAAA,CAEjC8Y,CAAAA,CAAiB,GAAA,CAAI9Y,CAAAA,CAAI,EAAE,EAAG,IAAA,CAAKyY,CAAQ,CAAA,CAAA,CAGzCzY,CAAAA,CAAI,WAAY,CAClB,IAAMp3B,CAAAA,CAAQkwC,CAAAA,CAAiB,IAAI9Y,CAAAA,CAAI,IAAI,CAAA,CAC3C,GAAIp3B,CAAAA,EAASA,CAAAA,CAAM,MAAA,CAAS,CAAA,CAAG,CAC7B,IAAM+kC,CAAAA,CAAS/kC,CAAAA,CAAM,GAAA,GACf6rB,CAAAA,CAAM6jB,CAAAA,CAAW,GAAA,CAAItY,CAAAA,CAAI,IAAI,CAAA,EAAK,CAAA,CACxC+Y,CAAAA,CAAY,IAAA,CAAK,CACf,OAAA,CAAS/Y,CAAAA,CAAI,IAAA,CACb,EAAGoY,CAAAA,CAAa3jB,CAAG,CAAA,CAAKsjB,EAAAA,CAAI,gBAAkB,CAAA,CAC9C,IAAA,CAAMpK,CAAAA,CACN,OAAA,CAAS8K,EACT,KAAA,CAAOV,EAAAA,CAAI,eACb,CAAC,EACH,CACF,CAEAU,CAAAA,EAAYjV,CAAAA,CAASuU,GAAI,iBAAA,CAAoBA,EAAAA,CAAI,gBAAA,CAAmBA,EAAAA,CAAI,iBAC1E,CAGA,IAAA,GAAW,CAACuB,CAAAA,CAAS1wC,CAAK,CAAA,GAAKkwC,CAAAA,CAC7B,IAAA,IAAWnL,CAAAA,IAAU/kC,CAAAA,CAAO,CAC1B,IAAM6rB,CAAAA,CAAM6jB,EAAW,GAAA,CAAIgB,CAAO,CAAA,EAAK,CAAA,CACvCP,EAAY,IAAA,CAAK,CACf,OAAA,CAAAO,CAAAA,CACA,EAAGlB,CAAAA,CAAa3jB,CAAG,CAAA,CAAKsjB,EAAAA,CAAI,gBAAkB,CAAA,CAC9C,IAAA,CAAMpK,CAAAA,CACN,OAAA,CAAS8K,EAAWV,EAAAA,CAAI,gBAAA,CAAmB,CAAA,CAC3C,KAAA,CAAOA,GAAI,eACb,CAAC,EACH,CAIF,IAAMwB,CAAAA,CAA4Bza,CAAAA,CAAQ,MAAA,CAAO,GAAA,CAAIsF,CAAAA,EAAS,CAE5D,IAAMoV,CAAAA,CAAWd,EAAStU,CAAAA,CAAM,UAAU,CAAA,CACpCqV,CAAAA,CAASf,EAAStU,CAAAA,CAAM,QAAQ,CAAA,CAChCsV,CAAAA,CAAAA,CAAYF,GAAU,CAAA,EAAKf,CAAAA,EAAYV,EAAAA,CAAI,WAAA,CAC3C4B,GAAeF,CAAAA,EAAQ,CAAA,EAAKhB,CAAAA,EAAYV,EAAAA,CAAI,eAAiB,EAAA,CAG7D6B,CAAAA,CAAiB,IAAI,GAAA,CAC3B,QAASC,CAAAA,CAAKzV,CAAAA,CAAM,UAAA,CAAYyV,CAAAA,EAAMzV,EAAM,QAAA,CAAUyV,CAAAA,EAAAA,CAAM,CAC1D,IAAM3X,CAAAA,CAAIpD,CAAAA,CAAQ,QAAA,CAAS+a,CAAE,EACzB3X,CAAAA,GACF0X,CAAAA,CAAe,GAAA,CAAItB,CAAAA,CAAW,IAAIpW,CAAAA,CAAE,IAAI,CAAA,EAAK,CAAC,EAC9C0X,CAAAA,CAAe,GAAA,CAAItB,CAAAA,CAAW,GAAA,CAAIpW,CAAAA,CAAE,EAAE,CAAA,EAAK,CAAC,GAEhD,CAEA,GAAI0X,CAAAA,CAAe,IAAA,GAAS,EAC1B,IAAA,IAASE,CAAAA,CAAK,CAAA,CAAGA,CAAAA,CAAKhb,EAAQ,MAAA,CAAO,MAAA,CAAQgb,CAAAA,EAAAA,CAAMF,CAAAA,CAAe,GAAA,CAAIE,CAAE,CAAA,CAE1E,IAAMC,EAAS,IAAA,CAAK,GAAA,CAAI,GAAGH,CAAc,EACnCI,CAAAA,CAAS,IAAA,CAAK,GAAA,CAAI,GAAGJ,CAAc,CAAA,CACnCK,CAAAA,CAAY7B,CAAAA,CAAa2B,CAAM,EAAK7B,CAAAA,CAAY6B,CAAM,CAAA,CAAK,CAAA,CAAIhC,GAAI,SAAA,CACnEmC,CAAAA,CAAa9B,CAAAA,CAAa4B,CAAM,EAAK9B,CAAAA,CAAY8B,CAAM,CAAA,CAAK,CAAA,CAAIjC,GAAI,SAAA,CAYpEoC,CAAAA,CAAW/V,CAAAA,CAAM,QAAA,CAAS,GAAA,CAAI/e,CAAAA,EAAK,CACvC,IAAM2a,EAAM0Y,CAAAA,CAASrzB,CAAAA,CAAE,KAAK,CAAA,CACtB+0B,EAAOpa,CAAAA,EAAK,CAAA,EAAKyY,CAAAA,CACnBv2B,CAAAA,CAAS,GAKb,GAAImD,CAAAA,CAAE,KAAA,EAAS2a,CAAAA,EAAK,KAAA,CAAO,CACzB,IAAMqa,CAAAA,CAAe,IAAIh1B,CAAAA,CAAE,KAAK,CAAA,CAAA,CAAA,CAC1Bi1B,CAAAA,CAAYjM,GAAkBgM,CAAAA,CAAc3L,CAAAA,CAAW,SAAA,CAAWC,EAAAA,CAAa,SAAS,CAAA,CACxF4L,CAAAA,CAAeN,CAAAA,CAAY,CAAA,CAC3BO,CAAAA,CAAgBD,CAAAA,CAAeD,CAAAA,CAE/BG,CAAAA,CAAYpM,GAAkBrO,CAAAA,CAAI,KAAA,CAAO0O,CAAAA,CAAW,SAAA,CAAWC,GAAa,SAAS,CAAA,CAGrF+L,CAAAA,CAAe1a,CAAAA,CAAI,OACrBA,CAAAA,CAAI,EAAA,CAAK,EAAA,CAAA,CACRA,CAAAA,CAAI,GAAKA,CAAAA,CAAI,EAAA,EAAM,CAAA,CAAIya,CAAAA,CAAY,EAClCE,CAAAA,CAAgBD,CAAAA,CAAeD,CAAAA,CAEjCD,CAAAA,CAAgBE,GAAgBH,CAAAA,CAAeI,CAAAA,GACjDz4B,CAAAA,CAAS,EAAA,EAEb,CAEA,OAAO,CAAE,CAAA,CAAGk4B,CAAAA,CAAOl4B,CAAAA,CAAQ,KAAA,CAAOmD,CAAAA,CAAE,KAAM,CAC5C,CAAC,CAAA,CAED,OAAO,CACL,KAAM+e,CAAAA,CAAM,IAAA,CACZ,KAAA,CAAOA,CAAAA,CAAM,MACb,CAAA,CAAG6V,CAAAA,CACH,CAAA,CAAGP,CAAAA,CACH,KAAA,CAAOQ,CAAAA,CAAaD,CAAAA,CACpB,MAAA,CAAQN,EAAcD,CAAAA,CACtB,QAAA,CAAAS,CACF,CACF,CAAC,CAAA,CAGKS,CAAAA,CAA0B9b,CAAAA,CAAQ,KAAA,CAAM,IAAIqD,CAAAA,EAAQ,CACxD,IAAM0Y,CAAAA,CAAQ,IAAA,CAAK,GAAA,CACjB9C,EAAAA,CAAI,SAAA,CACJ1J,GAAkBlM,CAAAA,CAAK,IAAA,CAAMuM,CAAAA,CAAW,SAAA,CAAWC,GAAa,SAAS,CAAA,CAAIoJ,EAAAA,CAAI,WAAA,CAAc,CACjG,CAAA,CACM+C,CAAAA,CAAQpM,CAAAA,CAAW,SAAA,CAAYqJ,GAAI,WAAA,CAAc,CAAA,CAIjDgD,CAAAA,CAAAA,CADSrC,CAAAA,CAASvW,EAAK,UAAU,CAAA,EAChB,CAAA,EAAKoW,CAAAA,CAASR,GAAI,WAAA,EAAe,CAAA,CAGlDiD,CAAAA,CAAgB1C,CAAAA,CAAW,IAAInW,CAAAA,CAAK,QAAA,CAAS,CAAC,CAAA,EAAK,EAAE,CAAA,EAAK,CAAA,CAC5D8Y,CAAAA,CACJ,GAAI9Y,CAAAA,CAAK,QAAA,GAAa,MAAA,CACpB8Y,CAAAA,CAAQ7C,EAAa4C,CAAa,CAAA,CAAK9C,CAAAA,CAAY8C,CAAa,EAAK,CAAA,CAAIH,CAAAA,CAAQ9C,EAAAA,CAAI,OAAA,CAAA,KAAA,GAC5E5V,EAAK,QAAA,GAAa,OAAA,CAC3B8Y,CAAAA,CAAQ7C,CAAAA,CAAa4C,CAAa,CAAA,CAAK9C,CAAAA,CAAY8C,CAAa,CAAA,CAAK,EAAIjD,EAAAA,CAAI,OAAA,CAAA,KAAA,GAGzE5V,CAAAA,CAAK,QAAA,CAAS,OAAS,CAAA,CAAG,CAC5B,IAAM+Y,CAAAA,CAAe5C,CAAAA,CAAW,GAAA,CAAInW,CAAAA,CAAK,QAAA,CAASA,EAAK,QAAA,CAAS,MAAA,CAAS,CAAC,CAAA,EAAK,EAAE,CAAA,EAAK6Y,CAAAA,CACtFC,CAAAA,CAAAA,CAAS7C,CAAAA,CAAa4C,CAAa,CAAA,CAAK5C,CAAAA,CAAa8C,CAAY,CAAA,EAAM,EAAIL,CAAAA,CAAQ,EACrF,CAAA,KACEI,CAAAA,CAAQ7C,EAAa4C,CAAa,CAAA,CAAKH,CAAAA,CAAQ,CAAA,CAInD,OAAO,CAAE,IAAA,CAAM1Y,CAAAA,CAAK,IAAA,CAAM,EAAG8Y,CAAAA,CAAO,CAAA,CAAGF,CAAAA,CAAO,KAAA,CAAOF,CAAAA,CAAO,MAAA,CAAQC,CAAM,CAC5E,CAAC,CAAA,CAQKK,CAAAA,CAAgB1C,CAAAA,CAAWV,EAAAA,CAAI,QAGjCqD,CAAAA,CAAarD,EAAAA,CAAI,OAAA,CACjBsD,CAAAA,CAAa,EACjB,IAAA,IAAWnzC,CAAAA,IAAKswC,CAAAA,CACd4C,CAAAA,CAAa,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAYlzC,CAAAA,CAAE,EAAIA,CAAAA,CAAE,KAAA,CAAQ,CAAC,CAAA,CACnDmzC,EAAa,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAYnzC,CAAAA,CAAE,EAAIA,CAAAA,CAAE,KAAA,CAAQ,CAAC,CAAA,CAErD,IAAA,IAAWoI,CAAAA,IAAKipC,CAAAA,CACd6B,CAAAA,CAAa,KAAK,GAAA,CAAIA,CAAAA,CAAY9qC,CAAAA,CAAE,CAAC,EACrC+qC,CAAAA,CAAa,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAY/qC,EAAE,CAAA,CAAIA,CAAAA,CAAE,KAAK,CAAA,CAEjD,QAAW3I,CAAAA,IAAKizC,CAAAA,CACdQ,CAAAA,CAAa,IAAA,CAAK,IAAIA,CAAAA,CAAYzzC,CAAAA,CAAE,CAAC,CAAA,CACrC0zC,EAAa,IAAA,CAAK,GAAA,CAAIA,CAAAA,CAAY1zC,CAAAA,CAAE,EAAIA,CAAAA,CAAE,KAAK,CAAA,CAIjD,IAAM2zC,CAAAA,CAASF,CAAAA,CAAarD,EAAAA,CAAI,OAAA,CAAUA,GAAI,OAAA,CAAUqD,CAAAA,CAAa,CAAA,CACrE,GAAIE,EAAS,CAAA,CAAG,CACd,IAAA,IAAWpzC,CAAAA,IAAKswC,EAAQtwC,CAAAA,CAAE,CAAA,EAAKozC,CAAAA,CAC/B,IAAA,IAAWpZ,CAAAA,IAAKwW,CAAAA,CAAYxW,CAAAA,CAAE,EAAA,EAAMoZ,EAAQpZ,CAAAA,CAAE,EAAA,EAAMoZ,CAAAA,CACpD,IAAA,IAAWC,KAAOxC,CAAAA,CAAawC,CAAAA,CAAI,CAAA,EAAKD,CAAAA,CACxC,QAAWhrC,CAAAA,IAAKipC,CAAAA,CAAUjpC,CAAAA,CAAE,CAAA,EAAKgrC,CAAAA,CACjC,IAAA,IAAW3zC,CAAAA,IAAKizC,CAAAA,CAAOjzC,EAAE,CAAA,EAAK2zC,CAAAA,CAE9B,IAAA,IAASxzC,CAAAA,CAAI,EAAGA,CAAAA,CAAIswC,CAAAA,CAAa,MAAA,CAAQtwC,CAAAA,EAAAA,CAAKswC,EAAatwC,CAAC,CAAA,EAAMwzC,EACpE,CAGA,IAAME,CAAAA,CAAwB1c,CAAAA,CAAQ,MAAA,CAAO,GAAA,CAAI,CAAC52B,CAAAA,CAAGJ,CAAAA,IAAO,CAC1D,OAAA,CAASI,EAAE,EAAA,CACX,CAAA,CAAGkwC,CAAAA,CAAatwC,CAAC,EACjB,IAAA,CAAMywC,CAAAA,CAASR,EAAAA,CAAI,WAAA,CACnB,OAAA,CAASoD,CAAAA,CAAgBpD,EAAAA,CAAI,OAC/B,EAAE,CAAA,CAGI0D,CAAAA,CAAeJ,CAAAA,CAAaC,CAAAA,CAASvD,GAAI,OAAA,CACzC2D,CAAAA,CAAgBP,CAAAA,CAEtB,OAAO,CACL,KAAA,CAAO,IAAA,CAAK,GAAA,CAAIM,CAAAA,CAAc,GAAG,CAAA,CACjC,MAAA,CAAQ,IAAA,CAAK,IAAIC,CAAAA,CAAe,GAAG,CAAA,CACnC,MAAA,CAAAlD,EACA,SAAA,CAAAgD,CAAAA,CACA,QAAA,CAAA9C,CAAAA,CACA,YAAAK,CAAAA,CACA,MAAA,CAAAQ,CAAAA,CACA,KAAA,CAAAqB,CACF,CACF,CCtUO,SAASe,GACd7c,CAAAA,CACAhV,CAAAA,CACAL,CAAAA,CAAe,OAAA,CACfM,EAAuB,KAAA,CACf,CACR,IAAM3S,CAAAA,CAAkB,EAAC,CAGzBA,CAAAA,CAAM,IAAA,CAAKyS,EAAAA,CAAWiV,EAAQ,KAAA,CAAOA,CAAAA,CAAQ,MAAA,CAAQhV,CAAAA,CAAQC,CAAW,CAAC,CAAA,CACzE3S,CAAAA,CAAM,IAAA,CAAKoS,GAAgBC,CAAAA,CAAM,KAAK,CAAC,CAAA,CACvCrS,EAAM,IAAA,CAAK,QAAQ,CAAA,CAGnBA,CAAAA,CAAM,IAAA,CAAKi+B,EAAAA,EAAiB,CAAA,CAC5Bj+B,EAAM,IAAA,CAAK,SAAS,CAAA,CAGpB,IAAA,IAAWgtB,KAAStF,CAAAA,CAAQ,MAAA,CAC1B1nB,CAAAA,CAAM,IAAA,CAAKwkC,GAAYxX,CAAK,CAAC,CAAA,CAI/B,IAAA,IAAWyX,KAAY/c,CAAAA,CAAQ,SAAA,CAC7B1nB,CAAAA,CAAM,IAAA,CAAK0kC,GAAeD,CAAQ,CAAC,CAAA,CAIrC,IAAA,IAAWE,KAAcjd,CAAAA,CAAQ,WAAA,CAC/B1nB,CAAAA,CAAM,IAAA,CAAK4kC,GAAiBD,CAAU,CAAC,CAAA,CAIzC,IAAA,IAAW/I,CAAAA,IAAWlU,CAAAA,CAAQ,QAAA,CAC5B1nB,CAAAA,CAAM,KAAK6kC,EAAAA,CAAcjJ,CAAO,CAAC,CAAA,CAInC,QAAW7Q,CAAAA,IAAQrD,CAAAA,CAAQ,KAAA,CACzB1nB,CAAAA,CAAM,KAAK8kC,EAAAA,CAAW/Z,CAAI,CAAC,CAAA,CAI7B,QAAWkB,CAAAA,IAASvE,CAAAA,CAAQ,MAAA,CAC1B1nB,CAAAA,CAAM,KAAK+kC,EAAAA,CAAY9Y,CAAK,CAAC,CAAA,CAG/B,OAAAjsB,CAAAA,CAAM,IAAA,CAAK,QAAQ,CAAA,CACZA,EAAM,IAAA,CAAK;AAAA,CAAI,CACxB,CAMA,SAASi+B,EAAAA,EAA0B,CACjC,IAAMhrC,CAAAA,CAAI2kC,GAAW,KAAA,CACf7jC,CAAAA,CAAI6jC,GAAW,MAAA,CACrB,OACE,yCAAyC3kC,CAAC,CAAA,gBAAA,EAAmBc,CAAC,CAAA,QAAA,EAAWd,CAAC,CAAA,QAAA,EAAWc,CAAAA,CAAI,CAAC,CAAA;AAAA,0BAAA,EAC3Dd,CAAC,CAAA,CAAA,EAAIc,CAAAA,CAAI,CAAC,OAAOA,CAAC,CAAA;AAAA;AAAA,2CAAA,EAGDd,CAAC,CAAA,gBAAA,EAAmBc,CAAC,WAAWd,CAAC,CAAA,QAAA,EAAWc,EAAI,CAAC,CAAA;AAAA,2BAAA,EACjEd,CAAC,CAAA,CAAA,EAAIc,CAAAA,CAAI,CAAC,OAAOA,CAAC,CAAA;AAAA,WAAA,CAGtD,CAOA,SAASgxC,EAAAA,CAAY9Y,CAAAA,CAAgC,CACnD,GAAM,CAAE,CAAA,CAAAtzB,CAAAA,CAAG,CAAA,CAAAC,CAAAA,CAAG,KAAA,CAAAyM,EAAO,MAAA,CAAApL,CAAAA,CAAQ,KAAA,CAAA3I,CAAAA,CAAO,IAAA,CAAA6Y,CAAK,EAAI8hB,CAAAA,CAE7C,GAAI9hB,CAAAA,GAAS,OAAA,CAAS,CAKpB,IAAMwJ,EAAK1Z,CAAAA,CAAS,EAAA,CAAM,EAAA,CACpB+qC,CAAAA,CAAKrsC,CAAAA,CAAI,EAAA,CAAKgb,EACdsxB,CAAAA,CAAKrsC,CAAAA,CAAAA,CAAKqB,CAAAA,CAAS,EAAA,CAAK0Z,CAAAA,EAAK,CAAA,CAC7B2rB,EAAK5H,EAAAA,CAAc,QAAA,CAAW/jB,CAAAA,CAC9BuxB,CAAAA,CAAa,cAAA,CAEnB,OACE,2BAA2BF,CAAE,CAAA,CAAA,EAAIC,CAAE,CAAA,QAAA,EAAWtxB,CAAC,CAAA;AAAA,kJAAA,EAEwGuxB,CAAU,mBAAmB5F,CAAE,CAAA;AAAA,kJAAA,EAE/B4F,CAAU,mBAAmB5F,CAAE,CAAA;AAAA,0HAAA,EAEvD4F,CAAU,mBAAmB5F,CAAE,CAAA;AAAA;AAAA,SAAA,EAGhJ3mC,CAAC,CAAA,KAAA,EAAQC,CAAAA,CAAIqB,CAAAA,CAAS,EAAE,CAAA,kCAAA,EAAqCq9B,CAAAA,CAAW,SAAS,CAAA,eAAA,EAAkBC,EAAAA,CAAa,SAAS,CAAA,sBAAA,EAAyBgH,GAAUjtC,CAAK,CAAC,CAAA,OAAA,CAEpL,CAIA,OACE,CAAA,SAAA,EAFWqH,CAAAA,CAAI0M,CAAAA,CAAQ,CAEP,CAAA,KAAA,EAAQzM,CAAC,CAAA,SAAA,EAAYyM,CAAK,CAAA,UAAA,EAAapL,CAAM,CAAA,oFAAA,EACUy9B,GAAc,QAAQ,CAAA;AAAA,SAAA,EAC/E/+B,CAAC,QAAQC,CAAAA,CAAIqB,CAAAA,CAAS,CAAC,CAAA,2BAAA,EAA8B09B,EAAmB,CAAA,aAAA,EACxEL,CAAAA,CAAW,SAAS,CAAA,eAAA,EAAkBC,GAAa,SAAS,CAAA,sBAAA,EAAyBgH,GAAUjtC,CAAK,CAAC,SAEvH,CAGA,SAASozC,EAAAA,CAAeD,CAAAA,CAA4B,CAClD,OACE,aAAaA,CAAAA,CAAS,CAAC,SAASA,CAAAA,CAAS,IAAI,SAASA,CAAAA,CAAS,CAAC,CAAA,MAAA,EAASA,CAAAA,CAAS,OAAO,CAAA,qEAAA,CAG7F,CAGA,SAASG,EAAAA,CAAiBD,EAAgC,CACxD,OACE,YAAYA,CAAAA,CAAW,CAAC,CAAA,KAAA,EAAQA,CAAAA,CAAW,IAAI,CAAA,SAAA,EAAYA,EAAW,KAAK,CAAA,UAAA,EAAaA,EAAW,OAAA,CAAUA,CAAAA,CAAW,IAAI,CAAA,sEAAA,EACrDjN,EAAAA,CAAc,QAAQ,CAAA,IAAA,CAEjG,CAGA,SAASmN,GAAcjc,CAAAA,CAAgC,CACrD,IAAM5oB,CAAAA,CAAkB,GAClBy+B,CAAAA,CAAY7V,CAAAA,CAAI,SAAA,GAAc,QAAA,CAAW,yBAAA,CAA4B,EAAA,CACrEuc,EAAWvc,CAAAA,CAAI,SAAA,GAAc,SAAW,WAAA,CAAc,gBAAA,CAE5D,GAAIA,CAAAA,CAAI,MAAA,CAIN5oB,CAAAA,CAAM,IAAA,CACJ,CAAA,kBAAA,EAAqB4oB,CAAAA,CAAI,EAAE,CAAA,CAAA,EAAIA,CAAAA,CAAI,CAAC,CAAA,CAAA,EAAIA,CAAAA,CAAI,EAAA,CAAK,EAAK,CAAA,CAAA,EAAIA,CAAAA,CAAI,CAAC,CAAA,CAAA,EAAIA,CAAAA,CAAI,EAAA,CAAK,EAAK,CAAA,CAAA,EAAIA,CAAAA,CAAI,EAAI,EAAK,CAAA,CAAA,EAAIA,EAAI,EAAE,CAAA,CAAA,EAAIA,CAAAA,CAAI,CAAA,CAAI,EAAK,CAAA,kDAAA,EAC1E8O,GAAc,SAAS,CAAA,CAAA,EAAI+G,CAAS,CAAA,kBAAA,EAAqB0G,CAAQ,OACtH,CAAA,CAEAnlC,CAAAA,CAAM,IAAA,CACJ,CAAA,SAAA,EAAY4oB,CAAAA,CAAI,EAAA,CAAK,GAAQ,CAAC,CAAA,KAAA,EAAQA,EAAI,CAAA,CAAI,EAAA,CAAQ,CAAC,CAAA,MAAA,EAAS+O,EAAmB,CAAA,aAAA,EACrEL,CAAAA,CAAW,SAAS,CAAA,eAAA,EAAkBC,GAAa,SAAS,CAAA,4BAAA,EAA+BgH,GAAU3V,CAAAA,CAAI,KAAK,CAAC,CAAA,OAAA,CAC/H,CAAA,CAAA,KACK,CAEL5oB,CAAAA,CAAM,IAAA,CACJ,CAAA,UAAA,EAAa4oB,EAAI,EAAE,CAAA,MAAA,EAASA,EAAI,CAAC,CAAA,MAAA,EAASA,EAAI,EAAE,CAAA,MAAA,EAASA,CAAAA,CAAI,CAAC,CAAA,sCAAA,EACvB8O,EAAAA,CAAc,SAAS,CAAA,CAAA,EAAI+G,CAAS,qBAAqB0G,CAAQ,CAAA,KAAA,CAC1G,EAEA,IAAMjS,CAAAA,CAAAA,CAAQtK,CAAAA,CAAI,EAAA,CAAKA,CAAAA,CAAI,EAAA,EAAM,EACjC5oB,CAAAA,CAAM,IAAA,CACJ,YAAYkzB,CAAI,CAAA,KAAA,EAAQtK,EAAI,CAAA,CAAI,CAAC,CAAA,kCAAA,EACnB0O,CAAAA,CAAW,SAAS,CAAA,eAAA,EAAkBC,GAAa,SAAS,CAAA,4BAAA,EAA+BgH,EAAAA,CAAU3V,CAAAA,CAAI,KAAK,CAAC,SAC/H,EACF,CAEA,OAAO5oB,CAAAA,CAAM,IAAA,CAAK;AAAA,CAAI,CACxB,CAGA,SAASwkC,EAAAA,CAAYxX,EAAgC,CACnD,IAAMhtB,CAAAA,CAAkB,EAAC,CAGzBA,CAAAA,CAAM,IAAA,CACJ,CAAA,SAAA,EAAYgtB,EAAM,CAAC,CAAA,KAAA,EAAQA,CAAAA,CAAM,CAAC,CAAA,SAAA,EAAYA,CAAAA,CAAM,KAAK,CAAA,UAAA,EAAaA,EAAM,MAAM,CAAA,uEAAA,EACV0K,EAAAA,CAAc,QAAQ,MAChG,CAAA,CAGA,IAAM0N,CAAAA,CAAY,CAAA,EAAGpY,EAAM,IAAI,CAAA,EAAGA,CAAAA,CAAM,KAAA,CAAQ,CAAA,EAAA,EAAKA,CAAAA,CAAM,KAAK,CAAA,CAAA,CAAA,CAAM,EAAE,CAAA,CAAA,CAClEqY,CAAAA,CAAWpO,EAAAA,CAAkBmO,CAAAA,CAAW9N,CAAAA,CAAW,SAAA,CAAWC,EAAAA,CAAa,WAAW,EAAI,EAAA,CAC1F+N,CAAAA,CAAY,EAAA,CAElBtlC,CAAAA,CAAM,IAAA,CACJ,CAAA,SAAA,EAAYgtB,CAAAA,CAAM,CAAC,QAAQA,CAAAA,CAAM,CAAC,CAAA,SAAA,EAAYqY,CAAQ,aAAaC,CAAS,CAAA,sEAAA,EACL5N,EAAAA,CAAc,QAAQ,MAC/F,CAAA,CACA13B,CAAAA,CAAM,IAAA,CACJ,CAAA,SAAA,EAAYgtB,CAAAA,CAAM,CAAA,CAAI,CAAC,CAAA,KAAA,EAAQA,EAAM,CAAA,CAAIsY,CAAAA,CAAY,CAAC,CAAA,MAAA,EAAS3N,EAAmB,CAAA,aAAA,EACpEL,CAAAA,CAAW,SAAS,kBAAkBC,EAAAA,CAAa,WAAW,CAAA,0BAAA,EAA6BgH,EAAAA,CAAU6G,CAAS,CAAC,CAAA,OAAA,CAC/H,CAAA,CAGA,QAAWG,CAAAA,IAAWvY,CAAAA,CAAM,QAAA,CAC1BhtB,CAAAA,CAAM,KACJ,CAAA,UAAA,EAAagtB,CAAAA,CAAM,CAAC,CAAA,MAAA,EAASuY,EAAQ,CAAC,CAAA,MAAA,EAASvY,CAAAA,CAAM,CAAA,CAAIA,CAAAA,CAAM,KAAK,CAAA,MAAA,EAASuY,CAAAA,CAAQ,CAAC,CAAA,qEAAA,CAExF,CAAA,CACIA,CAAAA,CAAQ,KAAA,EACVvlC,EAAM,IAAA,CACJ,CAAA,SAAA,EAAYgtB,CAAAA,CAAM,CAAA,CAAI,CAAC,CAAA,KAAA,EAAQuY,CAAAA,CAAQ,CAAA,CAAI,EAAE,CAAA,aAAA,EAAgBjO,CAAAA,CAAW,SAAS,CAAA,eAAA,EACjEC,GAAa,SAAS,CAAA,6BAAA,EAAgCgH,EAAAA,CAAUgH,CAAAA,CAAQ,KAAK,CAAC,CAAA,QAAA,CAChG,CAAA,CAIJ,OAAOvlC,EAAM,IAAA,CAAK;AAAA,CAAI,CACxB,CAGA,SAAS8kC,EAAAA,CAAW/Z,EAA8B,CAGhD,OACE,YAAYA,CAAAA,CAAK,CAAC,QAAQA,CAAAA,CAAK,CAAC,YAAYA,CAAAA,CAAK,KAAK,aAAaA,CAAAA,CAAK,MAAM,CAAA,sEAAA,EACP2M,EAAAA,CAAc,QAAQ,CAAA;AAAA,iBAAA,EAEvE3M,CAAAA,CAAK,CAAA,CAAIA,CAAAA,CAAK,KAAA,CAAQ,CAAQ,CAAA,CAAA,EAAIA,CAAAA,CAAK,CAAC,CAAA,CAAA,EAAIA,CAAAA,CAAK,CAAA,CAAIA,CAAAA,CAAK,KAAK,IAAIA,CAAAA,CAAK,CAAA,CAAI,CAAQ,CAAA,CAAA,EAAIA,CAAAA,CAAK,CAAA,CAAIA,CAAAA,CAAK,KAAA,CAAQ,CAAQ,CAAA,CAAA,EAAIA,CAAAA,CAAK,CAAA,CAAI,CAAQ,CAAA;AAAA,SAAA,EAGnJA,EAAK,CAAA,CAAIA,CAAAA,CAAK,MAAQ,CAAC,CAAA,KAAA,EAAQA,EAAK,CAAA,CAAIA,CAAAA,CAAK,OAAS,CAAC,CAAA,2BAAA,EAA8B4M,EAAmB,CAAA,aAAA,EACxGL,CAAAA,CAAW,SAAS,CAAA,eAAA,EAAkBC,EAAAA,CAAa,SAAS,CAAA,4BAAA,EAA+BgH,EAAAA,CAAUxT,EAAK,IAAI,CAAC,SAEjI,CAMA,SAASwT,GAAUzrB,CAAAA,CAAsB,CACvC,OAAOA,CAAAA,CACJ,OAAA,CAAQ,KAAM,OAAO,CAAA,CACrB,QAAQ,IAAA,CAAM,MAAM,EACpB,OAAA,CAAQ,IAAA,CAAM,MAAM,CAAA,CACpB,OAAA,CAAQ,KAAM,QAAQ,CAAA,CACtB,QAAQ,IAAA,CAAM,OAAO,CAC1B,CChQA,IAAAkkB,GAAkB,EAAA,CAAA,EAAA,EAAA,CAAA,CAmBX,IAAMwO,GAAM,CAEjB,OAAA,CAAS,GAET,OAAA,CAAS,CAAA,CAET,iBAAkB,EAAA,CAElB,gBAAA,CAAkB,GAElB,eAAA,CAAiB,EAAA,CAEjB,YAAa,CAAA,CAEb,kBAAA,CAAoB,EAEpB,QAAA,CAAU,GAAA,CAEV,eAAgB,EAAA,CAIhB,WAAA,CAAa,EAAA,CAEb,aAAc,EAChB,CAAA,CAQA,eAAsBC,EAAAA,CACpB/d,CAAAA,CACAmZ,EAA0B,EAAC,CACM,CACjC,GAAInZ,CAAAA,CAAQ,OAAA,CAAQ,MAAA,GAAW,EAC7B,OAAO,CAAE,MAAO,CAAA,CAAG,MAAA,CAAQ,EAAG,OAAA,CAAS,GAAI,aAAA,CAAe,EAAG,CAAA,CAI/D,IAAMge,EAAa,IAAI,GAAA,CAEvB,QAAWjX,CAAAA,IAAO/G,CAAAA,CAAQ,QAAS,CACjC,IAAMyV,EAAe1O,CAAAA,CAAI,UAAA,CACrB+W,GAAI,gBAAA,CAAmBA,EAAAA,CAAI,iBAC3BA,EAAAA,CAAI,gBAAA,CAEFG,EAAalX,CAAAA,CAAI,UAAA,CAAW,OAAS,CAAA,CACvCA,CAAAA,CAAI,WAAW,MAAA,CAAS+W,EAAAA,CAAI,gBAAkBA,EAAAA,CAAI,WAAA,CAClDA,GAAI,kBAAA,CAEFI,CAAAA,CAAenX,EAAI,OAAA,CAAQ,MAAA,CAAS,EACtCA,CAAAA,CAAI,OAAA,CAAQ,OAAS+W,EAAAA,CAAI,eAAA,CAAkBA,GAAI,WAAA,CAC/CA,EAAAA,CAAI,mBAGFK,CAAAA,CAAc5O,EAAAA,CAAkBxI,EAAI,KAAA,CAAO6I,CAAAA,CAAW,UAAWC,EAAAA,CAAa,SAAS,EACvFuO,CAAAA,CAAWC,EAAAA,CAAetX,EAAI,UAAU,CAAA,CACxCuX,EAAaD,EAAAA,CAAetX,CAAAA,CAAI,OAAO,CAAA,CACvCppB,CAAAA,CAAQ,KAAK,GAAA,CAAImgC,EAAAA,CAAI,SAAUK,CAAAA,CAAcL,EAAAA,CAAI,QAAU,CAAA,CAAGM,CAAAA,CAAWN,GAAI,OAAA,CAAU,CAAA,CAAGQ,CAAAA,CAAaR,EAAAA,CAAI,QAAU,CAAC,CAAA,CAEtHvrC,EAASkjC,CAAAA,CAAewI,CAAAA,CAAaC,EAE3CF,CAAAA,CAAW,GAAA,CAAIjX,EAAI,EAAA,CAAI,CAAE,MAAAppB,CAAAA,CAAO,MAAA,CAAApL,EAAQ,YAAA,CAAAkjC,CAAAA,CAAc,WAAAwI,CAAAA,CAAY,YAAA,CAAAC,CAAa,CAAC,EAClF,CAGA,IAAMx1C,CAAAA,CAAI,IAAI,EAAA,CAAAqpC,OAAAA,CAAM,SAAS,KAAA,CAAM,CAAE,SAAU,IAAK,CAAC,EACrDrpC,CAAAA,CAAE,QAAA,CAAS,CACT,OAAA,CAAS,IAAA,CACT,UAAW,QAAA,CACX,OAAA,CAASo1C,GAAI,WAAA,CACb,OAAA,CAASA,GAAI,YAAA,CACb,OAAA,CAASA,GAAI,OAAA,CACb,OAAA,CAASA,GAAI,OACf,CAAC,EACDp1C,CAAAA,CAAE,mBAAA,CAAoB,KAAO,EAAC,CAAE,EAEhC,IAAA,IAAWq+B,CAAAA,IAAO/G,EAAQ,OAAA,CAAS,CACjC,IAAM5gB,CAAAA,CAAO4+B,CAAAA,CAAW,IAAIjX,CAAAA,CAAI,EAAE,EAClCr+B,CAAAA,CAAE,OAAA,CAAQq+B,EAAI,EAAA,CAAI,CAAE,MAAO3nB,CAAAA,CAAK,KAAA,CAAO,OAAQA,CAAAA,CAAK,MAAO,CAAC,EAC9D,CAGA,QAASpW,CAAAA,CAAI,CAAA,CAAGA,EAAIg3B,CAAAA,CAAQ,aAAA,CAAc,OAAQh3B,CAAAA,EAAAA,CAAK,CACrD,IAAMo+B,CAAAA,CAAMpH,CAAAA,CAAQ,cAAch3B,CAAC,CAAA,CAC7BwK,EAAqC,CAAE,MAAA,CAAQxK,CAAE,CAAA,CACnDo+B,CAAAA,CAAI,QACN5zB,CAAAA,CAAU,KAAA,CAAQ4zB,EAAI,KAAA,CACtB5zB,CAAAA,CAAU,MAAQ+7B,EAAAA,CAAkBnI,CAAAA,CAAI,MAAOwI,CAAAA,CAAW,SAAA,CAAWC,GAAa,SAAS,CAAA,CAAI,EAC/Fr8B,CAAAA,CAAU,MAAA,CAASo8B,EAAW,SAAA,CAAY,CAAA,CAC1Cp8B,EAAU,QAAA,CAAW,GAAA,CAAA,CAEvB9K,EAAE,OAAA,CAAQ0+B,CAAAA,CAAI,KAAMA,CAAAA,CAAI,EAAA,CAAI5zB,CAAS,EACvC,CAIA,GAAI,CACF,EAAA,CAAAu+B,QAAM,MAAA,CAAOrpC,CAAC,EAChB,CAAA,MAASurC,CAAAA,CAAK,CACZ,IAAMC,CAAAA,CAAUD,aAAe,KAAA,CAAQA,CAAAA,CAAI,QAAU,MAAA,CAAOA,CAAG,EAC/D,MAAM,IAAI,MAAM,CAAA,qCAAA,EAAwCC,CAAO,EAAE,CACnE,CAGA,IAAMqK,CAAAA,CAAc,IAAI,IACxB,IAAA,IAAWxX,CAAAA,IAAO/G,EAAQ,OAAA,CAASue,CAAAA,CAAY,IAAIxX,CAAAA,CAAI,EAAA,CAAIA,CAAG,CAAA,CAE9D,IAAMyX,EAA2Cxe,CAAAA,CAAQ,OAAA,CAAQ,GAAA,CAAI+G,CAAAA,EAAO,CAC1E,IAAMwL,CAAAA,CAAY7pC,EAAE,IAAA,CAAKq+B,CAAAA,CAAI,EAAE,CAAA,CACzB3nB,CAAAA,CAAO4+B,EAAW,GAAA,CAAIjX,CAAAA,CAAI,EAAE,CAAA,CAC5ByL,CAAAA,CAAUrC,GAAgBoC,CAAAA,CAAU,CAAA,CAAGA,EAAU,CAAA,CAAGA,CAAAA,CAAU,MAAOA,CAAAA,CAAU,MAAM,EAC3F,OAAO,CACL,GAAIxL,CAAAA,CAAI,EAAA,CACR,MAAOA,CAAAA,CAAI,KAAA,CACX,WAAYA,CAAAA,CAAI,UAAA,CAChB,WAAYA,CAAAA,CAAI,UAAA,CAChB,QAASA,CAAAA,CAAI,OAAA,CACb,EAAGyL,CAAAA,CAAQ,CAAA,CACX,EAAGA,CAAAA,CAAQ,CAAA,CACX,MAAOD,CAAAA,CAAU,KAAA,EAASnzB,EAAK,KAAA,CAC/B,MAAA,CAAQmzB,EAAU,MAAA,EAAUnzB,CAAAA,CAAK,OACjC,YAAA,CAAcA,CAAAA,CAAK,aACnB,UAAA,CAAYA,CAAAA,CAAK,WACjB,YAAA,CAAcA,CAAAA,CAAK,YACrB,CACF,CAAC,EAGKq/B,CAAAA,CAA+C/1C,CAAAA,CAAE,OAAM,CAAE,GAAA,CAAIsQ,GAAW,CAC5E,IAAM05B,EAAYhqC,CAAAA,CAAE,IAAA,CAAKsQ,CAAO,CAAA,CAC1BouB,CAAAA,CAAMpH,EAAQ,aAAA,CAAc0S,CAAAA,CAAU,MAAgB,CAAA,CACtDE,CAAAA,CAAYF,EAAU,MAAA,EAAU,GAEhCO,CAAAA,CAAcvC,EAAAA,CAAiBkC,EAAW,IAAI,CAAA,CAM9C8L,EAAUh2C,CAAAA,CAAE,IAAA,CAAKsQ,EAAQ,CAAC,CAAA,CAC1B2lC,EAAUj2C,CAAAA,CAAE,IAAA,CAAKsQ,EAAQ,CAAC,CAAA,CAC1B23B,EAASO,EAAAA,CACb+B,CAAAA,CACAyL,EAAU,CAAE,EAAA,CAAIA,EAAQ,CAAA,CAAG,EAAA,CAAIA,EAAQ,CAAA,CAAG,EAAA,CAAIA,EAAQ,KAAA,CAAQ,CAAA,CAAG,GAAIA,CAAAA,CAAQ,MAAA,CAAS,CAAE,CAAA,CAAI,IAAA,CAC5FC,EAAU,CAAE,EAAA,CAAIA,EAAQ,CAAA,CAAG,EAAA,CAAIA,EAAQ,CAAA,CAAG,EAAA,CAAIA,EAAQ,KAAA,CAAQ,CAAA,CAAG,GAAIA,CAAAA,CAAQ,MAAA,CAAS,CAAE,CAAA,CAAI,IAC9F,EAGIvL,CAAAA,CACJ,OAAIhM,EAAI,KAAA,EAASsL,CAAAA,CAAU,GAAK,IAAA,EAAQA,CAAAA,CAAU,GAAK,IAAA,GACrDU,CAAAA,CAAgB,CAAE,CAAA,CAAGV,CAAAA,CAAU,EAAG,CAAA,CAAGA,CAAAA,CAAU,CAAE,CAAA,CAAA,CAG5C,CACL,KAAMtL,CAAAA,CAAI,IAAA,CACV,GAAIA,CAAAA,CAAI,EAAA,CACR,KAAMA,CAAAA,CAAI,IAAA,CACV,SAAUA,CAAAA,CAAI,QAAA,CACd,MAAOA,CAAAA,CAAI,KAAA,CACX,gBAAiBA,CAAAA,CAAI,eAAA,CACrB,aAAA,CAAeA,CAAAA,CAAI,cACnB,MAAA,CAAAuJ,CAAAA,CACA,cAAAyC,CACF,CACF,CAAC,CAAA,CAED,OAAO,CACL,KAAA,CAAO1qC,CAAAA,CAAE,OAAM,CAAE,KAAA,EAAS,IAC1B,MAAA,CAAQA,CAAAA,CAAE,OAAM,CAAE,MAAA,EAAU,IAC5B,OAAA,CAAS81C,CAAAA,CACT,cAAAC,CACF,CACF,CAGA,SAASJ,EAAAA,CAAeO,EAAgC,CACtD,GAAIA,EAAQ,MAAA,GAAW,CAAA,CAAG,OAAO,CAAA,CACjC,IAAIC,EAAO,CAAA,CACX,IAAA,IAAWzb,KAAKwb,CAAAA,CAAS,CACvB,IAAMxzB,CAAAA,CAAO0zB,EAAAA,CAAe1b,CAAC,CAAA,CAEvB73B,CAAAA,CAAIokC,GAAsBvkB,CAAAA,CAAM0yB,EAAAA,CAAI,cAAc,CAAA,CACpDvyC,CAAAA,CAAIszC,IAAMA,CAAAA,CAAOtzC,CAAAA,EACvB,CACA,OAAOszC,CACT,CAGO,SAASC,EAAAA,CAAe1b,EAAwB,CACrD,IAAM2E,EAAM3E,CAAAA,CAAE,UAAA,CAAa,GAAGA,CAAAA,CAAE,UAAU,IAAM,EAAA,CAC1C3gB,CAAAA,CAAO2gB,EAAE,IAAA,CAAO,CAAA,EAAA,EAAKA,EAAE,IAAI,CAAA,CAAA,CAAK,GACtC,OAAO,CAAA,EAAG2E,CAAG,CAAA,EAAG3E,CAAAA,CAAE,IAAI,CAAA,EAAG3gB,CAAI,EAC/B,CCrMA,IAAMs8B,GAAW,CACf,UAAA,CAAY,GACZ,YAAA,CAAc,GAAA,CACd,eAAgB,EAAA,CAChB,gBAAA,CAAkB,GACpB,CAAA,CAQO,SAASC,GACdhf,CAAAA,CACAhV,CAAAA,CACAL,EAAe,OAAA,CACfM,CAAAA,CAAuB,MACf,CACR,IAAM3S,EAAkB,EAAC,CAGzBA,EAAM,IAAA,CAAKyS,EAAAA,CAAWiV,EAAQ,KAAA,CAAOA,CAAAA,CAAQ,OAAQhV,CAAAA,CAAQC,CAAW,CAAC,CAAA,CACzE3S,CAAAA,CAAM,KAAKoS,EAAAA,CAAgBC,CAAAA,CAAM,IAAI,CAAC,CAAA,CACtCrS,EAAM,IAAA,CAAK,QAAQ,EACnBA,CAAAA,CAAM,IAAA,CAAK2mC,IAAwB,CAAA,CACnC3mC,EAAM,IAAA,CAAK,SAAS,EAGpB,IAAA,IAAW8uB,CAAAA,IAAOpH,EAAQ,aAAA,CACxB1nB,CAAAA,CAAM,KAAK4mC,EAAAA,CAAmB9X,CAAG,CAAC,CAAA,CAIpC,IAAA,IAAWL,KAAO/G,CAAAA,CAAQ,OAAA,CACxB1nB,EAAM,IAAA,CAAK6mC,EAAAA,CAAepY,CAAG,CAAC,CAAA,CAIhC,QAAWK,CAAAA,IAAOpH,CAAAA,CAAQ,cACxB1nB,CAAAA,CAAM,IAAA,CAAK8mC,GAAyBhY,CAAG,CAAC,EAG1C,OAAA9uB,CAAAA,CAAM,KAAK,QAAQ,CAAA,CACZA,EAAM,IAAA,CAAK;AAAA,CAAI,CACxB,CAkBA,SAAS2mC,EAAAA,EAAiC,CACxC,OAEE,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAA,CAgBJ,CAOA,SAASE,EAAAA,CAAepY,CAAAA,CAAkC,CACxD,GAAM,CAAE,CAAA,CAAA91B,CAAAA,CAAG,CAAA,CAAAC,CAAAA,CAAG,KAAA,CAAAyM,EAAO,MAAA,CAAApL,CAAAA,CAAQ,YAAA,CAAAkjC,CAAAA,CAAc,UAAA,CAAAwI,CAAAA,CAAY,YAAA,CAAAC,CAAa,CAAA,CAAInX,CAAAA,CAClEzuB,CAAAA,CAAkB,EAAC,CAGzBA,CAAAA,CAAM,KACJ,CAAA,SAAA,EAAYrH,CAAC,CAAA,KAAA,EAAQC,CAAC,CAAA,SAAA,EAAYyM,CAAK,aAAapL,CAAM,CAAA,oFAAA,EAC2By9B,EAAAA,CAAc,QAAQ,CAAA,IAAA,CAC7G,CAAA,CAGA13B,EAAM,IAAA,CACJ,CAAA,SAAA,EAAYrH,CAAC,CAAA,KAAA,EAAQC,CAAC,CAAA,SAAA,EAAYyM,CAAK,CAAA,UAAA,EAAa83B,CAAY,CAAA,oFAAA,EACqBzF,EAAAA,CAAc,QAAQ,CAAA,IAAA,CAC7G,CAAA,CAGA,IAAIqP,CAAAA,CAAQnuC,CAAAA,CAAIukC,CAAAA,CAAe,CAAA,CAC/B,GAAI1O,CAAAA,CAAI,WAAY,CAClB,IAAMuY,CAAAA,CAASpuC,CAAAA,CAAI,EAAA,CACnBoH,CAAAA,CAAM,KACJ,CAAA,SAAA,EAAYrH,CAAAA,CAAI0M,CAAAA,CAAQ,CAAC,CAAA,KAAA,EAAQ2hC,CAAM,CAAA,2BAAA,EAA8BrP,EAAmB,CAAA,aAAA,EAC1E8O,EAAAA,CAAS,cAAc,CAAA,eAAA,EAAkBA,EAAAA,CAAS,gBAAgB,2DACvBlI,EAAAA,CAAU9P,CAAAA,CAAI,UAAU,CAAC,CAAA,eAAA,CACpF,CAAA,CACAsY,EAAQnuC,CAAAA,CAAIukC,CAAAA,CAAe,CAAA,CAAI,EACjC,CAGAn9B,CAAAA,CAAM,KACJ,CAAA,SAAA,EAAYrH,CAAAA,CAAI0M,CAAAA,CAAQ,CAAC,CAAA,KAAA,EAAQ0hC,CAAK,CAAA,2BAAA,EAA8BpP,EAAmB,CAAA,aAAA,EACzEL,CAAAA,CAAW,SAAS,CAAA,wCAAA,EAA2CiH,EAAAA,CAAU9P,CAAAA,CAAI,KAAK,CAAC,CAAA,OAAA,CACnG,CAAA,CAGA,IAAMwY,CAAAA,CAAUruC,CAAAA,CAAIukC,EACpBn9B,CAAAA,CAAM,IAAA,CACJ,CAAA,UAAA,EAAarH,CAAC,CAAA,MAAA,EAASsuC,CAAO,SAAStuC,CAAAA,CAAI0M,CAAK,CAAA,MAAA,EAAS4hC,CAAO,CAAA,6CAAA,EAClBvP,EAAAA,CAAc,QAAQ,CAAA,IAAA,CACtE,CAAA,CAGA,IAAMwP,CAAAA,CAAa,EAAA,CACnB,IAAA,IAASx2C,CAAAA,CAAI,EAAGA,CAAAA,CAAI+9B,CAAAA,CAAI,UAAA,CAAW,MAAA,CAAQ/9B,CAAAA,EAAAA,CAAK,CAC9C,IAAM09B,CAAAA,CAASK,CAAAA,CAAI,UAAA,CAAW/9B,CAAC,CAAA,CACzBy2C,CAAAA,CAAUF,EAAU,CAAA,CAAIv2C,CAAAA,CAAIw2C,CAAAA,CAAaA,CAAAA,CAAa,CAAA,CAC5DlnC,CAAAA,CAAM,IAAA,CAAKonC,EAAAA,CAAahZ,CAAAA,CAAQz1B,CAAAA,CAAI6sC,EAAAA,CAAI,OAAA,CAAS2B,CAAO,CAAC,EAC3D,CAGA,IAAME,CAAAA,CAAYJ,CAAAA,CAAUtB,CAAAA,CAC5B3lC,CAAAA,CAAM,KACJ,CAAA,UAAA,EAAarH,CAAC,CAAA,MAAA,EAAS0uC,CAAS,CAAA,MAAA,EAAS1uC,CAAAA,CAAI0M,CAAK,CAAA,MAAA,EAASgiC,CAAS,CAAA,6CAAA,EACtB3P,EAAAA,CAAc,QAAQ,CAAA,IAAA,CACtE,CAAA,CAGA,IAAA,IAAShnC,CAAAA,CAAI,CAAA,CAAGA,CAAAA,CAAI+9B,CAAAA,CAAI,OAAA,CAAQ,MAAA,CAAQ/9B,IAAK,CAC3C,IAAM09B,CAAAA,CAASK,CAAAA,CAAI,OAAA,CAAQ/9B,CAAC,CAAA,CACtBy2C,CAAAA,CAAUE,CAAAA,CAAY,CAAA,CAAI32C,CAAAA,CAAIw2C,CAAAA,CAAaA,CAAAA,CAAa,CAAA,CAC9DlnC,EAAM,IAAA,CAAKonC,EAAAA,CAAahZ,CAAAA,CAAQz1B,CAAAA,CAAI6sC,EAAAA,CAAI,OAAA,CAAS2B,CAAO,CAAC,EAC3D,CAEA,OAAOnnC,CAAAA,CAAM,IAAA,CAAK;AAAA,CAAI,CACxB,CAUA,SAASonC,GAAahZ,CAAAA,CAAqBz1B,CAAAA,CAAWC,EAAmB,CACvE,IAAM0uC,CAAAA,CAAYlZ,CAAAA,CAAO,WAAa,sBAAA,CAAyB,EAAA,CACzDmZ,EAAanZ,CAAAA,CAAO,QAAA,CAAW,+BAAiC,EAAA,CAGhEoZ,CAAAA,CAAkB,EAAC,CAEzB,OAAIpZ,CAAAA,CAAO,UAAA,EACToZ,EAAM,IAAA,CAAK,CAAA,iCAAA,EAAoCjJ,GAAUnQ,CAAAA,CAAO,UAAU,CAAC,CAAA,SAAA,CAAW,EAGxFoZ,CAAAA,CAAM,IAAA,CAAK,kCAAkCjJ,EAAAA,CAAUnQ,CAAAA,CAAO,IAAI,CAAC,CAAA,QAAA,CAAU,CAAA,CAEzEA,CAAAA,CAAO,OACToZ,CAAAA,CAAM,IAAA,CAAK,6CAA6C,CAAA,CACxDA,CAAAA,CAAM,KAAK,CAAA,iCAAA,EAAoCjJ,EAAAA,CAAUnQ,CAAAA,CAAO,IAAI,CAAC,CAAA,QAAA,CAAU,CAAA,CAAA,CAI/E,YAAYz1B,CAAC,CAAA,KAAA,EAAQC,CAAC,CAAA,mBAAA,EAAsB++B,EAAmB,CAAA,aAAA,EACjD8O,EAAAA,CAAS,UAAU,CAAA,eAAA,EAAkBA,EAAAA,CAAS,YAAY,CAAA,CAAA,EAAIa,CAAS,GAAGC,CAAU,CAAA,CAAA,EAC/FC,CAAAA,CAAM,IAAA,CAAK,EAAE,CAAC,CAAA,OAAA,CAErB,CAOA,SAASZ,EAAAA,CAAmB9X,EAA0C,CACpE,GAAIA,CAAAA,CAAI,MAAA,CAAO,OAAS,CAAA,CAAG,OAAO,GAElC,IAAMnuB,CAAAA,CAAWmuB,EAAI,MAAA,CAAO,GAAA,CAAIj2B,CAAAA,EAAK,CAAA,EAAGA,EAAE,CAAC,CAAA,CAAA,EAAIA,EAAE,CAAC,CAAA,CAAE,EAAE,IAAA,CAAK,GAAG,CAAA,CAExD4lC,CAAAA,CADW3P,EAAI,IAAA,GAAS,YAAA,EAAgBA,EAAI,IAAA,GAAS,aAAA,CAC9B,0BAA4B,EAAA,CAGnD6P,CAAAA,CAAU8I,EAAAA,CAAuB3Y,CAAAA,CAAI,KAAMA,CAAAA,CAAI,QAAQ,EAE7D,OACE,CAAA,kBAAA,EAAqBnuB,CAAQ,CAAA,kDAAA,EACZ+2B,EAAAA,CAAc,SAAS,CAAA,CAAA,EAAI+G,CAAS,CAAA,EAAGE,CAAO,KAEnE,CAQA,SAAS8I,GAAuBt9B,CAAAA,CAAwB0lB,CAAAA,CAAiC,CACvF,IAAMsV,EAAWuC,EAAAA,CAAev9B,CAAI,EACpC,OAAKg7B,CAAAA,CAEDtV,IAAa,MAAA,CACR,CAAA,oBAAA,EAAuBsV,CAAQ,CAAA,EAAA,CAAA,CAE/B,qBAAqBA,CAAQ,CAAA,EAAA,CAAA,CALhB,EAOxB,CAGA,SAASuC,GAAev9B,CAAAA,CAAuC,CAC7D,OAAQA,CAAAA,EACN,KAAK,aAAA,CACL,KAAK,cACH,OAAO,aAAA,CACT,KAAK,aAAA,CACH,OAAO,iBAAA,CACT,KAAK,cACH,OAAO,iBAAA,CACT,KAAK,aAAA,CACL,KAAK,aACH,OAAO,WAAA,CACT,QACE,OAAO,IACX,CACF,CAGA,SAAS28B,EAAAA,CAAyBhY,CAAAA,CAA0C,CAE1E,GADI,CAACA,CAAAA,CAAI,KAAA,EAAS,CAACA,CAAAA,CAAI,eAAA,EAAmB,CAACA,CAAAA,CAAI,aAAA,EAC3CA,EAAI,MAAA,CAAO,MAAA,CAAS,CAAA,CAAG,OAAO,GAElC,IAAM9uB,CAAAA,CAAkB,EAAC,CAGzB,GAAI8uB,EAAI,KAAA,CAAO,CACb,IAAMprB,CAAAA,CAAMorB,EAAI,aAAA,EAAiB6Y,EAAAA,CAAS7Y,EAAI,MAAM,CAAA,CACpD9uB,EAAM,IAAA,CACJ,CAAA,SAAA,EAAY0D,CAAAA,CAAI,CAAC,QAAQA,CAAAA,CAAI,CAAA,CAAI,CAAC,CAAA,kCAAA,EACpB4zB,CAAAA,CAAW,SAAS,CAAA,eAAA,EAAkBC,EAAAA,CAAa,SAAS,CAAA,4BAAA,EAC7CgH,GAAUzP,CAAAA,CAAI,KAAK,CAAC,CAAA,OAAA,CACnD,EACF,CAGA,GAAIA,CAAAA,CAAI,eAAA,CAAiB,CACvB,IAAMj2B,CAAAA,CAAIi2B,CAAAA,CAAI,OAAO,CAAC,CAAA,CAChB1Y,EAAO0Y,CAAAA,CAAI,MAAA,CAAO,CAAC,CAAA,CACnBhkB,EAAS88B,EAAAA,CAAkB/uC,CAAAA,CAAGud,CAAI,CAAA,CACxCpW,CAAAA,CAAM,KACJ,CAAA,SAAA,EAAYnH,CAAAA,CAAE,CAAA,CAAIiS,CAAAA,CAAO,CAAC,CAAA,KAAA,EAAQjS,CAAAA,CAAE,EAAIiS,CAAAA,CAAO,CAAC,qCAClCwsB,CAAAA,CAAW,SAAS,CAAA,eAAA,EAAkBC,EAAAA,CAAa,SAAS,CAAA,4BAAA,EAC7CgH,EAAAA,CAAUzP,EAAI,eAAe,CAAC,SAC7D,EACF,CAGA,GAAIA,CAAAA,CAAI,cAAe,CACrB,IAAMj2B,EAAIi2B,CAAAA,CAAI,MAAA,CAAOA,EAAI,MAAA,CAAO,MAAA,CAAS,CAAC,CAAA,CACpCt8B,EAAOs8B,CAAAA,CAAI,MAAA,CAAOA,EAAI,MAAA,CAAO,MAAA,CAAS,CAAC,CAAA,CACvChkB,CAAAA,CAAS88B,EAAAA,CAAkB/uC,CAAAA,CAAGrG,CAAI,CAAA,CACxCwN,CAAAA,CAAM,KACJ,CAAA,SAAA,EAAYnH,CAAAA,CAAE,EAAIiS,CAAAA,CAAO,CAAC,CAAA,KAAA,EAAQjS,CAAAA,CAAE,EAAIiS,CAAAA,CAAO,CAAC,qCAClCwsB,CAAAA,CAAW,SAAS,kBAAkBC,EAAAA,CAAa,SAAS,+BAC7CgH,EAAAA,CAAUzP,CAAAA,CAAI,aAAa,CAAC,CAAA,OAAA,CAC3D,EACF,CAEA,OAAO9uB,EAAM,IAAA,CAAK;AAAA,CAAI,CACxB,CAGA,SAAS2nC,EAAAA,CAAStP,CAAAA,CAAmE,CACnF,GAAIA,CAAAA,CAAO,MAAA,GAAW,CAAA,CAAG,OAAO,CAAE,CAAA,CAAG,EAAG,CAAA,CAAG,CAAE,EAC7C,IAAMuG,CAAAA,CAAM,IAAA,CAAK,KAAA,CAAMvG,EAAO,MAAA,CAAS,CAAC,EACxC,OAAOA,CAAAA,CAAOuG,CAAG,CACnB,CAGA,SAASgJ,EAAAA,CACPptB,EACAC,CAAAA,CAC0B,CAC1B,IAAMjhB,CAAAA,CAAKihB,CAAAA,CAAG,EAAID,CAAAA,CAAK,CAAA,CACjB/gB,CAAAA,CAAKghB,CAAAA,CAAG,EAAID,CAAAA,CAAK,CAAA,CAEvB,OAAI,IAAA,CAAK,GAAA,CAAIhhB,CAAE,CAAA,CAAI,IAAA,CAAK,GAAA,CAAIC,CAAE,EAErB,CAAE,CAAA,CAAGD,EAAK,CAAA,CAAI,EAAA,CAAK,IAAK,CAAA,CAAG,GAAI,CAAA,CAGjC,CAAE,EAAG,GAAA,CAAK,CAAA,CAAGC,EAAK,CAAA,CAAI,EAAA,CAAK,GAAI,CACxC,CAMA,SAAS8kC,EAAAA,CAAUzrB,EAAsB,CACvC,OAAOA,EACJ,OAAA,CAAQ,IAAA,CAAM,OAAO,CAAA,CACrB,OAAA,CAAQ,IAAA,CAAM,MAAM,EACpB,OAAA,CAAQ,IAAA,CAAM,MAAM,CAAA,CACpB,QAAQ,IAAA,CAAM,QAAQ,CAAA,CACtB,OAAA,CAAQ,KAAM,OAAO,CAC1B,CCpVA,IAAAkkB,EAAAA,CAAkB,SAkBlB,IAAM6Q,EAAAA,CAAK,CACT,OAAA,CAAS,GACT,OAAA,CAAS,EAAA,CACT,aAAc,EAAA,CACd,SAAA,CAAW,GACX,QAAA,CAAU,GAAA,CACV,YAAA,CAAc,EAAA,CAEd,WAAA,CAAa,GACb,YAAA,CAAc,EAChB,EAQA,eAAsBC,EAAAA,CACpBpgB,CAAAA,CACAmZ,CAAAA,CAA0B,EAAC,CACG,CAC9B,GAAInZ,CAAAA,CAAQ,QAAA,CAAS,SAAW,CAAA,CAC9B,OAAO,CAAE,KAAA,CAAO,EAAG,MAAA,CAAQ,CAAA,CAAG,SAAU,EAAC,CAAG,cAAe,EAAG,CAAA,CAIhE,IAAMqgB,EAAc,IAAI,GAAA,CAExB,QAAWpU,CAAAA,IAAUjM,CAAAA,CAAQ,SAAU,CAErC,IAAMme,CAAAA,CAAc5O,EAAAA,CAAkBtD,EAAO,KAAA,CAAO2D,CAAAA,CAAW,UAAWC,EAAAA,CAAa,SAAS,EAI5FuO,CAAAA,CAAW,CAAA,CACf,IAAA,IAAWxS,CAAAA,IAAQK,EAAO,UAAA,CAAY,CACpC,IAAMqU,CAAAA,CAAW,GAAG1U,CAAAA,CAAK,IAAI,CAAA,EAAA,EAAKA,CAAAA,CAAK,IAAI,CAAA,EAAGA,CAAAA,CAAK,KAAK,MAAA,CAAS,CAAA,CAAI,KAAOA,CAAAA,CAAK,IAAA,CAAK,IAAA,CAAK,GAAG,EAAI,EAAE,CAAA,CAAA,CAC9FrgC,EAAIokC,EAAAA,CAAsB2Q,CAAAA,CAAUH,GAAG,YAAY,CAAA,CACrD50C,CAAAA,CAAI6yC,CAAAA,GAAUA,EAAW7yC,CAAAA,EAC/B,CAEA,IAAMoS,CAAAA,CAAQ,IAAA,CAAK,IAAIwiC,EAAAA,CAAG,QAAA,CAAUhC,CAAAA,CAAcgC,EAAAA,CAAG,QAAU,CAAA,CAAG/B,CAAAA,CAAW+B,GAAG,OAAA,CAAU,CAAC,EACrF5tC,CAAAA,CAAS4tC,EAAAA,CAAG,YAAA,CAAe,IAAA,CAAK,IAAIlU,CAAAA,CAAO,UAAA,CAAW,OAAQ,CAAC,CAAA,CAAIkU,GAAG,SAAA,CAE5EE,CAAAA,CAAY,GAAA,CAAIpU,CAAAA,CAAO,GAAI,CAAE,KAAA,CAAAtuB,EAAO,MAAA,CAAApL,CAAO,CAAC,EAC9C,CAGA,IAAM7J,CAAAA,CAAI,IAAI,EAAA,CAAAqpC,OAAAA,CAAM,SAAS,KAAA,CAAM,CAAE,SAAU,IAAK,CAAC,CAAA,CACrDrpC,CAAAA,CAAE,SAAS,CACT,OAAA,CAAS,IAAA,CACT,SAAA,CAAW,SACX,OAAA,CAASy3C,EAAAA,CAAG,WAAA,CACZ,OAAA,CAASA,GAAG,YAAA,CACZ,OAAA,CAASA,GAAG,OAAA,CACZ,OAAA,CAASA,GAAG,OACd,CAAC,CAAA,CACDz3C,CAAAA,CAAE,oBAAoB,KAAO,GAAG,CAAA,CAEhC,IAAA,IAAWujC,KAAUjM,CAAAA,CAAQ,QAAA,CAAU,CACrC,IAAM5gB,EAAOihC,CAAAA,CAAY,GAAA,CAAIpU,EAAO,EAAE,CAAA,CACtCvjC,EAAE,OAAA,CAAQujC,CAAAA,CAAO,EAAA,CAAI,CAAE,MAAO7sB,CAAAA,CAAK,KAAA,CAAO,OAAQA,CAAAA,CAAK,MAAO,CAAC,EACjE,CAEA,IAAA,IAASpW,CAAAA,CAAI,EAAGA,CAAAA,CAAIg3B,CAAAA,CAAQ,cAAc,MAAA,CAAQh3B,CAAAA,EAAAA,CAAK,CACrD,IAAMo+B,CAAAA,CAAMpH,CAAAA,CAAQ,aAAA,CAAch3B,CAAC,CAAA,CACnCN,CAAAA,CAAE,QAAQ0+B,CAAAA,CAAI,OAAA,CAASA,EAAI,OAAA,CAAS,CAClC,MAAA,CAAQp+B,CAAAA,CACR,MAAOo+B,CAAAA,CAAI,KAAA,CACX,MAAOmI,EAAAA,CAAkBnI,CAAAA,CAAI,MAAOwI,CAAAA,CAAW,SAAA,CAAWC,EAAAA,CAAa,SAAS,EAAI,CAAA,CACpF,MAAA,CAAQD,CAAAA,CAAW,SAAA,CAAY,EAC/B,QAAA,CAAU,GACZ,CAAC,EACH,CAIA,GAAI,CACF,GAAAmC,OAAAA,CAAM,MAAA,CAAOrpC,CAAC,EAChB,CAAA,MAASurC,CAAAA,CAAK,CACZ,IAAMC,CAAAA,CAAUD,CAAAA,YAAe,MAAQA,CAAAA,CAAI,OAAA,CAAU,OAAOA,CAAG,CAAA,CAC/D,MAAM,IAAI,MAAM,CAAA,kCAAA,EAAqCC,CAAO,EAAE,CAChE,CAGA,IAAMqM,CAAAA,CAAe,IAAI,GAAA,CACzB,IAAA,IAAWtU,KAAUjM,CAAAA,CAAQ,QAAA,CAAUugB,EAAa,GAAA,CAAItU,CAAAA,CAAO,GAAIA,CAAM,CAAA,CAEzE,IAAMuU,CAAAA,CAA2CxgB,EAAQ,QAAA,CAAS,GAAA,CAAIiM,GAAU,CAC9E,IAAMsG,EAAY7pC,CAAAA,CAAE,IAAA,CAAKujC,CAAAA,CAAO,EAAE,EAC5BuG,CAAAA,CAAUrC,EAAAA,CAAgBoC,EAAU,CAAA,CAAGA,CAAAA,CAAU,EAAGA,CAAAA,CAAU,KAAA,CAAOA,CAAAA,CAAU,MAAM,EAC3F,OAAO,CACL,GAAItG,CAAAA,CAAO,EAAA,CACX,MAAOA,CAAAA,CAAO,KAAA,CACd,UAAA,CAAYA,CAAAA,CAAO,WACnB,CAAA,CAAGuG,CAAAA,CAAQ,CAAA,CACX,CAAA,CAAGA,EAAQ,CAAA,CACX,KAAA,CAAOD,CAAAA,CAAU,KAAA,EAAS8N,EAAY,GAAA,CAAIpU,CAAAA,CAAO,EAAE,CAAA,CAAG,KAAA,CACtD,OAAQsG,CAAAA,CAAU,MAAA,EAAU8N,CAAAA,CAAY,GAAA,CAAIpU,EAAO,EAAE,CAAA,CAAG,OACxD,YAAA,CAAckU,EAAAA,CAAG,aACjB,SAAA,CAAWA,EAAAA,CAAG,SAChB,CACF,CAAC,CAAA,CAGK1B,CAAAA,CAA4C/1C,EAAE,KAAA,EAAM,CAAE,IAAIsQ,CAAAA,EAAW,CACzE,IAAM05B,CAAAA,CAAYhqC,EAAE,IAAA,CAAKsQ,CAAO,EAC1BouB,CAAAA,CAAMpH,CAAAA,CAAQ,cAAc0S,CAAAA,CAAU,MAAgB,CAAA,CACtDE,CAAAA,CAAYF,EAAU,MAAA,EAAU,GAEhCO,CAAAA,CAAcvC,EAAAA,CAAiBkC,EAAW,KAAK,CAAA,CAM/C8L,CAAAA,CAAUh2C,CAAAA,CAAE,KAAKsQ,CAAAA,CAAQ,CAAC,EAC1B2lC,CAAAA,CAAUj2C,CAAAA,CAAE,KAAKsQ,CAAAA,CAAQ,CAAC,CAAA,CAC1B23B,CAAAA,CAASO,GACb+B,CAAAA,CACAyL,CAAAA,CAAU,CAAE,EAAA,CAAIA,CAAAA,CAAQ,EAAG,EAAA,CAAIA,CAAAA,CAAQ,CAAA,CAAG,EAAA,CAAIA,EAAQ,KAAA,CAAQ,CAAA,CAAG,EAAA,CAAIA,CAAAA,CAAQ,OAAS,CAAE,CAAA,CAAI,IAAA,CAC5FC,CAAAA,CAAU,CAAE,EAAA,CAAIA,CAAAA,CAAQ,EAAG,EAAA,CAAIA,CAAAA,CAAQ,EAAG,EAAA,CAAIA,CAAAA,CAAQ,KAAA,CAAQ,CAAA,CAAG,GAAIA,CAAAA,CAAQ,MAAA,CAAS,CAAE,CAAA,CAAI,IAC9F,EAEA,OAAO,CACL,OAAA,CAASvX,CAAAA,CAAI,QACb,OAAA,CAASA,CAAAA,CAAI,QACb,YAAA,CAAcA,CAAAA,CAAI,aAClB,YAAA,CAAcA,CAAAA,CAAI,YAAA,CAClB,KAAA,CAAOA,EAAI,KAAA,CACX,WAAA,CAAaA,EAAI,WAAA,CACjB,MAAA,CAAAuJ,CACF,CACF,CAAC,CAAA,CAED,OAAO,CACL,KAAA,CAAOjoC,CAAAA,CAAE,OAAM,CAAE,KAAA,EAAS,IAC1B,MAAA,CAAQA,CAAAA,CAAE,KAAA,EAAM,CAAE,QAAU,GAAA,CAC5B,QAAA,CAAU83C,EACV,aAAA,CAAA/B,CACF,CACF,CC/IA,IAAMgC,EAAAA,CAAU,CACd,SAAU,EAAA,CACV,UAAA,CAAY,IACZ,OAAA,CAAS,CAAA,CACT,UAAW,GACb,CAAA,CAQO,SAASC,EAAAA,CACd1gB,EACAhV,CAAAA,CACAL,CAAAA,CAAe,OAAA,CACfM,CAAAA,CAAuB,MACf,CACR,IAAM3S,CAAAA,CAAkB,GAGxBA,CAAAA,CAAM,IAAA,CAAKyS,GAAWiV,CAAAA,CAAQ,KAAA,CAAOA,EAAQ,MAAA,CAAQhV,CAAAA,CAAQC,CAAW,CAAC,EACzE3S,CAAAA,CAAM,IAAA,CAAKoS,GAAgBC,CAAAA,CAAM,IAAI,CAAC,CAAA,CACtCrS,CAAAA,CAAM,IAAA,CAAK,QAAQ,EACnBA,CAAAA,CAAM,IAAA,CAAK,SAAS,CAAA,CAGpB,IAAA,IAAW8uB,KAAOpH,CAAAA,CAAQ,aAAA,CACxB1nB,CAAAA,CAAM,IAAA,CAAKqoC,GAAuBvZ,CAAG,CAAC,EAIxC,IAAA,IAAW6E,CAAAA,IAAUjM,EAAQ,QAAA,CAC3B1nB,CAAAA,CAAM,IAAA,CAAKsoC,EAAAA,CAAgB3U,CAAM,CAAC,CAAA,CAIpC,QAAW7E,CAAAA,IAAOpH,CAAAA,CAAQ,cACxB1nB,CAAAA,CAAM,IAAA,CAAKuoC,EAAAA,CAAkBzZ,CAAG,CAAC,CAAA,CAInC,IAAA,IAAWA,KAAOpH,CAAAA,CAAQ,aAAA,CACxB1nB,EAAM,IAAA,CAAKwoC,EAAAA,CAAwB1Z,CAAG,CAAC,EAGzC,OAAA9uB,CAAAA,CAAM,KAAK,QAAQ,CAAA,CACZA,EAAM,IAAA,CAAK;AAAA,CAAI,CACxB,CAOA,SAASsoC,EAAAA,CAAgB3U,EAAoC,CAC3D,GAAM,CAAE,CAAA,CAAAh7B,EAAG,CAAA,CAAAC,CAAAA,CAAG,KAAA,CAAAyM,CAAAA,CAAO,OAAApL,CAAAA,CAAQ,YAAA,CAAAkjC,CAAAA,CAAc,SAAA,CAAAnjB,CAAAA,CAAW,KAAA,CAAA1oB,CAAAA,CAAO,UAAA,CAAAm3C,CAAW,CAAA,CAAI9U,CAAAA,CACtE3zB,CAAAA,CAAkB,GAGxBA,CAAAA,CAAM,IAAA,CACJ,CAAA,SAAA,EAAYrH,CAAC,QAAQC,CAAC,CAAA,SAAA,EAAYyM,CAAK,CAAA,UAAA,EAAapL,CAAM,CAAA,oFAAA,EAC2By9B,EAAAA,CAAc,QAAQ,MAC7G,CAAA,CAGA13B,CAAAA,CAAM,IAAA,CACJ,CAAA,SAAA,EAAYrH,CAAC,CAAA,KAAA,EAAQC,CAAC,CAAA,SAAA,EAAYyM,CAAK,aAAa83B,CAAY,CAAA,oFAAA,EACqBzF,EAAAA,CAAc,QAAQ,MAC7G,CAAA,CAGA13B,CAAAA,CAAM,IAAA,CACJ,CAAA,SAAA,EAAYrH,EAAI0M,CAAAA,CAAQ,CAAC,CAAA,KAAA,EAAQzM,CAAAA,CAAIukC,EAAe,CAAC,CAAA,2BAAA,EAA8BxF,EAAmB,CAAA,aAAA,EACxFL,EAAW,SAAS,CAAA,wCAAA,EAA2CiH,EAAAA,CAAUjtC,CAAK,CAAC,CAAA,OAAA,CAC/F,CAAA,CAGA,IAAM21C,EAAUruC,CAAAA,CAAIukC,CAAAA,CACpBn9B,CAAAA,CAAM,IAAA,CACJ,aAAarH,CAAC,CAAA,MAAA,EAASsuC,CAAO,CAAA,MAAA,EAAStuC,EAAI0M,CAAK,CAAA,MAAA,EAAS4hC,CAAO,CAAA,6CAAA,EAClBvP,GAAc,QAAQ,CAAA,IAAA,CACtE,CAAA,CAGA,IAAA,IAAShnC,EAAI,CAAA,CAAGA,CAAAA,CAAI+3C,CAAAA,CAAW,MAAA,CAAQ/3C,IAAK,CAC1C,IAAM4iC,CAAAA,CAAOmV,CAAAA,CAAW/3C,CAAC,CAAA,CACnBg4C,CAAAA,CAAOzB,CAAAA,CAAUv2C,CAAAA,CAAIspB,CAAAA,CAAYA,CAAAA,CAAY,CAAA,CACnDha,CAAAA,CAAM,KAAK2oC,EAAAA,CAAgBrV,CAAAA,CAAM36B,CAAAA,CAAG+vC,CAAAA,CAAMrjC,CAAK,CAAC,EAClD,CAGA,OAAIojC,EAAW,MAAA,GAAW,CAAA,EACxBzoC,CAAAA,CAAM,IAAA,CACJ,YAAYrH,CAAAA,CAAI0M,CAAAA,CAAQ,CAAC,CAAA,KAAA,EAAQ4hC,EAAUjtB,CAAAA,CAAY,CAAC,CAAA,2BAAA,EAA8B2d,EAAmB,gBAC3FwQ,EAAAA,CAAQ,QAAQ,CAAA,sEAAA,CAChC,CAAA,CAGKnoC,EAAM,IAAA,CAAK;AAAA,CAAI,CACxB,CASA,SAAS2oC,EAAAA,CAAgBrV,CAAAA,CAAmBsV,CAAAA,CAAchwC,CAAAA,CAAWqnB,CAAAA,CAA0B,CAC7F,IAAMjgB,CAAAA,CAAkB,GAGpB6oC,CAAAA,CAAW,CAAA,CACf,GAAIvV,CAAAA,CAAK,IAAA,CAAK,MAAA,CAAS,CAAA,CAAG,CACxB,IAAMwV,CAAAA,CAAUxV,CAAAA,CAAK,IAAA,CAAK,IAAA,CAAK,GAAG,CAAA,CAClCuV,CAAAA,CAAW5R,GAAkB6R,CAAAA,CAASX,EAAAA,CAAQ,OAAA,CAASA,EAAAA,CAAQ,SAAS,CAAA,CAAI,CAAA,CAC5EnoC,CAAAA,CAAM,IAAA,CACJ,CAAA,SAAA,EAAY4oC,CAAAA,CAAO,CAAC,CAAA,KAAA,EAAQhwC,CAAAA,CAAI,CAAC,CAAA,SAAA,EAAYiwC,CAAQ,CAAA,uDAAA,CAEvD,CAAA,CACA7oC,CAAAA,CAAM,IAAA,CACJ,CAAA,SAAA,EAAY4oC,CAAAA,CAAO,CAAA,CAAIC,CAAAA,CAAW,CAAC,CAAA,KAAA,EAAQjwC,CAAC,CAAA,2BAAA,EAA8B++B,EAAmB,CAAA,aAAA,EAC/EwQ,EAAAA,CAAQ,OAAO,kBAAkBA,EAAAA,CAAQ,SAAS,CAAA,0BAAA,EAA6B7U,CAAAA,CAAK,IAAA,CAAK,IAAA,CAAK,GAAG,CAAC,CAAA,OAAA,CAClH,EACF,CAGA,IAAMyV,CAAAA,CAAQH,CAAAA,CAAO,CAAA,EAAKC,CAAAA,CAAW,EAAIA,CAAAA,CAAW,CAAA,CAAI,CAAA,CAAA,CACxD7oC,CAAAA,CAAM,IAAA,CACJ,CAAA,SAAA,EAAY+oC,CAAK,CAAA,KAAA,EAAQnwC,CAAC,CAAA,mBAAA,EAAsB++B,EAAmB,CAAA,aAAA,EACrDwQ,EAAAA,CAAQ,QAAQ,CAAA,eAAA,EAAkBA,EAAAA,CAAQ,UAAU,CAAA,mCAAA,EAC9B5J,EAAAA,CAAUjL,CAAAA,CAAK,IAAI,CAAC,CAAA,eAAA,CAC1D,CAAA,CAGA,IAAM0V,CAAAA,CAAQJ,CAAAA,CAAO3oB,CAAAA,CAAW,CAAA,CAChC,OAAAjgB,CAAAA,CAAM,IAAA,CACJ,CAAA,SAAA,EAAYgpC,CAAK,CAAA,KAAA,EAAQpwC,CAAC,CAAA,qCAAA,EAAwC++B,EAAmB,CAAA,aAAA,EACvEwQ,EAAAA,CAAQ,QAAQ,CAAA,eAAA,EAAkBA,GAAQ,UAAU,CAAA,iCAAA,EAChC5J,EAAAA,CAAUjL,CAAAA,CAAK,IAAI,CAAC,CAAA,eAAA,CACxD,CAAA,CAEOtzB,EAAM,IAAA,CAAK;AAAA,CAAI,CACxB,CAOA,SAASqoC,EAAAA,CAAuBvZ,EAAuC,CACrE,GAAIA,EAAI,MAAA,CAAO,MAAA,CAAS,EAAG,OAAO,EAAA,CAElC,IAAMnuB,CAAAA,CAAWmuB,CAAAA,CAAI,OAAO,GAAA,CAAIj2B,CAAAA,EAAK,GAAGA,CAAAA,CAAE,CAAC,IAAIA,CAAAA,CAAE,CAAC,EAAE,CAAA,CAAE,IAAA,CAAK,GAAG,CAAA,CACxD4lC,CAAAA,CAAa3P,EAAI,WAAA,CAA0C,EAAA,CAA5B,0BAErC,OACE,CAAA,kBAAA,EAAqBnuB,CAAQ,CAAA,kDAAA,EACZ+2B,EAAAA,CAAc,SAAS,CAAA,CAAA,EAAI+G,CAAS,KAEzD,CAGA,SAAS+J,GAAwB1Z,CAAAA,CAAuC,CACtE,GAAI,CAACA,CAAAA,CAAI,OAASA,CAAAA,CAAI,MAAA,CAAO,OAAS,CAAA,CAAG,OAAO,GAEhD,IAAM8P,CAAAA,CAAM+I,GAAS7Y,CAAAA,CAAI,MAAM,EAIzBma,CAAAA,CAHYhS,EAAAA,CAAkBnI,EAAI,KAAA,CAAOwI,CAAAA,CAAW,UAAWC,EAAAA,CAAa,SAAS,EAGnE,CAAA,CAClB2R,CAAAA,CAAM5R,EAAW,SAAA,CAAY,CAAA,CAEnC,OACE,CAAA,SAAA,EAAYsH,CAAAA,CAAI,EAAIqK,CAAAA,CAAM,CAAC,QAAQrK,CAAAA,CAAI,CAAA,CAAIsK,EAAM,CAAC,CAAA,SAAA,EAAYD,CAAG,CAAA,UAAA,EAAaC,CAAG,CAAA;AAAA,SAAA,EAEnEtK,EAAI,CAAC,CAAA,KAAA,EAAQA,CAAAA,CAAI,CAAC,8BAA8BjH,EAAmB,CAAA,aAAA,EACnEL,CAAAA,CAAW,SAAS,kBAAkBC,EAAAA,CAAa,SAAS,+BAA+BgH,EAAAA,CAAUzP,CAAAA,CAAI,KAAK,CAAC,CAAA,OAAA,CAEjI,CAWA,SAASyZ,GAAkBzZ,CAAAA,CAAuC,CAChE,GAAIA,CAAAA,CAAI,MAAA,CAAO,OAAS,CAAA,CAAG,OAAO,EAAA,CAClC,IAAM9uB,EAAkB,EAAC,CAGnBhH,EAAK81B,CAAAA,CAAI,MAAA,CAAO,CAAC,CAAA,CACjB71B,CAAAA,CAAK61B,CAAAA,CAAI,MAAA,CAAO,CAAC,CAAA,CACvB9uB,CAAAA,CAAM,IAAA,CAAKmpC,EAAAA,CAAgBnwC,EAAIC,CAAAA,CAAI61B,CAAAA,CAAI,YAAY,CAAC,EAGpD,IAAMsa,CAAAA,CAAKta,EAAI,MAAA,CAAOA,CAAAA,CAAI,OAAO,MAAA,CAAS,CAAC,CAAA,CACrCua,CAAAA,CAAMva,EAAI,MAAA,CAAOA,CAAAA,CAAI,OAAO,MAAA,CAAS,CAAC,EAC5C,OAAA9uB,CAAAA,CAAM,IAAA,CAAKmpC,EAAAA,CAAgBC,EAAIC,CAAAA,CAAKva,CAAAA,CAAI,YAAY,CAAC,CAAA,CAE9C9uB,EAAM,IAAA,CAAK;AAAA,CAAI,CACxB,CAMA,SAASmpC,EAAAA,CACPz+B,CAAAA,CACA4+B,EACAC,CAAAA,CACQ,CACR,IAAMvpC,CAAAA,CAAkB,EAAC,CACnBs/B,EAAK5H,EAAAA,CAAc,SAAA,CAAY,GAAA,CAG/Bl+B,CAAAA,CAAKkR,CAAAA,CAAM,CAAA,CAAI4+B,CAAAA,CAAO,CAAA,CACtB7vC,CAAAA,CAAKiR,CAAAA,CAAM,CAAA,CAAI4+B,CAAAA,CAAO,CAAA,CACtBE,CAAAA,CAAM,KAAK,IAAA,CAAKhwC,CAAAA,CAAKA,CAAAA,CAAKC,CAAAA,CAAKA,CAAE,CAAA,CACvC,GAAI+vC,CAAAA,GAAQ,CAAA,CAAG,OAAO,EAAA,CACtB,IAAMC,CAAAA,CAAKjwC,CAAAA,CAAKgwC,EACVE,CAAAA,CAAKjwC,CAAAA,CAAK+vC,CAAAA,CAGVG,CAAAA,CAAK,CAACD,CAAAA,CACNE,CAAAA,CAAKH,CAAAA,CAGLI,CAAAA,CAAOn/B,CAAAA,CAAM,CAAA,CAAI++B,CAAAA,CAAK,CAAA,CACtBK,CAAAA,CAAOp/B,EAAM,CAAA,CAAIg/B,CAAAA,CAAK,CAAA,CACtBK,CAAAA,CAAQr/B,CAAAA,CAAM,CAAA,CAAI++B,EAAK,EAAA,CACvBO,CAAAA,CAAQt/B,CAAAA,CAAM,CAAA,CAAIg/B,CAAAA,CAAK,EAAA,CAGvBO,EAAaV,CAAAA,GAAgB,KAAA,EAASA,CAAAA,GAAgB,UAAA,CACtDW,CAAAA,CAAeX,CAAAA,GAAgB,MAAA,EAAUA,CAAAA,GAAgB,WAAA,CACzDY,CAAAA,CAAYZ,CAAAA,GAAgB,UAAA,EAAcA,CAAAA,GAAgB,WAAA,CAGhE,GAAIU,CAAAA,CAAY,CAEdjqC,CAAAA,CAAM,IAAA,CACJ,CAAA,UAAA,EAAa6pC,CAAAA,CAAOF,CAAAA,CAAK,CAAK,CAAA,MAAA,EAASG,CAAAA,CAAOF,CAAAA,CAAK,CAAK,CAAA,MAAA,EACjDC,CAAAA,CAAOF,EAAK,CAAK,CAAA,MAAA,EAASG,CAAAA,CAAOF,CAAAA,CAAK,CAAK,CAAA,sCAAA,EACXtK,CAAE,CAAA,IAAA,CAC3C,CAAA,CAEA,IAAM8K,CAAAA,CAASP,CAAAA,CAAOJ,CAAAA,CAAK,CAAA,CACrBY,EAASP,CAAAA,CAAOJ,CAAAA,CAAK,CAAA,CAC3B1pC,CAAAA,CAAM,IAAA,CACJ,CAAA,UAAA,EAAaoqC,EAAST,CAAAA,CAAK,CAAK,CAAA,MAAA,EAASU,CAAAA,CAAST,CAAAA,CAAK,CAAK,SACrDQ,CAAAA,CAAST,CAAAA,CAAK,CAAK,CAAA,MAAA,EAASU,CAAAA,CAAST,CAAAA,CAAK,CAAK,CAAA,sCAAA,EACftK,CAAE,CAAA,IAAA,CAC3C,EACF,CAGA,GAAI4K,CAAAA,CAAc,CAGhB,IAAMI,CAAAA,CAAST,CAAAA,CACTU,CAAAA,CAAST,CAAAA,CAEf9pC,CAAAA,CAAM,IAAA,CAEJ,CAAA,UAAA,EAAasqC,CAAAA,CAASX,CAAAA,CAAK,CAAI,CAAA,MAAA,EAASY,CAAAA,CAASX,CAAAA,CAAK,CAAI,CAAA,MAAA,EACnDG,CAAK,CAAA,MAAA,EAASC,CAAK,CAAA,sCAAA,EACa1K,CAAE,CAAA,IAAA,CAC3C,CAAA,CACAt/B,CAAAA,CAAM,IAAA,CAEJ,CAAA,UAAA,EAAasqC,CAAM,CAAA,MAAA,EAASC,CAAM,SAC3BR,CAAK,CAAA,MAAA,EAASC,CAAK,CAAA,sCAAA,EACa1K,CAAE,CAAA,IAAA,CAC3C,CAAA,CACAt/B,CAAAA,CAAM,IAAA,CAEJ,CAAA,UAAA,EAAasqC,CAAAA,CAASX,CAAAA,CAAK,CAAI,CAAA,MAAA,EAASY,EAASX,CAAAA,CAAK,CAAI,CAAA,MAAA,EACnDG,CAAK,CAAA,MAAA,EAASC,CAAK,CAAA,sCAAA,EACa1K,CAAE,CAAA,IAAA,CAC3C,EACF,CAGA,GAAI6K,CAAAA,CAAW,CACb,IAAMK,CAAAA,CAAeN,CAAAA,CAAe,EAAA,CAAK,EAAA,CACnCO,CAAAA,CAAU//B,CAAAA,CAAM,CAAA,CAAI++B,CAAAA,CAAKe,CAAAA,CACzBE,CAAAA,CAAUhgC,CAAAA,CAAM,CAAA,CAAIg/B,CAAAA,CAAKc,CAAAA,CAC/BxqC,EAAM,IAAA,CACJ,CAAA,YAAA,EAAeyqC,CAAO,CAAA,MAAA,EAASC,CAAO,CAAA,6DAAA,EACkBpL,CAAE,CAAA,IAAA,CAC5D,EACF,CAEA,OAAOt/B,CAAAA,CAAM,IAAA,CAAK;AAAA,CAAI,CACxB,CAMA,SAAS2nC,EAAAA,CAAStP,EAAmE,CACnF,GAAIA,EAAO,MAAA,GAAW,CAAA,CAAG,OAAO,CAAE,CAAA,CAAG,EAAG,CAAA,CAAG,CAAE,EAC7C,GAAIA,CAAAA,CAAO,SAAW,CAAA,CAAG,OAAOA,EAAO,CAAC,CAAA,CAGxC,IAAIsS,CAAAA,CAAW,CAAA,CACf,QAAS,CAAA,CAAI,CAAA,CAAG,EAAItS,CAAAA,CAAO,MAAA,CAAQ,IAAK,CACtC,IAAM7+B,EAAK6+B,CAAAA,CAAO,CAAC,EAAG,CAAA,CAAIA,CAAAA,CAAO,CAAA,CAAI,CAAC,CAAA,CAAG,CAAA,CACnC5+B,EAAK4+B,CAAAA,CAAO,CAAC,EAAG,CAAA,CAAIA,CAAAA,CAAO,EAAI,CAAC,CAAA,CAAG,EACzCsS,CAAAA,EAAY,IAAA,CAAK,KAAKnxC,CAAAA,CAAKA,CAAAA,CAAKC,EAAKA,CAAE,EACzC,CAEA,GAAIkxC,CAAAA,GAAa,CAAA,CAAG,OAAOtS,CAAAA,CAAO,CAAC,EAGnC,IAAMuS,CAAAA,CAAUD,EAAW,CAAA,CACvBE,CAAAA,CAAS,EACb,IAAA,IAAS,CAAA,CAAI,EAAG,CAAA,CAAIxS,CAAAA,CAAO,OAAQ,CAAA,EAAA,CAAK,CACtC,IAAM7+B,CAAAA,CAAK6+B,CAAAA,CAAO,CAAC,CAAA,CAAG,CAAA,CAAIA,CAAAA,CAAO,CAAA,CAAI,CAAC,CAAA,CAAG,EACnC5+B,CAAAA,CAAK4+B,CAAAA,CAAO,CAAC,CAAA,CAAG,CAAA,CAAIA,EAAO,CAAA,CAAI,CAAC,EAAG,CAAA,CACnC6G,CAAAA,CAAS,KAAK,IAAA,CAAK1lC,CAAAA,CAAKA,EAAKC,CAAAA,CAAKA,CAAE,EAC1C,GAAIoxC,CAAAA,CAAS3L,CAAAA,EAAU0L,CAAAA,CAAS,CAC9B,IAAMp6C,EAAI0uC,CAAAA,CAAS,CAAA,CAAA,CAAK0L,EAAUC,CAAAA,EAAU3L,CAAAA,CAAS,EACrD,OAAO,CACL,EAAG7G,CAAAA,CAAO,CAAA,CAAI,CAAC,CAAA,CAAG,CAAA,CAAI7+B,EAAKhJ,CAAAA,CAC3B,CAAA,CAAG6nC,EAAO,CAAA,CAAI,CAAC,CAAA,CAAG,CAAA,CAAI5+B,CAAAA,CAAKjJ,CAC7B,CACF,CACAq6C,CAAAA,EAAU3L,EACZ,CAEA,OAAO7G,EAAOA,CAAAA,CAAO,MAAA,CAAS,CAAC,CACjC,CAMA,SAASkG,EAAAA,CAAUzrB,CAAAA,CAAsB,CACvC,OAAOA,CAAAA,CACJ,QAAQ,IAAA,CAAM,OAAO,CAAA,CACrB,OAAA,CAAQ,IAAA,CAAM,MAAM,EACpB,OAAA,CAAQ,IAAA,CAAM,MAAM,CAAA,CACpB,OAAA,CAAQ,KAAM,QAAQ,CAAA,CACtB,QAAQ,IAAA,CAAM,OAAO,CAC1B,CChUA,SAAS+jB,GAAkB/jB,CAAAA,CAAyD,CAClF,IAAM0P,CAAAA,CAAY1P,CAAAA,CAAK,IAAA,EAAK,CAAE,KAAA,CAAM;AAAA,CAAI,EAAE,CAAC,CAAA,EAAG,MAAK,CAAE,WAAA,IAAiB,EAAA,CAEtE,OAAI,sBAAA,CAAuB,IAAA,CAAK0P,CAAS,CAAA,CAAU,UAAA,CAC/C,oBAAoB,IAAA,CAAKA,CAAS,EAAU,OAAA,CAC5C,gBAAA,CAAiB,IAAA,CAAKA,CAAS,EAAU,IAAA,CAGtC,WACT,CAOA,SAASsoB,EAAAA,CAAY/T,EAAuC,CAC1D,OAAO,CACL,EAAA,CAAIA,EAAQ,EAAA,EAAMnlB,EAAAA,CAAS,GAC3B,EAAA,CAAImlB,CAAAA,CAAQ,IAAMnlB,EAAAA,CAAS,EAAA,CAC3B,IAAA,CAAMmlB,CAAAA,CAAQ,KACd,MAAA,CAAQA,CAAAA,CAAQ,OAChB,KAAA,CAAOA,CAAAA,CAAQ,MACf,OAAA,CAASA,CAAAA,CAAQ,OAAA,CACjB,MAAA,CAAQA,EAAQ,MAClB,CACF,CAkCA,eAAsBgU,EAAAA,CACpBj4B,EACAikB,CAAAA,CAAyB,EAAC,CACT,CACjB,IAAMrkB,CAAAA,CAASo4B,EAAAA,CAAY/T,CAAO,CAAA,CAC5B1kB,CAAAA,CAAO0kB,EAAQ,IAAA,EAAQ,OAAA,CACvBpkB,EAAcokB,CAAAA,CAAQ,WAAA,EAAe,MACrCiU,CAAAA,CAAcnU,EAAAA,CAAkB/jB,CAAI,CAAA,CAGpCC,CAAAA,CAAQD,EAAK,KAAA,CAAM;AAAA,CAAI,CAAA,CAAE,GAAA,CAAI3Z,CAAAA,EAAKA,CAAAA,CAAE,IAAA,EAAM,CAAA,CAAE,MAAA,CAAOA,CAAAA,EAAKA,CAAAA,CAAE,MAAA,CAAS,CAAA,EAAK,CAACA,CAAAA,CAAE,UAAA,CAAW,IAAI,CAAC,CAAA,CAEjG,OAAQ6xC,CAAAA,EACN,KAAK,UAAA,CAAY,CACf,IAAMtjB,CAAAA,CAAUD,EAAAA,CAAqB1U,CAAK,CAAA,CACpCk4B,CAAAA,CAAarK,EAAAA,CAAsBlZ,CAAAA,CAASqP,CAAO,CAAA,CACzD,OAAOwN,EAAAA,CAAkB0G,CAAAA,CAAYv4B,CAAAA,CAAQL,CAAAA,CAAMM,CAAW,CAChE,CACA,KAAK,OAAA,CAAS,CACZ,IAAM+U,CAAAA,CAAUoG,EAAAA,CAAkB/a,CAAK,CAAA,CACjCk4B,CAAAA,CAAa,MAAMxF,EAAAA,CAAmB/d,CAAAA,CAASqP,CAAO,CAAA,CAC5D,OAAO2P,EAAAA,CAAeuE,CAAAA,CAAYv4B,CAAAA,CAAQL,CAAAA,CAAMM,CAAW,CAC7D,CACA,KAAK,IAAA,CAAM,CACT,IAAM+U,CAAAA,CAAUyL,EAAAA,CAAepgB,CAAK,CAAA,CAC9Bk4B,CAAAA,CAAa,MAAMnD,EAAAA,CAAgBpgB,CAAAA,CAASqP,CAAO,CAAA,CACzD,OAAOqR,EAAAA,CAAY6C,CAAAA,CAAYv4B,CAAAA,CAAQL,CAAAA,CAAMM,CAAW,CAC1D,CAEA,QAAS,CAEP,IAAM5a,CAAAA,CAAQ8a,EAAAA,CAAaC,CAAI,CAAA,CACzBm4B,CAAAA,CAAa,MAAM70C,EAAAA,CAAY2B,CAAAA,CAAOg/B,CAAO,CAAA,CACnD,OAAOiH,EAAAA,CAAUiN,CAAAA,CAAYv4B,CAAAA,CAAQL,CAAAA,CAAMM,CAAW,CACxD,CACF,CACF,CCtHI,OAAO,MAAA,CAAW,GAAA,GAClB,MAAA,CAA8C,SAAA,CAAY,CAC1D,aAAA,CAAAo4B,EAAAA,CACA,kBAAA,CAAAjU,EAAAA,CACA,MAAA,CAAAhlB,EAAAA,CACA,QAAA,CAAAF,EAAAA,CACA,cAAA,CAAAG,EACF,CAAA,CAAA","file":"beautiful-mermaid.browser.global.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.dagre = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n/*\nCopyright (c) 2012-2014 Chris Pettitt\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n*/\n\nmodule.exports = {\n  graphlib: require(\"@dagrejs/graphlib\"),\n\n  layout: require(\"./lib/layout\"),\n  debug: require(\"./lib/debug\"),\n  util: {\n    time: require(\"./lib/util\").time,\n    notime: require(\"./lib/util\").notime\n  },\n  version: require(\"./lib/version\")\n};\n\n},{\"./lib/debug\":6,\"./lib/layout\":8,\"./lib/util\":27,\"./lib/version\":28,\"@dagrejs/graphlib\":29}],2:[function(require,module,exports){\n\"use strict\";\n\nlet greedyFAS = require(\"./greedy-fas\");\nlet uniqueId = require(\"./util\").uniqueId;\n\nmodule.exports = {\n  run: run,\n  undo: undo\n};\n\nfunction run(g) {\n  let fas = (g.graph().acyclicer === \"greedy\"\n    ? greedyFAS(g, weightFn(g))\n    : dfsFAS(g));\n  fas.forEach(e => {\n    let label = g.edge(e);\n    g.removeEdge(e);\n    label.forwardName = e.name;\n    label.reversed = true;\n    g.setEdge(e.w, e.v, label, uniqueId(\"rev\"));\n  });\n\n  function weightFn(g) {\n    return e => {\n      return g.edge(e).weight;\n    };\n  }\n}\n\nfunction dfsFAS(g) {\n  let fas = [];\n  let stack = {};\n  let visited = {};\n\n  function dfs(v) {\n    if (Object.hasOwn(visited, v)) {\n      return;\n    }\n    visited[v] = true;\n    stack[v] = true;\n    g.outEdges(v).forEach(e => {\n      if (Object.hasOwn(stack, e.w)) {\n        fas.push(e);\n      } else {\n        dfs(e.w);\n      }\n    });\n    delete stack[v];\n  }\n\n  g.nodes().forEach(dfs);\n  return fas;\n}\n\nfunction undo(g) {\n  g.edges().forEach(e => {\n    let label = g.edge(e);\n    if (label.reversed) {\n      g.removeEdge(e);\n\n      let forwardName = label.forwardName;\n      delete label.reversed;\n      delete label.forwardName;\n      g.setEdge(e.w, e.v, label, forwardName);\n    }\n  });\n}\n\n},{\"./greedy-fas\":7,\"./util\":27}],3:[function(require,module,exports){\nlet util = require(\"./util\");\n\nmodule.exports = addBorderSegments;\n\nfunction addBorderSegments(g) {\n  function dfs(v) {\n    let children = g.children(v);\n    let node = g.node(v);\n    if (children.length) {\n      children.forEach(dfs);\n    }\n\n    if (Object.hasOwn(node, \"minRank\")) {\n      node.borderLeft = [];\n      node.borderRight = [];\n      for (let rank = node.minRank, maxRank = node.maxRank + 1;\n        rank < maxRank;\n        ++rank) {\n        addBorderNode(g, \"borderLeft\", \"_bl\", v, node, rank);\n        addBorderNode(g, \"borderRight\", \"_br\", v, node, rank);\n      }\n    }\n  }\n\n  g.children().forEach(dfs);\n}\n\nfunction addBorderNode(g, prop, prefix, sg, sgNode, rank) {\n  let label = { width: 0, height: 0, rank: rank, borderType: prop };\n  let prev = sgNode[prop][rank - 1];\n  let curr = util.addDummyNode(g, \"border\", label, prefix);\n  sgNode[prop][rank] = curr;\n  g.setParent(curr, sg);\n  if (prev) {\n    g.setEdge(prev, curr, { weight: 1 });\n  }\n}\n\n},{\"./util\":27}],4:[function(require,module,exports){\n\"use strict\";\n\nmodule.exports = {\n  adjust: adjust,\n  undo: undo\n};\n\nfunction adjust(g) {\n  let rankDir = g.graph().rankdir.toLowerCase();\n  if (rankDir === \"lr\" || rankDir === \"rl\") {\n    swapWidthHeight(g);\n  }\n}\n\nfunction undo(g) {\n  let rankDir = g.graph().rankdir.toLowerCase();\n  if (rankDir === \"bt\" || rankDir === \"rl\") {\n    reverseY(g);\n  }\n\n  if (rankDir === \"lr\" || rankDir === \"rl\") {\n    swapXY(g);\n    swapWidthHeight(g);\n  }\n}\n\nfunction swapWidthHeight(g) {\n  g.nodes().forEach(v => swapWidthHeightOne(g.node(v)));\n  g.edges().forEach(e => swapWidthHeightOne(g.edge(e)));\n}\n\nfunction swapWidthHeightOne(attrs) {\n  let w = attrs.width;\n  attrs.width = attrs.height;\n  attrs.height = w;\n}\n\nfunction reverseY(g) {\n  g.nodes().forEach(v => reverseYOne(g.node(v)));\n\n  g.edges().forEach(e => {\n    let edge = g.edge(e);\n    edge.points.forEach(reverseYOne);\n    if (Object.hasOwn(edge, \"y\")) {\n      reverseYOne(edge);\n    }\n  });\n}\n\nfunction reverseYOne(attrs) {\n  attrs.y = -attrs.y;\n}\n\nfunction swapXY(g) {\n  g.nodes().forEach(v => swapXYOne(g.node(v)));\n\n  g.edges().forEach(e => {\n    let edge = g.edge(e);\n    edge.points.forEach(swapXYOne);\n    if (Object.hasOwn(edge, \"x\")) {\n      swapXYOne(edge);\n    }\n  });\n}\n\nfunction swapXYOne(attrs) {\n  let x = attrs.x;\n  attrs.x = attrs.y;\n  attrs.y = x;\n}\n\n},{}],5:[function(require,module,exports){\n/*\n * Simple doubly linked list implementation derived from Cormen, et al.,\n * \"Introduction to Algorithms\".\n */\n\nclass List {\n  constructor() {\n    let sentinel = {};\n    sentinel._next = sentinel._prev = sentinel;\n    this._sentinel = sentinel;\n  }\n\n  dequeue() {\n    let sentinel = this._sentinel;\n    let entry = sentinel._prev;\n    if (entry !== sentinel) {\n      unlink(entry);\n      return entry;\n    }\n  }\n\n  enqueue(entry) {\n    let sentinel = this._sentinel;\n    if (entry._prev && entry._next) {\n      unlink(entry);\n    }\n    entry._next = sentinel._next;\n    sentinel._next._prev = entry;\n    sentinel._next = entry;\n    entry._prev = sentinel;\n  }\n\n  toString() {\n    let strs = [];\n    let sentinel = this._sentinel;\n    let curr = sentinel._prev;\n    while (curr !== sentinel) {\n      strs.push(JSON.stringify(curr, filterOutLinks));\n      curr = curr._prev;\n    }\n    return \"[\" + strs.join(\", \") + \"]\";\n  }\n}\n\nfunction unlink(entry) {\n  entry._prev._next = entry._next;\n  entry._next._prev = entry._prev;\n  delete entry._next;\n  delete entry._prev;\n}\n\nfunction filterOutLinks(k, v) {\n  if (k !== \"_next\" && k !== \"_prev\") {\n    return v;\n  }\n}\n\nmodule.exports = List;\n\n},{}],6:[function(require,module,exports){\nlet util = require(\"./util\");\nlet Graph = require(\"@dagrejs/graphlib\").Graph;\n\nmodule.exports = {\n  debugOrdering: debugOrdering\n};\n\n/* istanbul ignore next */\nfunction debugOrdering(g) {\n  let layerMatrix = util.buildLayerMatrix(g);\n\n  let h = new Graph({ compound: true, multigraph: true }).setGraph({});\n\n  g.nodes().forEach(v => {\n    h.setNode(v, { label: v });\n    h.setParent(v, \"layer\" + g.node(v).rank);\n  });\n\n  g.edges().forEach(e => h.setEdge(e.v, e.w, {}, e.name));\n\n  layerMatrix.forEach((layer, i) => {\n    let layerV = \"layer\" + i;\n    h.setNode(layerV, { rank: \"same\" });\n    layer.reduce((u, v) => {\n      h.setEdge(u, v, { style: \"invis\" });\n      return v;\n    });\n  });\n\n  return h;\n}\n\n},{\"./util\":27,\"@dagrejs/graphlib\":29}],7:[function(require,module,exports){\nlet Graph = require(\"@dagrejs/graphlib\").Graph;\nlet List = require(\"./data/list\");\n\n/*\n * A greedy heuristic for finding a feedback arc set for a graph. A feedback\n * arc set is a set of edges that can be removed to make a graph acyclic.\n * The algorithm comes from: P. Eades, X. Lin, and W. F. Smyth, \"A fast and\n * effective heuristic for the feedback arc set problem.\" This implementation\n * adjusts that from the paper to allow for weighted edges.\n */\nmodule.exports = greedyFAS;\n\nlet DEFAULT_WEIGHT_FN = () => 1;\n\nfunction greedyFAS(g, weightFn) {\n  if (g.nodeCount() <= 1) {\n    return [];\n  }\n  let state = buildState(g, weightFn || DEFAULT_WEIGHT_FN);\n  let results = doGreedyFAS(state.graph, state.buckets, state.zeroIdx);\n\n  // Expand multi-edges\n  return results.flatMap(e => g.outEdges(e.v, e.w));\n}\n\nfunction doGreedyFAS(g, buckets, zeroIdx) {\n  let results = [];\n  let sources = buckets[buckets.length - 1];\n  let sinks = buckets[0];\n\n  let entry;\n  while (g.nodeCount()) {\n    while ((entry = sinks.dequeue()))   { removeNode(g, buckets, zeroIdx, entry); }\n    while ((entry = sources.dequeue())) { removeNode(g, buckets, zeroIdx, entry); }\n    if (g.nodeCount()) {\n      for (let i = buckets.length - 2; i > 0; --i) {\n        entry = buckets[i].dequeue();\n        if (entry) {\n          results = results.concat(removeNode(g, buckets, zeroIdx, entry, true));\n          break;\n        }\n      }\n    }\n  }\n\n  return results;\n}\n\nfunction removeNode(g, buckets, zeroIdx, entry, collectPredecessors) {\n  let results = collectPredecessors ? [] : undefined;\n\n  g.inEdges(entry.v).forEach(edge => {\n    let weight = g.edge(edge);\n    let uEntry = g.node(edge.v);\n\n    if (collectPredecessors) {\n      results.push({ v: edge.v, w: edge.w });\n    }\n\n    uEntry.out -= weight;\n    assignBucket(buckets, zeroIdx, uEntry);\n  });\n\n  g.outEdges(entry.v).forEach(edge => {\n    let weight = g.edge(edge);\n    let w = edge.w;\n    let wEntry = g.node(w);\n    wEntry[\"in\"] -= weight;\n    assignBucket(buckets, zeroIdx, wEntry);\n  });\n\n  g.removeNode(entry.v);\n\n  return results;\n}\n\nfunction buildState(g, weightFn) {\n  let fasGraph = new Graph();\n  let maxIn = 0;\n  let maxOut = 0;\n\n  g.nodes().forEach(v => {\n    fasGraph.setNode(v, { v: v, \"in\": 0, out: 0 });\n  });\n\n  // Aggregate weights on nodes, but also sum the weights across multi-edges\n  // into a single edge for the fasGraph.\n  g.edges().forEach(e => {\n    let prevWeight = fasGraph.edge(e.v, e.w) || 0;\n    let weight = weightFn(e);\n    let edgeWeight = prevWeight + weight;\n    fasGraph.setEdge(e.v, e.w, edgeWeight);\n    maxOut = Math.max(maxOut, fasGraph.node(e.v).out += weight);\n    maxIn  = Math.max(maxIn,  fasGraph.node(e.w)[\"in\"]  += weight);\n  });\n\n  let buckets = range(maxOut + maxIn + 3).map(() => new List());\n  let zeroIdx = maxIn + 1;\n\n  fasGraph.nodes().forEach(v => {\n    assignBucket(buckets, zeroIdx, fasGraph.node(v));\n  });\n\n  return { graph: fasGraph, buckets: buckets, zeroIdx: zeroIdx };\n}\n\nfunction assignBucket(buckets, zeroIdx, entry) {\n  if (!entry.out) {\n    buckets[0].enqueue(entry);\n  } else if (!entry[\"in\"]) {\n    buckets[buckets.length - 1].enqueue(entry);\n  } else {\n    buckets[entry.out - entry[\"in\"] + zeroIdx].enqueue(entry);\n  }\n}\n\nfunction range(limit) {\n  const range = [];\n  for (let i = 0; i < limit; i++) {\n    range.push(i);\n  }\n\n  return range;\n}\n\n},{\"./data/list\":5,\"@dagrejs/graphlib\":29}],8:[function(require,module,exports){\n\"use strict\";\n\nlet acyclic = require(\"./acyclic\");\nlet normalize = require(\"./normalize\");\nlet rank = require(\"./rank\");\nlet normalizeRanks = require(\"./util\").normalizeRanks;\nlet parentDummyChains = require(\"./parent-dummy-chains\");\nlet removeEmptyRanks = require(\"./util\").removeEmptyRanks;\nlet nestingGraph = require(\"./nesting-graph\");\nlet addBorderSegments = require(\"./add-border-segments\");\nlet coordinateSystem = require(\"./coordinate-system\");\nlet order = require(\"./order\");\nlet position = require(\"./position\");\nlet util = require(\"./util\");\nlet Graph = require(\"@dagrejs/graphlib\").Graph;\n\nmodule.exports = layout;\n\nfunction layout(g, opts) {\n  let time = opts && opts.debugTiming ? util.time : util.notime;\n  time(\"layout\", () => {\n    let layoutGraph =\n      time(\"  buildLayoutGraph\", () => buildLayoutGraph(g));\n    time(\"  runLayout\",        () => runLayout(layoutGraph, time, opts));\n    time(\"  updateInputGraph\", () => updateInputGraph(g, layoutGraph));\n  });\n}\n\nfunction runLayout(g, time, opts) {\n  time(\"    makeSpaceForEdgeLabels\", () => makeSpaceForEdgeLabels(g));\n  time(\"    removeSelfEdges\",        () => removeSelfEdges(g));\n  time(\"    acyclic\",                () => acyclic.run(g));\n  time(\"    nestingGraph.run\",       () => nestingGraph.run(g));\n  time(\"    rank\",                   () => rank(util.asNonCompoundGraph(g)));\n  time(\"    injectEdgeLabelProxies\", () => injectEdgeLabelProxies(g));\n  time(\"    removeEmptyRanks\",       () => removeEmptyRanks(g));\n  time(\"    nestingGraph.cleanup\",   () => nestingGraph.cleanup(g));\n  time(\"    normalizeRanks\",         () => normalizeRanks(g));\n  time(\"    assignRankMinMax\",       () => assignRankMinMax(g));\n  time(\"    removeEdgeLabelProxies\", () => removeEdgeLabelProxies(g));\n  time(\"    normalize.run\",          () => normalize.run(g));\n  time(\"    parentDummyChains\",      () => parentDummyChains(g));\n  time(\"    addBorderSegments\",      () => addBorderSegments(g));\n  time(\"    order\",                  () => order(g, opts));\n  time(\"    insertSelfEdges\",        () => insertSelfEdges(g));\n  time(\"    adjustCoordinateSystem\", () => coordinateSystem.adjust(g));\n  time(\"    position\",               () => position(g));\n  time(\"    positionSelfEdges\",      () => positionSelfEdges(g));\n  time(\"    removeBorderNodes\",      () => removeBorderNodes(g));\n  time(\"    normalize.undo\",         () => normalize.undo(g));\n  time(\"    fixupEdgeLabelCoords\",   () => fixupEdgeLabelCoords(g));\n  time(\"    undoCoordinateSystem\",   () => coordinateSystem.undo(g));\n  time(\"    translateGraph\",         () => translateGraph(g));\n  time(\"    assignNodeIntersects\",   () => assignNodeIntersects(g));\n  time(\"    reversePoints\",          () => reversePointsForReversedEdges(g));\n  time(\"    acyclic.undo\",           () => acyclic.undo(g));\n}\n\n/*\n * Copies final layout information from the layout graph back to the input\n * graph. This process only copies whitelisted attributes from the layout graph\n * to the input graph, so it serves as a good place to determine what\n * attributes can influence layout.\n */\nfunction updateInputGraph(inputGraph, layoutGraph) {\n  inputGraph.nodes().forEach(v => {\n    let inputLabel = inputGraph.node(v);\n    let layoutLabel = layoutGraph.node(v);\n\n    if (inputLabel) {\n      inputLabel.x = layoutLabel.x;\n      inputLabel.y = layoutLabel.y;\n      inputLabel.rank = layoutLabel.rank;\n\n      if (layoutGraph.children(v).length) {\n        inputLabel.width = layoutLabel.width;\n        inputLabel.height = layoutLabel.height;\n      }\n    }\n  });\n\n  inputGraph.edges().forEach(e => {\n    let inputLabel = inputGraph.edge(e);\n    let layoutLabel = layoutGraph.edge(e);\n\n    inputLabel.points = layoutLabel.points;\n    if (Object.hasOwn(layoutLabel, \"x\")) {\n      inputLabel.x = layoutLabel.x;\n      inputLabel.y = layoutLabel.y;\n    }\n  });\n\n  inputGraph.graph().width = layoutGraph.graph().width;\n  inputGraph.graph().height = layoutGraph.graph().height;\n}\n\nlet graphNumAttrs = [\"nodesep\", \"edgesep\", \"ranksep\", \"marginx\", \"marginy\"];\nlet graphDefaults = { ranksep: 50, edgesep: 20, nodesep: 50, rankdir: \"tb\" };\nlet graphAttrs = [\"acyclicer\", \"ranker\", \"rankdir\", \"align\"];\nlet nodeNumAttrs = [\"width\", \"height\", \"rank\"];\nlet nodeDefaults = { width: 0, height: 0 };\nlet edgeNumAttrs = [\"minlen\", \"weight\", \"width\", \"height\", \"labeloffset\"];\nlet edgeDefaults = {\n  minlen: 1, weight: 1, width: 0, height: 0,\n  labeloffset: 10, labelpos: \"r\"\n};\nlet edgeAttrs = [\"labelpos\"];\n\n/*\n * Constructs a new graph from the input graph, which can be used for layout.\n * This process copies only whitelisted attributes from the input graph to the\n * layout graph. Thus this function serves as a good place to determine what\n * attributes can influence layout.\n */\nfunction buildLayoutGraph(inputGraph) {\n  let g = new Graph({ multigraph: true, compound: true });\n  let graph = canonicalize(inputGraph.graph());\n\n  g.setGraph(Object.assign({},\n    graphDefaults,\n    selectNumberAttrs(graph, graphNumAttrs),\n    util.pick(graph, graphAttrs)));\n\n  inputGraph.nodes().forEach(v => {\n    let node = canonicalize(inputGraph.node(v));\n    const newNode = selectNumberAttrs(node, nodeNumAttrs);\n    Object.keys(nodeDefaults).forEach(k => {\n      if (newNode[k] === undefined) {\n        newNode[k] = nodeDefaults[k];\n      }\n    });\n\n    g.setNode(v, newNode);\n    g.setParent(v, inputGraph.parent(v));\n  });\n\n  inputGraph.edges().forEach(e => {\n    let edge = canonicalize(inputGraph.edge(e));\n    g.setEdge(e, Object.assign({},\n      edgeDefaults,\n      selectNumberAttrs(edge, edgeNumAttrs),\n      util.pick(edge, edgeAttrs)));\n  });\n\n  return g;\n}\n\n/*\n * This idea comes from the Gansner paper: to account for edge labels in our\n * layout we split each rank in half by doubling minlen and halving ranksep.\n * Then we can place labels at these mid-points between nodes.\n *\n * We also add some minimal padding to the width to push the label for the edge\n * away from the edge itself a bit.\n */\nfunction makeSpaceForEdgeLabels(g) {\n  let graph = g.graph();\n  graph.ranksep /= 2;\n  g.edges().forEach(e => {\n    let edge = g.edge(e);\n    edge.minlen *= 2;\n    if (edge.labelpos.toLowerCase() !== \"c\") {\n      if (graph.rankdir === \"TB\" || graph.rankdir === \"BT\") {\n        edge.width += edge.labeloffset;\n      } else {\n        edge.height += edge.labeloffset;\n      }\n    }\n  });\n}\n\n/*\n * Creates temporary dummy nodes that capture the rank in which each edge's\n * label is going to, if it has one of non-zero width and height. We do this\n * so that we can safely remove empty ranks while preserving balance for the\n * label's position.\n */\nfunction injectEdgeLabelProxies(g) {\n  g.edges().forEach(e => {\n    let edge = g.edge(e);\n    if (edge.width && edge.height) {\n      let v = g.node(e.v);\n      let w = g.node(e.w);\n      let label = { rank: (w.rank - v.rank) / 2 + v.rank, e: e };\n      util.addDummyNode(g, \"edge-proxy\", label, \"_ep\");\n    }\n  });\n}\n\nfunction assignRankMinMax(g) {\n  let maxRank = 0;\n  g.nodes().forEach(v => {\n    let node = g.node(v);\n    if (node.borderTop) {\n      node.minRank = g.node(node.borderTop).rank;\n      node.maxRank = g.node(node.borderBottom).rank;\n      maxRank = Math.max(maxRank, node.maxRank);\n    }\n  });\n  g.graph().maxRank = maxRank;\n}\n\nfunction removeEdgeLabelProxies(g) {\n  g.nodes().forEach(v => {\n    let node = g.node(v);\n    if (node.dummy === \"edge-proxy\") {\n      g.edge(node.e).labelRank = node.rank;\n      g.removeNode(v);\n    }\n  });\n}\n\nfunction translateGraph(g) {\n  let minX = Number.POSITIVE_INFINITY;\n  let maxX = 0;\n  let minY = Number.POSITIVE_INFINITY;\n  let maxY = 0;\n  let graphLabel = g.graph();\n  let marginX = graphLabel.marginx || 0;\n  let marginY = graphLabel.marginy || 0;\n\n  function getExtremes(attrs) {\n    let x = attrs.x;\n    let y = attrs.y;\n    let w = attrs.width;\n    let h = attrs.height;\n    minX = Math.min(minX, x - w / 2);\n    maxX = Math.max(maxX, x + w / 2);\n    minY = Math.min(minY, y - h / 2);\n    maxY = Math.max(maxY, y + h / 2);\n  }\n\n  g.nodes().forEach(v => getExtremes(g.node(v)));\n  g.edges().forEach(e => {\n    let edge = g.edge(e);\n    if (Object.hasOwn(edge, \"x\")) {\n      getExtremes(edge);\n    }\n  });\n\n  minX -= marginX;\n  minY -= marginY;\n\n  g.nodes().forEach(v => {\n    let node = g.node(v);\n    node.x -= minX;\n    node.y -= minY;\n  });\n\n  g.edges().forEach(e => {\n    let edge = g.edge(e);\n    edge.points.forEach(p => {\n      p.x -= minX;\n      p.y -= minY;\n    });\n    if (Object.hasOwn(edge, \"x\")) { edge.x -= minX; }\n    if (Object.hasOwn(edge, \"y\")) { edge.y -= minY; }\n  });\n\n  graphLabel.width = maxX - minX + marginX;\n  graphLabel.height = maxY - minY + marginY;\n}\n\nfunction assignNodeIntersects(g) {\n  g.edges().forEach(e => {\n    let edge = g.edge(e);\n    let nodeV = g.node(e.v);\n    let nodeW = g.node(e.w);\n    let p1, p2;\n    if (!edge.points) {\n      edge.points = [];\n      p1 = nodeW;\n      p2 = nodeV;\n    } else {\n      p1 = edge.points[0];\n      p2 = edge.points[edge.points.length - 1];\n    }\n    edge.points.unshift(util.intersectRect(nodeV, p1));\n    edge.points.push(util.intersectRect(nodeW, p2));\n  });\n}\n\nfunction fixupEdgeLabelCoords(g) {\n  g.edges().forEach(e => {\n    let edge = g.edge(e);\n    if (Object.hasOwn(edge, \"x\")) {\n      if (edge.labelpos === \"l\" || edge.labelpos === \"r\") {\n        edge.width -= edge.labeloffset;\n      }\n      switch (edge.labelpos) {\n      case \"l\": edge.x -= edge.width / 2 + edge.labeloffset; break;\n      case \"r\": edge.x += edge.width / 2 + edge.labeloffset; break;\n      }\n    }\n  });\n}\n\nfunction reversePointsForReversedEdges(g) {\n  g.edges().forEach(e => {\n    let edge = g.edge(e);\n    if (edge.reversed) {\n      edge.points.reverse();\n    }\n  });\n}\n\nfunction removeBorderNodes(g) {\n  g.nodes().forEach(v => {\n    if (g.children(v).length) {\n      let node = g.node(v);\n      let t = g.node(node.borderTop);\n      let b = g.node(node.borderBottom);\n      let l = g.node(node.borderLeft[node.borderLeft.length - 1]);\n      let r = g.node(node.borderRight[node.borderRight.length - 1]);\n\n      node.width = Math.abs(r.x - l.x);\n      node.height = Math.abs(b.y - t.y);\n      node.x = l.x + node.width / 2;\n      node.y = t.y + node.height / 2;\n    }\n  });\n\n  g.nodes().forEach(v => {\n    if (g.node(v).dummy === \"border\") {\n      g.removeNode(v);\n    }\n  });\n}\n\nfunction removeSelfEdges(g) {\n  g.edges().forEach(e => {\n    if (e.v === e.w) {\n      var node = g.node(e.v);\n      if (!node.selfEdges) {\n        node.selfEdges = [];\n      }\n      node.selfEdges.push({ e: e, label: g.edge(e) });\n      g.removeEdge(e);\n    }\n  });\n}\n\nfunction insertSelfEdges(g) {\n  var layers = util.buildLayerMatrix(g);\n  layers.forEach(layer => {\n    var orderShift = 0;\n    layer.forEach((v, i) => {\n      var node = g.node(v);\n      node.order = i + orderShift;\n      (node.selfEdges || []).forEach(selfEdge => {\n        util.addDummyNode(g, \"selfedge\", {\n          width: selfEdge.label.width,\n          height: selfEdge.label.height,\n          rank: node.rank,\n          order: i + (++orderShift),\n          e: selfEdge.e,\n          label: selfEdge.label\n        }, \"_se\");\n      });\n      delete node.selfEdges;\n    });\n  });\n}\n\nfunction positionSelfEdges(g) {\n  g.nodes().forEach(v => {\n    var node = g.node(v);\n    if (node.dummy === \"selfedge\") {\n      var selfNode = g.node(node.e.v);\n      var x = selfNode.x + selfNode.width / 2;\n      var y = selfNode.y;\n      var dx = node.x - x;\n      var dy = selfNode.height / 2;\n      g.setEdge(node.e, node.label);\n      g.removeNode(v);\n      node.label.points = [\n        { x: x + 2 * dx / 3, y: y - dy },\n        { x: x + 5 * dx / 6, y: y - dy },\n        { x: x +     dx    , y: y },\n        { x: x + 5 * dx / 6, y: y + dy },\n        { x: x + 2 * dx / 3, y: y + dy }\n      ];\n      node.label.x = node.x;\n      node.label.y = node.y;\n    }\n  });\n}\n\nfunction selectNumberAttrs(obj, attrs) {\n  return util.mapValues(util.pick(obj, attrs), Number);\n}\n\nfunction canonicalize(attrs) {\n  var newAttrs = {};\n  if (attrs) {\n    Object.entries(attrs).forEach(([k, v]) => {\n      if (typeof k === \"string\") {\n        k = k.toLowerCase();\n      }\n\n      newAttrs[k] = v;\n    });\n  }\n  return newAttrs;\n}\n\n},{\"./acyclic\":2,\"./add-border-segments\":3,\"./coordinate-system\":4,\"./nesting-graph\":9,\"./normalize\":10,\"./order\":15,\"./parent-dummy-chains\":20,\"./position\":22,\"./rank\":24,\"./util\":27,\"@dagrejs/graphlib\":29}],9:[function(require,module,exports){\nlet util = require(\"./util\");\n\nmodule.exports = {\n  run,\n  cleanup,\n};\n\n/*\n * A nesting graph creates dummy nodes for the tops and bottoms of subgraphs,\n * adds appropriate edges to ensure that all cluster nodes are placed between\n * these boundaries, and ensures that the graph is connected.\n *\n * In addition we ensure, through the use of the minlen property, that nodes\n * and subgraph border nodes to not end up on the same rank.\n *\n * Preconditions:\n *\n *    1. Input graph is a DAG\n *    2. Nodes in the input graph has a minlen attribute\n *\n * Postconditions:\n *\n *    1. Input graph is connected.\n *    2. Dummy nodes are added for the tops and bottoms of subgraphs.\n *    3. The minlen attribute for nodes is adjusted to ensure nodes do not\n *       get placed on the same rank as subgraph border nodes.\n *\n * The nesting graph idea comes from Sander, \"Layout of Compound Directed\n * Graphs.\"\n */\nfunction run(g) {\n  let root = util.addDummyNode(g, \"root\", {}, \"_root\");\n  let depths = treeDepths(g);\n  let depthsArr = Object.values(depths);\n  let height = util.applyWithChunking(Math.max, depthsArr) - 1; // Note: depths is an Object not an array\n  let nodeSep = 2 * height + 1;\n\n  g.graph().nestingRoot = root;\n\n  // Multiply minlen by nodeSep to align nodes on non-border ranks.\n  g.edges().forEach(e => g.edge(e).minlen *= nodeSep);\n\n  // Calculate a weight that is sufficient to keep subgraphs vertically compact\n  let weight = sumWeights(g) + 1;\n\n  // Create border nodes and link them up\n  g.children().forEach(child => dfs(g, root, nodeSep, weight, height, depths, child));\n\n  // Save the multiplier for node layers for later removal of empty border\n  // layers.\n  g.graph().nodeRankFactor = nodeSep;\n}\n\nfunction dfs(g, root, nodeSep, weight, height, depths, v) {\n  let children = g.children(v);\n  if (!children.length) {\n    if (v !== root) {\n      g.setEdge(root, v, { weight: 0, minlen: nodeSep });\n    }\n    return;\n  }\n\n  let top = util.addBorderNode(g, \"_bt\");\n  let bottom = util.addBorderNode(g, \"_bb\");\n  let label = g.node(v);\n\n  g.setParent(top, v);\n  label.borderTop = top;\n  g.setParent(bottom, v);\n  label.borderBottom = bottom;\n\n  children.forEach(child => {\n    dfs(g, root, nodeSep, weight, height, depths, child);\n\n    let childNode = g.node(child);\n    let childTop = childNode.borderTop ? childNode.borderTop : child;\n    let childBottom = childNode.borderBottom ? childNode.borderBottom : child;\n    let thisWeight = childNode.borderTop ? weight : 2 * weight;\n    let minlen = childTop !== childBottom ? 1 : height - depths[v] + 1;\n\n    g.setEdge(top, childTop, {\n      weight: thisWeight,\n      minlen: minlen,\n      nestingEdge: true\n    });\n\n    g.setEdge(childBottom, bottom, {\n      weight: thisWeight,\n      minlen: minlen,\n      nestingEdge: true\n    });\n  });\n\n  if (!g.parent(v)) {\n    g.setEdge(root, top, { weight: 0, minlen: height + depths[v] });\n  }\n}\n\nfunction treeDepths(g) {\n  var depths = {};\n  function dfs(v, depth) {\n    var children = g.children(v);\n    if (children && children.length) {\n      children.forEach(child => dfs(child, depth + 1));\n    }\n    depths[v] = depth;\n  }\n  g.children().forEach(v => dfs(v, 1));\n  return depths;\n}\n\nfunction sumWeights(g) {\n  return g.edges().reduce((acc, e) => acc + g.edge(e).weight, 0);\n}\n\nfunction cleanup(g) {\n  var graphLabel = g.graph();\n  g.removeNode(graphLabel.nestingRoot);\n  delete graphLabel.nestingRoot;\n  g.edges().forEach(e => {\n    var edge = g.edge(e);\n    if (edge.nestingEdge) {\n      g.removeEdge(e);\n    }\n  });\n}\n\n},{\"./util\":27}],10:[function(require,module,exports){\n\"use strict\";\n\nlet util = require(\"./util\");\n\nmodule.exports = {\n  run: run,\n  undo: undo\n};\n\n/*\n * Breaks any long edges in the graph into short segments that span 1 layer\n * each. This operation is undoable with the denormalize function.\n *\n * Pre-conditions:\n *\n *    1. The input graph is a DAG.\n *    2. Each node in the graph has a \"rank\" property.\n *\n * Post-condition:\n *\n *    1. All edges in the graph have a length of 1.\n *    2. Dummy nodes are added where edges have been split into segments.\n *    3. The graph is augmented with a \"dummyChains\" attribute which contains\n *       the first dummy in each chain of dummy nodes produced.\n */\nfunction run(g) {\n  g.graph().dummyChains = [];\n  g.edges().forEach(edge => normalizeEdge(g, edge));\n}\n\nfunction normalizeEdge(g, e) {\n  let v = e.v;\n  let vRank = g.node(v).rank;\n  let w = e.w;\n  let wRank = g.node(w).rank;\n  let name = e.name;\n  let edgeLabel = g.edge(e);\n  let labelRank = edgeLabel.labelRank;\n\n  if (wRank === vRank + 1) return;\n\n  g.removeEdge(e);\n\n  let dummy, attrs, i;\n  for (i = 0, ++vRank; vRank < wRank; ++i, ++vRank) {\n    edgeLabel.points = [];\n    attrs = {\n      width: 0, height: 0,\n      edgeLabel: edgeLabel, edgeObj: e,\n      rank: vRank\n    };\n    dummy = util.addDummyNode(g, \"edge\", attrs, \"_d\");\n    if (vRank === labelRank) {\n      attrs.width = edgeLabel.width;\n      attrs.height = edgeLabel.height;\n      attrs.dummy = \"edge-label\";\n      attrs.labelpos = edgeLabel.labelpos;\n    }\n    g.setEdge(v, dummy, { weight: edgeLabel.weight }, name);\n    if (i === 0) {\n      g.graph().dummyChains.push(dummy);\n    }\n    v = dummy;\n  }\n\n  g.setEdge(v, w, { weight: edgeLabel.weight }, name);\n}\n\nfunction undo(g) {\n  g.graph().dummyChains.forEach(v => {\n    let node = g.node(v);\n    let origLabel = node.edgeLabel;\n    let w;\n    g.setEdge(node.edgeObj, origLabel);\n    while (node.dummy) {\n      w = g.successors(v)[0];\n      g.removeNode(v);\n      origLabel.points.push({ x: node.x, y: node.y });\n      if (node.dummy === \"edge-label\") {\n        origLabel.x = node.x;\n        origLabel.y = node.y;\n        origLabel.width = node.width;\n        origLabel.height = node.height;\n      }\n      v = w;\n      node = g.node(v);\n    }\n  });\n}\n\n},{\"./util\":27}],11:[function(require,module,exports){\nmodule.exports = addSubgraphConstraints;\n\nfunction addSubgraphConstraints(g, cg, vs) {\n  let prev = {},\n    rootPrev;\n\n  vs.forEach(v => {\n    let child = g.parent(v),\n      parent,\n      prevChild;\n    while (child) {\n      parent = g.parent(child);\n      if (parent) {\n        prevChild = prev[parent];\n        prev[parent] = child;\n      } else {\n        prevChild = rootPrev;\n        rootPrev = child;\n      }\n      if (prevChild && prevChild !== child) {\n        cg.setEdge(prevChild, child);\n        return;\n      }\n      child = parent;\n    }\n  });\n\n  /*\n  function dfs(v) {\n    var children = v ? g.children(v) : g.children();\n    if (children.length) {\n      var min = Number.POSITIVE_INFINITY,\n          subgraphs = [];\n      children.forEach(function(child) {\n        var childMin = dfs(child);\n        if (g.children(child).length) {\n          subgraphs.push({ v: child, order: childMin });\n        }\n        min = Math.min(min, childMin);\n      });\n      _.sortBy(subgraphs, \"order\").reduce(function(prev, curr) {\n        cg.setEdge(prev.v, curr.v);\n        return curr;\n      });\n      return min;\n    }\n    return g.node(v).order;\n  }\n  dfs(undefined);\n  */\n}\n\n},{}],12:[function(require,module,exports){\nmodule.exports = barycenter;\n\nfunction barycenter(g, movable = []) {\n  return movable.map(v => {\n    let inV = g.inEdges(v);\n    if (!inV.length) {\n      return { v: v };\n    } else {\n      let result = inV.reduce((acc, e) => {\n        let edge = g.edge(e),\n          nodeU = g.node(e.v);\n        return {\n          sum: acc.sum + (edge.weight * nodeU.order),\n          weight: acc.weight + edge.weight\n        };\n      }, { sum: 0, weight: 0 });\n\n      return {\n        v: v,\n        barycenter: result.sum / result.weight,\n        weight: result.weight\n      };\n    }\n  });\n}\n\n\n},{}],13:[function(require,module,exports){\nlet Graph = require(\"@dagrejs/graphlib\").Graph;\nlet util = require(\"../util\");\n\nmodule.exports = buildLayerGraph;\n\n/*\n * Constructs a graph that can be used to sort a layer of nodes. The graph will\n * contain all base and subgraph nodes from the request layer in their original\n * hierarchy and any edges that are incident on these nodes and are of the type\n * requested by the \"relationship\" parameter.\n *\n * Nodes from the requested rank that do not have parents are assigned a root\n * node in the output graph, which is set in the root graph attribute. This\n * makes it easy to walk the hierarchy of movable nodes during ordering.\n *\n * Pre-conditions:\n *\n *    1. Input graph is a DAG\n *    2. Base nodes in the input graph have a rank attribute\n *    3. Subgraph nodes in the input graph has minRank and maxRank attributes\n *    4. Edges have an assigned weight\n *    5. If `nodesWithRank` is not undefined, it must contains only the nodes\n *       which belong to `g` and belong to `rank`.\n *\n * Post-conditions:\n *\n *    1. Output graph has all nodes in the movable rank with preserved\n *       hierarchy.\n *    2. Root nodes in the movable layer are made children of the node\n *       indicated by the root attribute of the graph.\n *    3. Non-movable nodes incident on movable nodes, selected by the\n *       relationship parameter, are included in the graph (without hierarchy).\n *    4. Edges incident on movable nodes, selected by the relationship\n *       parameter, are added to the output graph.\n *    5. The weights for copied edges are aggregated as need, since the output\n *       graph is not a multi-graph.\n */\nfunction buildLayerGraph(g, rank, relationship, nodesWithRank) {\n  if (!nodesWithRank) {\n    nodesWithRank = g.nodes();\n  }\n  let root = createRootNode(g),\n    result = new Graph({ compound: true })\n      .setGraph({ root: root })\n      .setDefaultNodeLabel((v) => g.node(v));\n\n  nodesWithRank.forEach((v) => {\n    let node = g.node(v),\n      parent = g.parent(v);\n\n    if (node.rank === rank || node.minRank <= rank && rank <= node.maxRank) {\n      result.setNode(v);\n      result.setParent(v, parent || root);\n\n      // This assumes we have only short edges!\n      g[relationship](v).forEach(e => {\n        let u = e.v === v ? e.w : e.v,\n          edge = result.edge(u, v),\n          weight = edge !== undefined ? edge.weight : 0;\n        result.setEdge(u, v, { weight: g.edge(e).weight + weight });\n      });\n\n      if (Object.hasOwn(node, \"minRank\")) {\n        result.setNode(v, {\n          borderLeft: node.borderLeft[rank],\n          borderRight: node.borderRight[rank]\n        });\n      }\n    }\n  });\n\n  return result;\n}\n\nfunction createRootNode(g) {\n  var v;\n  while (g.hasNode((v = util.uniqueId(\"_root\"))));\n  return v;\n}\n\n},{\"../util\":27,\"@dagrejs/graphlib\":29}],14:[function(require,module,exports){\n\"use strict\";\n\nlet zipObject = require(\"../util\").zipObject;\n\nmodule.exports = crossCount;\n\n/*\n * A function that takes a layering (an array of layers, each with an array of\n * ordererd nodes) and a graph and returns a weighted crossing count.\n *\n * Pre-conditions:\n *\n *    1. Input graph must be simple (not a multigraph), directed, and include\n *       only simple edges.\n *    2. Edges in the input graph must have assigned weights.\n *\n * Post-conditions:\n *\n *    1. The graph and layering matrix are left unchanged.\n *\n * This algorithm is derived from Barth, et al., \"Bilayer Cross Counting.\"\n */\nfunction crossCount(g, layering) {\n  let cc = 0;\n  for (let i = 1; i < layering.length; ++i) {\n    cc += twoLayerCrossCount(g, layering[i-1], layering[i]);\n  }\n  return cc;\n}\n\nfunction twoLayerCrossCount(g, northLayer, southLayer) {\n  // Sort all of the edges between the north and south layers by their position\n  // in the north layer and then the south. Map these edges to the position of\n  // their head in the south layer.\n  let southPos = zipObject(southLayer, southLayer.map((v, i) => i));\n  let southEntries = northLayer.flatMap(v => {\n    return g.outEdges(v).map(e => {\n      return { pos: southPos[e.w], weight: g.edge(e).weight };\n    }).sort((a, b) => a.pos - b.pos);\n  });\n\n  // Build the accumulator tree\n  let firstIndex = 1;\n  while (firstIndex < southLayer.length) firstIndex <<= 1;\n  let treeSize = 2 * firstIndex - 1;\n  firstIndex -= 1;\n  let tree = new Array(treeSize).fill(0);\n\n  // Calculate the weighted crossings\n  let cc = 0;\n  southEntries.forEach(entry => {\n    let index = entry.pos + firstIndex;\n    tree[index] += entry.weight;\n    let weightSum = 0;\n    while (index > 0) {\n      if (index % 2) {\n        weightSum += tree[index + 1];\n      }\n      index = (index - 1) >> 1;\n      tree[index] += entry.weight;\n    }\n    cc += entry.weight * weightSum;\n  });\n\n  return cc;\n}\n\n},{\"../util\":27}],15:[function(require,module,exports){\n\"use strict\";\n\nlet initOrder = require(\"./init-order\");\nlet crossCount = require(\"./cross-count\");\nlet sortSubgraph = require(\"./sort-subgraph\");\nlet buildLayerGraph = require(\"./build-layer-graph\");\nlet addSubgraphConstraints = require(\"./add-subgraph-constraints\");\nlet Graph = require(\"@dagrejs/graphlib\").Graph;\nlet util = require(\"../util\");\n\nmodule.exports = order;\n\n/*\n * Applies heuristics to minimize edge crossings in the graph and sets the best\n * order solution as an order attribute on each node.\n *\n * Pre-conditions:\n *\n *    1. Graph must be DAG\n *    2. Graph nodes must be objects with a \"rank\" attribute\n *    3. Graph edges must have the \"weight\" attribute\n *\n * Post-conditions:\n *\n *    1. Graph nodes will have an \"order\" attribute based on the results of the\n *       algorithm.\n */\nfunction order(g, opts) {\n  if (opts && typeof opts.customOrder === 'function') {\n    opts.customOrder(g, order);\n    return;\n  }\n\n  let maxRank = util.maxRank(g),\n    downLayerGraphs = buildLayerGraphs(g, util.range(1, maxRank + 1), \"inEdges\"),\n    upLayerGraphs = buildLayerGraphs(g, util.range(maxRank - 1, -1, -1), \"outEdges\");\n\n  let layering = initOrder(g);\n  assignOrder(g, layering);\n\n  if (opts && opts.disableOptimalOrderHeuristic) {\n    return;\n  }\n\n  let bestCC = Number.POSITIVE_INFINITY,\n    best;\n\n  for (let i = 0, lastBest = 0; lastBest < 4; ++i, ++lastBest) {\n    sweepLayerGraphs(i % 2 ? downLayerGraphs : upLayerGraphs, i % 4 >= 2);\n\n    layering = util.buildLayerMatrix(g);\n    let cc = crossCount(g, layering);\n    if (cc < bestCC) {\n      lastBest = 0;\n      best = Object.assign({}, layering);\n      bestCC = cc;\n    }\n  }\n\n  assignOrder(g, best);\n}\n\nfunction buildLayerGraphs(g, ranks, relationship) {\n  // Build an index mapping from rank to the nodes with that rank.\n  // This helps to avoid a quadratic search for all nodes with the same rank as\n  // the current node.\n  const nodesByRank = new Map();\n  const addNodeToRank = (rank, node) => {\n    if (!nodesByRank.has(rank)) {\n      nodesByRank.set(rank, []);\n    }\n    nodesByRank.get(rank).push(node);\n  };\n\n  // Visit the nodes in their original order in the graph, and add each\n  // node to the ranks(s) that it belongs to.\n  for (const v of g.nodes()) {\n    const node = g.node(v);\n    if (typeof node.rank === \"number\") {\n      addNodeToRank(node.rank, v);\n    }\n    // If there is a range of ranks, add it to each, but skip the `node.rank` which\n    // has already had the node added.\n    if (typeof node.minRank === \"number\" && typeof node.maxRank === \"number\") {\n      for (let r = node.minRank; r <= node.maxRank; r++) {\n        if (r !== node.rank) {\n          // Don't add this node to its `node.rank` twice.\n          addNodeToRank(r, v);\n        }\n      }\n    }\n  }\n\n  return ranks.map(function (rank) {\n    return buildLayerGraph(g, rank, relationship, nodesByRank.get(rank) || []);\n  });\n}\n\nfunction sweepLayerGraphs(layerGraphs, biasRight) {\n  let cg = new Graph();\n  layerGraphs.forEach(function(lg) {\n    let root = lg.graph().root;\n    let sorted = sortSubgraph(lg, root, cg, biasRight);\n    sorted.vs.forEach((v, i) => lg.node(v).order = i);\n    addSubgraphConstraints(lg, cg, sorted.vs);\n  });\n}\n\nfunction assignOrder(g, layering) {\n  Object.values(layering).forEach(layer => layer.forEach((v, i) => g.node(v).order = i));\n}\n\n},{\"../util\":27,\"./add-subgraph-constraints\":11,\"./build-layer-graph\":13,\"./cross-count\":14,\"./init-order\":16,\"./sort-subgraph\":18,\"@dagrejs/graphlib\":29}],16:[function(require,module,exports){\n\"use strict\";\n\nlet util = require(\"../util\");\n\nmodule.exports = initOrder;\n\n/*\n * Assigns an initial order value for each node by performing a DFS search\n * starting from nodes in the first rank. Nodes are assigned an order in their\n * rank as they are first visited.\n *\n * This approach comes from Gansner, et al., \"A Technique for Drawing Directed\n * Graphs.\"\n *\n * Returns a layering matrix with an array per layer and each layer sorted by\n * the order of its nodes.\n */\nfunction initOrder(g) {\n  let visited = {};\n  let simpleNodes = g.nodes().filter(v => !g.children(v).length);\n  let simpleNodesRanks = simpleNodes.map(v => g.node(v).rank);\n  let maxRank = util.applyWithChunking(Math.max, simpleNodesRanks);\n  let layers = util.range(maxRank + 1).map(() => []);\n\n  function dfs(v) {\n    if (visited[v]) return;\n    visited[v] = true;\n    let node = g.node(v);\n    layers[node.rank].push(v);\n    g.successors(v).forEach(dfs);\n  }\n\n  let orderedVs = simpleNodes.sort((a, b) => g.node(a).rank - g.node(b).rank);\n  orderedVs.forEach(dfs);\n\n  return layers;\n}\n\n},{\"../util\":27}],17:[function(require,module,exports){\n\"use strict\";\n\nlet util = require(\"../util\");\n\nmodule.exports = resolveConflicts;\n\n/*\n * Given a list of entries of the form {v, barycenter, weight} and a\n * constraint graph this function will resolve any conflicts between the\n * constraint graph and the barycenters for the entries. If the barycenters for\n * an entry would violate a constraint in the constraint graph then we coalesce\n * the nodes in the conflict into a new node that respects the contraint and\n * aggregates barycenter and weight information.\n *\n * This implementation is based on the description in Forster, \"A Fast and\n * Simple Hueristic for Constrained Two-Level Crossing Reduction,\" thought it\n * differs in some specific details.\n *\n * Pre-conditions:\n *\n *    1. Each entry has the form {v, barycenter, weight}, or if the node has\n *       no barycenter, then {v}.\n *\n * Returns:\n *\n *    A new list of entries of the form {vs, i, barycenter, weight}. The list\n *    `vs` may either be a singleton or it may be an aggregation of nodes\n *    ordered such that they do not violate constraints from the constraint\n *    graph. The property `i` is the lowest original index of any of the\n *    elements in `vs`.\n */\nfunction resolveConflicts(entries, cg) {\n  let mappedEntries = {};\n  entries.forEach((entry, i) => {\n    let tmp = mappedEntries[entry.v] = {\n      indegree: 0,\n      \"in\": [],\n      out: [],\n      vs: [entry.v],\n      i: i\n    };\n    if (entry.barycenter !== undefined) {\n      tmp.barycenter = entry.barycenter;\n      tmp.weight = entry.weight;\n    }\n  });\n\n  cg.edges().forEach(e => {\n    let entryV = mappedEntries[e.v];\n    let entryW = mappedEntries[e.w];\n    if (entryV !== undefined && entryW !== undefined) {\n      entryW.indegree++;\n      entryV.out.push(mappedEntries[e.w]);\n    }\n  });\n\n  let sourceSet = Object.values(mappedEntries).filter(entry => !entry.indegree);\n\n  return doResolveConflicts(sourceSet);\n}\n\nfunction doResolveConflicts(sourceSet) {\n  let entries = [];\n\n  function handleIn(vEntry) {\n    return uEntry => {\n      if (uEntry.merged) {\n        return;\n      }\n      if (uEntry.barycenter === undefined ||\n          vEntry.barycenter === undefined ||\n          uEntry.barycenter >= vEntry.barycenter) {\n        mergeEntries(vEntry, uEntry);\n      }\n    };\n  }\n\n  function handleOut(vEntry) {\n    return wEntry => {\n      wEntry[\"in\"].push(vEntry);\n      if (--wEntry.indegree === 0) {\n        sourceSet.push(wEntry);\n      }\n    };\n  }\n\n  while (sourceSet.length) {\n    let entry = sourceSet.pop();\n    entries.push(entry);\n    entry[\"in\"].reverse().forEach(handleIn(entry));\n    entry.out.forEach(handleOut(entry));\n  }\n\n  return entries.filter(entry => !entry.merged).map(entry => {\n    return util.pick(entry, [\"vs\", \"i\", \"barycenter\", \"weight\"]);\n  });\n}\n\nfunction mergeEntries(target, source) {\n  let sum = 0;\n  let weight = 0;\n\n  if (target.weight) {\n    sum += target.barycenter * target.weight;\n    weight += target.weight;\n  }\n\n  if (source.weight) {\n    sum += source.barycenter * source.weight;\n    weight += source.weight;\n  }\n\n  target.vs = source.vs.concat(target.vs);\n  target.barycenter = sum / weight;\n  target.weight = weight;\n  target.i = Math.min(source.i, target.i);\n  source.merged = true;\n}\n\n},{\"../util\":27}],18:[function(require,module,exports){\nlet barycenter = require(\"./barycenter\");\nlet resolveConflicts = require(\"./resolve-conflicts\");\nlet sort = require(\"./sort\");\n\nmodule.exports = sortSubgraph;\n\nfunction sortSubgraph(g, v, cg, biasRight) {\n  let movable = g.children(v);\n  let node = g.node(v);\n  let bl = node ? node.borderLeft : undefined;\n  let br = node ? node.borderRight: undefined;\n  let subgraphs = {};\n\n  if (bl) {\n    movable = movable.filter(w => w !== bl && w !== br);\n  }\n\n  let barycenters = barycenter(g, movable);\n  barycenters.forEach(entry => {\n    if (g.children(entry.v).length) {\n      let subgraphResult = sortSubgraph(g, entry.v, cg, biasRight);\n      subgraphs[entry.v] = subgraphResult;\n      if (Object.hasOwn(subgraphResult, \"barycenter\")) {\n        mergeBarycenters(entry, subgraphResult);\n      }\n    }\n  });\n\n  let entries = resolveConflicts(barycenters, cg);\n  expandSubgraphs(entries, subgraphs);\n\n  let result = sort(entries, biasRight);\n\n  if (bl) {\n    result.vs = [bl, result.vs, br].flat(true);\n    if (g.predecessors(bl).length) {\n      let blPred = g.node(g.predecessors(bl)[0]),\n        brPred = g.node(g.predecessors(br)[0]);\n      if (!Object.hasOwn(result, \"barycenter\")) {\n        result.barycenter = 0;\n        result.weight = 0;\n      }\n      result.barycenter = (result.barycenter * result.weight +\n                           blPred.order + brPred.order) / (result.weight + 2);\n      result.weight += 2;\n    }\n  }\n\n  return result;\n}\n\nfunction expandSubgraphs(entries, subgraphs) {\n  entries.forEach(entry => {\n    entry.vs = entry.vs.flatMap(v => {\n      if (subgraphs[v]) {\n        return subgraphs[v].vs;\n      }\n      return v;\n    });\n  });\n}\n\nfunction mergeBarycenters(target, other) {\n  if (target.barycenter !== undefined) {\n    target.barycenter = (target.barycenter * target.weight +\n                         other.barycenter * other.weight) /\n                        (target.weight + other.weight);\n    target.weight += other.weight;\n  } else {\n    target.barycenter = other.barycenter;\n    target.weight = other.weight;\n  }\n}\n\n},{\"./barycenter\":12,\"./resolve-conflicts\":17,\"./sort\":19}],19:[function(require,module,exports){\nlet util = require(\"../util\");\n\nmodule.exports = sort;\n\nfunction sort(entries, biasRight) {\n  let parts = util.partition(entries, entry => {\n    return Object.hasOwn(entry, \"barycenter\");\n  });\n  let sortable = parts.lhs,\n    unsortable = parts.rhs.sort((a, b) => b.i - a.i),\n    vs = [],\n    sum = 0,\n    weight = 0,\n    vsIndex = 0;\n\n  sortable.sort(compareWithBias(!!biasRight));\n\n  vsIndex = consumeUnsortable(vs, unsortable, vsIndex);\n\n  sortable.forEach(entry => {\n    vsIndex += entry.vs.length;\n    vs.push(entry.vs);\n    sum += entry.barycenter * entry.weight;\n    weight += entry.weight;\n    vsIndex = consumeUnsortable(vs, unsortable, vsIndex);\n  });\n\n  let result = { vs: vs.flat(true) };\n  if (weight) {\n    result.barycenter = sum / weight;\n    result.weight = weight;\n  }\n  return result;\n}\n\nfunction consumeUnsortable(vs, unsortable, index) {\n  let last;\n  while (unsortable.length && (last = unsortable[unsortable.length - 1]).i <= index) {\n    unsortable.pop();\n    vs.push(last.vs);\n    index++;\n  }\n  return index;\n}\n\nfunction compareWithBias(bias) {\n  return (entryV, entryW) => {\n    if (entryV.barycenter < entryW.barycenter) {\n      return -1;\n    } else if (entryV.barycenter > entryW.barycenter) {\n      return 1;\n    }\n\n    return !bias ? entryV.i - entryW.i : entryW.i - entryV.i;\n  };\n}\n\n},{\"../util\":27}],20:[function(require,module,exports){\nmodule.exports = parentDummyChains;\n\nfunction parentDummyChains(g) {\n  let postorderNums = postorder(g);\n\n  g.graph().dummyChains.forEach(v => {\n    let node = g.node(v);\n    let edgeObj = node.edgeObj;\n    let pathData = findPath(g, postorderNums, edgeObj.v, edgeObj.w);\n    let path = pathData.path;\n    let lca = pathData.lca;\n    let pathIdx = 0;\n    let pathV = path[pathIdx];\n    let ascending = true;\n\n    while (v !== edgeObj.w) {\n      node = g.node(v);\n\n      if (ascending) {\n        while ((pathV = path[pathIdx]) !== lca &&\n               g.node(pathV).maxRank < node.rank) {\n          pathIdx++;\n        }\n\n        if (pathV === lca) {\n          ascending = false;\n        }\n      }\n\n      if (!ascending) {\n        while (pathIdx < path.length - 1 &&\n               g.node(pathV = path[pathIdx + 1]).minRank <= node.rank) {\n          pathIdx++;\n        }\n        pathV = path[pathIdx];\n      }\n\n      g.setParent(v, pathV);\n      v = g.successors(v)[0];\n    }\n  });\n}\n\n// Find a path from v to w through the lowest common ancestor (LCA). Return the\n// full path and the LCA.\nfunction findPath(g, postorderNums, v, w) {\n  let vPath = [];\n  let wPath = [];\n  let low = Math.min(postorderNums[v].low, postorderNums[w].low);\n  let lim = Math.max(postorderNums[v].lim, postorderNums[w].lim);\n  let parent;\n  let lca;\n\n  // Traverse up from v to find the LCA\n  parent = v;\n  do {\n    parent = g.parent(parent);\n    vPath.push(parent);\n  } while (parent &&\n           (postorderNums[parent].low > low || lim > postorderNums[parent].lim));\n  lca = parent;\n\n  // Traverse from w to LCA\n  parent = w;\n  while ((parent = g.parent(parent)) !== lca) {\n    wPath.push(parent);\n  }\n\n  return { path: vPath.concat(wPath.reverse()), lca: lca };\n}\n\nfunction postorder(g) {\n  let result = {};\n  let lim = 0;\n\n  function dfs(v) {\n    let low = lim;\n    g.children(v).forEach(dfs);\n    result[v] = { low: low, lim: lim++ };\n  }\n  g.children().forEach(dfs);\n\n  return result;\n}\n\n},{}],21:[function(require,module,exports){\n\"use strict\";\n\nlet Graph = require(\"@dagrejs/graphlib\").Graph;\nlet util = require(\"../util\");\n\n/*\n * This module provides coordinate assignment based on Brandes and Kpf, \"Fast\n * and Simple Horizontal Coordinate Assignment.\"\n */\n\nmodule.exports = {\n  positionX: positionX,\n  findType1Conflicts: findType1Conflicts,\n  findType2Conflicts: findType2Conflicts,\n  addConflict: addConflict,\n  hasConflict: hasConflict,\n  verticalAlignment: verticalAlignment,\n  horizontalCompaction: horizontalCompaction,\n  alignCoordinates: alignCoordinates,\n  findSmallestWidthAlignment: findSmallestWidthAlignment,\n  balance: balance\n};\n\n/*\n * Marks all edges in the graph with a type-1 conflict with the \"type1Conflict\"\n * property. A type-1 conflict is one where a non-inner segment crosses an\n * inner segment. An inner segment is an edge with both incident nodes marked\n * with the \"dummy\" property.\n *\n * This algorithm scans layer by layer, starting with the second, for type-1\n * conflicts between the current layer and the previous layer. For each layer\n * it scans the nodes from left to right until it reaches one that is incident\n * on an inner segment. It then scans predecessors to determine if they have\n * edges that cross that inner segment. At the end a final scan is done for all\n * nodes on the current rank to see if they cross the last visited inner\n * segment.\n *\n * This algorithm (safely) assumes that a dummy node will only be incident on a\n * single node in the layers being scanned.\n */\nfunction findType1Conflicts(g, layering) {\n  let conflicts = {};\n\n  function visitLayer(prevLayer, layer) {\n    let\n      // last visited node in the previous layer that is incident on an inner\n      // segment.\n      k0 = 0,\n      // Tracks the last node in this layer scanned for crossings with a type-1\n      // segment.\n      scanPos = 0,\n      prevLayerLength = prevLayer.length,\n      lastNode = layer[layer.length - 1];\n\n    layer.forEach((v, i) => {\n      let w = findOtherInnerSegmentNode(g, v),\n        k1 = w ? g.node(w).order : prevLayerLength;\n\n      if (w || v === lastNode) {\n        layer.slice(scanPos, i+1).forEach(scanNode => {\n          g.predecessors(scanNode).forEach(u => {\n            let uLabel = g.node(u),\n              uPos = uLabel.order;\n            if ((uPos < k0 || k1 < uPos) &&\n                !(uLabel.dummy && g.node(scanNode).dummy)) {\n              addConflict(conflicts, u, scanNode);\n            }\n          });\n        });\n        scanPos = i + 1;\n        k0 = k1;\n      }\n    });\n\n    return layer;\n  }\n\n  layering.length && layering.reduce(visitLayer);\n\n  return conflicts;\n}\n\nfunction findType2Conflicts(g, layering) {\n  let conflicts = {};\n\n  function scan(south, southPos, southEnd, prevNorthBorder, nextNorthBorder) {\n    let v;\n    util.range(southPos, southEnd).forEach(i => {\n      v = south[i];\n      if (g.node(v).dummy) {\n        g.predecessors(v).forEach(u => {\n          let uNode = g.node(u);\n          if (uNode.dummy &&\n              (uNode.order < prevNorthBorder || uNode.order > nextNorthBorder)) {\n            addConflict(conflicts, u, v);\n          }\n        });\n      }\n    });\n  }\n\n\n  function visitLayer(north, south) {\n    let prevNorthPos = -1,\n      nextNorthPos,\n      southPos = 0;\n\n    south.forEach((v, southLookahead) => {\n      if (g.node(v).dummy === \"border\") {\n        let predecessors = g.predecessors(v);\n        if (predecessors.length) {\n          nextNorthPos = g.node(predecessors[0]).order;\n          scan(south, southPos, southLookahead, prevNorthPos, nextNorthPos);\n          southPos = southLookahead;\n          prevNorthPos = nextNorthPos;\n        }\n      }\n      scan(south, southPos, south.length, nextNorthPos, north.length);\n    });\n\n    return south;\n  }\n\n  layering.length && layering.reduce(visitLayer);\n\n  return conflicts;\n}\n\nfunction findOtherInnerSegmentNode(g, v) {\n  if (g.node(v).dummy) {\n    return g.predecessors(v).find(u => g.node(u).dummy);\n  }\n}\n\nfunction addConflict(conflicts, v, w) {\n  if (v > w) {\n    let tmp = v;\n    v = w;\n    w = tmp;\n  }\n\n  let conflictsV = conflicts[v];\n  if (!conflictsV) {\n    conflicts[v] = conflictsV = {};\n  }\n  conflictsV[w] = true;\n}\n\nfunction hasConflict(conflicts, v, w) {\n  if (v > w) {\n    let tmp = v;\n    v = w;\n    w = tmp;\n  }\n  return !!conflicts[v] && Object.hasOwn(conflicts[v], w);\n}\n\n/*\n * Try to align nodes into vertical \"blocks\" where possible. This algorithm\n * attempts to align a node with one of its median neighbors. If the edge\n * connecting a neighbor is a type-1 conflict then we ignore that possibility.\n * If a previous node has already formed a block with a node after the node\n * we're trying to form a block with, we also ignore that possibility - our\n * blocks would be split in that scenario.\n */\nfunction verticalAlignment(g, layering, conflicts, neighborFn) {\n  let root = {},\n    align = {},\n    pos = {};\n\n  // We cache the position here based on the layering because the graph and\n  // layering may be out of sync. The layering matrix is manipulated to\n  // generate different extreme alignments.\n  layering.forEach(layer => {\n    layer.forEach((v, order) => {\n      root[v] = v;\n      align[v] = v;\n      pos[v] = order;\n    });\n  });\n\n  layering.forEach(layer => {\n    let prevIdx = -1;\n    layer.forEach(v => {\n      let ws = neighborFn(v);\n      if (ws.length) {\n        ws = ws.sort((a, b) => pos[a] - pos[b]);\n        let mp = (ws.length - 1) / 2;\n        for (let i = Math.floor(mp), il = Math.ceil(mp); i <= il; ++i) {\n          let w = ws[i];\n          if (align[v] === v &&\n              prevIdx < pos[w] &&\n              !hasConflict(conflicts, v, w)) {\n            align[w] = v;\n            align[v] = root[v] = root[w];\n            prevIdx = pos[w];\n          }\n        }\n      }\n    });\n  });\n\n  return { root: root, align: align };\n}\n\nfunction horizontalCompaction(g, layering, root, align, reverseSep) {\n  // This portion of the algorithm differs from BK due to a number of problems.\n  // Instead of their algorithm we construct a new block graph and do two\n  // sweeps. The first sweep places blocks with the smallest possible\n  // coordinates. The second sweep removes unused space by moving blocks to the\n  // greatest coordinates without violating separation.\n  let xs = {},\n    blockG = buildBlockGraph(g, layering, root, reverseSep),\n    borderType = reverseSep ? \"borderLeft\" : \"borderRight\";\n\n  function iterate(setXsFunc, nextNodesFunc) {\n    let stack = blockG.nodes();\n    let elem = stack.pop();\n    let visited = {};\n    while (elem) {\n      if (visited[elem]) {\n        setXsFunc(elem);\n      } else {\n        visited[elem] = true;\n        stack.push(elem);\n        stack = stack.concat(nextNodesFunc(elem));\n      }\n\n      elem = stack.pop();\n    }\n  }\n\n  // First pass, assign smallest coordinates\n  function pass1(elem) {\n    xs[elem] = blockG.inEdges(elem).reduce((acc, e) => {\n      return Math.max(acc, xs[e.v] + blockG.edge(e));\n    }, 0);\n  }\n\n  // Second pass, assign greatest coordinates\n  function pass2(elem) {\n    let min = blockG.outEdges(elem).reduce((acc, e) => {\n      return Math.min(acc, xs[e.w] - blockG.edge(e));\n    }, Number.POSITIVE_INFINITY);\n\n    let node = g.node(elem);\n    if (min !== Number.POSITIVE_INFINITY && node.borderType !== borderType) {\n      xs[elem] = Math.max(xs[elem], min);\n    }\n  }\n\n  iterate(pass1, blockG.predecessors.bind(blockG));\n  iterate(pass2, blockG.successors.bind(blockG));\n\n  // Assign x coordinates to all nodes\n  Object.keys(align).forEach(v => xs[v] = xs[root[v]]);\n\n  return xs;\n}\n\n\nfunction buildBlockGraph(g, layering, root, reverseSep) {\n  let blockGraph = new Graph(),\n    graphLabel = g.graph(),\n    sepFn = sep(graphLabel.nodesep, graphLabel.edgesep, reverseSep);\n\n  layering.forEach(layer => {\n    let u;\n    layer.forEach(v => {\n      let vRoot = root[v];\n      blockGraph.setNode(vRoot);\n      if (u) {\n        var uRoot = root[u],\n          prevMax = blockGraph.edge(uRoot, vRoot);\n        blockGraph.setEdge(uRoot, vRoot, Math.max(sepFn(g, v, u), prevMax || 0));\n      }\n      u = v;\n    });\n  });\n\n  return blockGraph;\n}\n\n/*\n * Returns the alignment that has the smallest width of the given alignments.\n */\nfunction findSmallestWidthAlignment(g, xss) {\n  return Object.values(xss).reduce((currentMinAndXs, xs) => {\n    let max = Number.NEGATIVE_INFINITY;\n    let min = Number.POSITIVE_INFINITY;\n\n    Object.entries(xs).forEach(([v, x]) => {\n      let halfWidth = width(g, v) / 2;\n\n      max = Math.max(x + halfWidth, max);\n      min = Math.min(x - halfWidth, min);\n    });\n\n    const newMin = max - min;\n    if (newMin < currentMinAndXs[0]) {\n      currentMinAndXs = [newMin, xs];\n    }\n    return currentMinAndXs;\n  }, [Number.POSITIVE_INFINITY, null])[1];\n}\n\n/*\n * Align the coordinates of each of the layout alignments such that\n * left-biased alignments have their minimum coordinate at the same point as\n * the minimum coordinate of the smallest width alignment and right-biased\n * alignments have their maximum coordinate at the same point as the maximum\n * coordinate of the smallest width alignment.\n */\nfunction alignCoordinates(xss, alignTo) {\n  let alignToVals = Object.values(alignTo),\n    alignToMin = util.applyWithChunking(Math.min, alignToVals),\n    alignToMax = util.applyWithChunking(Math.max, alignToVals);\n\n  [\"u\", \"d\"].forEach(vert => {\n    [\"l\", \"r\"].forEach(horiz => {\n      let alignment = vert + horiz,\n        xs = xss[alignment];\n\n      if (xs === alignTo) return;\n\n      let xsVals = Object.values(xs);\n      let delta = alignToMin - util.applyWithChunking(Math.min, xsVals);\n      if (horiz !== \"l\") {\n        delta = alignToMax - util.applyWithChunking(Math.max,xsVals);\n      }\n\n      if (delta) {\n        xss[alignment] = util.mapValues(xs, x => x + delta);\n      }\n    });\n  });\n}\n\nfunction balance(xss, align) {\n  return util.mapValues(xss.ul, (num, v) => {\n    if (align) {\n      return xss[align.toLowerCase()][v];\n    } else {\n      let xs = Object.values(xss).map(xs => xs[v]).sort((a, b) => a - b);\n      return (xs[1] + xs[2]) / 2;\n    }\n  });\n}\n\nfunction positionX(g) {\n  let layering = util.buildLayerMatrix(g);\n  let conflicts = Object.assign(\n    findType1Conflicts(g, layering),\n    findType2Conflicts(g, layering));\n\n  let xss = {};\n  let adjustedLayering;\n  [\"u\", \"d\"].forEach(vert => {\n    adjustedLayering = vert === \"u\" ? layering : Object.values(layering).reverse();\n    [\"l\", \"r\"].forEach(horiz => {\n      if (horiz === \"r\") {\n        adjustedLayering = adjustedLayering.map(inner => {\n          return Object.values(inner).reverse();\n        });\n      }\n\n      let neighborFn = (vert === \"u\" ? g.predecessors : g.successors).bind(g);\n      let align = verticalAlignment(g, adjustedLayering, conflicts, neighborFn);\n      let xs = horizontalCompaction(g, adjustedLayering,\n        align.root, align.align, horiz === \"r\");\n      if (horiz === \"r\") {\n        xs = util.mapValues(xs, x => -x);\n      }\n      xss[vert + horiz] = xs;\n    });\n  });\n\n\n  let smallestWidth = findSmallestWidthAlignment(g, xss);\n  alignCoordinates(xss, smallestWidth);\n  return balance(xss, g.graph().align);\n}\n\nfunction sep(nodeSep, edgeSep, reverseSep) {\n  return (g, v, w) => {\n    let vLabel = g.node(v);\n    let wLabel = g.node(w);\n    let sum = 0;\n    let delta;\n\n    sum += vLabel.width / 2;\n    if (Object.hasOwn(vLabel, \"labelpos\")) {\n      switch (vLabel.labelpos.toLowerCase()) {\n      case \"l\": delta = -vLabel.width / 2; break;\n      case \"r\": delta = vLabel.width / 2; break;\n      }\n    }\n    if (delta) {\n      sum += reverseSep ? delta : -delta;\n    }\n    delta = 0;\n\n    sum += (vLabel.dummy ? edgeSep : nodeSep) / 2;\n    sum += (wLabel.dummy ? edgeSep : nodeSep) / 2;\n\n    sum += wLabel.width / 2;\n    if (Object.hasOwn(wLabel, \"labelpos\")) {\n      switch (wLabel.labelpos.toLowerCase()) {\n      case \"l\": delta = wLabel.width / 2; break;\n      case \"r\": delta = -wLabel.width / 2; break;\n      }\n    }\n    if (delta) {\n      sum += reverseSep ? delta : -delta;\n    }\n    delta = 0;\n\n    return sum;\n  };\n}\n\nfunction width(g, v) {\n  return g.node(v).width;\n}\n\n},{\"../util\":27,\"@dagrejs/graphlib\":29}],22:[function(require,module,exports){\n\"use strict\";\n\nlet util = require(\"../util\");\nlet positionX = require(\"./bk\").positionX;\n\nmodule.exports = position;\n\nfunction position(g) {\n  g = util.asNonCompoundGraph(g);\n\n  positionY(g);\n  Object.entries(positionX(g)).forEach(([v, x]) => g.node(v).x = x);\n}\n\nfunction positionY(g) {\n  let layering = util.buildLayerMatrix(g);\n  let rankSep = g.graph().ranksep;\n  let prevY = 0;\n  layering.forEach(layer => {\n    const maxHeight = layer.reduce((acc, v) => {\n      const height = g.node(v).height;\n      if (acc > height) {\n        return acc;\n      } else {\n        return height;\n      }\n    }, 0);\n    layer.forEach(v => g.node(v).y = prevY + maxHeight / 2);\n    prevY += maxHeight + rankSep;\n  });\n}\n\n\n},{\"../util\":27,\"./bk\":21}],23:[function(require,module,exports){\n\"use strict\";\n\nvar Graph = require(\"@dagrejs/graphlib\").Graph;\nvar slack = require(\"./util\").slack;\n\nmodule.exports = feasibleTree;\n\n/*\n * Constructs a spanning tree with tight edges and adjusted the input node's\n * ranks to achieve this. A tight edge is one that is has a length that matches\n * its \"minlen\" attribute.\n *\n * The basic structure for this function is derived from Gansner, et al., \"A\n * Technique for Drawing Directed Graphs.\"\n *\n * Pre-conditions:\n *\n *    1. Graph must be a DAG.\n *    2. Graph must be connected.\n *    3. Graph must have at least one node.\n *    5. Graph nodes must have been previously assigned a \"rank\" property that\n *       respects the \"minlen\" property of incident edges.\n *    6. Graph edges must have a \"minlen\" property.\n *\n * Post-conditions:\n *\n *    - Graph nodes will have their rank adjusted to ensure that all edges are\n *      tight.\n *\n * Returns a tree (undirected graph) that is constructed using only \"tight\"\n * edges.\n */\nfunction feasibleTree(g) {\n  var t = new Graph({ directed: false });\n\n  // Choose arbitrary node from which to start our tree\n  var start = g.nodes()[0];\n  var size = g.nodeCount();\n  t.setNode(start, {});\n\n  var edge, delta;\n  while (tightTree(t, g) < size) {\n    edge = findMinSlackEdge(t, g);\n    delta = t.hasNode(edge.v) ? slack(g, edge) : -slack(g, edge);\n    shiftRanks(t, g, delta);\n  }\n\n  return t;\n}\n\n/*\n * Finds a maximal tree of tight edges and returns the number of nodes in the\n * tree.\n */\nfunction tightTree(t, g) {\n  function dfs(v) {\n    g.nodeEdges(v).forEach(e => {\n      var edgeV = e.v,\n        w = (v === edgeV) ? e.w : edgeV;\n      if (!t.hasNode(w) && !slack(g, e)) {\n        t.setNode(w, {});\n        t.setEdge(v, w, {});\n        dfs(w);\n      }\n    });\n  }\n\n  t.nodes().forEach(dfs);\n  return t.nodeCount();\n}\n\n/*\n * Finds the edge with the smallest slack that is incident on tree and returns\n * it.\n */\nfunction findMinSlackEdge(t, g) {\n  const edges = g.edges();\n\n  return edges.reduce((acc, edge) => {\n    let edgeSlack = Number.POSITIVE_INFINITY;\n    if (t.hasNode(edge.v) !== t.hasNode(edge.w)) {\n      edgeSlack = slack(g, edge);\n    }\n\n    if (edgeSlack < acc[0]) {\n      return [edgeSlack, edge];\n    }\n\n    return acc;\n  }, [Number.POSITIVE_INFINITY, null])[1];\n}\n\nfunction shiftRanks(t, g, delta) {\n  t.nodes().forEach(v => g.node(v).rank += delta);\n}\n\n},{\"./util\":26,\"@dagrejs/graphlib\":29}],24:[function(require,module,exports){\n\"use strict\";\n\nvar rankUtil = require(\"./util\");\nvar longestPath = rankUtil.longestPath;\nvar feasibleTree = require(\"./feasible-tree\");\nvar networkSimplex = require(\"./network-simplex\");\n\nmodule.exports = rank;\n\n/*\n * Assigns a rank to each node in the input graph that respects the \"minlen\"\n * constraint specified on edges between nodes.\n *\n * This basic structure is derived from Gansner, et al., \"A Technique for\n * Drawing Directed Graphs.\"\n *\n * Pre-conditions:\n *\n *    1. Graph must be a connected DAG\n *    2. Graph nodes must be objects\n *    3. Graph edges must have \"weight\" and \"minlen\" attributes\n *\n * Post-conditions:\n *\n *    1. Graph nodes will have a \"rank\" attribute based on the results of the\n *       algorithm. Ranks can start at any index (including negative), we'll\n *       fix them up later.\n */\nfunction rank(g) {\n  var ranker = g.graph().ranker;\n  if (ranker instanceof Function) {\n    return ranker(g);\n  }\n\n  switch(g.graph().ranker) {\n  case \"network-simplex\": networkSimplexRanker(g); break;\n  case \"tight-tree\": tightTreeRanker(g); break;\n  case \"longest-path\": longestPathRanker(g); break;\n  case \"none\": break;\n  default: networkSimplexRanker(g);\n  }\n}\n\n// A fast and simple ranker, but results are far from optimal.\nvar longestPathRanker = longestPath;\n\nfunction tightTreeRanker(g) {\n  longestPath(g);\n  feasibleTree(g);\n}\n\nfunction networkSimplexRanker(g) {\n  networkSimplex(g);\n}\n\n},{\"./feasible-tree\":23,\"./network-simplex\":25,\"./util\":26}],25:[function(require,module,exports){\n\"use strict\";\n\nvar feasibleTree = require(\"./feasible-tree\");\nvar slack = require(\"./util\").slack;\nvar initRank = require(\"./util\").longestPath;\nvar preorder = require(\"@dagrejs/graphlib\").alg.preorder;\nvar postorder = require(\"@dagrejs/graphlib\").alg.postorder;\nvar simplify = require(\"../util\").simplify;\n\nmodule.exports = networkSimplex;\n\n// Expose some internals for testing purposes\nnetworkSimplex.initLowLimValues = initLowLimValues;\nnetworkSimplex.initCutValues = initCutValues;\nnetworkSimplex.calcCutValue = calcCutValue;\nnetworkSimplex.leaveEdge = leaveEdge;\nnetworkSimplex.enterEdge = enterEdge;\nnetworkSimplex.exchangeEdges = exchangeEdges;\n\n/*\n * The network simplex algorithm assigns ranks to each node in the input graph\n * and iteratively improves the ranking to reduce the length of edges.\n *\n * Preconditions:\n *\n *    1. The input graph must be a DAG.\n *    2. All nodes in the graph must have an object value.\n *    3. All edges in the graph must have \"minlen\" and \"weight\" attributes.\n *\n * Postconditions:\n *\n *    1. All nodes in the graph will have an assigned \"rank\" attribute that has\n *       been optimized by the network simplex algorithm. Ranks start at 0.\n *\n *\n * A rough sketch of the algorithm is as follows:\n *\n *    1. Assign initial ranks to each node. We use the longest path algorithm,\n *       which assigns ranks to the lowest position possible. In general this\n *       leads to very wide bottom ranks and unnecessarily long edges.\n *    2. Construct a feasible tight tree. A tight tree is one such that all\n *       edges in the tree have no slack (difference between length of edge\n *       and minlen for the edge). This by itself greatly improves the assigned\n *       rankings by shorting edges.\n *    3. Iteratively find edges that have negative cut values. Generally a\n *       negative cut value indicates that the edge could be removed and a new\n *       tree edge could be added to produce a more compact graph.\n *\n * Much of the algorithms here are derived from Gansner, et al., \"A Technique\n * for Drawing Directed Graphs.\" The structure of the file roughly follows the\n * structure of the overall algorithm.\n */\nfunction networkSimplex(g) {\n  g = simplify(g);\n  initRank(g);\n  var t = feasibleTree(g);\n  initLowLimValues(t);\n  initCutValues(t, g);\n\n  var e, f;\n  while ((e = leaveEdge(t))) {\n    f = enterEdge(t, g, e);\n    exchangeEdges(t, g, e, f);\n  }\n}\n\n/*\n * Initializes cut values for all edges in the tree.\n */\nfunction initCutValues(t, g) {\n  var vs = postorder(t, t.nodes());\n  vs = vs.slice(0, vs.length - 1);\n  vs.forEach(v => assignCutValue(t, g, v));\n}\n\nfunction assignCutValue(t, g, child) {\n  var childLab = t.node(child);\n  var parent = childLab.parent;\n  t.edge(child, parent).cutvalue = calcCutValue(t, g, child);\n}\n\n/*\n * Given the tight tree, its graph, and a child in the graph calculate and\n * return the cut value for the edge between the child and its parent.\n */\nfunction calcCutValue(t, g, child) {\n  var childLab = t.node(child);\n  var parent = childLab.parent;\n  // True if the child is on the tail end of the edge in the directed graph\n  var childIsTail = true;\n  // The graph's view of the tree edge we're inspecting\n  var graphEdge = g.edge(child, parent);\n  // The accumulated cut value for the edge between this node and its parent\n  var cutValue = 0;\n\n  if (!graphEdge) {\n    childIsTail = false;\n    graphEdge = g.edge(parent, child);\n  }\n\n  cutValue = graphEdge.weight;\n\n  g.nodeEdges(child).forEach(e => {\n    var isOutEdge = e.v === child,\n      other = isOutEdge ? e.w : e.v;\n\n    if (other !== parent) {\n      var pointsToHead = isOutEdge === childIsTail,\n        otherWeight = g.edge(e).weight;\n\n      cutValue += pointsToHead ? otherWeight : -otherWeight;\n      if (isTreeEdge(t, child, other)) {\n        var otherCutValue = t.edge(child, other).cutvalue;\n        cutValue += pointsToHead ? -otherCutValue : otherCutValue;\n      }\n    }\n  });\n\n  return cutValue;\n}\n\nfunction initLowLimValues(tree, root) {\n  if (arguments.length < 2) {\n    root = tree.nodes()[0];\n  }\n  dfsAssignLowLim(tree, {}, 1, root);\n}\n\nfunction dfsAssignLowLim(tree, visited, nextLim, v, parent) {\n  var low = nextLim;\n  var label = tree.node(v);\n\n  visited[v] = true;\n  tree.neighbors(v).forEach(w => {\n    if (!Object.hasOwn(visited, w)) {\n      nextLim = dfsAssignLowLim(tree, visited, nextLim, w, v);\n    }\n  });\n\n  label.low = low;\n  label.lim = nextLim++;\n  if (parent) {\n    label.parent = parent;\n  } else {\n    // TODO should be able to remove this when we incrementally update low lim\n    delete label.parent;\n  }\n\n  return nextLim;\n}\n\nfunction leaveEdge(tree) {\n  return tree.edges().find(e => tree.edge(e).cutvalue < 0);\n}\n\nfunction enterEdge(t, g, edge) {\n  var v = edge.v;\n  var w = edge.w;\n\n  // For the rest of this function we assume that v is the tail and w is the\n  // head, so if we don't have this edge in the graph we should flip it to\n  // match the correct orientation.\n  if (!g.hasEdge(v, w)) {\n    v = edge.w;\n    w = edge.v;\n  }\n\n  var vLabel = t.node(v);\n  var wLabel = t.node(w);\n  var tailLabel = vLabel;\n  var flip = false;\n\n  // If the root is in the tail of the edge then we need to flip the logic that\n  // checks for the head and tail nodes in the candidates function below.\n  if (vLabel.lim > wLabel.lim) {\n    tailLabel = wLabel;\n    flip = true;\n  }\n\n  var candidates = g.edges().filter(edge => {\n    return flip === isDescendant(t, t.node(edge.v), tailLabel) &&\n           flip !== isDescendant(t, t.node(edge.w), tailLabel);\n  });\n\n  return candidates.reduce((acc, edge) => {\n    if (slack(g, edge) < slack(g, acc)) {\n      return edge;\n    }\n\n    return acc;\n  });\n}\n\nfunction exchangeEdges(t, g, e, f) {\n  var v = e.v;\n  var w = e.w;\n  t.removeEdge(v, w);\n  t.setEdge(f.v, f.w, {});\n  initLowLimValues(t);\n  initCutValues(t, g);\n  updateRanks(t, g);\n}\n\nfunction updateRanks(t, g) {\n  var root = t.nodes().find(v => !g.node(v).parent);\n  var vs = preorder(t, root);\n  vs = vs.slice(1);\n  vs.forEach(v => {\n    var parent = t.node(v).parent,\n      edge = g.edge(v, parent),\n      flipped = false;\n\n    if (!edge) {\n      edge = g.edge(parent, v);\n      flipped = true;\n    }\n\n    g.node(v).rank = g.node(parent).rank + (flipped ? edge.minlen : -edge.minlen);\n  });\n}\n\n/*\n * Returns true if the edge is in the tree.\n */\nfunction isTreeEdge(tree, u, v) {\n  return tree.hasEdge(u, v);\n}\n\n/*\n * Returns true if the specified node is descendant of the root node per the\n * assigned low and lim attributes in the tree.\n */\nfunction isDescendant(tree, vLabel, rootLabel) {\n  return rootLabel.low <= vLabel.lim && vLabel.lim <= rootLabel.lim;\n}\n\n},{\"../util\":27,\"./feasible-tree\":23,\"./util\":26,\"@dagrejs/graphlib\":29}],26:[function(require,module,exports){\n\"use strict\";\n\nconst { applyWithChunking } = require(\"../util\");\n\nmodule.exports = {\n  longestPath: longestPath,\n  slack: slack\n};\n\n/*\n * Initializes ranks for the input graph using the longest path algorithm. This\n * algorithm scales well and is fast in practice, it yields rather poor\n * solutions. Nodes are pushed to the lowest layer possible, leaving the bottom\n * ranks wide and leaving edges longer than necessary. However, due to its\n * speed, this algorithm is good for getting an initial ranking that can be fed\n * into other algorithms.\n *\n * This algorithm does not normalize layers because it will be used by other\n * algorithms in most cases. If using this algorithm directly, be sure to\n * run normalize at the end.\n *\n * Pre-conditions:\n *\n *    1. Input graph is a DAG.\n *    2. Input graph node labels can be assigned properties.\n *\n * Post-conditions:\n *\n *    1. Each node will be assign an (unnormalized) \"rank\" property.\n */\nfunction longestPath(g) {\n  var visited = {};\n\n  function dfs(v) {\n    var label = g.node(v);\n    if (Object.hasOwn(visited, v)) {\n      return label.rank;\n    }\n    visited[v] = true;\n\n    let outEdgesMinLens = g.outEdges(v).map(e => {\n      if (e == null) {\n        return Number.POSITIVE_INFINITY;\n      }\n\n      return dfs(e.w) - g.edge(e).minlen;\n    });\n\n    var rank = applyWithChunking(Math.min, outEdgesMinLens);\n\n    if (rank === Number.POSITIVE_INFINITY) {\n      rank = 0;\n    }\n\n    return (label.rank = rank);\n  }\n\n  g.sources().forEach(dfs);\n}\n\n/*\n * Returns the amount of slack for the given edge. The slack is defined as the\n * difference between the length of the edge and its minimum length.\n */\nfunction slack(g, e) {\n  return g.node(e.w).rank - g.node(e.v).rank - g.edge(e).minlen;\n}\n\n},{\"../util\":27}],27:[function(require,module,exports){\n/* eslint \"no-console\": off */\n\n\"use strict\";\n\nlet Graph = require(\"@dagrejs/graphlib\").Graph;\n\nmodule.exports = {\n  addBorderNode,\n  addDummyNode,\n  applyWithChunking,\n  asNonCompoundGraph,\n  buildLayerMatrix,\n  intersectRect,\n  mapValues,\n  maxRank,\n  normalizeRanks,\n  notime,\n  partition,\n  pick,\n  predecessorWeights,\n  range,\n  removeEmptyRanks,\n  simplify,\n  successorWeights,\n  time,\n  uniqueId,\n  zipObject,\n};\n\n/*\n * Adds a dummy node to the graph and return v.\n */\nfunction addDummyNode(g, type, attrs, name) {\n  var v = name;\n  while (g.hasNode(v)) {\n    v = uniqueId(name);\n  }\n\n  attrs.dummy = type;\n  g.setNode(v, attrs);\n  return v;\n}\n\n/*\n * Returns a new graph with only simple edges. Handles aggregation of data\n * associated with multi-edges.\n */\nfunction simplify(g) {\n  let simplified = new Graph().setGraph(g.graph());\n  g.nodes().forEach(v => simplified.setNode(v, g.node(v)));\n  g.edges().forEach(e => {\n    let simpleLabel = simplified.edge(e.v, e.w) || { weight: 0, minlen: 1 };\n    let label = g.edge(e);\n    simplified.setEdge(e.v, e.w, {\n      weight: simpleLabel.weight + label.weight,\n      minlen: Math.max(simpleLabel.minlen, label.minlen)\n    });\n  });\n  return simplified;\n}\n\nfunction asNonCompoundGraph(g) {\n  let simplified = new Graph({ multigraph: g.isMultigraph() }).setGraph(g.graph());\n  g.nodes().forEach(v => {\n    if (!g.children(v).length) {\n      simplified.setNode(v, g.node(v));\n    }\n  });\n  g.edges().forEach(e => {\n    simplified.setEdge(e, g.edge(e));\n  });\n  return simplified;\n}\n\nfunction successorWeights(g) {\n  let weightMap = g.nodes().map(v => {\n    let sucs = {};\n    g.outEdges(v).forEach(e => {\n      sucs[e.w] = (sucs[e.w] || 0) + g.edge(e).weight;\n    });\n    return sucs;\n  });\n  return zipObject(g.nodes(), weightMap);\n}\n\nfunction predecessorWeights(g) {\n  let weightMap = g.nodes().map(v => {\n    let preds = {};\n    g.inEdges(v).forEach(e => {\n      preds[e.v] = (preds[e.v] || 0) + g.edge(e).weight;\n    });\n    return preds;\n  });\n  return zipObject(g.nodes(), weightMap);\n}\n\n/*\n * Finds where a line starting at point ({x, y}) would intersect a rectangle\n * ({x, y, width, height}) if it were pointing at the rectangle's center.\n */\nfunction intersectRect(rect, point) {\n  let x = rect.x;\n  let y = rect.y;\n\n  // Rectangle intersection algorithm from:\n  // http://math.stackexchange.com/questions/108113/find-edge-between-two-boxes\n  let dx = point.x - x;\n  let dy = point.y - y;\n  let w = rect.width / 2;\n  let h = rect.height / 2;\n\n  if (!dx && !dy) {\n    throw new Error(\"Not possible to find intersection inside of the rectangle\");\n  }\n\n  let sx, sy;\n  if (Math.abs(dy) * w > Math.abs(dx) * h) {\n    // Intersection is top or bottom of rect.\n    if (dy < 0) {\n      h = -h;\n    }\n    sx = h * dx / dy;\n    sy = h;\n  } else {\n    // Intersection is left or right of rect.\n    if (dx < 0) {\n      w = -w;\n    }\n    sx = w;\n    sy = w * dy / dx;\n  }\n\n  return { x: x + sx, y: y + sy };\n}\n\n/*\n * Given a DAG with each node assigned \"rank\" and \"order\" properties, this\n * function will produce a matrix with the ids of each node.\n */\nfunction buildLayerMatrix(g) {\n  let layering = range(maxRank(g) + 1).map(() => []);\n  g.nodes().forEach(v => {\n    let node = g.node(v);\n    let rank = node.rank;\n    if (rank !== undefined) {\n      layering[rank][node.order] = v;\n    }\n  });\n  return layering;\n}\n\n/*\n * Adjusts the ranks for all nodes in the graph such that all nodes v have\n * rank(v) >= 0 and at least one node w has rank(w) = 0.\n */\nfunction normalizeRanks(g) {\n  let nodeRanks = g.nodes().map(v => {\n    let rank = g.node(v).rank;\n    if (rank === undefined) {\n      return Number.MAX_VALUE;\n    }\n\n    return rank;\n  });\n  let min = applyWithChunking(Math.min, nodeRanks);\n  g.nodes().forEach(v => {\n    let node = g.node(v);\n    if (Object.hasOwn(node, \"rank\")) {\n      node.rank -= min;\n    }\n  });\n}\n\nfunction removeEmptyRanks(g) {\n  // Ranks may not start at 0, so we need to offset them\n  let nodeRanks = g.nodes().map(v => g.node(v).rank);\n  let offset = applyWithChunking(Math.min, nodeRanks);\n\n  let layers = [];\n  g.nodes().forEach(v => {\n    let rank = g.node(v).rank - offset;\n    if (!layers[rank]) {\n      layers[rank] = [];\n    }\n    layers[rank].push(v);\n  });\n\n  let delta = 0;\n  let nodeRankFactor = g.graph().nodeRankFactor;\n  Array.from(layers).forEach((vs, i) => {\n    if (vs === undefined && i % nodeRankFactor !== 0) {\n      --delta;\n    } else if (vs !== undefined && delta) {\n      vs.forEach(v => g.node(v).rank += delta);\n    }\n  });\n}\n\nfunction addBorderNode(g, prefix, rank, order) {\n  let node = {\n    width: 0,\n    height: 0\n  };\n  if (arguments.length >= 4) {\n    node.rank = rank;\n    node.order = order;\n  }\n  return addDummyNode(g, \"border\", node, prefix);\n}\n\nfunction splitToChunks(array, chunkSize = CHUNKING_THRESHOLD) {\n  const chunks = [];\n  for (let i = 0; i < array.length; i += chunkSize) {\n    const chunk = array.slice(i, i + chunkSize);\n    chunks.push(chunk);\n  }\n  return chunks;\n}\n\nconst CHUNKING_THRESHOLD = 65535;\n\nfunction applyWithChunking(fn, argsArray) {\n  if(argsArray.length > CHUNKING_THRESHOLD) {\n    const chunks = splitToChunks(argsArray);\n    return fn.apply(null, chunks.map(chunk => fn.apply(null, chunk)));\n  } else {\n    return fn.apply(null, argsArray);\n  }\n}\n\nfunction maxRank(g) {\n  const nodes = g.nodes();\n  const nodeRanks = nodes.map(v => {\n    let rank = g.node(v).rank;\n    if (rank === undefined) {\n      return Number.MIN_VALUE;\n    }\n    return rank;\n  });\n\n  return applyWithChunking(Math.max, nodeRanks);\n}\n\n/*\n * Partition a collection into two groups: `lhs` and `rhs`. If the supplied\n * function returns true for an entry it goes into `lhs`. Otherwise it goes\n * into `rhs.\n */\nfunction partition(collection, fn) {\n  let result = { lhs: [], rhs: [] };\n  collection.forEach(value => {\n    if (fn(value)) {\n      result.lhs.push(value);\n    } else {\n      result.rhs.push(value);\n    }\n  });\n  return result;\n}\n\n/*\n * Returns a new function that wraps `fn` with a timer. The wrapper logs the\n * time it takes to execute the function.\n */\nfunction time(name, fn) {\n  let start = Date.now();\n  try {\n    return fn();\n  } finally {\n    console.log(name + \" time: \" + (Date.now() - start) + \"ms\");\n  }\n}\n\nfunction notime(name, fn) {\n  return fn();\n}\n\nlet idCounter = 0;\nfunction uniqueId(prefix) {\n  var id = ++idCounter;\n  return prefix + (\"\" + id);\n}\n\nfunction range(start, limit, step = 1) {\n  if (limit == null) {\n    limit = start;\n    start = 0;\n  }\n\n  let endCon = (i) => i < limit;\n  if (step < 0) {\n    endCon = (i) => limit < i;\n  }\n\n  const range = [];\n  for (let i = start; endCon(i); i += step) {\n    range.push(i);\n  }\n\n  return range;\n}\n\nfunction pick(source, keys) {\n  const dest = {};\n  for (const key of keys) {\n    if (source[key] !== undefined) {\n      dest[key] = source[key];\n    }\n  }\n\n  return dest;\n}\n\nfunction mapValues(obj, funcOrProp) {\n  let func = funcOrProp;\n  if (typeof funcOrProp === 'string') {\n    func = (val) => val[funcOrProp];\n  }\n\n  return Object.entries(obj).reduce((acc, [k, v]) => {\n    acc[k] = func(v, k);\n    return acc;\n  }, {});\n}\n\nfunction zipObject(props, values) {\n  return props.reduce((acc, key, i) => {\n    acc[key] = values[i];\n    return acc;\n  }, {});\n}\n\n},{\"@dagrejs/graphlib\":29}],28:[function(require,module,exports){\nmodule.exports = \"1.1.8\";\n\n},{}],29:[function(require,module,exports){\n/**\n * Copyright (c) 2014, Chris Pettitt\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n * list of conditions and the following disclaimer.\n *\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n * this list of conditions and the following disclaimer in the documentation\n * and/or other materials provided with the distribution.\n *\n * 3. Neither the name of the copyright holder nor the names of its contributors\n * may be used to endorse or promote products derived from this software without\n * specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nvar lib = require(\"./lib\");\n\nmodule.exports = {\n  Graph: lib.Graph,\n  json: require(\"./lib/json\"),\n  alg: require(\"./lib/alg\"),\n  version: lib.version\n};\n\n},{\"./lib\":45,\"./lib/alg\":36,\"./lib/json\":46}],30:[function(require,module,exports){\nmodule.exports = components;\n\nfunction components(g) {\n  var visited = {};\n  var cmpts = [];\n  var cmpt;\n\n  function dfs(v) {\n    if (Object.hasOwn(visited, v)) return;\n    visited[v] = true;\n    cmpt.push(v);\n    g.successors(v).forEach(dfs);\n    g.predecessors(v).forEach(dfs);\n  }\n\n  g.nodes().forEach(function(v) {\n    cmpt = [];\n    dfs(v);\n    if (cmpt.length) {\n      cmpts.push(cmpt);\n    }\n  });\n\n  return cmpts;\n}\n\n},{}],31:[function(require,module,exports){\nmodule.exports = dfs;\n\n/*\n * A helper that preforms a pre- or post-order traversal on the input graph\n * and returns the nodes in the order they were visited. If the graph is\n * undirected then this algorithm will navigate using neighbors. If the graph\n * is directed then this algorithm will navigate using successors.\n *\n * If the order is not \"post\", it will be treated as \"pre\".\n */\nfunction dfs(g, vs, order) {\n  if (!Array.isArray(vs)) {\n    vs = [vs];\n  }\n\n  var navigation = g.isDirected() ? v => g.successors(v) : v => g.neighbors(v);\n  var orderFunc = order === \"post\" ? postOrderDfs : preOrderDfs;\n\n  var acc = [];\n  var visited = {};\n  vs.forEach(v => {\n    if (!g.hasNode(v)) {\n      throw new Error(\"Graph does not have node: \" + v);\n    }\n\n    orderFunc(v, navigation, visited, acc);\n  });\n\n  return acc;\n}\n\nfunction postOrderDfs(v, navigation, visited, acc) {\n  var stack = [[v, false]];\n  while (stack.length > 0) {\n    var curr = stack.pop();\n    if (curr[1]) {\n      acc.push(curr[0]);\n    } else {\n      if (!Object.hasOwn(visited, curr[0])) {\n        visited[curr[0]] = true;\n        stack.push([curr[0], true]);\n        forEachRight(navigation(curr[0]), w => stack.push([w, false]));\n      }\n    }\n  }\n}\n\nfunction preOrderDfs(v, navigation, visited, acc) {\n  var stack = [v];\n  while (stack.length > 0) {\n    var curr = stack.pop();\n    if (!Object.hasOwn(visited, curr)) {\n      visited[curr] = true;\n      acc.push(curr);\n      forEachRight(navigation(curr), w => stack.push(w));\n    }\n  }\n}\n\nfunction forEachRight(array, iteratee) {\n  var length = array.length;\n  while (length--) {\n    iteratee(array[length], length, array);\n  }\n\n  return array;\n}\n\n},{}],32:[function(require,module,exports){\nvar dijkstra = require(\"./dijkstra\");\n\nmodule.exports = dijkstraAll;\n\nfunction dijkstraAll(g, weightFunc, edgeFunc) {\n  return g.nodes().reduce(function(acc, v) {\n    acc[v] = dijkstra(g, v, weightFunc, edgeFunc);\n    return acc;\n  }, {});\n}\n\n},{\"./dijkstra\":33}],33:[function(require,module,exports){\nvar PriorityQueue = require(\"../data/priority-queue\");\n\nmodule.exports = dijkstra;\n\nvar DEFAULT_WEIGHT_FUNC = () => 1;\n\nfunction dijkstra(g, source, weightFn, edgeFn) {\n  return runDijkstra(g, String(source),\n    weightFn || DEFAULT_WEIGHT_FUNC,\n    edgeFn || function(v) { return g.outEdges(v); });\n}\n\nfunction runDijkstra(g, source, weightFn, edgeFn) {\n  var results = {};\n  var pq = new PriorityQueue();\n  var v, vEntry;\n\n  var updateNeighbors = function(edge) {\n    var w = edge.v !== v ? edge.v : edge.w;\n    var wEntry = results[w];\n    var weight = weightFn(edge);\n    var distance = vEntry.distance + weight;\n\n    if (weight < 0) {\n      throw new Error(\"dijkstra does not allow negative edge weights. \" +\n                      \"Bad edge: \" + edge + \" Weight: \" + weight);\n    }\n\n    if (distance < wEntry.distance) {\n      wEntry.distance = distance;\n      wEntry.predecessor = v;\n      pq.decrease(w, distance);\n    }\n  };\n\n  g.nodes().forEach(function(v) {\n    var distance = v === source ? 0 : Number.POSITIVE_INFINITY;\n    results[v] = { distance: distance };\n    pq.add(v, distance);\n  });\n\n  while (pq.size() > 0) {\n    v = pq.removeMin();\n    vEntry = results[v];\n    if (vEntry.distance === Number.POSITIVE_INFINITY) {\n      break;\n    }\n\n    edgeFn(v).forEach(updateNeighbors);\n  }\n\n  return results;\n}\n\n},{\"../data/priority-queue\":43}],34:[function(require,module,exports){\nvar tarjan = require(\"./tarjan\");\n\nmodule.exports = findCycles;\n\nfunction findCycles(g) {\n  return tarjan(g).filter(function(cmpt) {\n    return cmpt.length > 1 || (cmpt.length === 1 && g.hasEdge(cmpt[0], cmpt[0]));\n  });\n}\n\n},{\"./tarjan\":41}],35:[function(require,module,exports){\nmodule.exports = floydWarshall;\n\nvar DEFAULT_WEIGHT_FUNC = () => 1;\n\nfunction floydWarshall(g, weightFn, edgeFn) {\n  return runFloydWarshall(g,\n    weightFn || DEFAULT_WEIGHT_FUNC,\n    edgeFn || function(v) { return g.outEdges(v); });\n}\n\nfunction runFloydWarshall(g, weightFn, edgeFn) {\n  var results = {};\n  var nodes = g.nodes();\n\n  nodes.forEach(function(v) {\n    results[v] = {};\n    results[v][v] = { distance: 0 };\n    nodes.forEach(function(w) {\n      if (v !== w) {\n        results[v][w] = { distance: Number.POSITIVE_INFINITY };\n      }\n    });\n    edgeFn(v).forEach(function(edge) {\n      var w = edge.v === v ? edge.w : edge.v;\n      var d = weightFn(edge);\n      results[v][w] = { distance: d, predecessor: v };\n    });\n  });\n\n  nodes.forEach(function(k) {\n    var rowK = results[k];\n    nodes.forEach(function(i) {\n      var rowI = results[i];\n      nodes.forEach(function(j) {\n        var ik = rowI[k];\n        var kj = rowK[j];\n        var ij = rowI[j];\n        var altDistance = ik.distance + kj.distance;\n        if (altDistance < ij.distance) {\n          ij.distance = altDistance;\n          ij.predecessor = kj.predecessor;\n        }\n      });\n    });\n  });\n\n  return results;\n}\n\n},{}],36:[function(require,module,exports){\nmodule.exports = {\n  components: require(\"./components\"),\n  dijkstra: require(\"./dijkstra\"),\n  dijkstraAll: require(\"./dijkstra-all\"),\n  findCycles: require(\"./find-cycles\"),\n  floydWarshall: require(\"./floyd-warshall\"),\n  isAcyclic: require(\"./is-acyclic\"),\n  postorder: require(\"./postorder\"),\n  preorder: require(\"./preorder\"),\n  prim: require(\"./prim\"),\n  tarjan: require(\"./tarjan\"),\n  topsort: require(\"./topsort\")\n};\n\n},{\"./components\":30,\"./dijkstra\":33,\"./dijkstra-all\":32,\"./find-cycles\":34,\"./floyd-warshall\":35,\"./is-acyclic\":37,\"./postorder\":38,\"./preorder\":39,\"./prim\":40,\"./tarjan\":41,\"./topsort\":42}],37:[function(require,module,exports){\nvar topsort = require(\"./topsort\");\n\nmodule.exports = isAcyclic;\n\nfunction isAcyclic(g) {\n  try {\n    topsort(g);\n  } catch (e) {\n    if (e instanceof topsort.CycleException) {\n      return false;\n    }\n    throw e;\n  }\n  return true;\n}\n\n},{\"./topsort\":42}],38:[function(require,module,exports){\nvar dfs = require(\"./dfs\");\n\nmodule.exports = postorder;\n\nfunction postorder(g, vs) {\n  return dfs(g, vs, \"post\");\n}\n\n},{\"./dfs\":31}],39:[function(require,module,exports){\nvar dfs = require(\"./dfs\");\n\nmodule.exports = preorder;\n\nfunction preorder(g, vs) {\n  return dfs(g, vs, \"pre\");\n}\n\n},{\"./dfs\":31}],40:[function(require,module,exports){\nvar Graph = require(\"../graph\");\nvar PriorityQueue = require(\"../data/priority-queue\");\n\nmodule.exports = prim;\n\nfunction prim(g, weightFunc) {\n  var result = new Graph();\n  var parents = {};\n  var pq = new PriorityQueue();\n  var v;\n\n  function updateNeighbors(edge) {\n    var w = edge.v === v ? edge.w : edge.v;\n    var pri = pq.priority(w);\n    if (pri !== undefined) {\n      var edgeWeight = weightFunc(edge);\n      if (edgeWeight < pri) {\n        parents[w] = v;\n        pq.decrease(w, edgeWeight);\n      }\n    }\n  }\n\n  if (g.nodeCount() === 0) {\n    return result;\n  }\n\n  g.nodes().forEach(function(v) {\n    pq.add(v, Number.POSITIVE_INFINITY);\n    result.setNode(v);\n  });\n\n  // Start from an arbitrary node\n  pq.decrease(g.nodes()[0], 0);\n\n  var init = false;\n  while (pq.size() > 0) {\n    v = pq.removeMin();\n    if (Object.hasOwn(parents, v)) {\n      result.setEdge(v, parents[v]);\n    } else if (init) {\n      throw new Error(\"Input graph is not connected: \" + g);\n    } else {\n      init = true;\n    }\n\n    g.nodeEdges(v).forEach(updateNeighbors);\n  }\n\n  return result;\n}\n\n},{\"../data/priority-queue\":43,\"../graph\":44}],41:[function(require,module,exports){\nmodule.exports = tarjan;\n\nfunction tarjan(g) {\n  var index = 0;\n  var stack = [];\n  var visited = {}; // node id -> { onStack, lowlink, index }\n  var results = [];\n\n  function dfs(v) {\n    var entry = visited[v] = {\n      onStack: true,\n      lowlink: index,\n      index: index++\n    };\n    stack.push(v);\n\n    g.successors(v).forEach(function(w) {\n      if (!Object.hasOwn(visited, w)) {\n        dfs(w);\n        entry.lowlink = Math.min(entry.lowlink, visited[w].lowlink);\n      } else if (visited[w].onStack) {\n        entry.lowlink = Math.min(entry.lowlink, visited[w].index);\n      }\n    });\n\n    if (entry.lowlink === entry.index) {\n      var cmpt = [];\n      var w;\n      do {\n        w = stack.pop();\n        visited[w].onStack = false;\n        cmpt.push(w);\n      } while (v !== w);\n      results.push(cmpt);\n    }\n  }\n\n  g.nodes().forEach(function(v) {\n    if (!Object.hasOwn(visited, v)) {\n      dfs(v);\n    }\n  });\n\n  return results;\n}\n\n},{}],42:[function(require,module,exports){\nfunction topsort(g) {\n  var visited = {};\n  var stack = {};\n  var results = [];\n\n  function visit(node) {\n    if (Object.hasOwn(stack, node)) {\n      throw new CycleException();\n    }\n\n    if (!Object.hasOwn(visited, node)) {\n      stack[node] = true;\n      visited[node] = true;\n      g.predecessors(node).forEach(visit);\n      delete stack[node];\n      results.push(node);\n    }\n  }\n\n  g.sinks().forEach(visit);\n\n  if (Object.keys(visited).length !== g.nodeCount()) {\n    throw new CycleException();\n  }\n\n  return results;\n}\n\nclass CycleException extends Error {\n  constructor() {\n    super(...arguments);\n  }\n}\n\nmodule.exports = topsort;\ntopsort.CycleException = CycleException;\n\n},{}],43:[function(require,module,exports){\n/**\n * A min-priority queue data structure. This algorithm is derived from Cormen,\n * et al., \"Introduction to Algorithms\". The basic idea of a min-priority\n * queue is that you can efficiently (in O(1) time) get the smallest key in\n * the queue. Adding and removing elements takes O(log n) time. A key can\n * have its priority decreased in O(log n) time.\n */\nclass PriorityQueue {\n  _arr = [];\n  _keyIndices = {};\n\n  /**\n   * Returns the number of elements in the queue. Takes `O(1)` time.\n   */\n  size() {\n    return this._arr.length;\n  }\n\n  /**\n   * Returns the keys that are in the queue. Takes `O(n)` time.\n   */\n  keys() {\n    return this._arr.map(function(x) { return x.key; });\n  }\n\n  /**\n   * Returns `true` if **key** is in the queue and `false` if not.\n   */\n  has(key) {\n    return Object.hasOwn(this._keyIndices, key);\n  }\n\n  /**\n   * Returns the priority for **key**. If **key** is not present in the queue\n   * then this function returns `undefined`. Takes `O(1)` time.\n   *\n   * @param {Object} key\n   */\n  priority(key) {\n    var index = this._keyIndices[key];\n    if (index !== undefined) {\n      return this._arr[index].priority;\n    }\n  }\n\n  /**\n   * Returns the key for the minimum element in this queue. If the queue is\n   * empty this function throws an Error. Takes `O(1)` time.\n   */\n  min() {\n    if (this.size() === 0) {\n      throw new Error(\"Queue underflow\");\n    }\n    return this._arr[0].key;\n  }\n\n  /**\n   * Inserts a new key into the priority queue. If the key already exists in\n   * the queue this function returns `false`; otherwise it will return `true`.\n   * Takes `O(n)` time.\n   *\n   * @param {Object} key the key to add\n   * @param {Number} priority the initial priority for the key\n   */\n  add(key, priority) {\n    var keyIndices = this._keyIndices;\n    key = String(key);\n    if (!Object.hasOwn(keyIndices, key)) {\n      var arr = this._arr;\n      var index = arr.length;\n      keyIndices[key] = index;\n      arr.push({key: key, priority: priority});\n      this._decrease(index);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Removes and returns the smallest key in the queue. Takes `O(log n)` time.\n   */\n  removeMin() {\n    this._swap(0, this._arr.length - 1);\n    var min = this._arr.pop();\n    delete this._keyIndices[min.key];\n    this._heapify(0);\n    return min.key;\n  }\n\n  /**\n   * Decreases the priority for **key** to **priority**. If the new priority is\n   * greater than the previous priority, this function will throw an Error.\n   *\n   * @param {Object} key the key for which to raise priority\n   * @param {Number} priority the new priority for the key\n   */\n  decrease(key, priority) {\n    var index = this._keyIndices[key];\n    if (priority > this._arr[index].priority) {\n      throw new Error(\"New priority is greater than current priority. \" +\n          \"Key: \" + key + \" Old: \" + this._arr[index].priority + \" New: \" + priority);\n    }\n    this._arr[index].priority = priority;\n    this._decrease(index);\n  }\n\n  _heapify(i) {\n    var arr = this._arr;\n    var l = 2 * i;\n    var r = l + 1;\n    var largest = i;\n    if (l < arr.length) {\n      largest = arr[l].priority < arr[largest].priority ? l : largest;\n      if (r < arr.length) {\n        largest = arr[r].priority < arr[largest].priority ? r : largest;\n      }\n      if (largest !== i) {\n        this._swap(i, largest);\n        this._heapify(largest);\n      }\n    }\n  }\n\n  _decrease(index) {\n    var arr = this._arr;\n    var priority = arr[index].priority;\n    var parent;\n    while (index !== 0) {\n      parent = index >> 1;\n      if (arr[parent].priority < priority) {\n        break;\n      }\n      this._swap(index, parent);\n      index = parent;\n    }\n  }\n\n  _swap(i, j) {\n    var arr = this._arr;\n    var keyIndices = this._keyIndices;\n    var origArrI = arr[i];\n    var origArrJ = arr[j];\n    arr[i] = origArrJ;\n    arr[j] = origArrI;\n    keyIndices[origArrJ.key] = i;\n    keyIndices[origArrI.key] = j;\n  }\n}\n\nmodule.exports = PriorityQueue;\n\n},{}],44:[function(require,module,exports){\n\"use strict\";\n\nvar DEFAULT_EDGE_NAME = \"\\x00\";\nvar GRAPH_NODE = \"\\x00\";\nvar EDGE_KEY_DELIM = \"\\x01\";\n\n// Implementation notes:\n//\n//  * Node id query functions should return string ids for the nodes\n//  * Edge id query functions should return an \"edgeObj\", edge object, that is\n//    composed of enough information to uniquely identify an edge: {v, w, name}.\n//  * Internally we use an \"edgeId\", a stringified form of the edgeObj, to\n//    reference edges. This is because we need a performant way to look these\n//    edges up and, object properties, which have string keys, are the closest\n//    we're going to get to a performant hashtable in JavaScript.\n\nclass Graph {\n  _isDirected = true;\n  _isMultigraph = false;\n  _isCompound = false;\n\n  // Label for the graph itself\n  _label;\n\n  // Defaults to be set when creating a new node\n  _defaultNodeLabelFn = () => undefined;\n\n  // Defaults to be set when creating a new edge\n  _defaultEdgeLabelFn = () => undefined;\n\n  // v -> label\n  _nodes = {};\n\n  // v -> edgeObj\n  _in = {};\n\n  // u -> v -> Number\n  _preds = {};\n\n  // v -> edgeObj\n  _out = {};\n\n  // v -> w -> Number\n  _sucs = {};\n\n  // e -> edgeObj\n  _edgeObjs = {};\n\n  // e -> label\n  _edgeLabels = {};\n\n  /* Number of nodes in the graph. Should only be changed by the implementation. */\n  _nodeCount = 0;\n\n  /* Number of edges in the graph. Should only be changed by the implementation. */\n  _edgeCount = 0;\n\n  _parent;\n\n  _children;\n\n  constructor(opts) {\n    if (opts) {\n      this._isDirected = Object.hasOwn(opts, \"directed\") ? opts.directed : true;\n      this._isMultigraph = Object.hasOwn(opts, \"multigraph\") ? opts.multigraph : false;\n      this._isCompound = Object.hasOwn(opts, \"compound\") ? opts.compound : false;\n    }\n\n    if (this._isCompound) {\n      // v -> parent\n      this._parent = {};\n\n      // v -> children\n      this._children = {};\n      this._children[GRAPH_NODE] = {};\n    }\n  }\n\n  /* === Graph functions ========= */\n\n  /**\n   * Whether graph was created with 'directed' flag set to true or not.\n   */\n  isDirected() {\n    return this._isDirected;\n  }\n\n  /**\n   * Whether graph was created with 'multigraph' flag set to true or not.\n   */\n  isMultigraph() {\n    return this._isMultigraph;\n  }\n\n  /**\n   * Whether graph was created with 'compound' flag set to true or not.\n   */\n  isCompound() {\n    return this._isCompound;\n  }\n\n  /**\n   * Sets the label of the graph.\n   */\n  setGraph(label) {\n    this._label = label;\n    return this;\n  }\n\n  /**\n   * Gets the graph label.\n   */\n  graph() {\n    return this._label;\n  }\n\n\n  /* === Node functions ========== */\n\n  /**\n   * Sets the default node label. If newDefault is a function, it will be\n   * invoked ach time when setting a label for a node. Otherwise, this label\n   * will be assigned as default label in case if no label was specified while\n   * setting a node.\n   * Complexity: O(1).\n   */\n  setDefaultNodeLabel(newDefault) {\n    this._defaultNodeLabelFn = newDefault;\n    if (typeof newDefault !== 'function') {\n      this._defaultNodeLabelFn = () => newDefault;\n    }\n\n    return this;\n  }\n\n  /**\n   * Gets the number of nodes in the graph.\n   * Complexity: O(1).\n   */\n  nodeCount() {\n    return this._nodeCount;\n  }\n\n  /**\n   * Gets all nodes of the graph. Note, the in case of compound graph subnodes are\n   * not included in list.\n   * Complexity: O(1).\n   */\n  nodes() {\n    return Object.keys(this._nodes);\n  }\n\n  /**\n   * Gets list of nodes without in-edges.\n   * Complexity: O(|V|).\n   */\n  sources() {\n    var self = this;\n    return this.nodes().filter(v => Object.keys(self._in[v]).length === 0);\n  }\n\n  /**\n   * Gets list of nodes without out-edges.\n   * Complexity: O(|V|).\n   */\n  sinks() {\n    var self = this;\n    return this.nodes().filter(v => Object.keys(self._out[v]).length === 0);\n  }\n\n  /**\n   * Invokes setNode method for each node in names list.\n   * Complexity: O(|names|).\n   */\n  setNodes(vs, value) {\n    var args = arguments;\n    var self = this;\n    vs.forEach(function(v) {\n      if (args.length > 1) {\n        self.setNode(v, value);\n      } else {\n        self.setNode(v);\n      }\n    });\n    return this;\n  }\n\n  /**\n   * Creates or updates the value for the node v in the graph. If label is supplied\n   * it is set as the value for the node. If label is not supplied and the node was\n   * created by this call then the default node label will be assigned.\n   * Complexity: O(1).\n   */\n  setNode(v, value) {\n    if (Object.hasOwn(this._nodes, v)) {\n      if (arguments.length > 1) {\n        this._nodes[v] = value;\n      }\n      return this;\n    }\n\n    this._nodes[v] = arguments.length > 1 ? value : this._defaultNodeLabelFn(v);\n    if (this._isCompound) {\n      this._parent[v] = GRAPH_NODE;\n      this._children[v] = {};\n      this._children[GRAPH_NODE][v] = true;\n    }\n    this._in[v] = {};\n    this._preds[v] = {};\n    this._out[v] = {};\n    this._sucs[v] = {};\n    ++this._nodeCount;\n    return this;\n  }\n\n  /**\n   * Gets the label of node with specified name.\n   * Complexity: O(|V|).\n   */\n  node(v) {\n    return this._nodes[v];\n  }\n\n  /**\n   * Detects whether graph has a node with specified name or not.\n   */\n  hasNode(v) {\n    return Object.hasOwn(this._nodes, v);\n  }\n\n  /**\n   * Remove the node with the name from the graph or do nothing if the node is not in\n   * the graph. If the node was removed this function also removes any incident\n   * edges.\n   * Complexity: O(1).\n   */\n  removeNode(v) {\n    var self = this;\n    if (Object.hasOwn(this._nodes, v)) {\n      var removeEdge = e => self.removeEdge(self._edgeObjs[e]);\n      delete this._nodes[v];\n      if (this._isCompound) {\n        this._removeFromParentsChildList(v);\n        delete this._parent[v];\n        this.children(v).forEach(function(child) {\n          self.setParent(child);\n        });\n        delete this._children[v];\n      }\n      Object.keys(this._in[v]).forEach(removeEdge);\n      delete this._in[v];\n      delete this._preds[v];\n      Object.keys(this._out[v]).forEach(removeEdge);\n      delete this._out[v];\n      delete this._sucs[v];\n      --this._nodeCount;\n    }\n    return this;\n  }\n\n  /**\n   * Sets node p as a parent for node v if it is defined, or removes the\n   * parent for v if p is undefined. Method throws an exception in case of\n   * invoking it in context of noncompound graph.\n   * Average-case complexity: O(1).\n   */\n  setParent(v, parent) {\n    if (!this._isCompound) {\n      throw new Error(\"Cannot set parent in a non-compound graph\");\n    }\n\n    if (parent === undefined) {\n      parent = GRAPH_NODE;\n    } else {\n      // Coerce parent to string\n      parent += \"\";\n      for (var ancestor = parent; ancestor !== undefined; ancestor = this.parent(ancestor)) {\n        if (ancestor === v) {\n          throw new Error(\"Setting \" + parent+ \" as parent of \" + v +\n              \" would create a cycle\");\n        }\n      }\n\n      this.setNode(parent);\n    }\n\n    this.setNode(v);\n    this._removeFromParentsChildList(v);\n    this._parent[v] = parent;\n    this._children[parent][v] = true;\n    return this;\n  }\n\n  _removeFromParentsChildList(v) {\n    delete this._children[this._parent[v]][v];\n  }\n\n  /**\n   * Gets parent node for node v.\n   * Complexity: O(1).\n   */\n  parent(v) {\n    if (this._isCompound) {\n      var parent = this._parent[v];\n      if (parent !== GRAPH_NODE) {\n        return parent;\n      }\n    }\n  }\n\n  /**\n   * Gets list of direct children of node v.\n   * Complexity: O(1).\n   */\n  children(v = GRAPH_NODE) {\n    if (this._isCompound) {\n      var children = this._children[v];\n      if (children) {\n        return Object.keys(children);\n      }\n    } else if (v === GRAPH_NODE) {\n      return this.nodes();\n    } else if (this.hasNode(v)) {\n      return [];\n    }\n  }\n\n  /**\n   * Return all nodes that are predecessors of the specified node or undefined if node v is not in\n   * the graph. Behavior is undefined for undirected graphs - use neighbors instead.\n   * Complexity: O(|V|).\n   */\n  predecessors(v) {\n    var predsV = this._preds[v];\n    if (predsV) {\n      return Object.keys(predsV);\n    }\n  }\n\n  /**\n   * Return all nodes that are successors of the specified node or undefined if node v is not in\n   * the graph. Behavior is undefined for undirected graphs - use neighbors instead.\n   * Complexity: O(|V|).\n   */\n  successors(v) {\n    var sucsV = this._sucs[v];\n    if (sucsV) {\n      return Object.keys(sucsV);\n    }\n  }\n\n  /**\n   * Return all nodes that are predecessors or successors of the specified node or undefined if\n   * node v is not in the graph.\n   * Complexity: O(|V|).\n   */\n  neighbors(v) {\n    var preds = this.predecessors(v);\n    if (preds) {\n      const union = new Set(preds);\n      for (var succ of this.successors(v)) {\n        union.add(succ);\n      }\n\n      return Array.from(union.values());\n    }\n  }\n\n  isLeaf(v) {\n    var neighbors;\n    if (this.isDirected()) {\n      neighbors = this.successors(v);\n    } else {\n      neighbors = this.neighbors(v);\n    }\n    return neighbors.length === 0;\n  }\n\n  /**\n   * Creates new graph with nodes filtered via filter. Edges incident to rejected node\n   * are also removed. In case of compound graph, if parent is rejected by filter,\n   * than all its children are rejected too.\n   * Average-case complexity: O(|E|+|V|).\n   */\n  filterNodes(filter) {\n    var copy = new this.constructor({\n      directed: this._isDirected,\n      multigraph: this._isMultigraph,\n      compound: this._isCompound\n    });\n\n    copy.setGraph(this.graph());\n\n    var self = this;\n    Object.entries(this._nodes).forEach(function([v, value]) {\n      if (filter(v)) {\n        copy.setNode(v, value);\n      }\n    });\n\n    Object.values(this._edgeObjs).forEach(function(e) {\n      if (copy.hasNode(e.v) && copy.hasNode(e.w)) {\n        copy.setEdge(e, self.edge(e));\n      }\n    });\n\n    var parents = {};\n    function findParent(v) {\n      var parent = self.parent(v);\n      if (parent === undefined || copy.hasNode(parent)) {\n        parents[v] = parent;\n        return parent;\n      } else if (parent in parents) {\n        return parents[parent];\n      } else {\n        return findParent(parent);\n      }\n    }\n\n    if (this._isCompound) {\n      copy.nodes().forEach(v => copy.setParent(v, findParent(v)));\n    }\n\n    return copy;\n  }\n\n  /* === Edge functions ========== */\n\n  /**\n   * Sets the default edge label or factory function. This label will be\n   * assigned as default label in case if no label was specified while setting\n   * an edge or this function will be invoked each time when setting an edge\n   * with no label specified and returned value * will be used as a label for edge.\n   * Complexity: O(1).\n   */\n  setDefaultEdgeLabel(newDefault) {\n    this._defaultEdgeLabelFn = newDefault;\n    if (typeof newDefault !== 'function') {\n      this._defaultEdgeLabelFn = () => newDefault;\n    }\n\n    return this;\n  }\n\n  /**\n   * Gets the number of edges in the graph.\n   * Complexity: O(1).\n   */\n  edgeCount() {\n    return this._edgeCount;\n  }\n\n  /**\n   * Gets edges of the graph. In case of compound graph subgraphs are not considered.\n   * Complexity: O(|E|).\n   */\n  edges() {\n    return Object.values(this._edgeObjs);\n  }\n\n  /**\n   * Establish an edges path over the nodes in nodes list. If some edge is already\n   * exists, it will update its label, otherwise it will create an edge between pair\n   * of nodes with label provided or default label if no label provided.\n   * Complexity: O(|nodes|).\n   */\n  setPath(vs, value) {\n    var self = this;\n    var args = arguments;\n    vs.reduce(function(v, w) {\n      if (args.length > 1) {\n        self.setEdge(v, w, value);\n      } else {\n        self.setEdge(v, w);\n      }\n      return w;\n    });\n    return this;\n  }\n\n  /**\n   * Creates or updates the label for the edge (v, w) with the optionally supplied\n   * name. If label is supplied it is set as the value for the edge. If label is not\n   * supplied and the edge was created by this call then the default edge label will\n   * be assigned. The name parameter is only useful with multigraphs.\n   */\n  setEdge() {\n    var v, w, name, value;\n    var valueSpecified = false;\n    var arg0 = arguments[0];\n\n    if (typeof arg0 === \"object\" && arg0 !== null && \"v\" in arg0) {\n      v = arg0.v;\n      w = arg0.w;\n      name = arg0.name;\n      if (arguments.length === 2) {\n        value = arguments[1];\n        valueSpecified = true;\n      }\n    } else {\n      v = arg0;\n      w = arguments[1];\n      name = arguments[3];\n      if (arguments.length > 2) {\n        value = arguments[2];\n        valueSpecified = true;\n      }\n    }\n\n    v = \"\" + v;\n    w = \"\" + w;\n    if (name !== undefined) {\n      name = \"\" + name;\n    }\n\n    var e = edgeArgsToId(this._isDirected, v, w, name);\n    if (Object.hasOwn(this._edgeLabels, e)) {\n      if (valueSpecified) {\n        this._edgeLabels[e] = value;\n      }\n      return this;\n    }\n\n    if (name !== undefined && !this._isMultigraph) {\n      throw new Error(\"Cannot set a named edge when isMultigraph = false\");\n    }\n\n    // It didn't exist, so we need to create it.\n    // First ensure the nodes exist.\n    this.setNode(v);\n    this.setNode(w);\n\n    this._edgeLabels[e] = valueSpecified ? value : this._defaultEdgeLabelFn(v, w, name);\n\n    var edgeObj = edgeArgsToObj(this._isDirected, v, w, name);\n    // Ensure we add undirected edges in a consistent way.\n    v = edgeObj.v;\n    w = edgeObj.w;\n\n    Object.freeze(edgeObj);\n    this._edgeObjs[e] = edgeObj;\n    incrementOrInitEntry(this._preds[w], v);\n    incrementOrInitEntry(this._sucs[v], w);\n    this._in[w][e] = edgeObj;\n    this._out[v][e] = edgeObj;\n    this._edgeCount++;\n    return this;\n  }\n\n  /**\n   * Gets the label for the specified edge.\n   * Complexity: O(1).\n   */\n  edge(v, w, name) {\n    var e = (arguments.length === 1\n      ? edgeObjToId(this._isDirected, arguments[0])\n      : edgeArgsToId(this._isDirected, v, w, name));\n    return this._edgeLabels[e];\n  }\n\n  /**\n   * Gets the label for the specified edge and converts it to an object.\n   * Complexity: O(1)\n   */\n  edgeAsObj() {\n    const edge = this.edge(...arguments);\n    if (typeof edge !== \"object\") {\n      return {label: edge};\n    }\n\n    return edge;\n  }\n\n  /**\n   * Detects whether the graph contains specified edge or not. No subgraphs are considered.\n   * Complexity: O(1).\n   */\n  hasEdge(v, w, name) {\n    var e = (arguments.length === 1\n      ? edgeObjToId(this._isDirected, arguments[0])\n      : edgeArgsToId(this._isDirected, v, w, name));\n    return Object.hasOwn(this._edgeLabels, e);\n  }\n\n  /**\n   * Removes the specified edge from the graph. No subgraphs are considered.\n   * Complexity: O(1).\n   */\n  removeEdge(v, w, name) {\n    var e = (arguments.length === 1\n      ? edgeObjToId(this._isDirected, arguments[0])\n      : edgeArgsToId(this._isDirected, v, w, name));\n    var edge = this._edgeObjs[e];\n    if (edge) {\n      v = edge.v;\n      w = edge.w;\n      delete this._edgeLabels[e];\n      delete this._edgeObjs[e];\n      decrementOrRemoveEntry(this._preds[w], v);\n      decrementOrRemoveEntry(this._sucs[v], w);\n      delete this._in[w][e];\n      delete this._out[v][e];\n      this._edgeCount--;\n    }\n    return this;\n  }\n\n  /**\n   * Return all edges that point to the node v. Optionally filters those edges down to just those\n   * coming from node u. Behavior is undefined for undirected graphs - use nodeEdges instead.\n   * Complexity: O(|E|).\n   */\n  inEdges(v, u) {\n    var inV = this._in[v];\n    if (inV) {\n      var edges = Object.values(inV);\n      if (!u) {\n        return edges;\n      }\n      return edges.filter(edge => edge.v === u);\n    }\n  }\n\n  /**\n   * Return all edges that are pointed at by node v. Optionally filters those edges down to just\n   * those point to w. Behavior is undefined for undirected graphs - use nodeEdges instead.\n   * Complexity: O(|E|).\n   */\n  outEdges(v, w) {\n    var outV = this._out[v];\n    if (outV) {\n      var edges = Object.values(outV);\n      if (!w) {\n        return edges;\n      }\n      return edges.filter(edge => edge.w === w);\n    }\n  }\n\n  /**\n   * Returns all edges to or from node v regardless of direction. Optionally filters those edges\n   * down to just those between nodes v and w regardless of direction.\n   * Complexity: O(|E|).\n   */\n  nodeEdges(v, w) {\n    var inEdges = this.inEdges(v, w);\n    if (inEdges) {\n      return inEdges.concat(this.outEdges(v, w));\n    }\n  }\n}\n\nfunction incrementOrInitEntry(map, k) {\n  if (map[k]) {\n    map[k]++;\n  } else {\n    map[k] = 1;\n  }\n}\n\nfunction decrementOrRemoveEntry(map, k) {\n  if (!--map[k]) { delete map[k]; }\n}\n\nfunction edgeArgsToId(isDirected, v_, w_, name) {\n  var v = \"\" + v_;\n  var w = \"\" + w_;\n  if (!isDirected && v > w) {\n    var tmp = v;\n    v = w;\n    w = tmp;\n  }\n  return v + EDGE_KEY_DELIM + w + EDGE_KEY_DELIM +\n             (name === undefined ? DEFAULT_EDGE_NAME : name);\n}\n\nfunction edgeArgsToObj(isDirected, v_, w_, name) {\n  var v = \"\" + v_;\n  var w = \"\" + w_;\n  if (!isDirected && v > w) {\n    var tmp = v;\n    v = w;\n    w = tmp;\n  }\n  var edgeObj =  { v: v, w: w };\n  if (name) {\n    edgeObj.name = name;\n  }\n  return edgeObj;\n}\n\nfunction edgeObjToId(isDirected, edgeObj) {\n  return edgeArgsToId(isDirected, edgeObj.v, edgeObj.w, edgeObj.name);\n}\n\nmodule.exports = Graph;\n\n},{}],45:[function(require,module,exports){\n// Includes only the \"core\" of graphlib\nmodule.exports = {\n  Graph: require(\"./graph\"),\n  version: require(\"./version\")\n};\n\n},{\"./graph\":44,\"./version\":47}],46:[function(require,module,exports){\nvar Graph = require(\"./graph\");\n\nmodule.exports = {\n  write: write,\n  read: read\n};\n\n/**\n * Creates a JSON representation of the graph that can be serialized to a string with\n * JSON.stringify. The graph can later be restored using json.read.\n */\nfunction write(g) {\n  var json = {\n    options: {\n      directed: g.isDirected(),\n      multigraph: g.isMultigraph(),\n      compound: g.isCompound()\n    },\n    nodes: writeNodes(g),\n    edges: writeEdges(g)\n  };\n\n  if (g.graph() !== undefined) {\n    json.value = structuredClone(g.graph());\n  }\n  return json;\n}\n\nfunction writeNodes(g) {\n  return g.nodes().map(function(v) {\n    var nodeValue = g.node(v);\n    var parent = g.parent(v);\n    var node = { v: v };\n    if (nodeValue !== undefined) {\n      node.value = nodeValue;\n    }\n    if (parent !== undefined) {\n      node.parent = parent;\n    }\n    return node;\n  });\n}\n\nfunction writeEdges(g) {\n  return g.edges().map(function(e) {\n    var edgeValue = g.edge(e);\n    var edge = { v: e.v, w: e.w };\n    if (e.name !== undefined) {\n      edge.name = e.name;\n    }\n    if (edgeValue !== undefined) {\n      edge.value = edgeValue;\n    }\n    return edge;\n  });\n}\n\n/**\n * Takes JSON as input and returns the graph representation.\n *\n * @example\n * var g2 = graphlib.json.read(JSON.parse(str));\n * g2.nodes();\n * // ['a', 'b']\n * g2.edges()\n * // [ { v: 'a', w: 'b' } ]\n */\nfunction read(json) {\n  var g = new Graph(json.options).setGraph(json.value);\n  json.nodes.forEach(function(entry) {\n    g.setNode(entry.v, entry.value);\n    if (entry.parent) {\n      g.setParent(entry.v, entry.parent);\n    }\n  });\n  json.edges.forEach(function(entry) {\n    g.setEdge({ v: entry.v, w: entry.w, name: entry.name }, entry.value);\n  });\n  return g;\n}\n\n},{\"./graph\":44}],47:[function(require,module,exports){\nmodule.exports = '2.2.4';\n\n},{}]},{},[1])(1)\n});\n","// ============================================================================\n// Theme system  CSS custom property-based theming for mermaid SVG diagrams.\n//\n// Architecture:\n//   - Two required variables: --bg (background) and --fg (foreground)\n//   - Five optional enrichment variables: --line, --accent, --muted, --surface, --border\n//   - Unset optionals fall back to color-mix() derivations from bg + fg\n//   - All derived values computed in a <style> block inside the SVG\n//\n// This means the SVG is a function of its CSS variables. The caller provides\n// colors, and the SVG adapts. No light/dark mode detection needed.\n// ============================================================================\n\n// ============================================================================\n// Types\n// ============================================================================\n\n/**\n * Diagram color configuration.\n *\n * Required: bg + fg give you a clean mono diagram.\n * Optional: line, accent, muted, surface, border bring in richer color\n * from Shiki themes or custom palettes. Each falls back to a color-mix()\n * derivation from bg + fg if not set.\n */\nexport interface DiagramColors {\n  /** Background color  CSS variable --bg */\n  bg: string\n  /** Foreground / primary text color  CSS variable --fg */\n  fg: string\n\n  // -- Optional enrichment (each falls back to color-mix from bg+fg) --\n\n  /** Edge/connector color  CSS variable --line */\n  line?: string\n  /** Arrow heads, highlights, special nodes  CSS variable --accent */\n  accent?: string\n  /** Secondary text, edge labels  CSS variable --muted */\n  muted?: string\n  /** Node/box fill tint  CSS variable --surface */\n  surface?: string\n  /** Node/group stroke color  CSS variable --border */\n  border?: string\n}\n\n// ============================================================================\n// Defaults\n// ============================================================================\n\n/** Default bg/fg when no colors are provided (zinc light) */\nexport const DEFAULTS: Readonly<{ bg: string; fg: string }> = {\n  bg: '#FFFFFF',\n  fg: '#27272A',\n} as const\n\n// ============================================================================\n// color-mix() weights for derived CSS variables\n//\n// When an optional enrichment variable is NOT set, we compute the derived\n// value by mixing --fg into --bg at these percentages. This produces a\n// coherent mono hierarchy on any bg/fg combination.\n// ============================================================================\n\nexport const MIX = {\n  /** Primary text: near-full fg */\n  text:         100, // just use --fg directly\n  /** Secondary text (group headers): fg mixed at 60% */\n  textSec:      60,\n  /** Muted text (edge labels, notes): fg mixed at 40% */\n  textMuted:    40,\n  /** Faint text (de-emphasized): fg mixed at 25% */\n  textFaint:    25,\n  /** Edge/connector lines: fg mixed at 30% */\n  line:         30,\n  /** Arrow head fill: fg mixed at 50% */\n  arrow:        50,\n  /** Node fill tint: fg mixed at 3% */\n  nodeFill:     3,\n  /** Node/group stroke: fg mixed at 20% */\n  nodeStroke:   20,\n  /** Group header band tint: fg mixed at 5% */\n  groupHeader:  5,\n  /** Inner divider strokes: fg mixed at 12% */\n  innerStroke:  12,\n  /** Key badge background opacity (ER diagrams) */\n  keyBadge:     10,\n} as const\n\n// ============================================================================\n// Well-known theme palettes\n//\n// Curated bg/fg pairs (+ optional enrichment) for popular editor themes.\n// Users can also extract from Shiki theme objects via fromShikiTheme().\n// ============================================================================\n\nexport const THEMES: Record<string, DiagramColors> = {\n  'zinc-dark': {\n    bg: '#18181B', fg: '#FAFAFA',\n  },\n  'tokyo-night': {\n    bg: '#1a1b26', fg: '#a9b1d6',\n    line: '#3d59a1', accent: '#7aa2f7', muted: '#565f89',\n  },\n  'tokyo-night-storm': {\n    bg: '#24283b', fg: '#a9b1d6',\n    line: '#3d59a1', accent: '#7aa2f7', muted: '#565f89',\n  },\n  'tokyo-night-light': {\n    bg: '#d5d6db', fg: '#343b58',\n    line: '#34548a', accent: '#34548a', muted: '#9699a3',\n  },\n  'catppuccin-mocha': {\n    bg: '#1e1e2e', fg: '#cdd6f4',\n    line: '#585b70', accent: '#cba6f7', muted: '#6c7086',\n  },\n  'catppuccin-latte': {\n    bg: '#eff1f5', fg: '#4c4f69',\n    line: '#9ca0b0', accent: '#8839ef', muted: '#9ca0b0',\n  },\n  'nord': {\n    bg: '#2e3440', fg: '#d8dee9',\n    line: '#4c566a', accent: '#88c0d0', muted: '#616e88',\n  },\n  'nord-light': {\n    bg: '#eceff4', fg: '#2e3440',\n    line: '#aab1c0', accent: '#5e81ac', muted: '#7b88a1',\n  },\n  'dracula': {\n    bg: '#282a36', fg: '#f8f8f2',\n    line: '#6272a4', accent: '#bd93f9', muted: '#6272a4',\n  },\n  'github-light': {\n    bg: '#ffffff', fg: '#1f2328',\n    line: '#d1d9e0', accent: '#0969da', muted: '#59636e',\n  },\n  'github-dark': {\n    bg: '#0d1117', fg: '#e6edf3',\n    line: '#3d444d', accent: '#4493f8', muted: '#9198a1',\n  },\n  'solarized-light': {\n    bg: '#fdf6e3', fg: '#657b83',\n    line: '#93a1a1', accent: '#268bd2', muted: '#93a1a1',\n  },\n  'solarized-dark': {\n    bg: '#002b36', fg: '#839496',\n    line: '#586e75', accent: '#268bd2', muted: '#586e75',\n  },\n  'one-dark': {\n    bg: '#282c34', fg: '#abb2bf',\n    line: '#4b5263', accent: '#c678dd', muted: '#5c6370',\n  },\n} as const\n\nexport type ThemeName = keyof typeof THEMES\n\n// ============================================================================\n// Shiki theme extraction\n//\n// Extracts DiagramColors from a Shiki ThemeRegistrationResolved object.\n// This provides native compatibility with any VS Code / TextMate theme.\n// ============================================================================\n\n/**\n * Minimal subset of Shiki's ThemeRegistrationResolved that we need.\n * We don't import from shiki to avoid a hard dependency.\n */\ninterface ShikiThemeLike {\n  type?: string\n  colors?: Record<string, string>\n  tokenColors?: Array<{\n    scope?: string | string[]\n    settings?: { foreground?: string }\n  }>\n}\n\n/**\n * Extract diagram colors from a Shiki theme object.\n * Works with any VS Code / TextMate theme loaded by Shiki.\n *\n * Maps editor UI colors to diagram roles:\n *   editor.background          bg\n *   editor.foreground          fg\n *   editorLineNumber.fg        line (optional)\n *   focusBorder / keyword      accent (optional)\n *   comment token              muted (optional)\n *   editor.selectionBackground surface (optional)\n *   editorWidget.border        border (optional)\n *\n * @example\n * ```ts\n * import { getSingletonHighlighter } from 'shiki'\n * import { fromShikiTheme } from 'beautiful-mermaid'\n *\n * const hl = await getSingletonHighlighter({ themes: ['tokyo-night'] })\n * const colors = fromShikiTheme(hl.getTheme('tokyo-night'))\n * const svg = await renderMermaid(code, colors)\n * ```\n */\nexport function fromShikiTheme(theme: ShikiThemeLike): DiagramColors {\n  const c = theme.colors ?? {}\n  const dark = theme.type === 'dark'\n\n  // Helper: find a token color by scope name\n  const tokenColor = (scope: string): string | undefined =>\n    theme.tokenColors?.find(t =>\n      Array.isArray(t.scope) ? t.scope.includes(scope) : t.scope === scope\n    )?.settings?.foreground\n\n  return {\n    bg: c['editor.background'] ?? (dark ? '#1e1e1e' : '#ffffff'),\n    fg: c['editor.foreground'] ?? (dark ? '#d4d4d4' : '#333333'),\n    line:    c['editorLineNumber.foreground'] ?? undefined,\n    accent:  c['focusBorder'] ?? tokenColor('keyword') ?? undefined,\n    muted:   tokenColor('comment') ?? c['editorLineNumber.foreground'] ?? undefined,\n    surface: c['editor.selectionBackground'] ?? undefined,\n    border:  c['editorWidget.border'] ?? undefined,\n  }\n}\n\n// ============================================================================\n// SVG style block  the CSS variable derivation system\n//\n// Generates the <style> content that maps user-facing variables (--bg, --fg,\n// --line, etc.) to internal derived variables (--_text, --_line, etc.) using\n// color-mix() fallbacks.\n// ============================================================================\n\n/**\n * Build the CSS variable derivation rules for the SVG <style> block.\n *\n * When an optional variable (--line, --accent, etc.) is set on the SVG or\n * a parent element, it's used directly. When unset, the fallback computes\n * a blended value from --fg and --bg using color-mix().\n */\nexport function buildStyleBlock(font: string, hasMonoFont: boolean): string {\n  const fontImports = [\n    `@import url('https://fonts.googleapis.com/css2?family=${encodeURIComponent(font)}:wght@400;500;600;700&amp;display=swap');`,\n    ...(hasMonoFont\n      ? [`@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&amp;display=swap');`]\n      : []),\n  ]\n\n  // Derived CSS variables: use override if set, else mix from bg+fg.\n  // The --_ prefix signals \"private/derived\"  not meant for external override.\n  const derivedVars = `\n    /* Derived from --bg and --fg (overridable via --line, --accent, etc.) */\n    --_text:          var(--fg);\n    --_text-sec:      var(--muted, color-mix(in srgb, var(--fg) ${MIX.textSec}%, var(--bg)));\n    --_text-muted:    var(--muted, color-mix(in srgb, var(--fg) ${MIX.textMuted}%, var(--bg)));\n    --_text-faint:    color-mix(in srgb, var(--fg) ${MIX.textFaint}%, var(--bg));\n    --_line:          var(--line, color-mix(in srgb, var(--fg) ${MIX.line}%, var(--bg)));\n    --_arrow:         var(--accent, color-mix(in srgb, var(--fg) ${MIX.arrow}%, var(--bg)));\n    --_node-fill:     var(--surface, color-mix(in srgb, var(--fg) ${MIX.nodeFill}%, var(--bg)));\n    --_node-stroke:   var(--border, color-mix(in srgb, var(--fg) ${MIX.nodeStroke}%, var(--bg)));\n    --_group-fill:    var(--bg);\n    --_group-hdr:     color-mix(in srgb, var(--fg) ${MIX.groupHeader}%, var(--bg));\n    --_inner-stroke:  color-mix(in srgb, var(--fg) ${MIX.innerStroke}%, var(--bg));\n    --_key-badge:     color-mix(in srgb, var(--fg) ${MIX.keyBadge}%, var(--bg));`\n\n  return [\n    '<style>',\n    `  ${fontImports.join('\\n  ')}`,\n    `  text { font-family: '${font}', system-ui, sans-serif; }`,\n    ...(hasMonoFont ? [`  .mono { font-family: 'JetBrains Mono', 'SF Mono', 'Fira Code', ui-monospace, monospace; }`] : []),\n    `  svg {${derivedVars}`,\n    `  }`,\n    '</style>',\n  ].join('\\n')\n}\n\n/**\n * Build the SVG opening tag with CSS variables set as inline styles.\n * Only includes optional variables that are actually provided  unset ones\n * will fall back to the color-mix() derivations in the <style> block.\n *\n * @param transparent - If true, omits the background style for transparent SVGs\n */\nexport function svgOpenTag(\n  width: number,\n  height: number,\n  colors: DiagramColors,\n  transparent?: boolean,\n): string {\n  // Build the style string with only the provided color variables\n  const vars = [\n    `--bg:${colors.bg}`,\n    `--fg:${colors.fg}`,\n    colors.line    ? `--line:${colors.line}` : '',\n    colors.accent  ? `--accent:${colors.accent}` : '',\n    colors.muted   ? `--muted:${colors.muted}` : '',\n    colors.surface ? `--surface:${colors.surface}` : '',\n    colors.border  ? `--border:${colors.border}` : '',\n  ].filter(Boolean).join(';')\n\n  const bgStyle = transparent ? '' : ';background:var(--bg)'\n\n  return (\n    `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 ${width} ${height}\" ` +\n    `width=\"${width}\" height=\"${height}\" style=\"${vars}${bgStyle}\">`\n  )\n}\n","import type { MermaidGraph, MermaidNode, MermaidEdge, MermaidSubgraph, Direction, NodeShape, EdgeStyle } from './types.ts'\n\n// ============================================================================\n// Mermaid parser  flowcharts and state diagrams\n//\n// Supports:\n//   Flowcharts: graph TD / flowchart LR\n//   State diagrams: stateDiagram-v2\n//\n// Line-by-line regex approach  the grammar is regular enough\n// that we don't need a grammar generator or full parser combinator.\n// ============================================================================\n\n/**\n * Parse Mermaid text into a logical graph structure.\n * Auto-detects diagram type (flowchart or state diagram).\n * Throws on invalid/unsupported input.\n */\nexport function parseMermaid(text: string): MermaidGraph {\n  const lines = text.split('\\n').map(l => l.trim()).filter(l => l.length > 0 && !l.startsWith('%%'))\n\n  if (lines.length === 0) {\n    throw new Error('Empty mermaid diagram')\n  }\n\n  // Detect diagram type from header\n  const header = lines[0]!\n\n  // State diagram: \"stateDiagram-v2\" or \"stateDiagram\"\n  if (/^stateDiagram(-v2)?\\s*$/i.test(header)) {\n    return parseStateDiagram(lines)\n  }\n\n  // Flowchart: \"graph TD\" or \"flowchart LR\"\n  return parseFlowchart(lines)\n}\n\n// ============================================================================\n// Flowchart parser\n// ============================================================================\n\nfunction parseFlowchart(lines: string[]): MermaidGraph {\n  const headerMatch = lines[0]!.match(/^(?:graph|flowchart)\\s+(TD|TB|LR|BT|RL)\\s*$/i)\n  if (!headerMatch) {\n    throw new Error(`Invalid mermaid header: \"${lines[0]}\". Expected \"graph TD\", \"flowchart LR\", \"stateDiagram-v2\", etc.`)\n  }\n\n  const direction = headerMatch[1]!.toUpperCase() as Direction\n\n  const graph: MermaidGraph = {\n    direction,\n    nodes: new Map(),\n    edges: [],\n    subgraphs: [],\n    classDefs: new Map(),\n    classAssignments: new Map(),\n    nodeStyles: new Map(),\n  }\n\n  // Subgraph stack for nested subgraphs.\n  const subgraphStack: MermaidSubgraph[] = []\n\n  for (let i = 1; i < lines.length; i++) {\n    const line = lines[i]!\n\n    // --- classDef: `classDef name prop:val,prop:val` ---\n    const classDefMatch = line.match(/^classDef\\s+(\\w+)\\s+(.+)$/)\n    if (classDefMatch) {\n      const name = classDefMatch[1]!\n      const propsStr = classDefMatch[2]!\n      const props = parseStyleProps(propsStr)\n      graph.classDefs.set(name, props)\n      continue\n    }\n\n    // --- class assignment: `class A,B className` ---\n    const classAssignMatch = line.match(/^class\\s+([\\w,-]+)\\s+(\\w+)$/)\n    if (classAssignMatch) {\n      const nodeIds = classAssignMatch[1]!.split(',').map(s => s.trim())\n      const className = classAssignMatch[2]!\n      for (const id of nodeIds) {\n        graph.classAssignments.set(id, className)\n      }\n      continue\n    }\n\n    // --- style statement: `style A,B fill:#f00,stroke:#333` ---\n    const styleMatch = line.match(/^style\\s+([\\w,-]+)\\s+(.+)$/)\n    if (styleMatch) {\n      const nodeIds = styleMatch[1]!.split(',').map(s => s.trim())\n      const props = parseStyleProps(styleMatch[2]!)\n      for (const id of nodeIds) {\n        graph.nodeStyles.set(id, { ...graph.nodeStyles.get(id), ...props })\n      }\n      continue\n    }\n\n    // --- direction override inside subgraph: `direction LR` ---\n    const dirMatch = line.match(/^direction\\s+(TD|TB|LR|BT|RL)\\s*$/i)\n    if (dirMatch && subgraphStack.length > 0) {\n      subgraphStack[subgraphStack.length - 1]!.direction = dirMatch[1]!.toUpperCase() as Direction\n      continue\n    }\n\n    // --- subgraph start: `subgraph Label` or `subgraph id [Label]` ---\n    const subgraphMatch = line.match(/^subgraph\\s+(.+)$/)\n    if (subgraphMatch) {\n      const rest = subgraphMatch[1]!.trim()\n      // Check for \"subgraph id [Label]\" form\n      // ID can contain hyphens (e.g. \"us-east\"), so use [\\w-]+ not \\w+\n      const bracketMatch = rest.match(/^([\\w-]+)\\s*\\[(.+)\\]$/)\n      let id: string\n      let label: string\n      if (bracketMatch) {\n        id = bracketMatch[1]!\n        label = bracketMatch[2]!\n      } else {\n        // Use the label text as id (slugified)\n        label = rest\n        id = rest.replace(/\\s+/g, '_').replace(/[^\\w]/g, '')\n      }\n      const sg: MermaidSubgraph = { id, label, nodeIds: [], children: [] }\n      subgraphStack.push(sg)\n      continue\n    }\n\n    // --- subgraph end ---\n    if (line === 'end') {\n      const completed = subgraphStack.pop()\n      if (completed) {\n        if (subgraphStack.length > 0) {\n          subgraphStack[subgraphStack.length - 1]!.children.push(completed)\n        } else {\n          graph.subgraphs.push(completed)\n        }\n      }\n      continue\n    }\n\n    // --- Edge/node definitions ---\n    parseEdgeLine(line, graph, subgraphStack)\n  }\n\n  return graph\n}\n\n// ============================================================================\n// State diagram parser\n//\n// Supported syntax:\n//   stateDiagram-v2\n//   s1 : Description\n//   state \"Description\" as s1\n//   s1 --> s2 : label\n//   [*] --> s1            (start pseudostate)\n//   s1 --> [*]            (end pseudostate)\n//   state CompositeState {\n//     inner1 --> inner2\n//   }\n// ============================================================================\n\nfunction parseStateDiagram(lines: string[]): MermaidGraph {\n  const graph: MermaidGraph = {\n    direction: 'TD',\n    nodes: new Map(),\n    edges: [],\n    subgraphs: [],\n    classDefs: new Map(),\n    classAssignments: new Map(),\n    nodeStyles: new Map(),\n  }\n\n  // Track composite state nesting (like subgraphs)\n  const compositeStack: MermaidSubgraph[] = []\n  // Counter for unique [*] pseudostate IDs\n  let startCount = 0\n  let endCount = 0\n\n  for (let i = 1; i < lines.length; i++) {\n    const line = lines[i]!\n\n    // --- direction override ---\n    const dirMatch = line.match(/^direction\\s+(TD|TB|LR|BT|RL)\\s*$/i)\n    if (dirMatch) {\n      if (compositeStack.length > 0) {\n        compositeStack[compositeStack.length - 1]!.direction = dirMatch[1]!.toUpperCase() as Direction\n      } else {\n        graph.direction = dirMatch[1]!.toUpperCase() as Direction\n      }\n      continue\n    }\n\n    // --- composite state start: `state CompositeState {` ---\n    const compositeMatch = line.match(/^state\\s+(?:\"([^\"]+)\"\\s+as\\s+)?(\\w+)\\s*\\{$/)\n    if (compositeMatch) {\n      const label = compositeMatch[1] ?? compositeMatch[2]!\n      const id = compositeMatch[2]!\n      const sg: MermaidSubgraph = { id, label, nodeIds: [], children: [] }\n      compositeStack.push(sg)\n      continue\n    }\n\n    // --- composite state end ---\n    if (line === '}') {\n      const completed = compositeStack.pop()\n      if (completed) {\n        if (compositeStack.length > 0) {\n          compositeStack[compositeStack.length - 1]!.children.push(completed)\n        } else {\n          graph.subgraphs.push(completed)\n        }\n      }\n      continue\n    }\n\n    // --- state alias: `state \"Description\" as s1` (without brace) ---\n    const stateAliasMatch = line.match(/^state\\s+\"([^\"]+)\"\\s+as\\s+(\\w+)\\s*$/)\n    if (stateAliasMatch) {\n      const label = stateAliasMatch[1]!\n      const id = stateAliasMatch[2]!\n      registerStateNode(graph, compositeStack, { id, label, shape: 'rounded' })\n      continue\n    }\n\n    // --- transition: `s1 --> s2` or `s1 --> s2 : label` or `[*] --> s1` ---\n    const transitionMatch = line.match(/^(\\[\\*\\]|[\\w-]+)\\s*(-->)\\s*(\\[\\*\\]|[\\w-]+)(?:\\s*:\\s*(.+))?$/)\n    if (transitionMatch) {\n      let sourceId = transitionMatch[1]!\n      let targetId = transitionMatch[3]!\n      const edgeLabel = transitionMatch[4]?.trim() || undefined\n\n      // Handle [*] pseudostates  each occurrence gets a unique ID\n      if (sourceId === '[*]') {\n        startCount++\n        sourceId = `_start${startCount > 1 ? startCount : ''}`\n        registerStateNode(graph, compositeStack, { id: sourceId, label: '', shape: 'state-start' })\n      } else {\n        ensureStateNode(graph, compositeStack, sourceId)\n      }\n\n      if (targetId === '[*]') {\n        endCount++\n        targetId = `_end${endCount > 1 ? endCount : ''}`\n        registerStateNode(graph, compositeStack, { id: targetId, label: '', shape: 'state-end' })\n      } else {\n        ensureStateNode(graph, compositeStack, targetId)\n      }\n\n      graph.edges.push({\n        source: sourceId,\n        target: targetId,\n        label: edgeLabel,\n        style: 'solid',\n        hasArrowStart: false,\n        hasArrowEnd: true,\n      })\n      continue\n    }\n\n    // --- state description: `s1 : Description` ---\n    const stateDescMatch = line.match(/^([\\w-]+)\\s*:\\s*(.+)$/)\n    if (stateDescMatch) {\n      const id = stateDescMatch[1]!\n      const label = stateDescMatch[2]!.trim()\n      registerStateNode(graph, compositeStack, { id, label, shape: 'rounded' })\n      continue\n    }\n  }\n\n  return graph\n}\n\n/** Register a state node and track in composite state if applicable */\nfunction registerStateNode(\n  graph: MermaidGraph,\n  compositeStack: MermaidSubgraph[],\n  node: MermaidNode\n): void {\n  const isNew = !graph.nodes.has(node.id)\n  if (isNew) {\n    graph.nodes.set(node.id, node)\n  }\n  if (compositeStack.length > 0) {\n    const current = compositeStack[compositeStack.length - 1]!\n    if (!current.nodeIds.includes(node.id)) {\n      current.nodeIds.push(node.id)\n    }\n  }\n}\n\n/** Ensure a state node exists with default rounded shape */\nfunction ensureStateNode(\n  graph: MermaidGraph,\n  compositeStack: MermaidSubgraph[],\n  id: string\n): void {\n  if (!graph.nodes.has(id)) {\n    registerStateNode(graph, compositeStack, { id, label: id, shape: 'rounded' })\n  } else {\n    // Track in composite if applicable\n    if (compositeStack.length > 0) {\n      const current = compositeStack[compositeStack.length - 1]!\n      if (!current.nodeIds.includes(id)) {\n        current.nodeIds.push(id)\n      }\n    }\n  }\n}\n\n// ============================================================================\n// Shared utilities\n// ============================================================================\n\n/** Parse \"fill:#f00,stroke:#333\" style property strings into a Record */\nfunction parseStyleProps(propsStr: string): Record<string, string> {\n  const props: Record<string, string> = {}\n  for (const pair of propsStr.split(',')) {\n    const colonIdx = pair.indexOf(':')\n    if (colonIdx > 0) {\n      const key = pair.slice(0, colonIdx).trim()\n      const val = pair.slice(colonIdx + 1).trim()\n      if (key && val) {\n        props[key] = val\n      }\n    }\n  }\n  return props\n}\n\n// ============================================================================\n// Flowchart edge line parser\n//\n// Handles chained edges like: A[Label] --> B(Label) -.-> C{Label}\n// Also handles & parallel links: A & B --> C & D\n// ============================================================================\n\n/**\n * Arrow regex  matches all arrow operators with optional labels.\n *\n * Supported operators:\n *   -->  ---       solid arrow / solid line\n *   -.-> -.-       dotted arrow / dotted line\n *   ==>  ===       thick arrow / thick line\n *   <--> <-.-> <==>  bidirectional variants\n *\n * Optional label: -->|label text|\n */\nconst ARROW_REGEX = /^(<)?(-->|-.->|==>|---|-\\.-|===)(?:\\|([^|]*)\\|)?/\n\n/**\n * Node shape patterns  ordered from most specific delimiters to least.\n * Multi-char delimiters must be tried before single-char to avoid false matches.\n */\nconst NODE_PATTERNS: Array<{ regex: RegExp; shape: NodeShape }> = [\n  // Triple delimiters (must be first)\n  { regex: /^([\\w-]+)\\(\\(\\((.+?)\\)\\)\\)/, shape: 'doublecircle' },  // A(((text)))\n\n  // Double delimiters with mixed brackets\n  { regex: /^([\\w-]+)\\(\\[(.+?)\\]\\)/,     shape: 'stadium' },       // A([text])\n  { regex: /^([\\w-]+)\\(\\((.+?)\\)\\)/,     shape: 'circle' },        // A((text))\n  { regex: /^([\\w-]+)\\[\\[(.+?)\\]\\]/,     shape: 'subroutine' },    // A[[text]]\n  { regex: /^([\\w-]+)\\[\\((.+?)\\)\\]/,     shape: 'cylinder' },      // A[(text)]\n\n  // Trapezoid variants  must come before plain [text]\n  { regex: /^([\\w-]+)\\[\\/(.+?)\\\\\\]/,     shape: 'trapezoid' },     // A[/text\\]\n  { regex: /^([\\w-]+)\\[\\\\(.+?)\\/\\]/,     shape: 'trapezoid-alt' }, // A[\\text/]\n\n  // Asymmetric flag shape\n  { regex: /^([\\w-]+)>(.+?)\\]/,          shape: 'asymmetric' },    // A>text]\n\n  // Double curly braces (hexagon)  must come before single {text}\n  { regex: /^([\\w-]+)\\{\\{(.+?)\\}\\}/,     shape: 'hexagon' },       // A{{text}}\n\n  // Single-char delimiters (last  most common, least specific)\n  { regex: /^([\\w-]+)\\[(.+?)\\]/,         shape: 'rectangle' },     // A[text]\n  { regex: /^([\\w-]+)\\((.+?)\\)/,         shape: 'rounded' },       // A(text)\n  { regex: /^([\\w-]+)\\{(.+?)\\}/,         shape: 'diamond' },       // A{text}\n]\n\n/** Regex for a bare node reference (just an ID, no shape brackets) */\nconst BARE_NODE_REGEX = /^([\\w-]+)/\n\n/** Regex for ::: class shorthand suffix  matches :::className immediately after a node */\nconst CLASS_SHORTHAND_REGEX = /^:::([\\w][\\w-]*)/\n\n/**\n * Parse a line that contains node definitions and edges.\n * Handles chaining: A --> B --> C produces edges AB and BC.\n * Handles parallel links: A & B --> C & D produces 4 edges.\n */\nfunction parseEdgeLine(\n  line: string,\n  graph: MermaidGraph,\n  subgraphStack: MermaidSubgraph[]\n): void {\n  let remaining = line.trim()\n\n  // Parse the first node group (possibly with & separators)\n  const firstGroup = consumeNodeGroup(remaining, graph, subgraphStack)\n  if (!firstGroup || firstGroup.ids.length === 0) return\n\n  remaining = firstGroup.remaining.trim()\n  let prevGroupIds = firstGroup.ids\n\n  // Parse arrow + node-group pairs until the line is exhausted\n  while (remaining.length > 0) {\n    const arrowMatch = remaining.match(ARROW_REGEX)\n    if (!arrowMatch) break\n\n    const hasArrowStart = Boolean(arrowMatch[1])\n    const arrowOp = arrowMatch[2]!\n    const edgeLabel = arrowMatch[3]?.trim() || undefined\n    remaining = remaining.slice(arrowMatch[0].length).trim()\n\n    const style = arrowStyleFromOp(arrowOp)\n    const hasArrowEnd = arrowOp.endsWith('>')\n\n    // Parse the next node group\n    const nextGroup = consumeNodeGroup(remaining, graph, subgraphStack)\n    if (!nextGroup || nextGroup.ids.length === 0) break\n\n    remaining = nextGroup.remaining.trim()\n\n    // Emit Cartesian product of edges: every source  every target\n    for (const sourceId of prevGroupIds) {\n      for (const targetId of nextGroup.ids) {\n        graph.edges.push({\n          source: sourceId,\n          target: targetId,\n          label: edgeLabel,\n          style,\n          hasArrowStart,\n          hasArrowEnd,\n        })\n      }\n    }\n\n    prevGroupIds = nextGroup.ids\n  }\n}\n\ninterface ConsumedNodeGroup {\n  ids: string[]\n  remaining: string\n}\n\n/**\n * Consume one or more nodes separated by `&`.\n * E.g. \"A & B & C --> ...\" returns ids: ['A', 'B', 'C']\n */\nfunction consumeNodeGroup(\n  text: string,\n  graph: MermaidGraph,\n  subgraphStack: MermaidSubgraph[]\n): ConsumedNodeGroup | null {\n  const first = consumeNode(text, graph, subgraphStack)\n  if (!first) return null\n\n  const ids = [first.id]\n  let remaining = first.remaining.trim()\n\n  // Check for & separators\n  while (remaining.startsWith('&')) {\n    remaining = remaining.slice(1).trim()\n    const next = consumeNode(remaining, graph, subgraphStack)\n    if (!next) break\n    ids.push(next.id)\n    remaining = next.remaining.trim()\n  }\n\n  return { ids, remaining }\n}\n\ninterface ConsumedNode {\n  id: string\n  remaining: string\n}\n\n/**\n * Try to consume a node definition from the start of `text`.\n * If the node has a shape+label (e.g. A[Text]), it's registered in the graph.\n * If it's a bare reference (e.g. A), we look it up or create a default.\n * Also handles ::: class shorthand suffix.\n */\nfunction consumeNode(\n  text: string,\n  graph: MermaidGraph,\n  subgraphStack: MermaidSubgraph[]\n): ConsumedNode | null {\n  let id: string | null = null\n  let remaining: string = text\n\n  // Try each node pattern (shape-qualified)\n  for (const { regex, shape } of NODE_PATTERNS) {\n    const match = text.match(regex)\n    if (match) {\n      id = match[1]!\n      const label = match[2]!\n      registerNode(graph, subgraphStack, { id, label, shape })\n      remaining = text.slice(match[0].length)\n      break\n    }\n  }\n\n  // Bare node reference\n  if (id === null) {\n    const bareMatch = text.match(BARE_NODE_REGEX)\n    if (bareMatch) {\n      id = bareMatch[1]!\n      if (!graph.nodes.has(id)) {\n        registerNode(graph, subgraphStack, { id, label: id, shape: 'rectangle' })\n      } else {\n        trackInSubgraph(subgraphStack, id)\n      }\n      remaining = text.slice(bareMatch[0].length)\n    }\n  }\n\n  if (id === null) return null\n\n  // Check for ::: class shorthand suffix immediately after the node\n  const classMatch = remaining.match(CLASS_SHORTHAND_REGEX)\n  if (classMatch) {\n    graph.classAssignments.set(id, classMatch[1]!)\n    remaining = remaining.slice(classMatch[0].length)\n  }\n\n  return { id, remaining }\n}\n\n/** Register a node in the graph and track it in the current subgraph */\nfunction registerNode(\n  graph: MermaidGraph,\n  subgraphStack: MermaidSubgraph[],\n  node: MermaidNode\n): void {\n  const isNew = !graph.nodes.has(node.id)\n  if (isNew) {\n    graph.nodes.set(node.id, node)\n  }\n  trackInSubgraph(subgraphStack, node.id)\n}\n\n/** Add node ID to the innermost subgraph if we're inside one */\nfunction trackInSubgraph(subgraphStack: MermaidSubgraph[], nodeId: string): void {\n  if (subgraphStack.length > 0) {\n    const current = subgraphStack[subgraphStack.length - 1]!\n    if (!current.nodeIds.includes(nodeId)) {\n      current.nodeIds.push(nodeId)\n    }\n  }\n}\n\n/** Map arrow operator string to edge style (ignoring direction) */\nfunction arrowStyleFromOp(op: string): EdgeStyle {\n  if (op === '-.->') return 'dotted'\n  if (op === '-.-') return 'dotted'\n  if (op === '==>') return 'thick'\n  if (op === '===') return 'thick'\n  // '-->'' and '---' are both solid\n  return 'solid'\n}\n","// ============================================================================\n// ASCII renderer  type definitions\n//\n// Ported from AlexanderGrooff/mermaid-ascii (Go).\n// These types model the grid-based coordinate system, 2D text canvas,\n// and graph structures used by the ASCII/Unicode renderer.\n// ============================================================================\n\n/** Logical grid coordinate  nodes occupy 3x3 blocks on this grid. */\nexport interface GridCoord {\n  x: number\n  y: number\n}\n\n/** Character-level coordinate on the 2D text canvas. */\nexport interface DrawingCoord {\n  x: number\n  y: number\n}\n\n/**\n * Direction constants model positions on a node's 3x3 grid block.\n * Each node occupies grid cells [x..x+2, y..y+2].\n * Directions are offsets into that block, used for edge attachment points.\n *\n *   (0,0) UL   (1,0) Up   (2,0) UR\n *   (0,1) Left (1,1) Mid  (2,1) Right\n *   (0,2) LL   (1,2) Down (2,2) LR\n */\nexport interface Direction {\n  readonly x: number\n  readonly y: number\n}\n\nexport const Up: Direction         = { x: 1, y: 0 }\nexport const Down: Direction       = { x: 1, y: 2 }\nexport const Left: Direction       = { x: 0, y: 1 }\nexport const Right: Direction      = { x: 2, y: 1 }\nexport const UpperRight: Direction = { x: 2, y: 0 }\nexport const UpperLeft: Direction  = { x: 0, y: 0 }\nexport const LowerRight: Direction = { x: 2, y: 2 }\nexport const LowerLeft: Direction  = { x: 0, y: 2 }\nexport const Middle: Direction     = { x: 1, y: 1 }\n\n/** All named directions for iteration. */\nexport const ALL_DIRECTIONS: readonly Direction[] = [\n  Up, Down, Left, Right, UpperRight, UpperLeft, LowerRight, LowerLeft, Middle,\n]\n\n/**\n * 2D text canvas  column-major (canvas[x][y]).\n * Each cell holds a single character (or space).\n */\nexport type Canvas = string[][]\n\n/** A node in the ASCII graph, positioned on the grid. */\nexport interface AsciiNode {\n  /** Unique identity key  the original node ID from the parser (e.g. \"A\", \"B\"). */\n  name: string\n  /** Human-readable label for rendering inside the box (e.g. \"Web Server\"). */\n  displayLabel: string\n  index: number\n  gridCoord: GridCoord | null\n  drawingCoord: DrawingCoord | null\n  drawing: Canvas | null\n  drawn: boolean\n  styleClassName: string\n  styleClass: AsciiStyleClass\n}\n\n/** Style class for colored node text (ported from Go's classDef). */\nexport interface AsciiStyleClass {\n  name: string\n  styles: Record<string, string>\n}\n\n/** An edge in the ASCII graph, with a routed path. */\nexport interface AsciiEdge {\n  from: AsciiNode\n  to: AsciiNode\n  text: string\n  path: GridCoord[]\n  labelLine: GridCoord[]\n  startDir: Direction\n  endDir: Direction\n}\n\n/** A subgraph container with bounding box for rendering. */\nexport interface AsciiSubgraph {\n  name: string\n  nodes: AsciiNode[]\n  parent: AsciiSubgraph | null\n  children: AsciiSubgraph[]\n  minX: number\n  minY: number\n  maxX: number\n  maxY: number\n}\n\n/** Configuration for ASCII rendering. */\nexport interface AsciiConfig {\n  /** true = ASCII chars (+,-,|), false = Unicode box-drawing (,,). Default: false */\n  useAscii: boolean\n  /** Horizontal spacing between nodes. Default: 5 */\n  paddingX: number\n  /** Vertical spacing between nodes. Default: 5 */\n  paddingY: number\n  /** Padding inside node boxes. Default: 1 */\n  boxBorderPadding: number\n  /** Graph direction: \"LR\" or \"TD\". */\n  graphDirection: 'LR' | 'TD'\n}\n\n/** Full ASCII graph state used during layout and rendering. */\nexport interface AsciiGraph {\n  nodes: AsciiNode[]\n  edges: AsciiEdge[]\n  canvas: Canvas\n  /** Grid occupancy map  maps \"x,y\" keys to node references. */\n  grid: Map<string, AsciiNode>\n  columnWidth: Map<number, number>\n  rowHeight: Map<number, number>\n  subgraphs: AsciiSubgraph[]\n  config: AsciiConfig\n  /** Offset applied to all drawing coords to accommodate subgraph borders. */\n  offsetX: number\n  offsetY: number\n}\n\n// ============================================================================\n// Coordinate helpers\n// ============================================================================\n\nexport function gridCoordEquals(a: GridCoord, b: GridCoord): boolean {\n  return a.x === b.x && a.y === b.y\n}\n\nexport function drawingCoordEquals(a: DrawingCoord, b: DrawingCoord): boolean {\n  return a.x === b.x && a.y === b.y\n}\n\n/** Apply a direction offset to a grid coordinate (move into the 3x3 block). */\nexport function gridCoordDirection(c: GridCoord, dir: Direction): GridCoord {\n  return { x: c.x + dir.x, y: c.y + dir.y }\n}\n\n/** Key for storing GridCoord in a Map. */\nexport function gridKey(c: GridCoord): string {\n  return `${c.x},${c.y}`\n}\n\n/** Default empty style class. */\nexport const EMPTY_STYLE: AsciiStyleClass = { name: '', styles: {} }\n","// ============================================================================\n// ASCII renderer  2D text canvas\n//\n// Ported from AlexanderGrooff/mermaid-ascii cmd/draw.go.\n// The canvas is a column-major 2D array of single-character strings.\n// canvas[x][y] gives the character at column x, row y.\n// ============================================================================\n\nimport type { Canvas, DrawingCoord } from './types.ts'\n\n/**\n * Create a blank canvas filled with spaces.\n * Dimensions are inclusive: mkCanvas(3, 2) creates a 4x3 grid (indices 0..3, 0..2).\n */\nexport function mkCanvas(x: number, y: number): Canvas {\n  const canvas: Canvas = []\n  for (let i = 0; i <= x; i++) {\n    const col: string[] = []\n    for (let j = 0; j <= y; j++) {\n      col.push(' ')\n    }\n    canvas.push(col)\n  }\n  return canvas\n}\n\n/** Create a blank canvas with the same dimensions as the given canvas. */\nexport function copyCanvas(source: Canvas): Canvas {\n  const [maxX, maxY] = getCanvasSize(source)\n  return mkCanvas(maxX, maxY)\n}\n\n/** Returns [maxX, maxY]  the highest valid indices in each dimension. */\nexport function getCanvasSize(canvas: Canvas): [number, number] {\n  return [canvas.length - 1, (canvas[0]?.length ?? 1) - 1]\n}\n\n/**\n * Grow the canvas to fit at least (newX, newY), preserving existing content.\n * Mutates the canvas in place and returns it.\n */\nexport function increaseSize(canvas: Canvas, newX: number, newY: number): Canvas {\n  const [currX, currY] = getCanvasSize(canvas)\n  const targetX = Math.max(newX, currX)\n  const targetY = Math.max(newY, currY)\n  const grown = mkCanvas(targetX, targetY)\n  for (let x = 0; x < grown.length; x++) {\n    for (let y = 0; y < grown[0]!.length; y++) {\n      if (x < canvas.length && y < canvas[0]!.length) {\n        grown[x]![y] = canvas[x]![y]!\n      }\n    }\n  }\n  // Mutate in place: splice old contents and replace with grown\n  canvas.length = 0\n  canvas.push(...grown)\n  return canvas\n}\n\n// ============================================================================\n// Junction merging  Unicode box-drawing character compositing\n// ============================================================================\n\n/** All Unicode box-drawing characters that participate in junction merging. */\nconst JUNCTION_CHARS = new Set([\n  '', '', '', '', '', '', '', '', '', '', '', '', '', '', '',\n])\n\nexport function isJunctionChar(c: string): boolean {\n  return JUNCTION_CHARS.has(c)\n}\n\n/**\n * When two junction characters overlap during canvas merging,\n * resolve them to the correct combined junction.\n * E.g., '' overlapping '' becomes ''.\n */\nconst JUNCTION_MAP: Record<string, Record<string, string>> = {\n  '': { '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '' },\n  '': { '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '' },\n  '': { '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '' },\n  '': { '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '' },\n  '': { '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '' },\n  '': { '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '' },\n  '': { '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '' },\n  '': { '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '' },\n  '': { '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '' },\n  '': { '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '', '': '' },\n}\n\nexport function mergeJunctions(c1: string, c2: string): string {\n  return JUNCTION_MAP[c1]?.[c2] ?? c1\n}\n\n// ============================================================================\n// Canvas merging  composite multiple canvases with offset\n// ============================================================================\n\n/**\n * Merge overlay canvases onto a base canvas at the given offset.\n * Non-space characters in overlays overwrite the base.\n * When both characters are Unicode junction chars, they're merged intelligently.\n */\nexport function mergeCanvases(\n  base: Canvas,\n  offset: DrawingCoord,\n  useAscii: boolean,\n  ...overlays: Canvas[]\n): Canvas {\n  let [maxX, maxY] = getCanvasSize(base)\n  for (const overlay of overlays) {\n    const [oX, oY] = getCanvasSize(overlay)\n    maxX = Math.max(maxX, oX + offset.x)\n    maxY = Math.max(maxY, oY + offset.y)\n  }\n\n  const merged = mkCanvas(maxX, maxY)\n\n  // Copy base\n  for (let x = 0; x <= maxX; x++) {\n    for (let y = 0; y <= maxY; y++) {\n      if (x < base.length && y < base[0]!.length) {\n        merged[x]![y] = base[x]![y]!\n      }\n    }\n  }\n\n  // Apply overlays\n  for (const overlay of overlays) {\n    for (let x = 0; x < overlay.length; x++) {\n      for (let y = 0; y < overlay[0]!.length; y++) {\n        const c = overlay[x]![y]!\n        if (c !== ' ') {\n          const mx = x + offset.x\n          const my = y + offset.y\n          const current = merged[mx]![my]!\n          if (!useAscii && isJunctionChar(c) && isJunctionChar(current)) {\n            merged[mx]![my] = mergeJunctions(current, c)\n          } else {\n            merged[mx]![my] = c\n          }\n        }\n      }\n    }\n  }\n\n  return merged\n}\n\n// ============================================================================\n// Canvas  string conversion\n// ============================================================================\n\n/** Convert the canvas to a multi-line string (row by row, left to right). */\nexport function canvasToString(canvas: Canvas): string {\n  const [maxX, maxY] = getCanvasSize(canvas)\n  const lines: string[] = []\n  for (let y = 0; y <= maxY; y++) {\n    let line = ''\n    for (let x = 0; x <= maxX; x++) {\n      line += canvas[x]![y]!\n    }\n    lines.push(line)\n  }\n  return lines.join('\\n')\n}\n\n// ============================================================================\n// Canvas vertical flip  used for BT (bottom-to-top) direction support.\n//\n// The ASCII renderer lays out graphs top-down (TD). For BT direction, we\n// flip the finished canvas vertically and remap directional characters so\n// arrows point upward and corners are mirrored correctly.\n// ============================================================================\n\n/**\n * Characters that change meaning when the Y-axis is flipped.\n * Symmetric characters (, , , , ) are unchanged.\n */\nconst VERTICAL_FLIP_MAP: Record<string, string> = {\n  // Unicode arrows\n  '': '', '': '',\n  '': '', '': '',\n  '': '', '': '',\n  // ASCII arrows\n  '^': 'v', 'v': '^',\n  // Unicode corners\n  '': '', '': '',\n  '': '', '': '',\n  // Unicode junctions (T-pieces flip vertically)\n  '': '', '': '',\n  // Box-start junctions (exit points from node boxes)\n  '': '', '': '',\n}\n\n/**\n * Flip the canvas vertically (mirror across the horizontal center).\n * Reverses row order within each column and remaps directional characters\n * (arrows, corners, junctions) so they point the correct way after flip.\n *\n * Used to transform a TD-rendered canvas into BT output.\n * Mutates the canvas in place and returns it.\n */\nexport function flipCanvasVertically(canvas: Canvas): Canvas {\n  // Reverse each column array (Y-axis flip in column-major layout)\n  for (const col of canvas) {\n    col.reverse()\n  }\n\n  // Remap directional characters that change meaning after vertical flip\n  for (const col of canvas) {\n    for (let y = 0; y < col.length; y++) {\n      const flipped = VERTICAL_FLIP_MAP[col[y]!]\n      if (flipped) col[y] = flipped\n    }\n  }\n\n  return canvas\n}\n\n/** Draw text string onto the canvas starting at the given coordinate. */\nexport function drawText(canvas: Canvas, start: DrawingCoord, text: string): void {\n  increaseSize(canvas, start.x + text.length, start.y)\n  for (let i = 0; i < text.length; i++) {\n    canvas[start.x + i]![start.y] = text[i]!\n  }\n}\n\n/**\n * Set the canvas size to fit all grid columns and rows.\n * Called after layout to ensure the canvas covers the full drawing area.\n */\nexport function setCanvasSizeToGrid(\n  canvas: Canvas,\n  columnWidth: Map<number, number>,\n  rowHeight: Map<number, number>,\n): void {\n  let maxX = 0\n  let maxY = 0\n  for (const w of columnWidth.values()) maxX += w\n  for (const h of rowHeight.values()) maxY += h\n  increaseSize(canvas, maxX - 1, maxY - 1)\n}\n","// ============================================================================\n// ASCII renderer  MermaidGraph  AsciiGraph converter\n//\n// Bridges the existing TypeScript parser output to the ASCII renderer's\n// internal graph structure. This avoids maintaining a separate parser\n// for ASCII rendering  we reuse parseMermaid() and convert its output.\n// ============================================================================\n\nimport type { MermaidGraph, MermaidSubgraph } from '../types.ts'\nimport type {\n  AsciiGraph, AsciiNode, AsciiEdge, AsciiSubgraph, AsciiConfig,\n} from './types.ts'\nimport { EMPTY_STYLE } from './types.ts'\nimport { mkCanvas } from './canvas.ts'\n\n/**\n * Convert a parsed MermaidGraph into an AsciiGraph ready for grid layout.\n *\n * Key mappings:\n * - MermaidGraph.nodes (Map)  ordered AsciiNode[] preserving insertion order\n * - MermaidGraph.edges  AsciiEdge[] with resolved node references\n * - MermaidGraph.subgraphs  AsciiSubgraph[] with parent/child tree\n * - Node labels are used as display names (not raw IDs)\n */\nexport function convertToAsciiGraph(parsed: MermaidGraph, config: AsciiConfig): AsciiGraph {\n  // Build node list preserving Map insertion order\n  const nodeMap = new Map<string, AsciiNode>()\n  let index = 0\n\n  for (const [id, mNode] of parsed.nodes) {\n    const asciiNode: AsciiNode = {\n      // Use the parser ID as the unique identity key to avoid collisions\n      // when multiple nodes share the same label (e.g. A[Web Server], C[Web Server]).\n      name: id,\n      // The label is used for rendering inside the box.\n      displayLabel: mNode.label,\n      index,\n      gridCoord: null,\n      drawingCoord: null,\n      drawing: null,\n      drawn: false,\n      styleClassName: '',\n      styleClass: EMPTY_STYLE,\n    }\n    nodeMap.set(id, asciiNode)\n    index++\n  }\n\n  const nodes = [...nodeMap.values()]\n\n  // Build edges with resolved node references\n  const edges: AsciiEdge[] = []\n  for (const mEdge of parsed.edges) {\n    const from = nodeMap.get(mEdge.source)\n    const to = nodeMap.get(mEdge.target)\n    if (!from || !to) continue\n\n    edges.push({\n      from,\n      to,\n      text: mEdge.label ?? '',\n      path: [],\n      labelLine: [],\n      startDir: { x: 0, y: 0 },\n      endDir: { x: 0, y: 0 },\n    })\n  }\n\n  // Convert subgraphs recursively\n  const subgraphs: AsciiSubgraph[] = []\n  for (const mSg of parsed.subgraphs) {\n    convertSubgraph(mSg, null, nodeMap, subgraphs)\n  }\n\n  // Deduplicate subgraph node membership to match Go parser behavior.\n  // In Go, a node belongs only to the subgraph where it was FIRST DEFINED.\n  // The TS parser adds referenced nodes to all subgraphs they appear in,\n  // which causes incorrect bounding boxes when nodes span subgraph boundaries.\n  deduplicateSubgraphNodes(parsed.subgraphs, subgraphs, nodeMap, parsed)\n\n  // Apply class definitions\n  for (const [nodeId, className] of parsed.classAssignments) {\n    const node = nodeMap.get(nodeId)\n    const classDef = parsed.classDefs.get(className)\n    if (node && classDef) {\n      node.styleClassName = className\n      node.styleClass = { name: className, styles: classDef }\n    }\n  }\n\n  return {\n    nodes,\n    edges,\n    canvas: mkCanvas(0, 0),\n    grid: new Map(),\n    columnWidth: new Map(),\n    rowHeight: new Map(),\n    subgraphs,\n    config,\n    offsetX: 0,\n    offsetY: 0,\n  }\n}\n\n/**\n * Recursively convert a MermaidSubgraph to AsciiSubgraph.\n * Flattens the tree into the subgraphs array while maintaining parent/child references.\n * This matches the Go implementation where all subgraphs are in a flat list\n * but linked via parent/children pointers.\n */\nfunction convertSubgraph(\n  mSg: MermaidSubgraph,\n  parent: AsciiSubgraph | null,\n  nodeMap: Map<string, AsciiNode>,\n  allSubgraphs: AsciiSubgraph[],\n): AsciiSubgraph {\n  const sg: AsciiSubgraph = {\n    name: mSg.label,\n    nodes: [],\n    parent,\n    children: [],\n    minX: 0, minY: 0, maxX: 0, maxY: 0,\n  }\n\n  // Resolve node references\n  for (const nodeId of mSg.nodeIds) {\n    const node = nodeMap.get(nodeId)\n    if (node) sg.nodes.push(node)\n  }\n\n  allSubgraphs.push(sg)\n\n  // Recurse into children\n  for (const childMSg of mSg.children) {\n    const child = convertSubgraph(childMSg, sg, nodeMap, allSubgraphs)\n    sg.children.push(child)\n\n    // Child nodes are also part of parent subgraphs (Go behavior).\n    // The Go parser adds nodes to ALL subgraphs in the stack, so a nested\n    // node belongs to both the inner and outer subgraph.\n    for (const childNode of child.nodes) {\n      if (!sg.nodes.includes(childNode)) {\n        sg.nodes.push(childNode)\n      }\n    }\n  }\n\n  return sg\n}\n\n/**\n * Deduplicate subgraph node membership to match Go parser behavior.\n *\n * The Go parser only adds a node to the subgraph that was active when the node\n * was FIRST CREATED. If a node is later referenced inside a different subgraph,\n * it is NOT added to that subgraph. The TS parser is more permissive  it adds\n * referenced nodes to whichever subgraph they appear in.\n *\n * This function fixes the discrepancy by:\n * 1. Walking the edges to determine which nodes were first created inside each subgraph\n * 2. Removing nodes from subgraphs where they weren't first created\n */\nfunction deduplicateSubgraphNodes(\n  mermaidSubgraphs: MermaidSubgraph[],\n  asciiSubgraphs: AsciiSubgraph[],\n  nodeMap: Map<string, AsciiNode>,\n  parsed: MermaidGraph,\n): void {\n  // Build a map from MermaidSubgraph to its corresponding AsciiSubgraph.\n  // The ordering matches since we convert them in the same order.\n  const sgMap = new Map<MermaidSubgraph, AsciiSubgraph>()\n  buildSgMap(mermaidSubgraphs, asciiSubgraphs, sgMap)\n\n  // Determine which subgraph each node was \"first defined\" in.\n  // A node is first defined in the subgraph where it first appears as a NEW node\n  // in the ordered edge/node list. We approximate this by checking the global\n  // node insertion order against subgraph membership.\n  const nodeOwner = new Map<string, AsciiSubgraph>() // nodeId  owning subgraph\n\n  // Walk all mermaid subgraphs in document order. For each subgraph,\n  // claim nodes that haven't been claimed yet by any previous subgraph.\n  function claimNodes(mSg: MermaidSubgraph): void {\n    const asciiSg = sgMap.get(mSg)\n    if (!asciiSg) return\n\n    // Recurse into children first (they appear before parent in the Go parser stack,\n    // but nodes defined in children are added to parent too  this is handled by\n    // the convertSubgraph function which propagates child nodes to parents).\n    // For dedup, we process children first so their claims propagate up correctly.\n    for (const child of mSg.children) {\n      claimNodes(child)\n    }\n\n    // Claim unclaimed nodes in this subgraph\n    for (const nodeId of mSg.nodeIds) {\n      if (!nodeOwner.has(nodeId)) {\n        nodeOwner.set(nodeId, asciiSg)\n      }\n    }\n  }\n\n  for (const mSg of mermaidSubgraphs) {\n    claimNodes(mSg)\n  }\n\n  // Now remove nodes from subgraphs that don't own them.\n  // A node should remain in: its owner subgraph + all ancestors of the owner.\n  for (const asciiSg of asciiSubgraphs) {\n    asciiSg.nodes = asciiSg.nodes.filter(node => {\n      // Find this node's ID in the nodeMap\n      let nodeId: string | undefined\n      for (const [id, n] of nodeMap) {\n        if (n === node) { nodeId = id; break }\n      }\n      if (!nodeId) return false\n\n      const owner = nodeOwner.get(nodeId)\n      if (!owner) return true // not in any subgraph claim  keep as-is\n\n      // Keep the node if this subgraph is the owner or an ancestor of the owner\n      return isAncestorOrSelf(asciiSg, owner)\n    })\n  }\n}\n\n/** Check if `candidate` is the same as or an ancestor of `target`. */\nfunction isAncestorOrSelf(candidate: AsciiSubgraph, target: AsciiSubgraph): boolean {\n  let current: AsciiSubgraph | null = target\n  while (current !== null) {\n    if (current === candidate) return true\n    current = current.parent\n  }\n  return false\n}\n\n/** Build a mapping from MermaidSubgraph  AsciiSubgraph (matching by position). */\nfunction buildSgMap(\n  mSgs: MermaidSubgraph[],\n  aSgs: AsciiSubgraph[],\n  result: Map<MermaidSubgraph, AsciiSubgraph>,\n): void {\n  // The asciiSubgraphs array is flat (all subgraphs including nested ones),\n  // while mermaidSubgraphs is hierarchical. We need to flatten the mermaid tree\n  // in the same order the converter processes them (pre-order DFS).\n  const flatMermaid: MermaidSubgraph[] = []\n  function flatten(sgs: MermaidSubgraph[]): void {\n    for (const sg of sgs) {\n      flatMermaid.push(sg)\n      flatten(sg.children)\n    }\n  }\n  flatten(mSgs)\n\n  for (let i = 0; i < flatMermaid.length && i < aSgs.length; i++) {\n    result.set(flatMermaid[i]!, aSgs[i]!)\n  }\n}\n","// ============================================================================\n// ASCII renderer  A* pathfinding for edge routing\n//\n// Ported from AlexanderGrooff/mermaid-ascii cmd/arrow.go.\n// Uses A* search with a corner-penalizing heuristic to find clean\n// paths between nodes on the grid. Prefers straight lines over zigzags.\n// ============================================================================\n\nimport type { GridCoord, AsciiNode } from './types.ts'\nimport { gridKey, gridCoordEquals } from './types.ts'\n\n// ============================================================================\n// Priority queue (min-heap) for A* open set\n// ============================================================================\n\ninterface PQItem {\n  coord: GridCoord\n  priority: number\n}\n\n/**\n * Simple min-heap priority queue.\n * For the grid sizes we handle (~100s of cells), this is more than fast enough.\n */\nclass MinHeap {\n  private items: PQItem[] = []\n\n  get length(): number {\n    return this.items.length\n  }\n\n  push(item: PQItem): void {\n    this.items.push(item)\n    this.bubbleUp(this.items.length - 1)\n  }\n\n  pop(): PQItem | undefined {\n    if (this.items.length === 0) return undefined\n    const top = this.items[0]!\n    const last = this.items.pop()!\n    if (this.items.length > 0) {\n      this.items[0] = last\n      this.sinkDown(0)\n    }\n    return top\n  }\n\n  private bubbleUp(i: number): void {\n    while (i > 0) {\n      const parent = (i - 1) >> 1\n      if (this.items[i]!.priority < this.items[parent]!.priority) {\n        ;[this.items[i], this.items[parent]] = [this.items[parent]!, this.items[i]!]\n        i = parent\n      } else {\n        break\n      }\n    }\n  }\n\n  private sinkDown(i: number): void {\n    const n = this.items.length\n    while (true) {\n      let smallest = i\n      const left = 2 * i + 1\n      const right = 2 * i + 2\n      if (left < n && this.items[left]!.priority < this.items[smallest]!.priority) {\n        smallest = left\n      }\n      if (right < n && this.items[right]!.priority < this.items[smallest]!.priority) {\n        smallest = right\n      }\n      if (smallest !== i) {\n        ;[this.items[i], this.items[smallest]] = [this.items[smallest]!, this.items[i]!]\n        i = smallest\n      } else {\n        break\n      }\n    }\n  }\n}\n\n// ============================================================================\n// A* heuristic\n// ============================================================================\n\n/**\n * Manhattan distance with a +1 penalty when both dx and dy are non-zero.\n * This encourages the pathfinder to prefer straight lines and minimize corners.\n */\nexport function heuristic(a: GridCoord, b: GridCoord): number {\n  const absX = Math.abs(a.x - b.x)\n  const absY = Math.abs(a.y - b.y)\n  if (absX === 0 || absY === 0) {\n    return absX + absY\n  }\n  return absX + absY + 1\n}\n\n// ============================================================================\n// A* pathfinding\n// ============================================================================\n\n/** 4-directional movement (no diagonals in grid pathfinding). */\nconst MOVE_DIRS: GridCoord[] = [\n  { x: 1, y: 0 },\n  { x: -1, y: 0 },\n  { x: 0, y: 1 },\n  { x: 0, y: -1 },\n]\n\n/** Check if a grid cell is unoccupied and has non-negative coordinates. */\nfunction isFreeInGrid(grid: Map<string, AsciiNode>, c: GridCoord): boolean {\n  if (c.x < 0 || c.y < 0) return false\n  return !grid.has(gridKey(c))\n}\n\n/**\n * Find a path from `from` to `to` on the grid using A*.\n * Returns the path as an array of GridCoords, or null if no path exists.\n */\nexport function getPath(\n  grid: Map<string, AsciiNode>,\n  from: GridCoord,\n  to: GridCoord,\n): GridCoord[] | null {\n  const pq = new MinHeap()\n  pq.push({ coord: from, priority: 0 })\n\n  const costSoFar = new Map<string, number>()\n  costSoFar.set(gridKey(from), 0)\n\n  const cameFrom = new Map<string, GridCoord | null>()\n  cameFrom.set(gridKey(from), null)\n\n  while (pq.length > 0) {\n    const current = pq.pop()!.coord\n\n    if (gridCoordEquals(current, to)) {\n      // Reconstruct path by walking backwards through cameFrom\n      const path: GridCoord[] = []\n      let c: GridCoord | null = current\n      while (c !== null) {\n        path.unshift(c)\n        c = cameFrom.get(gridKey(c)) ?? null\n      }\n      return path\n    }\n\n    const currentCost = costSoFar.get(gridKey(current))!\n\n    for (const dir of MOVE_DIRS) {\n      const next: GridCoord = { x: current.x + dir.x, y: current.y + dir.y }\n\n      // Allow moving to the destination even if it's occupied (it's a node boundary)\n      if (!isFreeInGrid(grid, next) && !gridCoordEquals(next, to)) {\n        continue\n      }\n\n      const newCost = currentCost + 1\n      const nextKey = gridKey(next)\n      const existingCost = costSoFar.get(nextKey)\n\n      if (existingCost === undefined || newCost < existingCost) {\n        costSoFar.set(nextKey, newCost)\n        const priority = newCost + heuristic(next, to)\n        pq.push({ coord: next, priority })\n        cameFrom.set(nextKey, current)\n      }\n    }\n  }\n\n  return null // No path found\n}\n\n/**\n * Simplify a path by removing intermediate waypoints on straight segments.\n * E.g., [(0,0), (1,0), (2,0), (2,1)] becomes [(0,0), (2,0), (2,1)].\n * This reduces the number of line-drawing operations.\n */\nexport function mergePath(path: GridCoord[]): GridCoord[] {\n  if (path.length <= 2) return path\n\n  const toRemove = new Set<number>()\n  let step0 = path[0]!\n  let step1 = path[1]!\n\n  for (let idx = 2; idx < path.length; idx++) {\n    const step2 = path[idx]!\n    const prevDx = step1.x - step0.x\n    const prevDy = step1.y - step0.y\n    const dx = step2.x - step1.x\n    const dy = step2.y - step1.y\n\n    // Same direction  the middle point is redundant\n    if (prevDx === dx && prevDy === dy) {\n      // In Go: indexToRemove = append(indexToRemove, idx+1) but idx is 0-based from path[2:]\n      // which corresponds to index idx in the full path. Go uses idx+1 because idx iterates\n      // from 0 in the [2:] slice, mapping to full-array index idx+1.\n      // Actually re-checking Go code: the loop is `for idx, step2 := range path[2:]`\n      // so idx=0  path[2], and it removes idx+1 which is index 1 in the full array.\n      // Wait, that doesn't look right. Let me re-read:\n      //   step0 = path[0], step1 = path[1]\n      //   for idx, step2 := range path[2:] { ... indexToRemove = append(indexToRemove, idx+1) ... }\n      //   When idx=0, step2=path[2], and it removes index 1 (step1 = path[1]) if directions match\n      // So it removes the middle point (step1) which is at index idx+1 in the original array\n      // when counting from the 2-ahead loop. Let me just track which middle indices to remove.\n      toRemove.add(idx - 1) // Remove the middle point (step1's position)\n    }\n\n    step0 = step1\n    step1 = step2\n  }\n\n  return path.filter((_, i) => !toRemove.has(i))\n}\n","// ============================================================================\n// ASCII renderer  direction system and edge path determination\n//\n// Ported from AlexanderGrooff/mermaid-ascii cmd/direction.go + cmd/mapping_edge.go.\n// Handles direction constants, edge attachment point selection,\n// and dual-path comparison for optimal edge routing.\n// ============================================================================\n\nimport type { GridCoord, Direction, AsciiEdge, AsciiGraph } from './types.ts'\nimport {\n  Up, Down, Left, Right, UpperRight, UpperLeft, LowerRight, LowerLeft, Middle,\n  gridCoordDirection,\n} from './types.ts'\nimport { getPath, mergePath } from './pathfinder.ts'\n\n// ============================================================================\n// Direction utilities\n// ============================================================================\n\nexport function getOpposite(d: Direction): Direction {\n  if (d === Up) return Down\n  if (d === Down) return Up\n  if (d === Left) return Right\n  if (d === Right) return Left\n  if (d === UpperRight) return LowerLeft\n  if (d === UpperLeft) return LowerRight\n  if (d === LowerRight) return UpperLeft\n  if (d === LowerLeft) return UpperRight\n  return Middle\n}\n\n/** Compare directions by value (not reference). */\nexport function dirEquals(a: Direction, b: Direction): boolean {\n  return a.x === b.x && a.y === b.y\n}\n\n/**\n * Determine 8-way direction from one coordinate to another.\n * Uses the coordinate difference to pick one of 8 cardinal/ordinal directions.\n */\nexport function determineDirection(from: { x: number; y: number }, to: { x: number; y: number }): Direction {\n  if (from.x === to.x) {\n    return from.y < to.y ? Down : Up\n  } else if (from.y === to.y) {\n    return from.x < to.x ? Right : Left\n  } else if (from.x < to.x) {\n    return from.y < to.y ? LowerRight : UpperRight\n  } else {\n    return from.y < to.y ? LowerLeft : UpperLeft\n  }\n}\n\n// ============================================================================\n// Start/end direction selection for edges\n// ============================================================================\n\n/** Self-reference routing (node points to itself). */\nfunction selfReferenceDirection(graphDirection: string): [Direction, Direction, Direction, Direction] {\n  if (graphDirection === 'LR') return [Right, Down, Down, Right]\n  return [Down, Right, Right, Down]\n}\n\n/**\n * Determine preferred and alternative start/end directions for an edge.\n * Returns [preferredStart, preferredEnd, alternativeStart, alternativeEnd].\n *\n * The edge routing tries both pairs and picks the shorter path.\n * Direction selection depends on relative node positions and graph direction (LR vs TD).\n */\nexport function determineStartAndEndDir(\n  edge: AsciiEdge,\n  graphDirection: string,\n): [Direction, Direction, Direction, Direction] {\n  if (edge.from === edge.to) return selfReferenceDirection(graphDirection)\n\n  const d = determineDirection(edge.from.gridCoord!, edge.to.gridCoord!)\n\n  let preferredDir: Direction\n  let preferredOppositeDir: Direction\n  let alternativeDir: Direction\n  let alternativeOppositeDir: Direction\n\n  const isBackwards = graphDirection === 'LR'\n    ? (dirEquals(d, Left) || dirEquals(d, UpperLeft) || dirEquals(d, LowerLeft))\n    : (dirEquals(d, Up) || dirEquals(d, UpperLeft) || dirEquals(d, UpperRight))\n\n  if (dirEquals(d, LowerRight)) {\n    if (graphDirection === 'LR') {\n      preferredDir = Down; preferredOppositeDir = Left\n      alternativeDir = Right; alternativeOppositeDir = Up\n    } else {\n      preferredDir = Right; preferredOppositeDir = Up\n      alternativeDir = Down; alternativeOppositeDir = Left\n    }\n  } else if (dirEquals(d, UpperRight)) {\n    if (graphDirection === 'LR') {\n      preferredDir = Up; preferredOppositeDir = Left\n      alternativeDir = Right; alternativeOppositeDir = Down\n    } else {\n      preferredDir = Right; preferredOppositeDir = Down\n      alternativeDir = Up; alternativeOppositeDir = Left\n    }\n  } else if (dirEquals(d, LowerLeft)) {\n    if (graphDirection === 'LR') {\n      preferredDir = Down; preferredOppositeDir = Down\n      alternativeDir = Left; alternativeOppositeDir = Up\n    } else {\n      preferredDir = Left; preferredOppositeDir = Up\n      alternativeDir = Down; alternativeOppositeDir = Right\n    }\n  } else if (dirEquals(d, UpperLeft)) {\n    if (graphDirection === 'LR') {\n      preferredDir = Down; preferredOppositeDir = Down\n      alternativeDir = Left; alternativeOppositeDir = Down\n    } else {\n      preferredDir = Right; preferredOppositeDir = Right\n      alternativeDir = Up; alternativeOppositeDir = Right\n    }\n  } else if (isBackwards) {\n    if (graphDirection === 'LR' && dirEquals(d, Left)) {\n      preferredDir = Down; preferredOppositeDir = Down\n      alternativeDir = Left; alternativeOppositeDir = Right\n    } else if (graphDirection === 'TD' && dirEquals(d, Up)) {\n      preferredDir = Right; preferredOppositeDir = Right\n      alternativeDir = Up; alternativeOppositeDir = Down\n    } else {\n      preferredDir = d; preferredOppositeDir = getOpposite(d)\n      alternativeDir = d; alternativeOppositeDir = getOpposite(d)\n    }\n  } else {\n    // Default: go in the natural direction\n    preferredDir = d; preferredOppositeDir = getOpposite(d)\n    alternativeDir = d; alternativeOppositeDir = getOpposite(d)\n  }\n\n  return [preferredDir, preferredOppositeDir, alternativeDir, alternativeOppositeDir]\n}\n\n// ============================================================================\n// Edge path determination\n// ============================================================================\n\n/**\n * Determine the path for an edge by trying two candidate routes (preferred + alternative)\n * and picking the shorter one. Sets edge.path, edge.startDir, edge.endDir.\n */\nexport function determinePath(graph: AsciiGraph, edge: AsciiEdge): void {\n  const [preferredDir, preferredOppositeDir, alternativeDir, alternativeOppositeDir] =\n    determineStartAndEndDir(edge, graph.config.graphDirection)\n\n  // Try preferred path\n  const prefFrom = gridCoordDirection(edge.from.gridCoord!, preferredDir)\n  const prefTo = gridCoordDirection(edge.to.gridCoord!, preferredOppositeDir)\n  let preferredPath = getPath(graph.grid, prefFrom, prefTo)\n\n  if (preferredPath === null) {\n    // No preferred path found  use alternative\n    edge.startDir = alternativeDir\n    edge.endDir = alternativeOppositeDir\n    edge.path = []\n    return\n  }\n  preferredPath = mergePath(preferredPath)\n\n  // Try alternative path\n  const altFrom = gridCoordDirection(edge.from.gridCoord!, alternativeDir)\n  const altTo = gridCoordDirection(edge.to.gridCoord!, alternativeOppositeDir)\n  let alternativePath = getPath(graph.grid, altFrom, altTo)\n\n  if (alternativePath === null) {\n    // Only preferred path works\n    edge.startDir = preferredDir\n    edge.endDir = preferredOppositeDir\n    edge.path = preferredPath\n    return\n  }\n  alternativePath = mergePath(alternativePath)\n\n  // Pick the shorter path\n  if (preferredPath.length <= alternativePath.length) {\n    edge.startDir = preferredDir\n    edge.endDir = preferredOppositeDir\n    edge.path = preferredPath\n  } else {\n    edge.startDir = alternativeDir\n    edge.endDir = alternativeOppositeDir\n    edge.path = alternativePath\n  }\n}\n\n/**\n * Find the best line segment in an edge's path to place a label on.\n * Picks the first segment wide enough for the label, or the widest segment overall.\n * Also increases the column width at the label position to fit the text.\n */\nexport function determineLabelLine(graph: AsciiGraph, edge: AsciiEdge): void {\n  if (edge.text.length === 0) return\n\n  const lenLabel = edge.text.length\n  let prevStep = edge.path[0]!\n  let largestLine: [GridCoord, GridCoord] = [prevStep, edge.path[1]!]\n  let largestLineSize = 0\n\n  for (let i = 1; i < edge.path.length; i++) {\n    const step = edge.path[i]!\n    const line: [GridCoord, GridCoord] = [prevStep, step]\n    const lineWidth = calculateLineWidth(graph, line)\n\n    if (lineWidth >= lenLabel) {\n      largestLine = line\n      break\n    } else if (lineWidth > largestLineSize) {\n      largestLineSize = lineWidth\n      largestLine = line\n    }\n    prevStep = step\n  }\n\n  // Ensure column at midpoint is wide enough for the label\n  const minX = Math.min(largestLine[0].x, largestLine[1].x)\n  const maxX = Math.max(largestLine[0].x, largestLine[1].x)\n  const middleX = minX + Math.floor((maxX - minX) / 2)\n\n  const current = graph.columnWidth.get(middleX) ?? 0\n  graph.columnWidth.set(middleX, Math.max(current, lenLabel + 2))\n\n  edge.labelLine = [largestLine[0], largestLine[1]]\n}\n\n/** Calculate the total character width of a line segment by summing column widths. */\nfunction calculateLineWidth(graph: AsciiGraph, line: [GridCoord, GridCoord]): number {\n  let total = 0\n  const startX = Math.min(line[0].x, line[1].x)\n  const endX = Math.max(line[0].x, line[1].x)\n  for (let x = startX; x <= endX; x++) {\n    total += graph.columnWidth.get(x) ?? 0\n  }\n  return total\n}\n","// ============================================================================\n// ASCII renderer  drawing operations\n//\n// Ported from AlexanderGrooff/mermaid-ascii cmd/draw.go + cmd/arrow.go.\n// Contains all visual rendering: boxes, lines, arrows, corners,\n// subgraphs, labels, and the top-level draw orchestrator.\n// ============================================================================\n\nimport type {\n  Canvas, DrawingCoord, GridCoord, Direction,\n  AsciiGraph, AsciiNode, AsciiEdge, AsciiSubgraph,\n} from './types.ts'\nimport {\n  Up, Down, Left, Right, UpperLeft, UpperRight, LowerLeft, LowerRight, Middle,\n  drawingCoordEquals,\n} from './types.ts'\nimport { mkCanvas, copyCanvas, getCanvasSize, mergeCanvases, drawText } from './canvas.ts'\nimport { determineDirection, dirEquals } from './edge-routing.ts'\nimport { gridToDrawingCoord, lineToDrawing } from './grid.ts'\n\n// ============================================================================\n// Box drawing  renders a node as a bordered rectangle\n// ============================================================================\n\n/**\n * Draw a node box with centered label text.\n * Returns a standalone canvas containing just the box.\n * Box size is determined by the grid column/row sizes for the node's position.\n */\nexport function drawBox(node: AsciiNode, graph: AsciiGraph): Canvas {\n  const gc = node.gridCoord!\n  const useAscii = graph.config.useAscii\n\n  // Width spans 2 columns (border + content)\n  let w = 0\n  for (let i = 0; i < 2; i++) {\n    w += graph.columnWidth.get(gc.x + i) ?? 0\n  }\n  // Height spans 2 rows (border + content)\n  let h = 0\n  for (let i = 0; i < 2; i++) {\n    h += graph.rowHeight.get(gc.y + i) ?? 0\n  }\n\n  const from: DrawingCoord = { x: 0, y: 0 }\n  const to: DrawingCoord = { x: w, y: h }\n  const box = mkCanvas(Math.max(from.x, to.x), Math.max(from.y, to.y))\n\n  if (!useAscii) {\n    // Unicode box-drawing characters\n    for (let x = from.x + 1; x < to.x; x++) box[x]![from.y] = ''\n    for (let x = from.x + 1; x < to.x; x++) box[x]![to.y] = ''\n    for (let y = from.y + 1; y < to.y; y++) box[from.x]![y] = ''\n    for (let y = from.y + 1; y < to.y; y++) box[to.x]![y] = ''\n    box[from.x]![from.y] = ''\n    box[to.x]![from.y] = ''\n    box[from.x]![to.y] = ''\n    box[to.x]![to.y] = ''\n  } else {\n    // ASCII characters\n    for (let x = from.x + 1; x < to.x; x++) box[x]![from.y] = '-'\n    for (let x = from.x + 1; x < to.x; x++) box[x]![to.y] = '-'\n    for (let y = from.y + 1; y < to.y; y++) box[from.x]![y] = '|'\n    for (let y = from.y + 1; y < to.y; y++) box[to.x]![y] = '|'\n    box[from.x]![from.y] = '+'\n    box[to.x]![from.y] = '+'\n    box[from.x]![to.y] = '+'\n    box[to.x]![to.y] = '+'\n  }\n\n  // Center the display label inside the box\n  const label = node.displayLabel\n  const textY = from.y + Math.floor(h / 2)\n  const textX = from.x + Math.floor(w / 2) - Math.ceil(label.length / 2) + 1\n  for (let i = 0; i < label.length; i++) {\n    box[textX + i]![textY] = label[i]!\n  }\n\n  return box\n}\n\n// ============================================================================\n// Multi-section box drawing  for class and ER diagram nodes\n// ============================================================================\n\n/**\n * Draw a multi-section box with horizontal dividers between sections.\n * Used by class diagrams (header | attributes | methods) and ER diagrams (header | attributes).\n * Each section is an array of text lines to render left-aligned with padding.\n *\n * @param sections - Array of sections, each section is an array of text lines\n * @param useAscii - true for ASCII chars, false for Unicode box-drawing\n * @param padding - horizontal padding inside the box (default 1)\n * @returns A standalone Canvas containing the multi-section box\n */\nexport function drawMultiBox(\n  sections: string[][],\n  useAscii: boolean,\n  padding: number = 1,\n): Canvas {\n  // Compute width: widest line across all sections + 2*padding + 2 border chars\n  let maxTextWidth = 0\n  for (const section of sections) {\n    for (const line of section) {\n      maxTextWidth = Math.max(maxTextWidth, line.length)\n    }\n  }\n  const innerWidth = maxTextWidth + 2 * padding\n  const boxWidth = innerWidth + 2 // +2 for left/right border\n\n  // Compute height: sum of all section line counts + dividers + 2 border rows\n  let totalLines = 0\n  for (const section of sections) {\n    totalLines += Math.max(section.length, 1) // at least 1 row per section\n  }\n  const numDividers = sections.length - 1\n  const boxHeight = totalLines + numDividers + 2 // +2 for top/bottom border\n\n  // Box-drawing characters\n  const hLine = useAscii ? '-' : ''\n  const vLine = useAscii ? '|' : ''\n  const tl = useAscii ? '+' : ''\n  const tr = useAscii ? '+' : ''\n  const bl = useAscii ? '+' : ''\n  const br = useAscii ? '+' : ''\n  const divL = useAscii ? '+' : ''\n  const divR = useAscii ? '+' : ''\n\n  const canvas = mkCanvas(boxWidth - 1, boxHeight - 1)\n\n  // Top border\n  canvas[0]![0] = tl\n  for (let x = 1; x < boxWidth - 1; x++) canvas[x]![0] = hLine\n  canvas[boxWidth - 1]![0] = tr\n\n  // Bottom border\n  canvas[0]![boxHeight - 1] = bl\n  for (let x = 1; x < boxWidth - 1; x++) canvas[x]![boxHeight - 1] = hLine\n  canvas[boxWidth - 1]![boxHeight - 1] = br\n\n  // Left and right borders (full height)\n  for (let y = 1; y < boxHeight - 1; y++) {\n    canvas[0]![y] = vLine\n    canvas[boxWidth - 1]![y] = vLine\n  }\n\n  // Render sections with dividers\n  let row = 1 // current y position (starts after top border)\n  for (let s = 0; s < sections.length; s++) {\n    const section = sections[s]!\n    const lines = section.length > 0 ? section : ['']\n\n    // Draw section text lines\n    for (const line of lines) {\n      const startX = 1 + padding\n      for (let i = 0; i < line.length; i++) {\n        canvas[startX + i]![row] = line[i]!\n      }\n      row++\n    }\n\n    // Draw divider after each section except the last\n    if (s < sections.length - 1) {\n      canvas[0]![row] = divL\n      for (let x = 1; x < boxWidth - 1; x++) canvas[x]![row] = hLine\n      canvas[boxWidth - 1]![row] = divR\n      row++\n    }\n  }\n\n  return canvas\n}\n\n// ============================================================================\n// Line drawing  8-directional lines on the canvas\n// ============================================================================\n\n/**\n * Draw a line between two drawing coordinates.\n * Returns the list of coordinates that were drawn on.\n * offsetFrom/offsetTo control how many cells to skip at the start/end.\n */\nexport function drawLine(\n  canvas: Canvas,\n  from: DrawingCoord,\n  to: DrawingCoord,\n  offsetFrom: number,\n  offsetTo: number,\n  useAscii: boolean,\n): DrawingCoord[] {\n  const dir = determineDirection(from, to)\n  const drawnCoords: DrawingCoord[] = []\n\n  // Horizontal/vertical/diagonal character pairs: [unicode, ascii]\n  const hChar = useAscii ? '-' : ''\n  const vChar = useAscii ? '|' : ''\n  const bslash = useAscii ? '\\\\' : ''\n  const fslash = useAscii ? '/' : ''\n\n  if (dirEquals(dir, Up)) {\n    for (let y = from.y - offsetFrom; y >= to.y - offsetTo; y--) {\n      drawnCoords.push({ x: from.x, y })\n      canvas[from.x]![y] = vChar\n    }\n  } else if (dirEquals(dir, Down)) {\n    for (let y = from.y + offsetFrom; y <= to.y + offsetTo; y++) {\n      drawnCoords.push({ x: from.x, y })\n      canvas[from.x]![y] = vChar\n    }\n  } else if (dirEquals(dir, Left)) {\n    for (let x = from.x - offsetFrom; x >= to.x - offsetTo; x--) {\n      drawnCoords.push({ x, y: from.y })\n      canvas[x]![from.y] = hChar\n    }\n  } else if (dirEquals(dir, Right)) {\n    for (let x = from.x + offsetFrom; x <= to.x + offsetTo; x++) {\n      drawnCoords.push({ x, y: from.y })\n      canvas[x]![from.y] = hChar\n    }\n  } else if (dirEquals(dir, UpperLeft)) {\n    for (let x = from.x, y = from.y - offsetFrom; x >= to.x - offsetTo && y >= to.y - offsetTo; x--, y--) {\n      drawnCoords.push({ x, y })\n      canvas[x]![y] = bslash\n    }\n  } else if (dirEquals(dir, UpperRight)) {\n    for (let x = from.x, y = from.y - offsetFrom; x <= to.x + offsetTo && y >= to.y - offsetTo; x++, y--) {\n      drawnCoords.push({ x, y })\n      canvas[x]![y] = fslash\n    }\n  } else if (dirEquals(dir, LowerLeft)) {\n    for (let x = from.x, y = from.y + offsetFrom; x >= to.x - offsetTo && y <= to.y + offsetTo; x--, y++) {\n      drawnCoords.push({ x, y })\n      canvas[x]![y] = fslash\n    }\n  } else if (dirEquals(dir, LowerRight)) {\n    for (let x = from.x, y = from.y + offsetFrom; x <= to.x + offsetTo && y <= to.y + offsetTo; x++, y++) {\n      drawnCoords.push({ x, y })\n      canvas[x]![y] = bslash\n    }\n  }\n\n  return drawnCoords\n}\n\n// ============================================================================\n// Arrow drawing  path, corners, arrowheads, box-start junctions, labels\n// ============================================================================\n\n/**\n * Draw a complete arrow (edge) between two nodes.\n * Returns 5 separate canvases for layered compositing:\n * [path, boxStart, arrowHead, corners, label]\n */\nexport function drawArrow(\n  graph: AsciiGraph,\n  edge: AsciiEdge,\n): [Canvas, Canvas, Canvas, Canvas, Canvas] {\n  if (edge.path.length === 0) {\n    const empty = copyCanvas(graph.canvas)\n    return [empty, empty, empty, empty, empty]\n  }\n\n  const labelCanvas = drawArrowLabel(graph, edge)\n  const [pathCanvas, linesDrawn, lineDirs] = drawPath(graph, edge.path)\n  const boxStartCanvas = drawBoxStart(graph, edge.path, linesDrawn[0]!)\n  const arrowHeadCanvas = drawArrowHead(\n    graph,\n    linesDrawn[linesDrawn.length - 1]!,\n    lineDirs[lineDirs.length - 1]!,\n  )\n  const cornersCanvas = drawCorners(graph, edge.path)\n\n  return [pathCanvas, boxStartCanvas, arrowHeadCanvas, cornersCanvas, labelCanvas]\n}\n\n/**\n * Draw the path lines for an edge.\n * Returns the canvas, the coordinates drawn for each segment, and the direction of each segment.\n */\nfunction drawPath(\n  graph: AsciiGraph,\n  path: GridCoord[],\n): [Canvas, DrawingCoord[][], Direction[]] {\n  const canvas = copyCanvas(graph.canvas)\n  let previousCoord = path[0]!\n  const linesDrawn: DrawingCoord[][] = []\n  const lineDirs: Direction[] = []\n\n  for (let i = 1; i < path.length; i++) {\n    const nextCoord = path[i]!\n    const prevDC = gridToDrawingCoord(graph, previousCoord)\n    const nextDC = gridToDrawingCoord(graph, nextCoord)\n\n    if (drawingCoordEquals(prevDC, nextDC)) {\n      previousCoord = nextCoord\n      continue\n    }\n\n    const dir = determineDirection(previousCoord, nextCoord)\n    const segment = drawLine(canvas, prevDC, nextDC, 1, -1, graph.config.useAscii)\n    if (segment.length === 0) segment.push(prevDC)\n    linesDrawn.push(segment)\n    lineDirs.push(dir)\n    previousCoord = nextCoord\n  }\n\n  return [canvas, linesDrawn, lineDirs]\n}\n\n/**\n * Draw the junction character where an edge exits the source node's box.\n * Only applies to Unicode mode (ASCII mode just uses the line characters).\n */\nfunction drawBoxStart(\n  graph: AsciiGraph,\n  path: GridCoord[],\n  firstLine: DrawingCoord[],\n): Canvas {\n  const canvas = copyCanvas(graph.canvas)\n  if (graph.config.useAscii) return canvas\n\n  const from = firstLine[0]!\n  const dir = determineDirection(path[0]!, path[1]!)\n\n  if (dirEquals(dir, Up)) canvas[from.x]![from.y + 1] = ''\n  else if (dirEquals(dir, Down)) canvas[from.x]![from.y - 1] = ''\n  else if (dirEquals(dir, Left)) canvas[from.x + 1]![from.y] = ''\n  else if (dirEquals(dir, Right)) canvas[from.x - 1]![from.y] = ''\n\n  return canvas\n}\n\n/**\n * Draw the arrowhead at the end of an edge path.\n * Uses triangular Unicode symbols () or ASCII symbols (^v<>).\n */\nfunction drawArrowHead(\n  graph: AsciiGraph,\n  lastLine: DrawingCoord[],\n  fallbackDir: Direction,\n): Canvas {\n  const canvas = copyCanvas(graph.canvas)\n  if (lastLine.length === 0) return canvas\n\n  const from = lastLine[0]!\n  const lastPos = lastLine[lastLine.length - 1]!\n  let dir = determineDirection(from, lastPos)\n  if (lastLine.length === 1 || dirEquals(dir, Middle)) dir = fallbackDir\n\n  let char: string\n\n  if (!graph.config.useAscii) {\n    if (dirEquals(dir, Up)) char = ''\n    else if (dirEquals(dir, Down)) char = ''\n    else if (dirEquals(dir, Left)) char = ''\n    else if (dirEquals(dir, Right)) char = ''\n    else if (dirEquals(dir, UpperRight)) char = ''\n    else if (dirEquals(dir, UpperLeft)) char = ''\n    else if (dirEquals(dir, LowerRight)) char = ''\n    else if (dirEquals(dir, LowerLeft)) char = ''\n    else {\n      // Fallback\n      if (dirEquals(fallbackDir, Up)) char = ''\n      else if (dirEquals(fallbackDir, Down)) char = ''\n      else if (dirEquals(fallbackDir, Left)) char = ''\n      else if (dirEquals(fallbackDir, Right)) char = ''\n      else if (dirEquals(fallbackDir, UpperRight)) char = ''\n      else if (dirEquals(fallbackDir, UpperLeft)) char = ''\n      else if (dirEquals(fallbackDir, LowerRight)) char = ''\n      else if (dirEquals(fallbackDir, LowerLeft)) char = ''\n      else char = ''\n    }\n  } else {\n    if (dirEquals(dir, Up)) char = '^'\n    else if (dirEquals(dir, Down)) char = 'v'\n    else if (dirEquals(dir, Left)) char = '<'\n    else if (dirEquals(dir, Right)) char = '>'\n    else {\n      if (dirEquals(fallbackDir, Up)) char = '^'\n      else if (dirEquals(fallbackDir, Down)) char = 'v'\n      else if (dirEquals(fallbackDir, Left)) char = '<'\n      else if (dirEquals(fallbackDir, Right)) char = '>'\n      else char = '*'\n    }\n  }\n\n  canvas[lastPos.x]![lastPos.y] = char\n  return canvas\n}\n\n/**\n * Draw corner characters at path bends (where the direction changes).\n * Uses  in Unicode mode, + in ASCII mode.\n */\nfunction drawCorners(graph: AsciiGraph, path: GridCoord[]): Canvas {\n  const canvas = copyCanvas(graph.canvas)\n\n  for (let idx = 1; idx < path.length - 1; idx++) {\n    const coord = path[idx]!\n    const dc = gridToDrawingCoord(graph, coord)\n    const prevDir = determineDirection(path[idx - 1]!, coord)\n    const nextDir = determineDirection(coord, path[idx + 1]!)\n\n    let corner: string\n    if (!graph.config.useAscii) {\n      if ((dirEquals(prevDir, Right) && dirEquals(nextDir, Down)) ||\n          (dirEquals(prevDir, Up) && dirEquals(nextDir, Left))) {\n        corner = ''\n      } else if ((dirEquals(prevDir, Right) && dirEquals(nextDir, Up)) ||\n                 (dirEquals(prevDir, Down) && dirEquals(nextDir, Left))) {\n        corner = ''\n      } else if ((dirEquals(prevDir, Left) && dirEquals(nextDir, Down)) ||\n                 (dirEquals(prevDir, Up) && dirEquals(nextDir, Right))) {\n        corner = ''\n      } else if ((dirEquals(prevDir, Left) && dirEquals(nextDir, Up)) ||\n                 (dirEquals(prevDir, Down) && dirEquals(nextDir, Right))) {\n        corner = ''\n      } else {\n        corner = '+'\n      }\n    } else {\n      corner = '+'\n    }\n\n    canvas[dc.x]![dc.y] = corner\n  }\n\n  return canvas\n}\n\n/** Draw edge label text centered on the widest path segment. */\nfunction drawArrowLabel(graph: AsciiGraph, edge: AsciiEdge): Canvas {\n  const canvas = copyCanvas(graph.canvas)\n  if (edge.text.length === 0) return canvas\n\n  const drawingLine = lineToDrawing(graph, edge.labelLine)\n  drawTextOnLine(canvas, drawingLine, edge.text)\n  return canvas\n}\n\n/** Draw text centered on a line segment defined by two drawing coordinates. */\nfunction drawTextOnLine(canvas: Canvas, line: DrawingCoord[], label: string): void {\n  if (line.length < 2) return\n  const minX = Math.min(line[0]!.x, line[1]!.x)\n  const maxX = Math.max(line[0]!.x, line[1]!.x)\n  const minY = Math.min(line[0]!.y, line[1]!.y)\n  const maxY = Math.max(line[0]!.y, line[1]!.y)\n  const middleX = minX + Math.floor((maxX - minX) / 2)\n  const middleY = minY + Math.floor((maxY - minY) / 2)\n  const startX = middleX - Math.floor(label.length / 2)\n  drawText(canvas, { x: startX, y: middleY }, label)\n}\n\n// ============================================================================\n// Subgraph drawing\n// ============================================================================\n\n/** Draw a subgraph border rectangle. */\nexport function drawSubgraphBox(sg: AsciiSubgraph, graph: AsciiGraph): Canvas {\n  const width = sg.maxX - sg.minX\n  const height = sg.maxY - sg.minY\n  if (width <= 0 || height <= 0) return mkCanvas(0, 0)\n\n  const from: DrawingCoord = { x: 0, y: 0 }\n  const to: DrawingCoord = { x: width, y: height }\n  const canvas = mkCanvas(width, height)\n\n  if (!graph.config.useAscii) {\n    for (let x = from.x + 1; x < to.x; x++) canvas[x]![from.y] = ''\n    for (let x = from.x + 1; x < to.x; x++) canvas[x]![to.y] = ''\n    for (let y = from.y + 1; y < to.y; y++) canvas[from.x]![y] = ''\n    for (let y = from.y + 1; y < to.y; y++) canvas[to.x]![y] = ''\n    canvas[from.x]![from.y] = ''\n    canvas[to.x]![from.y] = ''\n    canvas[from.x]![to.y] = ''\n    canvas[to.x]![to.y] = ''\n  } else {\n    for (let x = from.x + 1; x < to.x; x++) canvas[x]![from.y] = '-'\n    for (let x = from.x + 1; x < to.x; x++) canvas[x]![to.y] = '-'\n    for (let y = from.y + 1; y < to.y; y++) canvas[from.x]![y] = '|'\n    for (let y = from.y + 1; y < to.y; y++) canvas[to.x]![y] = '|'\n    canvas[from.x]![from.y] = '+'\n    canvas[to.x]![from.y] = '+'\n    canvas[from.x]![to.y] = '+'\n    canvas[to.x]![to.y] = '+'\n  }\n\n  return canvas\n}\n\n/** Draw a subgraph label centered in its header area. */\nexport function drawSubgraphLabel(sg: AsciiSubgraph, graph: AsciiGraph): [Canvas, DrawingCoord] {\n  const width = sg.maxX - sg.minX\n  const height = sg.maxY - sg.minY\n  if (width <= 0 || height <= 0) return [mkCanvas(0, 0), { x: 0, y: 0 }]\n\n  const canvas = mkCanvas(width, height)\n  const labelY = 1 // second row inside the subgraph box\n  let labelX = Math.floor(width / 2) - Math.floor(sg.name.length / 2)\n  if (labelX < 1) labelX = 1\n\n  for (let i = 0; i < sg.name.length; i++) {\n    if (labelX + i < width) {\n      canvas[labelX + i]![labelY] = sg.name[i]!\n    }\n  }\n\n  return [canvas, { x: sg.minX, y: sg.minY }]\n}\n\n// ============================================================================\n// Top-level draw orchestrator\n// ============================================================================\n\n/** Sort subgraphs by nesting depth (shallowest first) for correct layered rendering. */\nfunction sortSubgraphsByDepth(subgraphs: AsciiSubgraph[]): AsciiSubgraph[] {\n  function getDepth(sg: AsciiSubgraph): number {\n    return sg.parent === null ? 0 : 1 + getDepth(sg.parent)\n  }\n  const sorted = [...subgraphs]\n  sorted.sort((a, b) => getDepth(a) - getDepth(b))\n  return sorted\n}\n\n/**\n * Main draw function  renders the entire graph onto the canvas.\n * Drawing order matters for correct layering:\n * 1. Subgraph borders (bottom layer)\n * 2. Node boxes\n * 3. Edge paths (lines)\n * 4. Edge corners\n * 5. Arrowheads\n * 6. Box-start junctions\n * 7. Edge labels\n * 8. Subgraph labels (top layer)\n */\nexport function drawGraph(graph: AsciiGraph): Canvas {\n  const useAscii = graph.config.useAscii\n\n  // Draw subgraph borders\n  const sortedSgs = sortSubgraphsByDepth(graph.subgraphs)\n  for (const sg of sortedSgs) {\n    const sgCanvas = drawSubgraphBox(sg, graph)\n    const offset: DrawingCoord = { x: sg.minX, y: sg.minY }\n    graph.canvas = mergeCanvases(graph.canvas, offset, useAscii, sgCanvas)\n  }\n\n  // Draw node boxes\n  for (const node of graph.nodes) {\n    if (!node.drawn && node.drawingCoord && node.drawing) {\n      graph.canvas = mergeCanvases(graph.canvas, node.drawingCoord, useAscii, node.drawing)\n      node.drawn = true\n    }\n  }\n\n  // Collect all edge drawing layers\n  const lineCanvases: Canvas[] = []\n  const cornerCanvases: Canvas[] = []\n  const arrowHeadCanvases: Canvas[] = []\n  const boxStartCanvases: Canvas[] = []\n  const labelCanvases: Canvas[] = []\n\n  for (const edge of graph.edges) {\n    const [pathC, boxStartC, arrowHeadC, cornersC, labelC] = drawArrow(graph, edge)\n    lineCanvases.push(pathC)\n    cornerCanvases.push(cornersC)\n    arrowHeadCanvases.push(arrowHeadC)\n    boxStartCanvases.push(boxStartC)\n    labelCanvases.push(labelC)\n  }\n\n  // Merge edge layers in order\n  const zero: DrawingCoord = { x: 0, y: 0 }\n  graph.canvas = mergeCanvases(graph.canvas, zero, useAscii, ...lineCanvases)\n  graph.canvas = mergeCanvases(graph.canvas, zero, useAscii, ...cornerCanvases)\n  graph.canvas = mergeCanvases(graph.canvas, zero, useAscii, ...arrowHeadCanvases)\n  graph.canvas = mergeCanvases(graph.canvas, zero, useAscii, ...boxStartCanvases)\n  graph.canvas = mergeCanvases(graph.canvas, zero, useAscii, ...labelCanvases)\n\n  // Draw subgraph labels last (on top)\n  for (const sg of graph.subgraphs) {\n    if (sg.nodes.length === 0) continue\n    const [labelCanvas, offset] = drawSubgraphLabel(sg, graph)\n    graph.canvas = mergeCanvases(graph.canvas, offset, useAscii, labelCanvas)\n  }\n\n  return graph.canvas\n}\n","// ============================================================================\n// ASCII renderer  grid-based layout\n//\n// Ported from AlexanderGrooff/mermaid-ascii cmd/graph.go + cmd/mapping_node.go.\n// Places nodes on a logical grid, computes column/row sizes,\n// converts grid coordinates to character-level drawing coordinates,\n// and handles subgraph bounding boxes.\n// ============================================================================\n\nimport type {\n  GridCoord, DrawingCoord, Direction, AsciiGraph, AsciiNode, AsciiSubgraph,\n} from './types.ts'\nimport { gridKey } from './types.ts'\nimport { mkCanvas, setCanvasSizeToGrid } from './canvas.ts'\nimport { determinePath, determineLabelLine } from './edge-routing.ts'\nimport { drawBox } from './draw.ts'\n\n// ============================================================================\n// Grid coordinate  drawing coordinate conversion\n// ============================================================================\n\n/**\n * Convert a grid coordinate to a drawing (character) coordinate.\n * Sums column widths up to the target column, and row heights up to the target row,\n * then centers within the cell.\n */\nexport function gridToDrawingCoord(\n  graph: AsciiGraph,\n  c: GridCoord,\n  dir?: Direction,\n): DrawingCoord {\n  const target: GridCoord = dir\n    ? { x: c.x + dir.x, y: c.y + dir.y }\n    : c\n\n  let x = 0\n  for (let col = 0; col < target.x; col++) {\n    x += graph.columnWidth.get(col) ?? 0\n  }\n\n  let y = 0\n  for (let row = 0; row < target.y; row++) {\n    y += graph.rowHeight.get(row) ?? 0\n  }\n\n  const colW = graph.columnWidth.get(target.x) ?? 0\n  const rowH = graph.rowHeight.get(target.y) ?? 0\n  return {\n    x: x + Math.floor(colW / 2) + graph.offsetX,\n    y: y + Math.floor(rowH / 2) + graph.offsetY,\n  }\n}\n\n/** Convert a path of grid coords to drawing coords. */\nexport function lineToDrawing(graph: AsciiGraph, line: GridCoord[]): DrawingCoord[] {\n  return line.map(c => gridToDrawingCoord(graph, c))\n}\n\n// ============================================================================\n// Node placement on the grid\n// ============================================================================\n\n/**\n * Reserve a 3x3 block in the grid for a node.\n * If the requested position is occupied, recursively shift by 4 grid units\n * (in the perpendicular direction based on graph direction) until a free spot is found.\n */\nexport function reserveSpotInGrid(\n  graph: AsciiGraph,\n  node: AsciiNode,\n  requested: GridCoord,\n): GridCoord {\n  if (graph.grid.has(gridKey(requested))) {\n    // Collision  shift perpendicular to main flow direction\n    if (graph.config.graphDirection === 'LR') {\n      return reserveSpotInGrid(graph, node, { x: requested.x, y: requested.y + 4 })\n    } else {\n      return reserveSpotInGrid(graph, node, { x: requested.x + 4, y: requested.y })\n    }\n  }\n\n  // Reserve the 3x3 block\n  for (let dx = 0; dx < 3; dx++) {\n    for (let dy = 0; dy < 3; dy++) {\n      const reserved: GridCoord = { x: requested.x + dx, y: requested.y + dy }\n      graph.grid.set(gridKey(reserved), node)\n    }\n  }\n\n  node.gridCoord = requested\n  return requested\n}\n\n// ============================================================================\n// Column width / row height computation\n// ============================================================================\n\n/**\n * Set column widths and row heights for a node's 3x3 grid block.\n * Each node occupies 3 columns (border, content, border) and 3 rows.\n * The content column must be wide enough for the node's label.\n */\nexport function setColumnWidth(graph: AsciiGraph, node: AsciiNode): void {\n  const gc = node.gridCoord!\n  const padding = graph.config.boxBorderPadding\n\n  // 3 columns: [border=1] [content=2*padding+labelLen] [border=1]\n  const colWidths = [1, 2 * padding + node.displayLabel.length, 1]\n  // 3 rows: [border=1] [content=1+2*padding] [border=1]\n  const rowHeights = [1, 1 + 2 * padding, 1]\n\n  for (let idx = 0; idx < colWidths.length; idx++) {\n    const xCoord = gc.x + idx\n    const current = graph.columnWidth.get(xCoord) ?? 0\n    graph.columnWidth.set(xCoord, Math.max(current, colWidths[idx]!))\n  }\n\n  for (let idx = 0; idx < rowHeights.length; idx++) {\n    const yCoord = gc.y + idx\n    const current = graph.rowHeight.get(yCoord) ?? 0\n    graph.rowHeight.set(yCoord, Math.max(current, rowHeights[idx]!))\n  }\n\n  // Padding column/row before the node (spacing between nodes)\n  if (gc.x > 0) {\n    const current = graph.columnWidth.get(gc.x - 1) ?? 0\n    graph.columnWidth.set(gc.x - 1, Math.max(current, graph.config.paddingX))\n  }\n\n  if (gc.y > 0) {\n    let basePadding = graph.config.paddingY\n    // Extra vertical padding for nodes with incoming edges from outside their subgraph\n    if (hasIncomingEdgeFromOutsideSubgraph(graph, node)) {\n      const subgraphOverhead = 4\n      basePadding += subgraphOverhead\n    }\n    const current = graph.rowHeight.get(gc.y - 1) ?? 0\n    graph.rowHeight.set(gc.y - 1, Math.max(current, basePadding))\n  }\n}\n\n/** Ensure grid has width/height entries for all cells along an edge path. */\nexport function increaseGridSizeForPath(graph: AsciiGraph, path: GridCoord[]): void {\n  for (const c of path) {\n    if (!graph.columnWidth.has(c.x)) {\n      graph.columnWidth.set(c.x, Math.floor(graph.config.paddingX / 2))\n    }\n    if (!graph.rowHeight.has(c.y)) {\n      graph.rowHeight.set(c.y, Math.floor(graph.config.paddingY / 2))\n    }\n  }\n}\n\n// ============================================================================\n// Subgraph helpers\n// ============================================================================\n\nfunction isNodeInAnySubgraph(graph: AsciiGraph, node: AsciiNode): boolean {\n  return graph.subgraphs.some(sg => sg.nodes.includes(node))\n}\n\nfunction getNodeSubgraph(graph: AsciiGraph, node: AsciiNode): AsciiSubgraph | null {\n  for (const sg of graph.subgraphs) {\n    if (sg.nodes.includes(node)) return sg\n  }\n  return null\n}\n\n/**\n * Check if a node has an incoming edge from outside its subgraph\n * AND is the topmost such node in its subgraph.\n * Used to add extra vertical padding for subgraph borders.\n */\nfunction hasIncomingEdgeFromOutsideSubgraph(graph: AsciiGraph, node: AsciiNode): boolean {\n  const nodeSg = getNodeSubgraph(graph, node)\n  if (!nodeSg) return false\n\n  let hasExternalEdge = false\n  for (const edge of graph.edges) {\n    if (edge.to === node) {\n      const sourceSg = getNodeSubgraph(graph, edge.from)\n      if (sourceSg !== nodeSg) {\n        hasExternalEdge = true\n        break\n      }\n    }\n  }\n\n  if (!hasExternalEdge) return false\n\n  // Only return true for the topmost node with an external incoming edge\n  for (const otherNode of nodeSg.nodes) {\n    if (otherNode === node || !otherNode.gridCoord) continue\n    let otherHasExternal = false\n    for (const edge of graph.edges) {\n      if (edge.to === otherNode) {\n        const sourceSg = getNodeSubgraph(graph, edge.from)\n        if (sourceSg !== nodeSg) {\n          otherHasExternal = true\n          break\n        }\n      }\n    }\n    if (otherHasExternal && otherNode.gridCoord.y < node.gridCoord!.y) {\n      return false\n    }\n  }\n\n  return true\n}\n\n// ============================================================================\n// Subgraph bounding boxes\n// ============================================================================\n\nfunction calculateSubgraphBoundingBox(graph: AsciiGraph, sg: AsciiSubgraph): void {\n  if (sg.nodes.length === 0) return\n\n  let minX = 1_000_000\n  let minY = 1_000_000\n  let maxX = -1_000_000\n  let maxY = -1_000_000\n\n  // Include children's bounding boxes\n  for (const child of sg.children) {\n    calculateSubgraphBoundingBox(graph, child)\n    if (child.nodes.length > 0) {\n      minX = Math.min(minX, child.minX)\n      minY = Math.min(minY, child.minY)\n      maxX = Math.max(maxX, child.maxX)\n      maxY = Math.max(maxY, child.maxY)\n    }\n  }\n\n  // Include node positions\n  for (const node of sg.nodes) {\n    if (!node.drawingCoord || !node.drawing) continue\n    const nodeMinX = node.drawingCoord.x\n    const nodeMinY = node.drawingCoord.y\n    const nodeMaxX = nodeMinX + node.drawing.length - 1\n    const nodeMaxY = nodeMinY + node.drawing[0]!.length - 1\n    minX = Math.min(minX, nodeMinX)\n    minY = Math.min(minY, nodeMinY)\n    maxX = Math.max(maxX, nodeMaxX)\n    maxY = Math.max(maxY, nodeMaxY)\n  }\n\n  const subgraphPadding = 2\n  const subgraphLabelSpace = 2\n  sg.minX = minX - subgraphPadding\n  sg.minY = minY - subgraphPadding - subgraphLabelSpace\n  sg.maxX = maxX + subgraphPadding\n  sg.maxY = maxY + subgraphPadding\n}\n\n/** Ensure non-overlapping root subgraphs have minimum spacing. */\nfunction ensureSubgraphSpacing(graph: AsciiGraph): void {\n  const minSpacing = 1\n  const rootSubgraphs = graph.subgraphs.filter(sg => sg.parent === null && sg.nodes.length > 0)\n\n  for (let i = 0; i < rootSubgraphs.length; i++) {\n    for (let j = i + 1; j < rootSubgraphs.length; j++) {\n      const sg1 = rootSubgraphs[i]!\n      const sg2 = rootSubgraphs[j]!\n\n      // Horizontal overlap  adjust vertical\n      if (sg1.minX < sg2.maxX && sg1.maxX > sg2.minX) {\n        if (sg1.maxY >= sg2.minY - minSpacing && sg1.minY < sg2.minY) {\n          sg2.minY = sg1.maxY + minSpacing + 1\n        } else if (sg2.maxY >= sg1.minY - minSpacing && sg2.minY < sg1.minY) {\n          sg1.minY = sg2.maxY + minSpacing + 1\n        }\n      }\n      // Vertical overlap  adjust horizontal\n      if (sg1.minY < sg2.maxY && sg1.maxY > sg2.minY) {\n        if (sg1.maxX >= sg2.minX - minSpacing && sg1.minX < sg2.minX) {\n          sg2.minX = sg1.maxX + minSpacing + 1\n        } else if (sg2.maxX >= sg1.minX - minSpacing && sg2.minX < sg1.minX) {\n          sg1.minX = sg2.maxX + minSpacing + 1\n        }\n      }\n    }\n  }\n}\n\nexport function calculateSubgraphBoundingBoxes(graph: AsciiGraph): void {\n  for (const sg of graph.subgraphs) {\n    calculateSubgraphBoundingBox(graph, sg)\n  }\n  ensureSubgraphSpacing(graph)\n}\n\n/**\n * Offset all drawing coordinates so subgraph borders don't go negative.\n * If any subgraph has negative min coordinates, shift everything positive.\n */\nexport function offsetDrawingForSubgraphs(graph: AsciiGraph): void {\n  if (graph.subgraphs.length === 0) return\n\n  let minX = 0\n  let minY = 0\n  for (const sg of graph.subgraphs) {\n    minX = Math.min(minX, sg.minX)\n    minY = Math.min(minY, sg.minY)\n  }\n\n  const offsetX = -minX\n  const offsetY = -minY\n  if (offsetX === 0 && offsetY === 0) return\n\n  graph.offsetX = offsetX\n  graph.offsetY = offsetY\n\n  for (const sg of graph.subgraphs) {\n    sg.minX += offsetX\n    sg.minY += offsetY\n    sg.maxX += offsetX\n    sg.maxY += offsetY\n  }\n\n  for (const node of graph.nodes) {\n    if (node.drawingCoord) {\n      node.drawingCoord.x += offsetX\n      node.drawingCoord.y += offsetY\n    }\n  }\n}\n\n// ============================================================================\n// Main layout orchestrator\n// ============================================================================\n\n/**\n * createMapping performs the full grid layout:\n * 1. Place root nodes on the grid\n * 2. Place child nodes level by level\n * 3. Compute column widths and row heights\n * 4. Run A* pathfinding for all edges\n * 5. Determine label placement\n * 6. Convert grid coords  drawing coords\n * 7. Generate node box drawings\n * 8. Calculate subgraph bounding boxes\n */\nexport function createMapping(graph: AsciiGraph): void {\n  const dir = graph.config.graphDirection\n  const highestPositionPerLevel: number[] = new Array(100).fill(0)\n\n  // Identify root nodes  nodes that aren't the target of any edge\n  const nodesFound = new Set<string>()\n  const rootNodes: AsciiNode[] = []\n\n  for (const node of graph.nodes) {\n    if (!nodesFound.has(node.name)) {\n      rootNodes.push(node)\n    }\n    nodesFound.add(node.name)\n    for (const child of getChildren(graph, node)) {\n      nodesFound.add(child.name)\n    }\n  }\n\n  // In LR mode with both external and subgraph roots, separate them\n  // so subgraph roots are placed one level deeper\n  let hasExternalRoots = false\n  let hasSubgraphRootsWithEdges = false\n  for (const node of rootNodes) {\n    if (isNodeInAnySubgraph(graph, node)) {\n      if (getChildren(graph, node).length > 0) hasSubgraphRootsWithEdges = true\n    } else {\n      hasExternalRoots = true\n    }\n  }\n  const shouldSeparate = dir === 'LR' && hasExternalRoots && hasSubgraphRootsWithEdges\n\n  let externalRootNodes: AsciiNode[]\n  let subgraphRootNodes: AsciiNode[] = []\n\n  if (shouldSeparate) {\n    externalRootNodes = rootNodes.filter(n => !isNodeInAnySubgraph(graph, n))\n    subgraphRootNodes = rootNodes.filter(n => isNodeInAnySubgraph(graph, n))\n  } else {\n    externalRootNodes = rootNodes\n  }\n\n  // Place external root nodes\n  for (const node of externalRootNodes) {\n    const requested: GridCoord = dir === 'LR'\n      ? { x: 0, y: highestPositionPerLevel[0]! }\n      : { x: highestPositionPerLevel[0]!, y: 0 }\n    reserveSpotInGrid(graph, graph.nodes[node.index]!, requested)\n    highestPositionPerLevel[0] = highestPositionPerLevel[0]! + 4\n  }\n\n  // Place subgraph root nodes at level 4 (one level in from the edge)\n  if (shouldSeparate && subgraphRootNodes.length > 0) {\n    const subgraphLevel = 4\n    for (const node of subgraphRootNodes) {\n      const requested: GridCoord = dir === 'LR'\n        ? { x: subgraphLevel, y: highestPositionPerLevel[subgraphLevel]! }\n        : { x: highestPositionPerLevel[subgraphLevel]!, y: subgraphLevel }\n      reserveSpotInGrid(graph, graph.nodes[node.index]!, requested)\n      highestPositionPerLevel[subgraphLevel] = highestPositionPerLevel[subgraphLevel]! + 4\n    }\n  }\n\n  // Place child nodes level by level\n  for (const node of graph.nodes) {\n    const gc = node.gridCoord!\n    const childLevel = dir === 'LR' ? gc.x + 4 : gc.y + 4\n    let highestPosition = highestPositionPerLevel[childLevel]!\n\n    for (const child of getChildren(graph, node)) {\n      if (child.gridCoord !== null) continue // already placed\n\n      const requested: GridCoord = dir === 'LR'\n        ? { x: childLevel, y: highestPosition }\n        : { x: highestPosition, y: childLevel }\n      reserveSpotInGrid(graph, graph.nodes[child.index]!, requested)\n      highestPositionPerLevel[childLevel] = highestPosition + 4\n      highestPosition = highestPositionPerLevel[childLevel]!\n    }\n  }\n\n  // Compute column widths and row heights\n  for (const node of graph.nodes) {\n    setColumnWidth(graph, node)\n  }\n\n  // Route edges via A* and determine label positions\n  for (const edge of graph.edges) {\n    determinePath(graph, edge)\n    increaseGridSizeForPath(graph, edge.path)\n    determineLabelLine(graph, edge)\n  }\n\n  // Convert grid coords  drawing coords and generate box drawings\n  for (const node of graph.nodes) {\n    node.drawingCoord = gridToDrawingCoord(graph, node.gridCoord!)\n    node.drawing = drawBox(node, graph)\n  }\n\n  // Set canvas size and compute subgraph bounding boxes\n  setCanvasSizeToGrid(graph.canvas, graph.columnWidth, graph.rowHeight)\n  calculateSubgraphBoundingBoxes(graph)\n  offsetDrawingForSubgraphs(graph)\n}\n\n// ============================================================================\n// Graph traversal helpers\n// ============================================================================\n\n/** Get all edges originating from a node. */\nfunction getEdgesFromNode(graph: AsciiGraph, node: AsciiNode): AsciiGraph['edges'] {\n  return graph.edges.filter(e => e.from.name === node.name)\n}\n\n/** Get all direct children of a node (targets of outgoing edges). */\nfunction getChildren(graph: AsciiGraph, node: AsciiNode): AsciiNode[] {\n  return getEdgesFromNode(graph, node).map(e => e.to)\n}\n","import type { SequenceDiagram, Actor, Message, Block, Note } from './types.ts'\n\n// ============================================================================\n// Sequence diagram parser\n//\n// Parses Mermaid sequenceDiagram syntax into a SequenceDiagram structure.\n//\n// Supported syntax:\n//   participant A as Alice\n//   actor B as Bob\n//   A->>B: Solid arrow\n//   A-->>B: Dashed arrow\n//   A-)B: Open arrow\n//   A--)B: Dashed open arrow\n//   A->>+B: Activate target\n//   A-->>-B: Deactivate source\n//   loop Label ... end\n//   alt Label ... else Label ... end\n//   opt Label ... end\n//   par Label ... and Label ... end\n//   Note left of A: Text\n//   Note right of A: Text\n//   Note over A,B: Text\n// ============================================================================\n\n/**\n * Parse a Mermaid sequence diagram.\n * Expects the first line to be \"sequenceDiagram\".\n */\nexport function parseSequenceDiagram(lines: string[]): SequenceDiagram {\n  const diagram: SequenceDiagram = {\n    actors: [],\n    messages: [],\n    blocks: [],\n    notes: [],\n  }\n\n  // Track actor IDs to auto-create actors referenced in messages\n  const actorIds = new Set<string>()\n  // Track block nesting with a stack\n  const blockStack: Array<{ type: Block['type']; label: string; startIndex: number; dividers: Block['dividers'] }> = []\n\n  for (let i = 1; i < lines.length; i++) {\n    const line = lines[i]!\n\n    // --- Participant / Actor declaration ---\n    // \"participant A as Alice\" or \"participant Alice\"\n    // \"actor B as Bob\" or \"actor Bob\"\n    const actorMatch = line.match(/^(participant|actor)\\s+(\\S+?)(?:\\s+as\\s+(.+))?$/)\n    if (actorMatch) {\n      const type = actorMatch[1] as 'participant' | 'actor'\n      const id = actorMatch[2]!\n      const label = actorMatch[3]?.trim() ?? id\n      if (!actorIds.has(id)) {\n        actorIds.add(id)\n        diagram.actors.push({ id, label, type })\n      }\n      continue\n    }\n\n    // --- Note ---\n    // \"Note left of A: text\" / \"Note right of A: text\" / \"Note over A,B: text\"\n    const noteMatch = line.match(/^Note\\s+(left of|right of|over)\\s+([^:]+):\\s*(.+)$/i)\n    if (noteMatch) {\n      const posStr = noteMatch[1]!.toLowerCase()\n      const actorsStr = noteMatch[2]!.trim()\n      const text = noteMatch[3]!.trim()\n      const noteActorIds = actorsStr.split(',').map(s => s.trim())\n\n      // Ensure actors exist\n      for (const aid of noteActorIds) {\n        ensureActor(diagram, actorIds, aid)\n      }\n\n      let position: 'left' | 'right' | 'over' = 'over'\n      if (posStr === 'left of') position = 'left'\n      else if (posStr === 'right of') position = 'right'\n\n      diagram.notes.push({\n        actorIds: noteActorIds,\n        text,\n        position,\n        afterIndex: diagram.messages.length - 1,\n      })\n      continue\n    }\n\n    // --- Block start: loop, alt, opt, par, critical, break, rect ---\n    const blockMatch = line.match(/^(loop|alt|opt|par|critical|break|rect)\\s*(.*)$/)\n    if (blockMatch) {\n      const blockType = blockMatch[1] as Block['type']\n      const label = blockMatch[2]?.trim() ?? ''\n      blockStack.push({\n        type: blockType,\n        label,\n        startIndex: diagram.messages.length,\n        dividers: [],\n      })\n      continue\n    }\n\n    // --- Block divider: else, and ---\n    const dividerMatch = line.match(/^(else|and)\\s*(.*)$/)\n    if (dividerMatch && blockStack.length > 0) {\n      const label = dividerMatch[2]?.trim() ?? ''\n      blockStack[blockStack.length - 1]!.dividers.push({\n        index: diagram.messages.length,\n        label,\n      })\n      continue\n    }\n\n    // --- Block end ---\n    if (line === 'end' && blockStack.length > 0) {\n      const completed = blockStack.pop()!\n      diagram.blocks.push({\n        type: completed.type,\n        label: completed.label,\n        startIndex: completed.startIndex,\n        endIndex: Math.max(diagram.messages.length - 1, completed.startIndex),\n        dividers: completed.dividers,\n      })\n      continue\n    }\n\n    // --- Message ---\n    // Patterns: A->>B, A-->>B, A-)B, A--)B, with optional +/- activation\n    // Format: FROM ARROW TO: LABEL\n    const msgMatch = line.match(\n      /^(\\S+?)\\s*(--?>?>|--?[)x]|--?>>|--?>)\\s*([+-]?)(\\S+?)\\s*:\\s*(.+)$/\n    )\n    if (msgMatch) {\n      const from = msgMatch[1]!\n      const arrow = msgMatch[2]!\n      const activationMark = msgMatch[3]\n      const to = msgMatch[4]!\n      const label = msgMatch[5]!.trim()\n\n      // Ensure both actors exist\n      ensureActor(diagram, actorIds, from)\n      ensureActor(diagram, actorIds, to)\n\n      // Determine line style and arrow head from the arrow operator\n      const lineStyle = arrow.startsWith('--') ? 'dashed' : 'solid'\n      // \">>\" = filled arrow, \")\" or \">\" alone = open arrow, \"x\" = cross (treat as filled)\n      const arrowHead = arrow.includes('>>') || arrow.includes('x') ? 'filled' : 'open'\n\n      const msg: Message = {\n        from,\n        to,\n        label,\n        lineStyle,\n        arrowHead,\n      }\n\n      // Activation/deactivation via +/- prefix on target\n      if (activationMark === '+') msg.activate = true\n      if (activationMark === '-') msg.deactivate = true\n\n      diagram.messages.push(msg)\n      continue\n    }\n\n    // --- Simplified message format: A->>B: Label (fallback with more relaxed regex) ---\n    const simpleMsgMatch = line.match(\n      /^(\\S+?)\\s*(->>|-->>|-\\)|--\\)|-x|--x|->|-->)\\s*([+-]?)(\\S+?)\\s*:\\s*(.+)$/\n    )\n    if (simpleMsgMatch) {\n      const from = simpleMsgMatch[1]!\n      const arrow = simpleMsgMatch[2]!\n      const activationMark = simpleMsgMatch[3]\n      const to = simpleMsgMatch[4]!\n      const label = simpleMsgMatch[5]!.trim()\n\n      ensureActor(diagram, actorIds, from)\n      ensureActor(diagram, actorIds, to)\n\n      const lineStyle = arrow.startsWith('--') ? 'dashed' : 'solid'\n      const arrowHead = arrow.includes('>>') || arrow.includes('x') ? 'filled' : 'open'\n\n      const msg: Message = { from, to, label, lineStyle, arrowHead }\n      if (activationMark === '+') msg.activate = true\n      if (activationMark === '-') msg.deactivate = true\n\n      diagram.messages.push(msg)\n      continue\n    }\n\n    // --- activate / deactivate explicit commands ---\n    // These are handled implicitly via +/- on messages but can also appear standalone\n    // For now, we skip explicit activate/deactivate lines (they affect rendering only)\n  }\n\n  return diagram\n}\n\n/** Ensure an actor exists, creating a default participant if not */\nfunction ensureActor(diagram: SequenceDiagram, actorIds: Set<string>, id: string): void {\n  if (!actorIds.has(id)) {\n    actorIds.add(id)\n    diagram.actors.push({ id, label: id, type: 'participant' })\n  }\n}\n","// ============================================================================\n// ASCII renderer  sequence diagrams\n//\n// Renders sequenceDiagram text to ASCII/Unicode art using a column-based layout.\n// Each actor occupies a column with a vertical lifeline; messages are horizontal\n// arrows between lifelines. Blocks (loop/alt/opt/par) wrap around message groups.\n//\n// Layout is fundamentally different from flowcharts  no grid or A* pathfinding.\n// Instead: actors  columns, messages  rows, all positioned linearly.\n// ============================================================================\n\nimport { parseSequenceDiagram } from '../sequence/parser.ts'\nimport type { SequenceDiagram, Block } from '../sequence/types.ts'\nimport type { Canvas, AsciiConfig } from './types.ts'\nimport { mkCanvas, canvasToString, increaseSize } from './canvas.ts'\n\n/**\n * Render a Mermaid sequence diagram to ASCII/Unicode text.\n *\n * Pipeline: parse  layout (columns + rows)  draw onto canvas  string.\n */\nexport function renderSequenceAscii(text: string, config: AsciiConfig): string {\n  const lines = text.split('\\n').map(l => l.trim()).filter(l => l.length > 0 && !l.startsWith('%%'))\n  const diagram = parseSequenceDiagram(lines)\n\n  if (diagram.actors.length === 0) return ''\n\n  const useAscii = config.useAscii\n\n  // Box-drawing characters\n  const H = useAscii ? '-' : ''\n  const V = useAscii ? '|' : ''\n  const TL = useAscii ? '+' : ''\n  const TR = useAscii ? '+' : ''\n  const BL = useAscii ? '+' : ''\n  const BR = useAscii ? '+' : ''\n  const JT = useAscii ? '+' : '' // top junction on lifeline\n  const JB = useAscii ? '+' : '' // bottom junction on lifeline\n  const JL = useAscii ? '+' : '' // left junction\n  const JR = useAscii ? '+' : '' // right junction\n\n  // ---- LAYOUT: compute lifeline X positions ----\n\n  const actorIdx = new Map<string, number>()\n  diagram.actors.forEach((a, i) => actorIdx.set(a.id, i))\n\n  const boxPad = 1\n  const actorBoxWidths = diagram.actors.map(a => a.label.length + 2 * boxPad + 2)\n  const halfBox = actorBoxWidths.map(w => Math.ceil(w / 2))\n  const actorBoxH = 3 // top border + label row + bottom border\n\n  // Compute minimum gap between adjacent lifelines based on message labels.\n  // For messages spanning multiple actors, distribute the required width across gaps.\n  const adjMaxWidth: number[] = new Array(Math.max(diagram.actors.length - 1, 0)).fill(0)\n\n  for (const msg of diagram.messages) {\n    const fi = actorIdx.get(msg.from)!\n    const ti = actorIdx.get(msg.to)!\n    if (fi === ti) continue // self-messages don't affect spacing\n    const lo = Math.min(fi, ti)\n    const hi = Math.max(fi, ti)\n    // Required gap per span = (label + arrow decorations) / number of gaps\n    const needed = msg.label.length + 4\n    const numGaps = hi - lo\n    const perGap = Math.ceil(needed / numGaps)\n    for (let g = lo; g < hi; g++) {\n      adjMaxWidth[g] = Math.max(adjMaxWidth[g]!, perGap)\n    }\n  }\n\n  // Compute lifeline x-positions (greedy left-to-right)\n  const llX: number[] = [halfBox[0]!]\n  for (let i = 1; i < diagram.actors.length; i++) {\n    const gap = Math.max(\n      halfBox[i - 1]! + halfBox[i]! + 2,\n      adjMaxWidth[i - 1]! + 2,\n      10,\n    )\n    llX[i] = llX[i - 1]! + gap\n  }\n\n  // ---- LAYOUT: compute vertical positions for messages ----\n\n  // For each message index, track the y where its arrow is drawn.\n  // Also track block start/end y positions and divider y positions.\n  const msgArrowY: number[] = []\n  const msgLabelY: number[] = []\n  const blockStartY = new Map<number, number>()\n  const blockEndY = new Map<number, number>()\n  const divYMap = new Map<string, number>() // \"blockIdx:divIdx\"  y\n  const notePositions: Array<{ x: number; y: number; width: number; height: number; lines: string[] }> = []\n\n  let curY = actorBoxH // start right below header boxes\n\n  for (let m = 0; m < diagram.messages.length; m++) {\n    // Block openings at this message\n    for (let b = 0; b < diagram.blocks.length; b++) {\n      if (diagram.blocks[b]!.startIndex === m) {\n        curY += 2 // 1 blank + 1 header row\n        blockStartY.set(b, curY - 1)\n      }\n    }\n\n    // Dividers at this message index\n    for (let b = 0; b < diagram.blocks.length; b++) {\n      for (let d = 0; d < diagram.blocks[b]!.dividers.length; d++) {\n        if (diagram.blocks[b]!.dividers[d]!.index === m) {\n          curY += 1\n          divYMap.set(`${b}:${d}`, curY)\n          curY += 1\n        }\n      }\n    }\n\n    curY += 1 // blank row before message\n\n    const msg = diagram.messages[m]!\n    const isSelf = msg.from === msg.to\n\n    if (isSelf) {\n      // Self-message occupies 3 rows: top-arm, label-col, bottom-arm\n      msgLabelY[m] = curY + 1\n      msgArrowY[m] = curY\n      curY += 3\n    } else {\n      // Normal message: label row then arrow row\n      msgLabelY[m] = curY\n      msgArrowY[m] = curY + 1\n      curY += 2\n    }\n\n    // Notes after this message\n    for (let n = 0; n < diagram.notes.length; n++) {\n      if (diagram.notes[n]!.afterIndex === m) {\n        curY += 1\n        const note = diagram.notes[n]!\n        const nLines = note.text.split('\\\\n')\n        const nWidth = Math.max(...nLines.map(l => l.length)) + 4\n        const nHeight = nLines.length + 2\n\n        // Determine x position based on note.position\n        const aIdx = actorIdx.get(note.actorIds[0]!) ?? 0\n        let nx: number\n        if (note.position === 'left') {\n          nx = llX[aIdx]! - nWidth - 1\n        } else if (note.position === 'right') {\n          nx = llX[aIdx]! + 2\n        } else {\n          // 'over'  center over actor(s)\n          if (note.actorIds.length >= 2) {\n            const aIdx2 = actorIdx.get(note.actorIds[1]!) ?? aIdx\n            nx = Math.floor((llX[aIdx]! + llX[aIdx2]!) / 2) - Math.floor(nWidth / 2)\n          } else {\n            nx = llX[aIdx]! - Math.floor(nWidth / 2)\n          }\n        }\n        nx = Math.max(0, nx)\n\n        notePositions.push({ x: nx, y: curY, width: nWidth, height: nHeight, lines: nLines })\n        curY += nHeight\n      }\n    }\n\n    // Block closings after this message\n    for (let b = 0; b < diagram.blocks.length; b++) {\n      if (diagram.blocks[b]!.endIndex === m) {\n        curY += 1\n        blockEndY.set(b, curY)\n        curY += 1\n      }\n    }\n  }\n\n  curY += 1 // gap before footer\n  const footerY = curY\n  const totalH = footerY + actorBoxH\n\n  // Total canvas width\n  const lastLL = llX[llX.length - 1] ?? 0\n  const lastHalf = halfBox[halfBox.length - 1] ?? 0\n  let totalW = lastLL + lastHalf + 2\n\n  // Ensure canvas is wide enough for self-message labels and notes\n  for (let m = 0; m < diagram.messages.length; m++) {\n    const msg = diagram.messages[m]!\n    if (msg.from === msg.to) {\n      const fi = actorIdx.get(msg.from)!\n      const selfRight = llX[fi]! + 6 + 2 + msg.label.length\n      totalW = Math.max(totalW, selfRight + 1)\n    }\n  }\n  for (const np of notePositions) {\n    totalW = Math.max(totalW, np.x + np.width + 1)\n  }\n\n  const canvas = mkCanvas(totalW, totalH - 1)\n\n  // ---- DRAW: helper to place a bordered actor box ----\n\n  function drawActorBox(cx: number, topY: number, label: string): void {\n    const w = label.length + 2 * boxPad + 2\n    const left = cx - Math.floor(w / 2)\n    // Top border\n    canvas[left]![topY] = TL\n    for (let x = 1; x < w - 1; x++) canvas[left + x]![topY] = H\n    canvas[left + w - 1]![topY] = TR\n    // Sides + label\n    canvas[left]![topY + 1] = V\n    canvas[left + w - 1]![topY + 1] = V\n    const ls = left + 1 + boxPad\n    for (let i = 0; i < label.length; i++) canvas[ls + i]![topY + 1] = label[i]!\n    // Bottom border\n    canvas[left]![topY + 2] = BL\n    for (let x = 1; x < w - 1; x++) canvas[left + x]![topY + 2] = H\n    canvas[left + w - 1]![topY + 2] = BR\n  }\n\n  // ---- DRAW: lifelines ----\n\n  for (let i = 0; i < diagram.actors.length; i++) {\n    const x = llX[i]!\n    for (let y = actorBoxH; y <= footerY; y++) {\n      canvas[x]![y] = V\n    }\n  }\n\n  // ---- DRAW: actor header + footer boxes (drawn over lifelines) ----\n\n  for (let i = 0; i < diagram.actors.length; i++) {\n    const actor = diagram.actors[i]!\n    drawActorBox(llX[i]!, 0, actor.label)\n    drawActorBox(llX[i]!, footerY, actor.label)\n\n    // Lifeline junctions on box borders (Unicode only)\n    if (!useAscii) {\n      canvas[llX[i]!]![actorBoxH - 1] = JT // bottom of header  \n      canvas[llX[i]!]![footerY] = JB        // top of footer  \n    }\n  }\n\n  // ---- DRAW: messages ----\n\n  for (let m = 0; m < diagram.messages.length; m++) {\n    const msg = diagram.messages[m]!\n    const fi = actorIdx.get(msg.from)!\n    const ti = actorIdx.get(msg.to)!\n    const fromX = llX[fi]!\n    const toX = llX[ti]!\n    const isSelf = fi === ti\n    const isDashed = msg.lineStyle === 'dashed'\n    const isFilled = msg.arrowHead === 'filled'\n\n    // Arrow line character (solid vs dashed)\n    const lineChar = isDashed ? (useAscii ? '.' : '') : H\n\n    if (isSelf) {\n      // Self-message: 3-row loop to the right of the lifeline\n      //              (row 0 = msgArrowY)\n      //      Label     (row 1)\n      //              (row 2)\n      const y0 = msgArrowY[m]!\n      const loopW = Math.max(4, 4)\n\n      // Row 0: start junction + horizontal + top-right corner\n      canvas[fromX]![y0] = JL\n      for (let x = fromX + 1; x < fromX + loopW; x++) canvas[x]![y0] = lineChar\n      canvas[fromX + loopW]![y0] = useAscii ? '+' : ''\n\n      // Row 1: vertical on right side + label\n      canvas[fromX + loopW]![y0 + 1] = V\n      const labelX = fromX + loopW + 2\n      for (let i = 0; i < msg.label.length; i++) {\n        if (labelX + i < totalW) canvas[labelX + i]![y0 + 1] = msg.label[i]!\n      }\n\n      // Row 2: arrow-back + horizontal + bottom-right corner\n      const arrowChar = isFilled ? (useAscii ? '<' : '') : (useAscii ? '<' : '')\n      canvas[fromX]![y0 + 2] = arrowChar\n      for (let x = fromX + 1; x < fromX + loopW; x++) canvas[x]![y0 + 2] = lineChar\n      canvas[fromX + loopW]![y0 + 2] = useAscii ? '+' : ''\n    } else {\n      // Normal message: label on row above, arrow on row below\n      const labelY = msgLabelY[m]!\n      const arrowY = msgArrowY[m]!\n      const leftToRight = fromX < toX\n\n      // Draw label centered between the two lifelines\n      const midX = Math.floor((fromX + toX) / 2)\n      const labelStart = midX - Math.floor(msg.label.length / 2)\n      for (let i = 0; i < msg.label.length; i++) {\n        const lx = labelStart + i\n        if (lx >= 0 && lx < totalW) canvas[lx]![labelY] = msg.label[i]!\n      }\n\n      // Draw arrow line\n      if (leftToRight) {\n        for (let x = fromX + 1; x < toX; x++) canvas[x]![arrowY] = lineChar\n        // Arrowhead at destination\n        const ah = isFilled ? (useAscii ? '>' : '') : (useAscii ? '>' : '')\n        canvas[toX]![arrowY] = ah\n      } else {\n        for (let x = toX + 1; x < fromX; x++) canvas[x]![arrowY] = lineChar\n        const ah = isFilled ? (useAscii ? '<' : '') : (useAscii ? '<' : '')\n        canvas[toX]![arrowY] = ah\n      }\n    }\n  }\n\n  // ---- DRAW: blocks (loop, alt, opt, par, etc.) ----\n\n  for (let b = 0; b < diagram.blocks.length; b++) {\n    const block = diagram.blocks[b]!\n    const topY = blockStartY.get(b)\n    const botY = blockEndY.get(b)\n    if (topY === undefined || botY === undefined) continue\n\n    // Find the leftmost/rightmost lifelines involved in this block's messages\n    let minLX = totalW\n    let maxLX = 0\n    for (let m = block.startIndex; m <= block.endIndex; m++) {\n      if (m >= diagram.messages.length) break\n      const msg = diagram.messages[m]!\n      const f = actorIdx.get(msg.from) ?? 0\n      const t = actorIdx.get(msg.to) ?? 0\n      minLX = Math.min(minLX, llX[Math.min(f, t)]!)\n      maxLX = Math.max(maxLX, llX[Math.max(f, t)]!)\n    }\n\n    const bLeft = Math.max(0, minLX - 4)\n    const bRight = Math.min(totalW - 1, maxLX + 4)\n\n    // Top border with block type label\n    canvas[bLeft]![topY] = TL\n    for (let x = bLeft + 1; x < bRight; x++) canvas[x]![topY] = H\n    canvas[bRight]![topY] = TR\n    // Write block header label over the top border\n    const hdrLabel = block.label ? `${block.type} [${block.label}]` : block.type\n    for (let i = 0; i < hdrLabel.length && bLeft + 1 + i < bRight; i++) {\n      canvas[bLeft + 1 + i]![topY] = hdrLabel[i]!\n    }\n\n    // Bottom border\n    canvas[bLeft]![botY] = BL\n    for (let x = bLeft + 1; x < bRight; x++) canvas[x]![botY] = H\n    canvas[bRight]![botY] = BR\n\n    // Side borders\n    for (let y = topY + 1; y < botY; y++) {\n      canvas[bLeft]![y] = V\n      canvas[bRight]![y] = V\n    }\n\n    // Dividers\n    for (let d = 0; d < block.dividers.length; d++) {\n      const dY = divYMap.get(`${b}:${d}`)\n      if (dY === undefined) continue\n      const dashChar = isDashedH()\n      canvas[bLeft]![dY] = JL\n      for (let x = bLeft + 1; x < bRight; x++) canvas[x]![dY] = dashChar\n      canvas[bRight]![dY] = JR\n      // Divider label\n      const dLabel = block.dividers[d]!.label\n      if (dLabel) {\n        const dStr = `[${dLabel}]`\n        for (let i = 0; i < dStr.length && bLeft + 1 + i < bRight; i++) {\n          canvas[bLeft + 1 + i]![dY] = dStr[i]!\n        }\n      }\n    }\n  }\n\n  // ---- DRAW: notes ----\n\n  for (const np of notePositions) {\n    // Ensure canvas is big enough\n    increaseSize(canvas, np.x + np.width, np.y + np.height)\n    // Top border\n    canvas[np.x]![np.y] = TL\n    for (let x = 1; x < np.width - 1; x++) canvas[np.x + x]![np.y] = H\n    canvas[np.x + np.width - 1]![np.y] = TR\n    // Content rows\n    for (let l = 0; l < np.lines.length; l++) {\n      const ly = np.y + 1 + l\n      canvas[np.x]![ly] = V\n      canvas[np.x + np.width - 1]![ly] = V\n      for (let i = 0; i < np.lines[l]!.length; i++) {\n        canvas[np.x + 2 + i]![ly] = np.lines[l]![i]!\n      }\n    }\n    // Bottom border\n    const by = np.y + np.height - 1\n    canvas[np.x]![by] = BL\n    for (let x = 1; x < np.width - 1; x++) canvas[np.x + x]![by] = H\n    canvas[np.x + np.width - 1]![by] = BR\n  }\n\n  return canvasToString(canvas)\n\n  // ---- Helper: dashed horizontal character ----\n  function isDashedH(): string {\n    return useAscii ? '-' : ''\n  }\n}\n","import type { ClassDiagram, ClassNode, ClassRelationship, ClassMember, RelationshipType, ClassNamespace } from './types.ts'\n\n// ============================================================================\n// Class diagram parser\n//\n// Parses Mermaid classDiagram syntax into a ClassDiagram structure.\n//\n// Supported syntax:\n//   class Animal { +String name; +eat() void }\n//   class Shape { <<abstract>> }\n//   Animal <|-- Dog           (inheritance)\n//   Car *-- Engine            (composition)\n//   Car o-- Wheel             (aggregation)\n//   A --> B                   (association)\n//   A ..> B                   (dependency)\n//   A ..|> B                  (realization)\n//   A \"1\" --> \"*\" B : label   (with cardinality + label)\n//   Animal : +String name     (inline attribute)\n//   namespace MyNamespace { class A { } }\n// ============================================================================\n\n/**\n * Parse a Mermaid class diagram.\n * Expects the first line to be \"classDiagram\".\n */\nexport function parseClassDiagram(lines: string[]): ClassDiagram {\n  const diagram: ClassDiagram = {\n    classes: [],\n    relationships: [],\n    namespaces: [],\n  }\n\n  // Track classes by ID for deduplication\n  const classMap = new Map<string, ClassNode>()\n  // Track namespace nesting\n  let currentNamespace: ClassNamespace | null = null\n  // Track class body parsing\n  let currentClass: ClassNode | null = null\n  let braceDepth = 0\n\n  for (let i = 1; i < lines.length; i++) {\n    const line = lines[i]!\n\n    // --- Inside a class body block ---\n    if (currentClass && braceDepth > 0) {\n      if (line === '}') {\n        braceDepth--\n        if (braceDepth === 0) {\n          currentClass = null\n        }\n        continue\n      }\n\n      // Check for annotation like <<interface>>\n      const annotMatch = line.match(/^<<(\\w+)>>$/)\n      if (annotMatch) {\n        currentClass.annotation = annotMatch[1]!\n        continue\n      }\n\n      // Parse member: visibility, name, type, optional parens for method\n      const member = parseMember(line)\n      if (member) {\n        if (member.isMethod) {\n          currentClass.methods.push(member.member)\n        } else {\n          currentClass.attributes.push(member.member)\n        }\n      }\n      continue\n    }\n\n    // --- Namespace block start ---\n    const nsMatch = line.match(/^namespace\\s+(\\S+)\\s*\\{$/)\n    if (nsMatch) {\n      currentNamespace = { name: nsMatch[1]!, classIds: [] }\n      continue\n    }\n\n    // --- Namespace end ---\n    if (line === '}' && currentNamespace) {\n      diagram.namespaces.push(currentNamespace)\n      currentNamespace = null\n      continue\n    }\n\n    // --- Class block start: `class ClassName {` or `class ClassName` ---\n    const classBlockMatch = line.match(/^class\\s+(\\S+?)(?:\\s*~(\\w+)~)?\\s*\\{$/)\n    if (classBlockMatch) {\n      const id = classBlockMatch[1]!\n      const generic = classBlockMatch[2]\n      const cls = ensureClass(classMap, id)\n      if (generic) {\n        cls.label = `${id}<${generic}>`\n      }\n      currentClass = cls\n      braceDepth = 1\n      if (currentNamespace) {\n        currentNamespace.classIds.push(id)\n      }\n      continue\n    }\n\n    // --- Standalone class declaration (no body): `class ClassName` ---\n    const classOnlyMatch = line.match(/^class\\s+(\\S+?)(?:\\s*~(\\w+)~)?\\s*$/)\n    if (classOnlyMatch) {\n      const id = classOnlyMatch[1]!\n      const generic = classOnlyMatch[2]\n      const cls = ensureClass(classMap, id)\n      if (generic) {\n        cls.label = `${id}<${generic}>`\n      }\n      if (currentNamespace) {\n        currentNamespace.classIds.push(id)\n      }\n      continue\n    }\n\n    // --- Inline annotation: `class ClassName { <<interface>> }` (single line) ---\n    const inlineAnnotMatch = line.match(/^class\\s+(\\S+?)\\s*\\{\\s*<<(\\w+)>>\\s*\\}$/)\n    if (inlineAnnotMatch) {\n      const cls = ensureClass(classMap, inlineAnnotMatch[1]!)\n      cls.annotation = inlineAnnotMatch[2]!\n      continue\n    }\n\n    // --- Inline attribute: `ClassName : +String name` ---\n    const inlineAttrMatch = line.match(/^(\\S+?)\\s*:\\s*(.+)$/)\n    if (inlineAttrMatch) {\n      // Make sure this isn't a relationship line (those have arrows)\n      const rest = inlineAttrMatch[2]!\n      if (!rest.match(/<\\|--|--|\\*--|o--|-->|\\.\\.>|\\.\\.\\|>/)) {\n        const cls = ensureClass(classMap, inlineAttrMatch[1]!)\n        const member = parseMember(rest)\n        if (member) {\n          if (member.isMethod) {\n            cls.methods.push(member.member)\n          } else {\n            cls.attributes.push(member.member)\n          }\n        }\n        continue\n      }\n    }\n\n    // --- Relationship ---\n    // Pattern: [FROM] [\"card\"] ARROW [\"card\"] [TO] [: label]\n    // Arrows: <|--, *--, o--, -->, ..|>, ..>\n    // Can also be reversed: --o, --*, --|>\n    const rel = parseRelationship(line)\n    if (rel) {\n      // Ensure both classes exist\n      ensureClass(classMap, rel.from)\n      ensureClass(classMap, rel.to)\n      diagram.relationships.push(rel)\n      continue\n    }\n  }\n\n  diagram.classes = [...classMap.values()]\n  return diagram\n}\n\n/** Ensure a class exists in the map, creating a default if needed */\nfunction ensureClass(classMap: Map<string, ClassNode>, id: string): ClassNode {\n  let cls = classMap.get(id)\n  if (!cls) {\n    cls = { id, label: id, attributes: [], methods: [] }\n    classMap.set(id, cls)\n  }\n  return cls\n}\n\n/** Parse a class member line (attribute or method) */\nfunction parseMember(line: string): { member: ClassMember; isMethod: boolean } | null {\n  const trimmed = line.trim().replace(/;$/, '')\n  if (!trimmed) return null\n\n  // Extract visibility prefix\n  let visibility: ClassMember['visibility'] = ''\n  let rest = trimmed\n  if (/^[+\\-#~]/.test(rest)) {\n    visibility = rest[0] as ClassMember['visibility']\n    rest = rest.slice(1).trim()\n  }\n\n  // Check if it's a method (has parentheses)\n  const methodMatch = rest.match(/^(.+?)\\(([^)]*)\\)(?:\\s*(.+))?$/)\n  if (methodMatch) {\n    const name = methodMatch[1]!.trim()\n    const type = methodMatch[3]?.trim()\n    // Check for static ($) or abstract (*) markers\n    const isStatic = name.endsWith('$') || rest.includes('$')\n    const isAbstract = name.endsWith('*') || rest.includes('*')\n    return {\n      member: {\n        visibility,\n        name: name.replace(/[$*]$/, ''),\n        type: type || undefined,\n        isStatic,\n        isAbstract,\n      },\n      isMethod: true,\n    }\n  }\n\n  // It's an attribute: [Type] name or name Type\n  // Common patterns: \"String name\", \"+int age\", \"name\"\n  const parts = rest.split(/\\s+/)\n  let name: string\n  let type: string | undefined\n\n  if (parts.length >= 2) {\n    // \"Type name\" pattern\n    type = parts[0]\n    name = parts.slice(1).join(' ')\n  } else {\n    name = parts[0] ?? rest\n  }\n\n  const isStatic = name.endsWith('$')\n  const isAbstract = name.endsWith('*')\n\n  return {\n    member: {\n      visibility,\n      name: name.replace(/[$*]$/, ''),\n      type: type || undefined,\n      isStatic,\n      isAbstract,\n    },\n    isMethod: false,\n  }\n}\n\n/** Parse a relationship line into a ClassRelationship */\nfunction parseRelationship(line: string): ClassRelationship | null {\n  // Relationship regex  handles all arrow types with optional cardinality and labels\n  // Pattern: FROM [\"card\"] ARROW [\"card\"] TO [: label]\n  const match = line.match(\n    /^(\\S+?)\\s+(?:\"([^\"]*?)\"\\s+)?(<\\|--|<\\|\\.\\.|\\*--|o--|-->|--\\*|--o|--|>\\s*|\\.\\.>|\\.\\.\\|>|--)\\s+(?:\"([^\"]*?)\"\\s+)?(\\S+?)(?:\\s*:\\s*(.+))?$/\n  )\n  if (!match) return null\n\n  const from = match[1]!\n  const fromCardinality = match[2] || undefined\n  const arrow = match[3]!.trim()\n  const toCardinality = match[4] || undefined\n  const to = match[5]!\n  const label = match[6]?.trim() || undefined\n\n  const parsed = parseArrow(arrow)\n  if (!parsed) return null\n\n  return { from, to, type: parsed.type, markerAt: parsed.markerAt, label, fromCardinality, toCardinality }\n}\n\n/**\n * Map arrow syntax to relationship type and marker placement side.\n * Prefix markers (`<|--`, `*--`, `o--`) place the UML shape at the 'from' end.\n * Suffix markers (`..|>`, `-->`, `..>`, `--*`, `--o`) place it at the 'to' end.\n */\nfunction parseArrow(arrow: string): { type: RelationshipType; markerAt: 'from' | 'to' } | null {\n  switch (arrow) {\n    case '<|--': return { type: 'inheritance',  markerAt: 'from' }\n    case '<|..': return { type: 'realization',  markerAt: 'from' }\n    case '*--':  return { type: 'composition',  markerAt: 'from' }\n    case '--*':  return { type: 'composition',  markerAt: 'to' }\n    case 'o--':  return { type: 'aggregation',  markerAt: 'from' }\n    case '--o':  return { type: 'aggregation',  markerAt: 'to' }\n    case '-->':  return { type: 'association',  markerAt: 'to' }\n    case '..>':  return { type: 'dependency',   markerAt: 'to' }\n    case '..|>': return { type: 'realization',  markerAt: 'to' }\n    case '--':   return { type: 'association',  markerAt: 'to' }\n    default:     return null\n  }\n}\n","// ============================================================================\n// ASCII renderer  class diagrams\n//\n// Renders classDiagram text to ASCII/Unicode art.\n// Each class is a multi-compartment box (header | attributes | methods).\n// Relationships are drawn as lines between classes with UML markers.\n//\n// Layout: level-based top-down. \"From\" classes are placed above \"to\" classes\n// for all relationship types, matching dagre/mermaid.com behavior.\n// Relationship lines use simple Manhattan routing (vertical + horizontal).\n// ============================================================================\n\nimport { parseClassDiagram } from '../class/parser.ts'\nimport type { ClassDiagram, ClassNode, ClassMember, ClassRelationship, RelationshipType } from '../class/types.ts'\nimport type { Canvas, AsciiConfig } from './types.ts'\nimport { mkCanvas, canvasToString, increaseSize } from './canvas.ts'\nimport { drawMultiBox } from './draw.ts'\n\n// ============================================================================\n// Class member formatting\n// ============================================================================\n\n/** Format a class member as a display string: visibility + name + optional type */\nfunction formatMember(m: ClassMember): string {\n  const vis = m.visibility || ''\n  const type = m.type ? `: ${m.type}` : ''\n  return `${vis}${m.name}${type}`\n}\n\n/** Build the text sections for a class box: [header], [attributes], [methods] */\nfunction buildClassSections(cls: ClassNode): string[][] {\n  // Header section: optional annotation + class name (centered later by drawMultiBox)\n  const header: string[] = []\n  if (cls.annotation) header.push(`<<${cls.annotation}>>`)\n  header.push(cls.label)\n\n  // Attributes section\n  const attrs = cls.attributes.map(formatMember)\n\n  // Methods section\n  const methods = cls.methods.map(formatMember)\n\n  // If no attrs and no methods, just return header (1-section box)\n  if (attrs.length === 0 && methods.length === 0) return [header]\n  // If no methods, return header + attrs (2-section box)\n  if (methods.length === 0) return [header, attrs]\n  // Full 3-section box\n  return [header, attrs, methods]\n}\n\n// ============================================================================\n// Relationship marker characters\n// ============================================================================\n\ninterface RelMarker {\n  /** Relationship type (determines marker shape) */\n  type: RelationshipType\n  /** Which end the marker is placed at */\n  markerAt: 'from' | 'to'\n  /** Whether the line is dashed */\n  dashed: boolean\n}\n\n/**\n * Build the marker metadata for a relationship.\n * The actual marker character will be determined at placement time based on line direction.\n */\nfunction getRelMarker(type: RelationshipType, markerAt: 'from' | 'to'): RelMarker {\n  const dashed = type === 'dependency' || type === 'realization'\n  return { type, markerAt, dashed }\n}\n\n/**\n * Get the UML marker shape character for a relationship type.\n * For directional arrows (association/dependency), the direction parameter\n * specifies which way the arrow should point.\n */\nfunction getMarkerShape(\n  type: RelationshipType,\n  useAscii: boolean,\n  direction?: 'up' | 'down' | 'left' | 'right'\n): string {\n  switch (type) {\n    case 'inheritance':\n    case 'realization':\n      // Hollow triangle - rotate based on line direction\n      // Triangle points TOWARD the parent class\n      if (direction === 'down') {\n        // Line goes down (parent above, child below) - triangle points UP\n        return useAscii ? '^' : ''\n      } else if (direction === 'up') {\n        // Line goes up (parent below, child above) - triangle points DOWN\n        return useAscii ? 'v' : ''\n      } else if (direction === 'left') {\n        // Line goes left - triangle points LEFT\n        return useAscii ? '>' : ''\n      } else {\n        // Default: line goes right - triangle points RIGHT\n        return useAscii ? '<' : ''\n      }\n    case 'composition':\n      // Filled diamond - omnidirectional shape\n      return useAscii ? '*' : ''\n    case 'aggregation':\n      // Hollow diamond - omnidirectional shape\n      return useAscii ? 'o' : ''\n    case 'association':\n    case 'dependency':\n      // Directional arrow - rotate based on line direction\n      if (direction === 'down') {\n        return useAscii ? 'v' : ''\n      } else if (direction === 'up') {\n        return useAscii ? '^' : ''\n      } else if (direction === 'left') {\n        return useAscii ? '<' : ''\n      } else {\n        // Default to right (or when direction not specified)\n        return useAscii ? '>' : ''\n      }\n  }\n}\n\n// ============================================================================\n// Layout and rendering\n// ============================================================================\n\n/** Positioned class node on the canvas */\ninterface PlacedClass {\n  cls: ClassNode\n  sections: string[][]\n  x: number\n  y: number\n  width: number\n  height: number\n}\n\n/**\n * Render a Mermaid class diagram to ASCII/Unicode text.\n *\n * Pipeline: parse  build boxes  level-based layout  draw boxes  draw relationships  string.\n */\nexport function renderClassAscii(text: string, config: AsciiConfig): string {\n  const lines = text.split('\\n').map(l => l.trim()).filter(l => l.length > 0 && !l.startsWith('%%'))\n  const diagram = parseClassDiagram(lines)\n\n  if (diagram.classes.length === 0) return ''\n\n  const useAscii = config.useAscii\n  const hGap = 4  // horizontal gap between class boxes\n  const vGap = 3  // vertical gap between levels (enough for relationship lines)\n\n  // --- Build box dimensions for each class ---\n  const classSections = new Map<string, string[][]>()\n  const classBoxW = new Map<string, number>()\n  const classBoxH = new Map<string, number>()\n\n  for (const cls of diagram.classes) {\n    const sections = buildClassSections(cls)\n    classSections.set(cls.id, sections)\n\n    // Compute box dimensions from drawMultiBox logic\n    let maxTextW = 0\n    for (const section of sections) {\n      for (const line of section) maxTextW = Math.max(maxTextW, line.length)\n    }\n    const boxW = maxTextW + 4 // 2 border + 2 padding\n\n    let totalLines = 0\n    for (const section of sections) totalLines += Math.max(section.length, 1)\n    const boxH = totalLines + (sections.length - 1) + 2 // section lines + dividers + top/bottom border\n\n    classBoxW.set(cls.id, boxW)\n    classBoxH.set(cls.id, boxH)\n  }\n\n  // --- Assign levels: topological sort based on directed relationships ---\n  // All relationship types place \"from\" above \"to\" in the layout, matching\n  // dagre's layered algorithm and the official mermaid.com renderer behavior.\n  // For \"Animal <|-- Dog\": from=\"Animal\", to=\"Dog\"  Animal above Dog.\n  //\n  // Every relationship type (including association and dependency) forces nodes\n  // to different levels. Same-row routing for mixed diagrams causes collisions:\n  // detour lines overlap with cross-level routing, and labels overwrite box borders.\n\n  const classById = new Map<string, ClassNode>()\n  for (const cls of diagram.classes) classById.set(cls.id, cls)\n\n  const parents = new Map<string, Set<string>>()  // child  set of parent IDs\n  const children = new Map<string, Set<string>>() // parent  set of child IDs\n\n  for (const rel of diagram.relationships) {\n    // For inheritance/realization, the marker (hollow triangle) points to the parent.\n    // - `Animal <|-- Dog` (markerAt='from'): Animal is parent, Dog is child\n    // - `Bird ..|> Flyable` (markerAt='to'): Flyable is parent, Bird is child\n    // For other relationships, use the default fromto direction.\n    const isHierarchical = rel.type === 'inheritance' || rel.type === 'realization'\n    const parentId = isHierarchical && rel.markerAt === 'to' ? rel.to : rel.from\n    const childId = isHierarchical && rel.markerAt === 'to' ? rel.from : rel.to\n\n    if (!parents.has(childId)) parents.set(childId, new Set())\n    parents.get(childId)!.add(parentId)\n    if (!children.has(parentId)) children.set(parentId, new Set())\n    children.get(parentId)!.add(childId)\n  }\n\n  // BFS from roots (classes that have no parents) to assign levels.\n  // Cap at classes.length - 1 to prevent infinite loops on cyclic graphs\n  // (e.g. View --> Model and Model ..> View would otherwise push levels\n  // upward forever). In a DAG the longest path has at most N-1 edges.\n  const level = new Map<string, number>()\n  const roots = diagram.classes.filter(c => !parents.has(c.id) || parents.get(c.id)!.size === 0)\n  const queue: string[] = roots.map(c => c.id)\n  for (const id of queue) level.set(id, 0)\n\n  const levelCap = diagram.classes.length - 1\n  let qi = 0\n  while (qi < queue.length) {\n    const id = queue[qi++]!\n    const childSet = children.get(id)\n    if (!childSet) continue\n    for (const childId of childSet) {\n      const newLevel = (level.get(id) ?? 0) + 1\n      if (newLevel > levelCap) continue // cycle detected  skip to prevent infinite loop\n      if (!level.has(childId) || level.get(childId)! < newLevel) {\n        level.set(childId, newLevel)\n        queue.push(childId)\n      }\n    }\n  }\n\n  // Assign remaining (unconnected) classes to level 0\n  for (const cls of diagram.classes) {\n    if (!level.has(cls.id)) level.set(cls.id, 0)\n  }\n\n  // --- Position classes by level ---\n  // Group classes by level\n  const maxLevel = Math.max(...[...level.values()], 0)\n  const levelGroups: string[][] = Array.from({ length: maxLevel + 1 }, () => [])\n  for (const cls of diagram.classes) {\n    levelGroups[level.get(cls.id)!]!.push(cls.id)\n  }\n\n  // Compute positions: each level is a row, classes in a row are spaced horizontally\n  const placed = new Map<string, PlacedClass>()\n  let currentY = 0\n\n  for (let lv = 0; lv <= maxLevel; lv++) {\n    const group = levelGroups[lv]!\n    if (group.length === 0) continue\n\n    let currentX = 0\n    let maxH = 0\n\n    for (const id of group) {\n      const cls = classById.get(id)!\n      const w = classBoxW.get(id)!\n      const h = classBoxH.get(id)!\n      placed.set(id, {\n        cls,\n        sections: classSections.get(id)!,\n        x: currentX,\n        y: currentY,\n        width: w,\n        height: h,\n      })\n      currentX += w + hGap\n      maxH = Math.max(maxH, h)\n    }\n\n    currentY += maxH + vGap\n  }\n\n  // --- Create canvas ---\n  let totalW = 0\n  let totalH = 0\n  for (const p of placed.values()) {\n    totalW = Math.max(totalW, p.x + p.width)\n    totalH = Math.max(totalH, p.y + p.height)\n  }\n\n  // Extra space for relationship lines that may go below/beside\n  totalW += 4\n  totalH += 2\n\n  const canvas = mkCanvas(totalW - 1, totalH - 1)\n\n  // --- Draw class boxes ---\n  for (const p of placed.values()) {\n    const boxCanvas = drawMultiBox(p.sections, useAscii)\n    // Copy box onto main canvas at (p.x, p.y)\n    for (let bx = 0; bx < boxCanvas.length; bx++) {\n      for (let by = 0; by < boxCanvas[0]!.length; by++) {\n        const ch = boxCanvas[bx]![by]!\n        if (ch !== ' ') {\n          const cx = p.x + bx\n          const cy = p.y + by\n          if (cx < totalW && cy < totalH) {\n            canvas[cx]![cy] = ch\n          }\n        }\n      }\n    }\n  }\n\n  // --- Draw relationship lines ---\n  const H = useAscii ? '-' : ''\n  const V = useAscii ? '|' : ''\n  const dashH = useAscii ? '.' : ''\n  const dashV = useAscii ? ':' : ''\n\n  for (const rel of diagram.relationships) {\n    const fromP = placed.get(rel.from)\n    const toP = placed.get(rel.to)\n    if (!fromP || !toP) continue\n\n    const marker = getRelMarker(rel.type, rel.markerAt)\n    const lineH = marker.dashed ? dashH : H\n    const lineV = marker.dashed ? dashV : V\n\n    // Connection points: center-bottom of source  center-top of target\n    const fromCX = fromP.x + Math.floor(fromP.width / 2)\n    const fromBY = fromP.y + fromP.height - 1\n    const toCX = toP.x + Math.floor(toP.width / 2)\n    const toTY = toP.y\n\n    // Route: simple Manhattan routing\n    // If target is below source: vertical down from source, horizontal if needed, vertical down to target\n    // If same row: horizontal line with a small vertical detour above or below\n    if (fromBY < toTY) {\n      // Target is below source  simple vertical-first routing\n      const midY = fromBY + Math.floor((toTY - fromBY) / 2)\n\n      // Vertical from source bottom to midY\n      for (let y = fromBY + 1; y <= midY; y++) {\n        if (y < totalH) canvas[fromCX]![y] = lineV\n      }\n\n      // Horizontal from fromCX to toCX at midY\n      if (fromCX !== toCX) {\n        const lx = Math.min(fromCX, toCX)\n        const rx = Math.max(fromCX, toCX)\n        for (let x = lx; x <= rx; x++) {\n          if (x < totalW && midY < totalH) canvas[x]![midY] = lineH\n        }\n        // Corner characters\n        if (!useAscii && midY < totalH) {\n          if (fromCX < toCX) {\n            canvas[fromCX]![midY] = ''\n            canvas[toCX]![midY] = ''\n          } else {\n            canvas[fromCX]![midY] = ''\n            canvas[toCX]![midY] = ''\n          }\n        }\n      }\n\n      // Vertical from midY to target top\n      for (let y = midY + 1; y < toTY; y++) {\n        if (y < totalH) canvas[toCX]![y] = lineV\n      }\n\n      // Draw markers - arrows point in the direction of the vertical segment\n      if (marker.markerAt === 'to') {\n        // Marker at target (pointing down into the target box)\n        const markerChar = getMarkerShape(marker.type, useAscii, 'down')\n        const my = toTY - 1\n        if (my >= 0 && my < totalH) {\n          for (let i = 0; i < markerChar.length; i++) {\n            const mx = toCX - Math.floor(markerChar.length / 2) + i\n            if (mx >= 0 && mx < totalW) canvas[mx]![my] = markerChar[i]!\n          }\n        }\n      }\n      if (marker.markerAt === 'from') {\n        // Marker at source (pointing down away from source box)\n        const markerChar = getMarkerShape(marker.type, useAscii, 'down')\n        const my = fromBY + 1\n        if (my < totalH) {\n          for (let i = 0; i < markerChar.length; i++) {\n            const mx = fromCX - Math.floor(markerChar.length / 2) + i\n            if (mx >= 0 && mx < totalW) canvas[mx]![my] = markerChar[i]!\n          }\n        }\n      }\n    } else if (toP.y + toP.height - 1 < fromP.y) {\n      // Target is ABOVE source  draw upward from source top to target bottom\n      const fromTY = fromP.y\n      const toBY = toP.y + toP.height - 1\n      const midY = toBY + Math.floor((fromTY - toBY) / 2)\n\n      for (let y = fromTY - 1; y >= midY; y--) {\n        if (y >= 0 && y < totalH) canvas[fromCX]![y] = lineV\n      }\n\n      if (fromCX !== toCX) {\n        const lx = Math.min(fromCX, toCX)\n        const rx = Math.max(fromCX, toCX)\n        for (let x = lx; x <= rx; x++) {\n          if (x < totalW && midY >= 0 && midY < totalH) canvas[x]![midY] = lineH\n        }\n        if (!useAscii && midY >= 0 && midY < totalH) {\n          if (fromCX < toCX) {\n            canvas[fromCX]![midY] = ''\n            canvas[toCX]![midY] = ''\n          } else {\n            canvas[fromCX]![midY] = ''\n            canvas[toCX]![midY] = ''\n          }\n        }\n      }\n\n      for (let y = midY - 1; y > toBY; y--) {\n        if (y >= 0 && y < totalH) canvas[toCX]![y] = lineV\n      }\n\n      // Draw markers - arrows point in the direction of the vertical segment (upward)\n      if (marker.markerAt === 'from') {\n        // Marker at source (pointing up away from source box)\n        const markerChar = getMarkerShape(marker.type, useAscii, 'up')\n        const my = fromTY - 1\n        if (my >= 0 && my < totalH) {\n          for (let i = 0; i < markerChar.length; i++) {\n            const mx = fromCX - Math.floor(markerChar.length / 2) + i\n            if (mx >= 0 && mx < totalW) canvas[mx]![my] = markerChar[i]!\n          }\n        }\n      }\n      if (marker.markerAt === 'to') {\n        // Marker at target (pointing up into the target box from below)\n        // For inheritance/realization, triangle points toward parent - use 'down' to get \n        // For association/dependency, arrow points in line direction - use 'up' to get \n        const isHierarchical = marker.type === 'inheritance' || marker.type === 'realization'\n        const markerDir = isHierarchical ? 'down' : 'up'\n        const markerChar = getMarkerShape(marker.type, useAscii, markerDir)\n        const my = toBY + 1\n        if (my < totalH) {\n          for (let i = 0; i < markerChar.length; i++) {\n            const mx = toCX - Math.floor(markerChar.length / 2) + i\n            if (mx >= 0 && mx < totalW) canvas[mx]![my] = markerChar[i]!\n          }\n        }\n      }\n    } else {\n      // Same level  draw horizontal line with a detour below both boxes\n      const detourY = Math.max(fromBY, toP.y + toP.height - 1) + 2\n      increaseSize(canvas, totalW, detourY + 1)\n\n      // Vertical down from source\n      for (let y = fromBY + 1; y <= detourY; y++) {\n        canvas[fromCX]![y] = lineV\n      }\n      // Horizontal\n      const lx = Math.min(fromCX, toCX)\n      const rx = Math.max(fromCX, toCX)\n      for (let x = lx; x <= rx; x++) {\n        canvas[x]![detourY] = lineH\n      }\n      // Vertical up to target\n      for (let y = detourY - 1; y >= toP.y + toP.height; y--) {\n        canvas[toCX]![y] = lineV\n      }\n\n      // Draw markers - same-level routing uses vertical segments at both ends\n      if (marker.markerAt === 'from') {\n        // Marker at source (pointing down away from source box)\n        const markerChar = getMarkerShape(marker.type, useAscii, 'down')\n        const my = fromBY + 1\n        if (my < totalH) {\n          for (let i = 0; i < markerChar.length; i++) {\n            const mx = fromCX - Math.floor(markerChar.length / 2) + i\n            if (mx >= 0 && mx < totalW) canvas[mx]![my] = markerChar[i]!\n          }\n        }\n      }\n      if (marker.markerAt === 'to') {\n        // Marker at target bottom (pointing up into the target box)\n        const markerChar = getMarkerShape(marker.type, useAscii, 'up')\n        const my = toP.y + toP.height\n        if (my < totalH) {\n          for (let i = 0; i < markerChar.length; i++) {\n            const mx = toCX - Math.floor(markerChar.length / 2) + i\n            if (mx >= 0 && mx < totalW) canvas[mx]![my] = markerChar[i]!\n          }\n        }\n      }\n    }\n\n    // Draw relationship label at midpoint if present\n    // Add padding around the label for readability\n    if (rel.label) {\n      const paddedLabel = ` ${rel.label} `  // Add space padding on both sides\n      const midX = Math.floor((fromCX + toCX) / 2)\n      // Calculate midY based on routing direction\n      let midY: number\n      if (fromBY < toTY) {\n        // Target below source: midpoint between source bottom and target top\n        midY = Math.floor((fromBY + 1 + toTY - 1) / 2)\n      } else if (toP.y + toP.height - 1 < fromP.y) {\n        // Target above source: midpoint between target bottom and source top\n        const toBY = toP.y + toP.height - 1\n        midY = Math.floor((toBY + 1 + fromP.y - 1) / 2)\n      } else {\n        // Same level: place label at midpoint of the detour line\n        midY = Math.max(fromBY, toP.y + toP.height - 1) + 2\n      }\n      const labelStart = midX - Math.floor(paddedLabel.length / 2)\n      // Clear the area first (overwrite line characters) then draw the padded label\n      for (let i = 0; i < paddedLabel.length; i++) {\n        const lx = labelStart + i\n        if (lx >= 0 && lx < totalW && midY >= 0 && midY < totalH) {\n          canvas[lx]![midY] = paddedLabel[i]!\n        }\n      }\n    }\n  }\n\n  return canvasToString(canvas)\n}\n","import type { ErDiagram, ErEntity, ErAttribute, ErRelationship, Cardinality } from './types.ts'\n\n// ============================================================================\n// ER diagram parser\n//\n// Parses Mermaid erDiagram syntax into an ErDiagram structure.\n//\n// Supported syntax:\n//   CUSTOMER ||--o{ ORDER : places\n//   CUSTOMER {\n//     string name PK\n//     int age\n//     string email UK \"user email\"\n//   }\n//\n// Cardinality notation:\n//   ||  exactly one\n//   o|  zero or one (also |o)\n//   }|  one or more (also |{)\n//   o{  zero or more (also {o)\n//\n// Line style:\n//   --  identifying (solid line)\n//   ..  non-identifying (dashed line)\n// ============================================================================\n\n/**\n * Parse a Mermaid ER diagram.\n * Expects the first line to be \"erDiagram\".\n */\nexport function parseErDiagram(lines: string[]): ErDiagram {\n  const diagram: ErDiagram = {\n    entities: [],\n    relationships: [],\n  }\n\n  // Track entities by ID for deduplication\n  const entityMap = new Map<string, ErEntity>()\n  // Track entity body parsing\n  let currentEntity: ErEntity | null = null\n\n  for (let i = 1; i < lines.length; i++) {\n    const line = lines[i]!\n\n    // --- Inside entity body ---\n    if (currentEntity) {\n      if (line === '}') {\n        currentEntity = null\n        continue\n      }\n\n      // Attribute line: type name [PK|FK|UK] [\"comment\"]\n      const attr = parseAttribute(line)\n      if (attr) {\n        currentEntity.attributes.push(attr)\n      }\n      continue\n    }\n\n    // --- Entity block start: `ENTITY_NAME {` ---\n    const entityBlockMatch = line.match(/^(\\S+)\\s*\\{$/)\n    if (entityBlockMatch) {\n      const id = entityBlockMatch[1]!\n      const entity = ensureEntity(entityMap, id)\n      currentEntity = entity\n      continue\n    }\n\n    // --- Relationship: `ENTITY1 cardinality1--cardinality2 ENTITY2 : label` ---\n    const rel = parseRelationshipLine(line)\n    if (rel) {\n      // Ensure both entities exist\n      ensureEntity(entityMap, rel.entity1)\n      ensureEntity(entityMap, rel.entity2)\n      diagram.relationships.push(rel)\n      continue\n    }\n  }\n\n  diagram.entities = [...entityMap.values()]\n  return diagram\n}\n\n/** Ensure an entity exists in the map */\nfunction ensureEntity(entityMap: Map<string, ErEntity>, id: string): ErEntity {\n  let entity = entityMap.get(id)\n  if (!entity) {\n    entity = { id, label: id, attributes: [] }\n    entityMap.set(id, entity)\n  }\n  return entity\n}\n\n/** Parse an attribute line inside an entity block */\nfunction parseAttribute(line: string): ErAttribute | null {\n  // Format: type name [PK|FK|UK [...]] [\"comment\"]\n  const match = line.match(/^(\\S+)\\s+(\\S+)(?:\\s+(.+))?$/)\n  if (!match) return null\n\n  const type = match[1]!\n  const name = match[2]!\n  const rest = match[3]?.trim() ?? ''\n\n  // Extract key constraints (PK, FK, UK) and optional comment\n  const keys: ErAttribute['keys'] = []\n  let comment: string | undefined\n\n  // Extract quoted comment first\n  const commentMatch = rest.match(/\"([^\"]*)\"/)\n  if (commentMatch) {\n    comment = commentMatch[1]\n  }\n\n  // Extract key constraints\n  const restWithoutComment = rest.replace(/\"[^\"]*\"/, '').trim()\n  for (const part of restWithoutComment.split(/\\s+/)) {\n    const upper = part.toUpperCase()\n    if (upper === 'PK' || upper === 'FK' || upper === 'UK') {\n      keys.push(upper as 'PK' | 'FK' | 'UK')\n    }\n  }\n\n  return { type, name, keys, comment }\n}\n\n/**\n * Parse a relationship line.\n *\n * Cardinality symbols on each side of the line style:\n *   Left side (entity1):  ||  |o  o|  }|  |{  o{  {o\n *   Line:                 --  (identifying) or  ..  (non-identifying)\n *   Right side (entity2): ||  o|  |o  |{  }|  {o  o{\n *\n * Full pattern example: CUSTOMER ||--o{ ORDER : places\n */\nfunction parseRelationshipLine(line: string): ErRelationship | null {\n  // Match: ENTITY1 <cardinality_and_line> ENTITY2 : label\n  const match = line.match(/^(\\S+)\\s+([|o}{]+(?:--|\\.\\.)[|o}{]+)\\s+(\\S+)\\s*:\\s*(.+)$/)\n  if (!match) return null\n\n  const entity1 = match[1]!\n  const cardinalityStr = match[2]!\n  const entity2 = match[3]!\n  const label = match[4]!.trim()\n\n  // Split the cardinality string into left side, line style, right side\n  const lineMatch = cardinalityStr.match(/^([|o}{]+)(--|\\.\\.?)([|o}{]+)$/)\n  if (!lineMatch) return null\n\n  const leftStr = lineMatch[1]!\n  const lineStyle = lineMatch[2]!\n  const rightStr = lineMatch[3]!\n\n  const cardinality1 = parseCardinality(leftStr)\n  const cardinality2 = parseCardinality(rightStr)\n  const identifying = lineStyle === '--'\n\n  if (!cardinality1 || !cardinality2) return null\n\n  return { entity1, entity2, cardinality1, cardinality2, label, identifying }\n}\n\n/** Parse a cardinality notation string into a Cardinality type */\nfunction parseCardinality(str: string): Cardinality | null {\n  // Normalize: sort the characters to handle both orders (e.g., |o and o|)\n  const sorted = str.split('').sort().join('')\n\n  // Exact one: ||  sorted \"||\"\n  if (sorted === '||') return 'one'\n  // Zero or one: o| or |o  sorted \"o|\" (o=111 < |=124 in char codes)\n  if (sorted === 'o|') return 'zero-one'\n  // One or more: }| or |{  sorted \"|}\" or \"{|\"\n  if (sorted === '|}' || sorted === '{|') return 'many'\n  // Zero or more: o{ or {o  sorted \"{o\" or \"o{\"\n  if (sorted === '{o' || sorted === 'o{') return 'zero-many'\n\n  return null\n}\n","// ============================================================================\n// ASCII renderer  ER diagrams\n//\n// Renders erDiagram text to ASCII/Unicode art.\n// Each entity is a 2-section box (header | attributes).\n// Relationships are drawn as lines with crow's foot notation at endpoints.\n//\n// Layout: entities are placed in a grid pattern (multiple rows if needed).\n// Relationship lines use Manhattan routing between entity boxes.\n// ============================================================================\n\nimport { parseErDiagram } from '../er/parser.ts'\nimport type { ErDiagram, ErEntity, ErAttribute, Cardinality } from '../er/types.ts'\nimport type { Canvas, AsciiConfig } from './types.ts'\nimport { mkCanvas, canvasToString, increaseSize } from './canvas.ts'\nimport { drawMultiBox } from './draw.ts'\n\n// ============================================================================\n// Entity box content\n// ============================================================================\n\n/** Format an attribute line: \"PK type name\" or \"FK type name\" etc. */\nfunction formatAttribute(attr: ErAttribute): string {\n  const keyStr = attr.keys.length > 0 ? attr.keys.join(',') + ' ' : '   '\n  return `${keyStr}${attr.type} ${attr.name}`\n}\n\n/** Build sections for an entity box: [header], [attributes] */\nfunction buildEntitySections(entity: ErEntity): string[][] {\n  const header = [entity.label]\n  const attrs = entity.attributes.map(formatAttribute)\n  if (attrs.length === 0) return [header]\n  return [header, attrs]\n}\n\n// ============================================================================\n// Crow's foot notation\n// ============================================================================\n\n/**\n * Returns the ASCII/Unicode characters for a crow's foot cardinality marker.\n * These are drawn near the endpoint of a relationship line.\n *\n * Cardinality markers (horizontal direction):\n *   one:          or  --||--\n *   zero-one:  o  or  --o|--\n *   many:         or  --<|--  (or }|)\n *   zero-many: o  or  --o<--  (or o{)\n */\nfunction getCrowsFootChars(card: Cardinality, useAscii: boolean): string {\n  if (useAscii) {\n    switch (card) {\n      case 'one':       return '||'\n      case 'zero-one':  return 'o|'\n      case 'many':      return '}|'\n      case 'zero-many': return 'o{'\n    }\n  } else {\n    switch (card) {\n      case 'one':       return ''\n      case 'zero-one':  return 'o'\n      case 'many':      return ''\n      case 'zero-many': return 'o'\n    }\n  }\n}\n\n// ============================================================================\n// Positioned entity\n// ============================================================================\n\ninterface PlacedEntity {\n  entity: ErEntity\n  sections: string[][]\n  x: number\n  y: number\n  width: number\n  height: number\n}\n\n// ============================================================================\n// Layout and rendering\n// ============================================================================\n\n/**\n * Render a Mermaid ER diagram to ASCII/Unicode text.\n *\n * Pipeline: parse  build boxes  grid layout  draw boxes  draw relationships  string.\n */\nexport function renderErAscii(text: string, config: AsciiConfig): string {\n  const lines = text.split('\\n').map(l => l.trim()).filter(l => l.length > 0 && !l.startsWith('%%'))\n  const diagram = parseErDiagram(lines)\n\n  if (diagram.entities.length === 0) return ''\n\n  const useAscii = config.useAscii\n  const hGap = 6  // horizontal gap between entity boxes\n  const vGap = 4  // vertical gap between rows (for relationship lines)\n\n  // --- Build entity box dimensions ---\n  const entitySections = new Map<string, string[][]>()\n  const entityBoxW = new Map<string, number>()\n  const entityBoxH = new Map<string, number>()\n\n  for (const ent of diagram.entities) {\n    const sections = buildEntitySections(ent)\n    entitySections.set(ent.id, sections)\n\n    let maxTextW = 0\n    for (const section of sections) {\n      for (const line of section) maxTextW = Math.max(maxTextW, line.length)\n    }\n    const boxW = maxTextW + 4 // 2 border + 2 padding\n\n    let totalLines = 0\n    for (const section of sections) totalLines += Math.max(section.length, 1)\n    const boxH = totalLines + (sections.length - 1) + 2\n\n    entityBoxW.set(ent.id, boxW)\n    entityBoxH.set(ent.id, boxH)\n  }\n\n  // --- Layout: place entities in rows ---\n  // Use a simple grid: max N entities per row (based on count).\n  // Entities involved in relationships are placed adjacent when possible.\n  const maxPerRow = Math.max(2, Math.ceil(Math.sqrt(diagram.entities.length)))\n\n  const placed = new Map<string, PlacedEntity>()\n  let currentX = 0\n  let currentY = 0\n  let maxRowH = 0\n  let colCount = 0\n\n  for (const ent of diagram.entities) {\n    const w = entityBoxW.get(ent.id)!\n    const h = entityBoxH.get(ent.id)!\n\n    if (colCount >= maxPerRow) {\n      // Wrap to next row\n      currentY += maxRowH + vGap\n      currentX = 0\n      maxRowH = 0\n      colCount = 0\n    }\n\n    placed.set(ent.id, {\n      entity: ent,\n      sections: entitySections.get(ent.id)!,\n      x: currentX,\n      y: currentY,\n      width: w,\n      height: h,\n    })\n\n    currentX += w + hGap\n    maxRowH = Math.max(maxRowH, h)\n    colCount++\n  }\n\n  // --- Create canvas ---\n  let totalW = 0\n  let totalH = 0\n  for (const p of placed.values()) {\n    totalW = Math.max(totalW, p.x + p.width)\n    totalH = Math.max(totalH, p.y + p.height)\n  }\n  totalW += 4\n  totalH += 2\n\n  const canvas = mkCanvas(totalW - 1, totalH - 1)\n\n  // --- Draw entity boxes ---\n  for (const p of placed.values()) {\n    const boxCanvas = drawMultiBox(p.sections, useAscii)\n    for (let bx = 0; bx < boxCanvas.length; bx++) {\n      for (let by = 0; by < boxCanvas[0]!.length; by++) {\n        const ch = boxCanvas[bx]![by]!\n        if (ch !== ' ') {\n          const cx = p.x + bx\n          const cy = p.y + by\n          if (cx < totalW && cy < totalH) {\n            canvas[cx]![cy] = ch\n          }\n        }\n      }\n    }\n  }\n\n  // --- Draw relationships ---\n  const H = useAscii ? '-' : ''\n  const V = useAscii ? '|' : ''\n  const dashH = useAscii ? '.' : ''\n  const dashV = useAscii ? ':' : ''\n\n  for (const rel of diagram.relationships) {\n    const e1 = placed.get(rel.entity1)\n    const e2 = placed.get(rel.entity2)\n    if (!e1 || !e2) continue\n\n    const lineH = rel.identifying ? H : dashH\n    const lineV = rel.identifying ? V : dashV\n\n    // Determine connection direction based on relative position.\n    // Connect from right side of left entity to left side of right entity (horizontal),\n    // or from bottom of upper entity to top of lower entity (vertical).\n    const e1CX = e1.x + Math.floor(e1.width / 2)\n    const e1CY = e1.y + Math.floor(e1.height / 2)\n    const e2CX = e2.x + Math.floor(e2.width / 2)\n    const e2CY = e2.y + Math.floor(e2.height / 2)\n\n    // Check if entities are on the same row (horizontal connection)\n    const sameRow = Math.abs(e1CY - e2CY) < Math.max(e1.height, e2.height)\n\n    if (sameRow) {\n      // Horizontal connection: right side of left entity  left side of right entity\n      const [left, right] = e1CX < e2CX ? [e1, e2] : [e2, e1]\n      const [leftCard, rightCard] = e1CX < e2CX\n        ? [rel.cardinality1, rel.cardinality2]\n        : [rel.cardinality2, rel.cardinality1]\n\n      const startX = left.x + left.width\n      const endX = right.x - 1\n      const lineY = left.y + Math.floor(left.height / 2)\n\n      // Draw horizontal line\n      for (let x = startX; x <= endX; x++) {\n        if (x < totalW) canvas[x]![lineY] = lineH\n      }\n\n      // Draw crow's foot markers at endpoints\n      const leftChars = getCrowsFootChars(leftCard, useAscii)\n      for (let i = 0; i < leftChars.length; i++) {\n        const mx = startX + i\n        if (mx < totalW) canvas[mx]![lineY] = leftChars[i]!\n      }\n\n      const rightChars = getCrowsFootChars(rightCard, useAscii)\n      for (let i = 0; i < rightChars.length; i++) {\n        const mx = endX - rightChars.length + 1 + i\n        if (mx >= 0 && mx < totalW) canvas[mx]![lineY] = rightChars[i]!\n      }\n\n      // Relationship label centered in the gap between the two entities, above the line.\n      // Clamp label to the gap region [startX, endX] to avoid overwriting box borders.\n      if (rel.label) {\n        const gapMid = Math.floor((startX + endX) / 2)\n        const labelStart = Math.max(startX, gapMid - Math.floor(rel.label.length / 2))\n        const labelY = lineY - 1\n        if (labelY >= 0) {\n          for (let i = 0; i < rel.label.length; i++) {\n            const lx = labelStart + i\n            if (lx >= startX && lx <= endX && lx < totalW) {\n              canvas[lx]![labelY] = rel.label[i]!\n            }\n          }\n        }\n      }\n    } else {\n      // Vertical connection: bottom of upper entity  top of lower entity\n      const [upper, lower] = e1CY < e2CY ? [e1, e2] : [e2, e1]\n      const [upperCard, lowerCard] = e1CY < e2CY\n        ? [rel.cardinality1, rel.cardinality2]\n        : [rel.cardinality2, rel.cardinality1]\n\n      const startY = upper.y + upper.height\n      const endY = lower.y - 1\n      const lineX = upper.x + Math.floor(upper.width / 2)\n\n      // Vertical line\n      for (let y = startY; y <= endY; y++) {\n        if (y < totalH) canvas[lineX]![y] = lineV\n      }\n\n      // If horizontal offset needed, add a horizontal segment\n      const lowerCX = lower.x + Math.floor(lower.width / 2)\n      if (lineX !== lowerCX) {\n        const midY = Math.floor((startY + endY) / 2)\n        // Horizontal segment at midY\n        const lx = Math.min(lineX, lowerCX)\n        const rx = Math.max(lineX, lowerCX)\n        for (let x = lx; x <= rx; x++) {\n          if (x < totalW && midY < totalH) canvas[x]![midY] = lineH\n        }\n        // Vertical from midY to lower entity\n        for (let y = midY + 1; y <= endY; y++) {\n          if (y < totalH) canvas[lowerCX]![y] = lineV\n        }\n      }\n\n      // Crow's foot markers (vertical direction)\n      // Place markers near the entity connection points\n      const upperChars = getCrowsFootChars(upperCard, useAscii)\n      if (startY < totalH) {\n        for (let i = 0; i < upperChars.length; i++) {\n          const mx = lineX - Math.floor(upperChars.length / 2) + i\n          if (mx >= 0 && mx < totalW) canvas[mx]![startY] = upperChars[i]!\n        }\n      }\n\n      const targetX = lineX !== lowerCX ? lowerCX : lineX\n      const lowerChars = getCrowsFootChars(lowerCard, useAscii)\n      if (endY >= 0 && endY < totalH) {\n        for (let i = 0; i < lowerChars.length; i++) {\n          const mx = targetX - Math.floor(lowerChars.length / 2) + i\n          if (mx >= 0 && mx < totalW) canvas[mx]![endY] = lowerChars[i]!\n        }\n      }\n\n      // Relationship label  placed to the right of the vertical line at the midpoint.\n      // We expand the canvas as needed since labels can extend beyond the initial bounds.\n      if (rel.label) {\n        const midY = Math.floor((startY + endY) / 2)\n        const labelX = lineX + 2\n        if (midY >= 0) {\n          for (let i = 0; i < rel.label.length; i++) {\n            const lx = labelX + i\n            if (lx >= 0) {\n              increaseSize(canvas, lx + 1, midY + 1)\n              canvas[lx]![midY] = rel.label[i]!\n            }\n          }\n        }\n      }\n    }\n  }\n\n  return canvasToString(canvas)\n}\n","// ============================================================================\n// beautiful-mermaid  ASCII renderer public API\n//\n// Renders Mermaid diagrams to ASCII or Unicode box-drawing art.\n// No external dependencies  pure TypeScript.\n//\n// Supported diagram types:\n//   - Flowcharts (graph TD / flowchart LR)  grid-based layout with A* pathfinding\n//   - State diagrams (stateDiagram-v2)  same pipeline as flowcharts\n//   - Sequence diagrams (sequenceDiagram)  column-based timeline layout\n//   - Class diagrams (classDiagram)  level-based UML layout\n//   - ER diagrams (erDiagram)  grid layout with crow's foot notation\n//\n// Usage:\n//   import { renderMermaidAscii } from 'beautiful-mermaid'\n//   const ascii = renderMermaidAscii('graph LR\\n  A --> B')\n// ============================================================================\n\nimport { parseMermaid } from '../parser.ts'\nimport { convertToAsciiGraph } from './converter.ts'\nimport { createMapping } from './grid.ts'\nimport { drawGraph } from './draw.ts'\nimport { canvasToString, flipCanvasVertically } from './canvas.ts'\nimport { renderSequenceAscii } from './sequence.ts'\nimport { renderClassAscii } from './class-diagram.ts'\nimport { renderErAscii } from './er-diagram.ts'\nimport type { AsciiConfig } from './types.ts'\n\nexport interface AsciiRenderOptions {\n  /** true = ASCII chars (+,-,|,>), false = Unicode box-drawing (,,,). Default: false */\n  useAscii?: boolean\n  /** Horizontal spacing between nodes. Default: 5 */\n  paddingX?: number\n  /** Vertical spacing between nodes. Default: 5 */\n  paddingY?: number\n  /** Padding inside node boxes. Default: 1 */\n  boxBorderPadding?: number\n}\n\n/**\n * Detect the diagram type from the mermaid source text.\n * Mirrors the detection logic in src/index.ts for the SVG renderer.\n */\nfunction detectDiagramType(text: string): 'flowchart' | 'sequence' | 'class' | 'er' {\n  const firstLine = text.trim().split('\\n')[0]?.trim().toLowerCase() ?? ''\n\n  if (/^sequencediagram\\s*$/.test(firstLine)) return 'sequence'\n  if (/^classdiagram\\s*$/.test(firstLine)) return 'class'\n  if (/^erdiagram\\s*$/.test(firstLine)) return 'er'\n\n  // Default: flowchart/state (handled by parseMermaid internally)\n  return 'flowchart'\n}\n\n/**\n * Render Mermaid diagram text to an ASCII/Unicode string.\n *\n * Synchronous  no async layout engine needed (unlike the SVG renderer).\n * Auto-detects diagram type from the header line and dispatches to\n * the appropriate renderer.\n *\n * @param text - Mermaid source text (any supported diagram type)\n * @param options - Rendering options\n * @returns Multi-line ASCII/Unicode string\n *\n * @example\n * ```ts\n * const result = renderMermaidAscii(`\n *   graph LR\n *     A --> B --> C\n * `, { useAscii: true })\n *\n * // Output:\n * // +---+     +---+     +---+\n * // |   |     |   |     |   |\n * // | A |---->| B |---->| C |\n * // |   |     |   |     |   |\n * // +---+     +---+     +---+\n * ```\n */\nexport function renderMermaidAscii(\n  text: string,\n  options: AsciiRenderOptions = {},\n): string {\n  const config: AsciiConfig = {\n    useAscii: options.useAscii ?? false,\n    paddingX: options.paddingX ?? 5,\n    paddingY: options.paddingY ?? 5,\n    boxBorderPadding: options.boxBorderPadding ?? 1,\n    graphDirection: 'TD', // default, overridden for flowcharts below\n  }\n\n  const diagramType = detectDiagramType(text)\n\n  switch (diagramType) {\n    case 'sequence':\n      return renderSequenceAscii(text, config)\n\n    case 'class':\n      return renderClassAscii(text, config)\n\n    case 'er':\n      return renderErAscii(text, config)\n\n    case 'flowchart':\n    default: {\n      // Flowchart + state diagram pipeline (original)\n      const parsed = parseMermaid(text)\n\n      // Normalize direction for grid layout.\n      // BT is laid out as TD then flipped vertically after drawing.\n      // RL is treated as LR (full RL support not yet implemented).\n      if (parsed.direction === 'LR' || parsed.direction === 'RL') {\n        config.graphDirection = 'LR'\n      } else {\n        config.graphDirection = 'TD'\n      }\n\n      const graph = convertToAsciiGraph(parsed, config)\n      createMapping(graph)\n      drawGraph(graph)\n\n      // BT: flip the finished canvas vertically so the flow runs bottomtop.\n      // The grid layout ran as TD; flipping + character remapping produces BT.\n      if (parsed.direction === 'BT') {\n        flipCanvasVertically(graph.canvas)\n      }\n\n      return canvasToString(graph.canvas)\n    }\n  }\n}\n","// @ts-expect-error  dagre types are declared for the package root, not the dist path;\n// importing the pre-built browser bundle avoids Bun.build hanging on 30+ CJS file resolution\nimport dagre from '@dagrejs/dagre/dist/dagre.js'\nimport type { MermaidGraph, MermaidSubgraph, PositionedGraph, PositionedNode, PositionedEdge, PositionedGroup, Point, RenderOptions } from './types.ts'\nimport { estimateTextWidth, FONT_SIZES, FONT_WEIGHTS, NODE_PADDING, GROUP_HEADER_CONTENT_PAD } from './styles.ts'\nimport { centerToTopLeft, snapToOrthogonal, clipToDiamondBoundary, clipToCircleBoundary, clipEndpointsToNodes } from './dagre-adapter.ts'\n\n/** Shapes that render as circles  need edge endpoint clipping to the circle boundary */\nconst CIRCULAR_SHAPES = new Set(['circle', 'doublecircle', 'state-start', 'state-end'])\n\n/** Non-rectangular shapes  skip rectangular endpoint clipping for these (they use\n *  their own boundary equations via clipToDiamondBoundary / clipToCircleBoundary) */\nconst NON_RECT_SHAPES = new Set(['diamond', 'circle', 'doublecircle', 'state-start', 'state-end'])\n\n// ============================================================================\n// Layout engine  converts MermaidGraph to PositionedGraph via dagre\n//\n// Pipeline:\n//   1. Estimate node sizes from label text + shape padding\n//   2. Build dagre graph (nodes, edges, compound parents for subgraphs)\n//   3. Run dagre.layout() synchronously\n//   4. Extract positions back into our PositionedGraph format\n//\n// Dagre differences from ELK:\n//   - Synchronous (no web worker / WASM)\n//   - Node coords are center-based (converted to top-left via adapter)\n//   - Edge points may not be orthogonal (post-processed via adapter)\n//   - Compound nodes use setParent() instead of nested children JSON\n//   - All coordinates are absolute (no container-relative offsets)\n// ============================================================================\n\n/** Default render options (layout-only  color defaults are in theme.ts) */\nconst DEFAULTS: Required<Pick<RenderOptions, 'font' | 'padding' | 'nodeSpacing' | 'layerSpacing'>> = {\n  font: 'Inter',\n  padding: 40,\n  nodeSpacing: 24,\n  layerSpacing: 40,\n}\n\n// ============================================================================\n// Two-pass layout for subgraph direction overrides\n//\n// Dagre only supports a single global rankdir. When a subgraph has a different\n// direction (e.g. `direction LR` inside a `graph TD`), we pre-compute its\n// internal layout in a separate dagre pass, then inject the result as a\n// fixed-size placeholder in the main layout.\n// ============================================================================\n\n/** Pre-computed layout data for a direction-overridden subgraph */\ninterface PreComputedSubgraph {\n  id: string\n  label: string\n  /** Bounding box for the placeholder node in the main layout */\n  width: number\n  height: number\n  /** Internal nodes positioned relative to (0,0) of the bounding box */\n  nodes: PositionedNode[]\n  /** Internal edges positioned relative to (0,0) of the bounding box */\n  edges: PositionedEdge[]\n  /** Nested subgroup boxes positioned relative to (0,0) */\n  groups: PositionedGroup[]\n  /** All node IDs contained in this subgraph */\n  nodeIds: Set<string>\n  /** Indices of edges in graph.edges[] that are internal to this subgraph */\n  internalEdgeIndices: Set<number>\n}\n\n/**\n * Pre-compute the internal layout of a subgraph that has a direction override.\n *\n * Runs a separate dagre layout using the subgraph's direction as rankdir,\n * with only the subgraph's internal nodes and edges. Returns positioned\n * elements relative to a (0,0) origin, plus the overall bounding box.\n */\nfunction preComputeSubgraphLayout(\n  sg: MermaidSubgraph,\n  graph: MermaidGraph,\n  opts: Required<Pick<RenderOptions, 'font' | 'padding' | 'nodeSpacing' | 'layerSpacing'>>,\n): PreComputedSubgraph {\n  const subG = new dagre.graphlib.Graph({ directed: true, compound: true })\n  subG.setGraph({\n    rankdir: directionToDagre(sg.direction!),\n    acyclicer: 'greedy',\n    nodesep: opts.nodeSpacing,\n    ranksep: opts.layerSpacing,\n    // Tighter margins for subgraph internals  the parent group provides outer padding\n    marginx: 16,\n    marginy: 12,\n  })\n  subG.setDefaultEdgeLabel(() => ({}))\n\n  // Collect all node IDs in this subgraph (including nested children)\n  const nodeIds = new Set<string>()\n  nodeIds.add(sg.id)\n  collectSubgraphNodeIds(sg, nodeIds)\n\n  // Add direct child nodes\n  for (const nodeId of sg.nodeIds) {\n    const node = graph.nodes.get(nodeId)\n    if (node) {\n      const size = estimateNodeSize(nodeId, node.label, node.shape)\n      subG.setNode(nodeId, { label: node.label, width: size.width, height: size.height })\n    }\n  }\n\n  // Add nested subgraphs as compound nodes (they keep the parent's direction)\n  for (const child of sg.children) {\n    addSubgraphToDagre(subG, child, graph)\n  }\n\n  // Identify and add internal edges (both endpoints inside this subgraph)\n  const internalEdgeIndices = new Set<number>()\n  for (let i = 0; i < graph.edges.length; i++) {\n    const edge = graph.edges[i]!\n    if (nodeIds.has(edge.source) && nodeIds.has(edge.target)) {\n      internalEdgeIndices.add(i)\n      const edgeLabel: Record<string, unknown> = { _index: i }\n      if (edge.label) {\n        edgeLabel.label = edge.label\n        edgeLabel.width = estimateTextWidth(edge.label, FONT_SIZES.edgeLabel, FONT_WEIGHTS.edgeLabel) + 8\n        edgeLabel.height = FONT_SIZES.edgeLabel + 6\n        edgeLabel.labelpos = 'c'\n      }\n      subG.setEdge(edge.source, edge.target, edgeLabel)\n    }\n  }\n\n  // Run layout on the isolated subgraph\n  dagre.layout(subG)\n\n  // Determine orthogonal bend direction for the overridden direction\n  const verticalFirst = sg.direction === 'TD' || sg.direction === 'TB' || sg.direction === 'BT'\n\n  // Build a set of subgraph IDs within this subgraph for node/group separation\n  const nestedSubgraphIds = new Set<string>()\n  for (const child of sg.children) {\n    collectAllSubgraphIds(child, nestedSubgraphIds)\n  }\n\n  // Extract positioned nodes (skip nested subgraph compound nodes)\n  const nodes: PositionedNode[] = []\n  for (const nodeId of subG.nodes()) {\n    if (nestedSubgraphIds.has(nodeId)) continue\n    const mNode = graph.nodes.get(nodeId)\n    if (!mNode) continue\n    const dagreNode = subG.node(nodeId)\n    if (!dagreNode) continue\n    const topLeft = centerToTopLeft(dagreNode.x, dagreNode.y, dagreNode.width, dagreNode.height)\n    nodes.push({\n      id: nodeId,\n      label: mNode.label,\n      shape: mNode.shape,\n      x: topLeft.x,\n      y: topLeft.y,\n      width: dagreNode.width,\n      height: dagreNode.height,\n      inlineStyle: resolveNodeStyle(graph, nodeId),\n    })\n  }\n\n  // Extract positioned edges\n  const edges: PositionedEdge[] = subG.edges().map(edgeObj => {\n    const dagreEdge = subG.edge(edgeObj)\n    const originalEdge = graph.edges[dagreEdge._index as number]!\n    const rawPoints: Point[] = dagreEdge.points ?? []\n\n    // Clip edge endpoints to non-rectangular shape boundaries.\n    // Dagre computes endpoints on the rectangular bounding box, but diamonds\n    // and circles are inscribed within the rectangle  endpoints float in the air.\n    if (rawPoints.length > 0) {\n      const srcShape = graph.nodes.get(edgeObj.v)?.shape\n      if (srcShape === 'diamond') {\n        const sn = subG.node(edgeObj.v)\n        rawPoints[0] = clipToDiamondBoundary(rawPoints[0]!, sn.x, sn.y, sn.width / 2, sn.height / 2)\n      } else if (srcShape && CIRCULAR_SHAPES.has(srcShape)) {\n        const sn = subG.node(edgeObj.v)\n        rawPoints[0] = clipToCircleBoundary(rawPoints[0]!, sn.x, sn.y, Math.min(sn.width, sn.height) / 2)\n      }\n      const tgtShape = graph.nodes.get(edgeObj.w)?.shape\n      if (tgtShape === 'diamond') {\n        const tn = subG.node(edgeObj.w)\n        const last = rawPoints.length - 1\n        rawPoints[last] = clipToDiamondBoundary(rawPoints[last]!, tn.x, tn.y, tn.width / 2, tn.height / 2)\n      } else if (tgtShape && CIRCULAR_SHAPES.has(tgtShape)) {\n        const tn = subG.node(edgeObj.w)\n        const last = rawPoints.length - 1\n        rawPoints[last] = clipToCircleBoundary(rawPoints[last]!, tn.x, tn.y, Math.min(tn.width, tn.height) / 2)\n      }\n    }\n\n    const orthoPoints = snapToOrthogonal(rawPoints, verticalFirst)\n\n    // Clip rectangular endpoints to the correct side after orthogonalization.\n    // Non-rectangular shapes (diamond, circle) are already handled above.\n    const srcShape = graph.nodes.get(edgeObj.v)?.shape\n    const tgtShape = graph.nodes.get(edgeObj.w)?.shape\n    const srcRect = (srcShape && !NON_RECT_SHAPES.has(srcShape)) || !srcShape\n      ? (() => { const sn = subG.node(edgeObj.v); return sn ? { cx: sn.x, cy: sn.y, hw: sn.width / 2, hh: sn.height / 2 } : null })()\n      : null\n    const tgtRect = (tgtShape && !NON_RECT_SHAPES.has(tgtShape)) || !tgtShape\n      ? (() => { const tn = subG.node(edgeObj.w); return tn ? { cx: tn.x, cy: tn.y, hw: tn.width / 2, hh: tn.height / 2 } : null })()\n      : null\n    const points = clipEndpointsToNodes(orthoPoints, srcRect, tgtRect)\n\n    let labelPosition: Point | undefined\n    if (originalEdge.label && dagreEdge.x != null && dagreEdge.y != null) {\n      labelPosition = { x: dagreEdge.x, y: dagreEdge.y }\n    }\n\n    return {\n      source: originalEdge.source,\n      target: originalEdge.target,\n      label: originalEdge.label,\n      style: originalEdge.style,\n      hasArrowStart: originalEdge.hasArrowStart,\n      hasArrowEnd: originalEdge.hasArrowEnd,\n      points,\n      labelPosition,\n    }\n  })\n\n  // Extract nested subgroup positions\n  const groups: PositionedGroup[] = sg.children.map(child => extractGroup(subG, child))\n\n  const graphInfo = subG.graph()\n  return {\n    id: sg.id,\n    label: sg.label,\n    width: graphInfo.width ?? 200,\n    height: graphInfo.height ?? 100,\n    nodes,\n    edges,\n    groups,\n    nodeIds,\n    internalEdgeIndices,\n  }\n}\n\n/**\n * Lay out a parsed mermaid graph using dagre.\n * Returns a fully positioned graph ready for SVG rendering.\n *\n * Kept async for API compatibility  dagre itself is synchronous.\n */\nexport async function layoutGraph(\n  graph: MermaidGraph,\n  options: RenderOptions = {}\n): Promise<PositionedGraph> {\n  const opts = { ...DEFAULTS, ...options }\n\n  // -------------------------------------------------------------------------\n  // Phase 1: Pre-compute layouts for subgraphs with direction overrides.\n  //\n  // Dagre only supports a single global rankdir. Subgraphs with a different\n  // direction (e.g. `direction LR` inside `graph TD`) get their own dagre\n  // layout pass. The result is injected as a fixed-size placeholder in the\n  // main layout, then composited back after positioning.\n  // -------------------------------------------------------------------------\n  const preComputed = new Map<string, PreComputedSubgraph>()\n  for (const sg of graph.subgraphs) {\n    if (sg.direction && sg.direction !== graph.direction) {\n      preComputed.set(sg.id, preComputeSubgraphLayout(sg, graph, opts))\n    }\n  }\n\n  // -------------------------------------------------------------------------\n  // Phase 2: Build the main dagre graph.\n  // Pre-computed subgraphs become fixed-size leaf nodes instead of compound nodes.\n  // -------------------------------------------------------------------------\n  const g = new dagre.graphlib.Graph({ directed: true, compound: true })\n  g.setGraph({\n    rankdir: directionToDagre(graph.direction),\n    acyclicer: 'greedy',\n    nodesep: opts.nodeSpacing,\n    ranksep: opts.layerSpacing,\n    marginx: opts.padding,\n    marginy: opts.padding,\n  })\n  g.setDefaultEdgeLabel(() => ({}))\n\n  // Collect node IDs that belong to subgraphs (to exclude from root level).\n  // Also exclude the subgraph IDs themselves  in state diagrams, a composite\n  // state like \"Processing\" exists as both a node (from transition references)\n  // and a subgraph (from the composite definition). Without this exclusion,\n  // dagre receives a duplicate node for the same ID.\n  const subgraphNodeIds = new Set<string>()\n  for (const sg of graph.subgraphs) {\n    subgraphNodeIds.add(sg.id)\n    collectSubgraphNodeIds(sg, subgraphNodeIds)\n  }\n\n  // Add top-level nodes (those not in any subgraph)\n  for (const [id, node] of graph.nodes) {\n    if (!subgraphNodeIds.has(id)) {\n      const size = estimateNodeSize(id, node.label, node.shape)\n      g.setNode(id, { label: node.label, width: size.width, height: size.height })\n    }\n  }\n\n  // Add subgraph compound nodes and their children recursively.\n  // Pre-computed subgraphs are added as fixed-size leaf nodes instead.\n  for (const sg of graph.subgraphs) {\n    if (preComputed.has(sg.id)) {\n      const pc = preComputed.get(sg.id)!\n      g.setNode(sg.id, { width: pc.width, height: pc.height })\n    } else {\n      addSubgraphToDagre(g, sg, graph)\n    }\n  }\n\n  // Build redirect maps for edges that target/originate from compound nodes.\n  // Dagre crashes when edges connect directly to compound parent nodes (known bug\n  // in its ranking algorithm). Workaround: redirect edges to the first/last child\n  // of the subgraph  \"first\" for incoming edges, \"last\" for outgoing.\n  const subgraphEntryNode = new Map<string, string>()\n  const subgraphExitNode = new Map<string, string>()\n  for (const sg of graph.subgraphs) {\n    if (!preComputed.has(sg.id)) {\n      buildSubgraphRedirects(sg, subgraphEntryNode, subgraphExitNode)\n    }\n  }\n\n  // For pre-computed subgraphs, redirect all internal node references to the\n  // placeholder leaf node. External edges to/from internal nodes get routed\n  // to the placeholder boundary; endpoints are fixed up after compositing.\n  for (const [sgId, pc] of preComputed) {\n    for (const nodeId of pc.nodeIds) {\n      subgraphEntryNode.set(nodeId, sgId)\n      subgraphExitNode.set(nodeId, sgId)\n    }\n  }\n\n  // Add edges  skip internal edges of pre-computed subgraphs (handled by pre-computation).\n  // Track cross-boundary edges for post-layout endpoint fixup.\n  const allInternalIndices = new Set<number>()\n  for (const pc of preComputed.values()) {\n    for (const idx of pc.internalEdgeIndices) allInternalIndices.add(idx)\n  }\n\n  // Weight heuristic for stable rank ordering in cyclic graphs (e.g. state diagrams).\n  //\n  // Dagre's acyclicer reverses feedback edges to break cycles, but equal-weight edges\n  // give the ranking algorithm freedom to collapse nodes onto the same rank.\n  // Fix: \"spine\" edges (those that introduce a node as a target for the first time)\n  // get higher weight, biasing dagre to keep them short (1 rank apart). Feedback\n  // edges (target already introduced) keep default weight, allowing them to stretch.\n  const introducedTargets = new Set<string>()\n\n  for (let i = 0; i < graph.edges.length; i++) {\n    if (allInternalIndices.has(i)) continue\n\n    const edge = graph.edges[i]!\n    const source = subgraphExitNode.get(edge.source) ?? edge.source\n    const target = subgraphEntryNode.get(edge.target) ?? edge.target\n    const edgeLabel: Record<string, unknown> = { _index: i }\n    if (edge.label) {\n      edgeLabel.label = edge.label\n      edgeLabel.width = estimateTextWidth(edge.label, FONT_SIZES.edgeLabel, FONT_WEIGHTS.edgeLabel) + 8\n      edgeLabel.height = FONT_SIZES.edgeLabel + 6\n      edgeLabel.labelpos = 'c'\n    }\n\n    // Spine edges get higher weight to maintain sequential ordering\n    if (!introducedTargets.has(target)) {\n      edgeLabel.weight = 2\n      introducedTargets.add(target)\n    }\n\n    g.setEdge(source, target, edgeLabel)\n  }\n\n  // -------------------------------------------------------------------------\n  // Phase 3: Run synchronous layout  mutates g in place.\n  // -------------------------------------------------------------------------\n  try {\n    dagre.layout(g)\n  } catch (err) {\n    const message = err instanceof Error ? err.message : String(err)\n    throw new Error(`Dagre layout failed: ${message}`)\n  }\n\n  // -------------------------------------------------------------------------\n  // Phase 4: Extract positions and compose pre-computed layouts.\n  // -------------------------------------------------------------------------\n  return extractPositionedGraph(g, graph, opts.padding, preComputed)\n}\n\n// ============================================================================\n// Dagre graph construction helpers\n// ============================================================================\n\n/** Convert mermaid direction to dagre rankdir value */\nfunction directionToDagre(dir: MermaidGraph['direction']): string {\n  switch (dir) {\n    case 'LR': return 'LR'\n    case 'RL': return 'RL'\n    case 'BT': return 'BT'\n    case 'TD':\n    case 'TB':\n    default: return 'TB'\n  }\n}\n\n/** Estimate node size based on label text + shape padding */\nfunction estimateNodeSize(id: string, label: string, shape: string): { width: number; height: number } {\n  const textWidth = estimateTextWidth(label, FONT_SIZES.nodeLabel, FONT_WEIGHTS.nodeLabel)\n\n  let width = textWidth + NODE_PADDING.horizontal * 2\n  let height = FONT_SIZES.nodeLabel + NODE_PADDING.vertical * 2\n\n  // Diamonds need extra space because text is inside a rotated square\n  if (shape === 'diamond') {\n    const side = Math.max(width, height) + NODE_PADDING.diamondExtra\n    width = side\n    height = side\n  }\n\n  // Circles and double circles: bounding box must be square, diameter must fit text rect\n  // For a rect (w x h) inscribed in a circle: diameter >= sqrt(w^2 + h^2)\n  if (shape === 'circle' || shape === 'doublecircle') {\n    const diameter = Math.ceil(Math.sqrt(width * width + height * height)) + 8\n    width = shape === 'doublecircle' ? diameter + 12 : diameter\n    height = width\n  }\n\n  // Hexagons need extra horizontal padding for the angled sides\n  if (shape === 'hexagon') {\n    width += NODE_PADDING.horizontal\n  }\n\n  // Trapezoids need extra horizontal padding for angled edges\n  if (shape === 'trapezoid' || shape === 'trapezoid-alt') {\n    width += NODE_PADDING.horizontal\n  }\n\n  // Asymmetric flag shape needs left padding for the pointed end\n  if (shape === 'asymmetric') {\n    width += 12\n  }\n\n  // Cylinder needs extra vertical space for the ellipse cap\n  if (shape === 'cylinder') {\n    height += 14\n  }\n\n  // State diagram pseudostates  small fixed-size circles\n  if (shape === 'state-start' || shape === 'state-end') {\n    width = 28\n    height = 28\n  }\n\n  // Minimum sizes for aesthetics\n  width = Math.max(width, 60)\n  height = Math.max(height, 36)\n\n  return { width, height }\n}\n\n/**\n * Recursively add a subgraph and its children to the dagre graph.\n *\n * Dagre compound nodes work via setParent(child, parent)  unlike ELK's\n * nested children[] JSON tree. We set padding on compound nodes so dagre\n * allocates space for children plus the subgraph header label.\n */\nfunction addSubgraphToDagre(\n  g: dagre.graphlib.Graph,\n  sg: MermaidSubgraph,\n  graph: MermaidGraph,\n  parentId?: string,\n): void {\n  // Register the subgraph as a compound node.\n  // Note: dagre ignores paddingX/paddingY/clusterLabelPos on compound nodes \n  // they're not in dagre's nodeNumAttrs. Header space is handled by post-processing\n  // in extractPositionedGraph() via expandGroupsForHeaders().\n  g.setNode(sg.id, { label: sg.label })\n\n  // Set parent if this is a nested subgraph\n  if (parentId) {\n    g.setParent(sg.id, parentId)\n  }\n\n  // Add direct child nodes inside this subgraph\n  for (const nodeId of sg.nodeIds) {\n    const node = graph.nodes.get(nodeId)\n    if (node) {\n      const size = estimateNodeSize(nodeId, node.label, node.shape)\n      g.setNode(nodeId, { label: node.label, width: size.width, height: size.height })\n      g.setParent(nodeId, sg.id)\n    }\n  }\n\n  // Add nested subgraphs recursively\n  for (const child of sg.children) {\n    addSubgraphToDagre(g, child, graph, sg.id)\n  }\n}\n\n/**\n * Build redirect maps for subgraph entry/exit nodes.\n *\n * Dagre's ranking algorithm crashes when edges connect to compound parent nodes.\n * This maps each subgraph ID to its first child (entry) and last child (exit),\n * so edges targeting a subgraph get redirected to a real leaf node inside it.\n * Handles nested subgraphs by recursing into children.\n */\nfunction buildSubgraphRedirects(\n  sg: MermaidSubgraph,\n  entryMap: Map<string, string>,\n  exitMap: Map<string, string>,\n): void {\n  // Recurse into nested subgraphs FIRST so their entries are available\n  // for transitive resolution when we set this subgraph's redirects.\n  for (const child of sg.children) {\n    buildSubgraphRedirects(child, entryMap, exitMap)\n  }\n\n  // Collect all direct child IDs (both leaf nodes and nested subgraphs)\n  const childIds = [...sg.nodeIds, ...sg.children.map(c => c.id)]\n\n  if (childIds.length === 0) {\n    // Empty subgraph  no children to redirect to.\n    // Dagre treats it as a regular node (no setParent calls) so edges\n    // targeting it won't trigger the compound-node ranking crash.\n    // Map it to itself so consumers of the redirect maps always get a result.\n    entryMap.set(sg.id, sg.id)\n    exitMap.set(sg.id, sg.id)\n    return\n  }\n\n  // For nested subgraphs as entry/exit: resolve transitively to a leaf node\n  const firstChild = childIds[0]!\n  const lastChild = childIds[childIds.length - 1]!\n  entryMap.set(sg.id, entryMap.get(firstChild) ?? firstChild)\n  exitMap.set(sg.id, exitMap.get(lastChild) ?? lastChild)\n}\n\n/**\n * Resolve the final inline style for a node by merging classDef base styles\n * with any explicit `style` overrides. The renderer only reads inlineStyle,\n * so class-based styles must be folded in at construction time.\n */\nfunction resolveNodeStyle(graph: MermaidGraph, nodeId: string): Record<string, string> | undefined {\n  const className = graph.classAssignments.get(nodeId)\n  const classProps = className ? graph.classDefs.get(className) : undefined\n  const inlineProps = graph.nodeStyles.get(nodeId)\n  if (!classProps && !inlineProps) return undefined\n  // Class styles as base, explicit inline `style` overrides on top\n  return { ...classProps, ...inlineProps }\n}\n\n/** Recursively collect all node IDs that belong to any subgraph */\nfunction collectSubgraphNodeIds(sg: MermaidSubgraph, out: Set<string>): void {\n  for (const id of sg.nodeIds) {\n    out.add(id)\n  }\n  for (const child of sg.children) {\n    collectSubgraphNodeIds(child, out)\n  }\n}\n\n// ============================================================================\n// Position extraction  convert dagre layout results to our PositionedGraph\n// ============================================================================\n\nfunction extractPositionedGraph(\n  g: dagre.graphlib.Graph,\n  graph: MermaidGraph,\n  padding: number,\n  preComputed?: Map<string, PreComputedSubgraph>,\n): PositionedGraph {\n  const nodes: PositionedNode[] = []\n  const groups: PositionedGroup[] = []\n\n  // Build a set of subgraph IDs for distinguishing compound nodes from leaf nodes\n  const subgraphIds = new Set<string>()\n  for (const sg of graph.subgraphs) {\n    collectAllSubgraphIds(sg, subgraphIds)\n  }\n\n  // Collect all pre-computed internal node IDs (they're not in the dagre graph)\n  const preComputedNodeIds = new Set<string>()\n  if (preComputed) {\n    for (const pc of preComputed.values()) {\n      for (const nodeId of pc.nodeIds) preComputedNodeIds.add(nodeId)\n    }\n  }\n\n  // Extract leaf nodes (non-subgraph nodes, non-pre-computed-internal nodes)\n  for (const nodeId of g.nodes()) {\n    if (subgraphIds.has(nodeId)) continue\n\n    const mNode = graph.nodes.get(nodeId)\n    if (!mNode) continue\n\n    const dagreNode = g.node(nodeId)\n    if (!dagreNode) continue\n\n    const topLeft = centerToTopLeft(dagreNode.x, dagreNode.y, dagreNode.width, dagreNode.height)\n\n    nodes.push({\n      id: nodeId,\n      label: mNode.label,\n      shape: mNode.shape,\n      x: topLeft.x,\n      y: topLeft.y,\n      width: dagreNode.width,\n      height: dagreNode.height,\n      inlineStyle: resolveNodeStyle(graph, nodeId),\n    })\n  }\n\n  // Extract subgraph groups recursively from the original subgraph tree structure.\n  // For pre-computed subgraphs, the dagre leaf node position provides the group box.\n  for (const sg of graph.subgraphs) {\n    groups.push(extractGroup(g, sg))\n  }\n\n  // Vertical-first bends for TD/BT layouts; horizontal-first for LR/RL\n  const verticalFirst = graph.direction === 'TD' || graph.direction === 'TB' || graph.direction === 'BT'\n\n  // Extract edges  dagre gives us flat points arrays (no sections/container offsets)\n  const edges: PositionedEdge[] = g.edges().map(edgeObj => {\n    const dagreEdge = g.edge(edgeObj)\n    // Retrieve the original edge index stored during graph construction\n    const originalEdge = graph.edges[dagreEdge._index as number]!\n    const rawPoints: Point[] = dagreEdge.points ?? []\n\n    // Clip edge endpoints to non-rectangular shape boundaries.\n    // Dagre computes endpoints on the rectangular bounding box, but diamonds\n    // and circles are inscribed within the rectangle  endpoints float in the air.\n    if (rawPoints.length > 0) {\n      const srcShape = graph.nodes.get(edgeObj.v)?.shape\n      if (srcShape === 'diamond') {\n        const sn = g.node(edgeObj.v)\n        rawPoints[0] = clipToDiamondBoundary(rawPoints[0]!, sn.x, sn.y, sn.width / 2, sn.height / 2)\n      } else if (srcShape && CIRCULAR_SHAPES.has(srcShape)) {\n        const sn = g.node(edgeObj.v)\n        rawPoints[0] = clipToCircleBoundary(rawPoints[0]!, sn.x, sn.y, Math.min(sn.width, sn.height) / 2)\n      }\n      const tgtShape = graph.nodes.get(edgeObj.w)?.shape\n      if (tgtShape === 'diamond') {\n        const tn = g.node(edgeObj.w)\n        const last = rawPoints.length - 1\n        rawPoints[last] = clipToDiamondBoundary(rawPoints[last]!, tn.x, tn.y, tn.width / 2, tn.height / 2)\n      } else if (tgtShape && CIRCULAR_SHAPES.has(tgtShape)) {\n        const tn = g.node(edgeObj.w)\n        const last = rawPoints.length - 1\n        rawPoints[last] = clipToCircleBoundary(rawPoints[last]!, tn.x, tn.y, Math.min(tn.width, tn.height) / 2)\n      }\n    }\n\n    // Post-process to orthogonal segments (direction-aware bend order)\n    const orthoPoints = snapToOrthogonal(rawPoints, verticalFirst)\n\n    // Clip rectangular endpoints to the correct side after orthogonalization.\n    // Non-rectangular shapes (diamond, circle) are already handled above.\n    const srcShapeForClip = graph.nodes.get(edgeObj.v)?.shape\n    const tgtShapeForClip = graph.nodes.get(edgeObj.w)?.shape\n    const srcRect = (srcShapeForClip && !NON_RECT_SHAPES.has(srcShapeForClip)) || !srcShapeForClip\n      ? (() => { const sn = g.node(edgeObj.v); return sn ? { cx: sn.x, cy: sn.y, hw: sn.width / 2, hh: sn.height / 2 } : null })()\n      : null\n    const tgtRect = (tgtShapeForClip && !NON_RECT_SHAPES.has(tgtShapeForClip)) || !tgtShapeForClip\n      ? (() => { const tn = g.node(edgeObj.w); return tn ? { cx: tn.x, cy: tn.y, hw: tn.width / 2, hh: tn.height / 2 } : null })()\n      : null\n    const points = clipEndpointsToNodes(orthoPoints, srcRect, tgtRect)\n\n    // Dagre returns edge label center position directly as edge.x, edge.y\n    let labelPosition: Point | undefined\n    if (originalEdge.label && dagreEdge.x != null && dagreEdge.y != null) {\n      labelPosition = { x: dagreEdge.x, y: dagreEdge.y }\n    }\n\n    return {\n      source: originalEdge.source,\n      target: originalEdge.target,\n      label: originalEdge.label,\n      style: originalEdge.style,\n      hasArrowStart: originalEdge.hasArrowStart,\n      hasArrowEnd: originalEdge.hasArrowEnd,\n      points,\n      labelPosition,\n    }\n  })\n\n  // ---------------------------------------------------------------------------\n  // Compose pre-computed subgraph layouts into the main layout.\n  //\n  // The main dagre graph positioned each pre-computed subgraph as a leaf node.\n  // Now we inject the internal elements at the correct offset and fix cross-\n  // boundary edge endpoints so they connect to actual internal nodes.\n  // ---------------------------------------------------------------------------\n  if (preComputed && preComputed.size > 0) {\n    // Build a map of all composed node positions for endpoint fixup\n    const nodePositionMap = new Map<string, { cx: number; cy: number }>()\n    for (const n of nodes) {\n      nodePositionMap.set(n.id, { cx: n.x + n.width / 2, cy: n.y + n.height / 2 })\n    }\n\n    for (const [sgId, pc] of preComputed) {\n      // Get the placeholder's position from dagre (center-based)\n      const placeholder = g.node(sgId)\n      if (!placeholder) continue\n      const topLeft = centerToTopLeft(placeholder.x, placeholder.y, placeholder.width, placeholder.height)\n\n      // Inject internal nodes at the correct offset\n      for (const pcNode of pc.nodes) {\n        const composed = {\n          ...pcNode,\n          x: pcNode.x + topLeft.x,\n          y: pcNode.y + topLeft.y,\n        }\n        nodes.push(composed)\n        nodePositionMap.set(composed.id, {\n          cx: composed.x + composed.width / 2,\n          cy: composed.y + composed.height / 2,\n        })\n      }\n\n      // Inject internal edges at the correct offset\n      for (const pcEdge of pc.edges) {\n        edges.push({\n          ...pcEdge,\n          points: pcEdge.points.map(p => ({ x: p.x + topLeft.x, y: p.y + topLeft.y })),\n          labelPosition: pcEdge.labelPosition\n            ? { x: pcEdge.labelPosition.x + topLeft.x, y: pcEdge.labelPosition.y + topLeft.y }\n            : undefined,\n        })\n      }\n\n      // Update the group's nested children positions (from pre-computation)\n      const group = findGroupById(groups, sgId)\n      if (group && pc.groups.length > 0) {\n        group.children = pc.groups.map(cg => offsetGroup(cg, topLeft.x, topLeft.y))\n      }\n    }\n\n    // Fix cross-boundary edge endpoints.\n    // Edges that originally connected to internal nodes were redirected to the\n    // placeholder during main layout. Now replace the endpoint with the actual\n    // composed node position and re-run orthogonal snapping.\n    for (const edge of edges) {\n      // Skip edges that are from pre-computed layouts (already correctly routed)\n      if (preComputedNodeIds.has(edge.source) && preComputedNodeIds.has(edge.target)) continue\n\n      let modified = false\n\n      // Fix source endpoint  if the source is inside a pre-computed subgraph\n      if (preComputedNodeIds.has(edge.source)) {\n        const pos = nodePositionMap.get(edge.source)\n        if (pos && edge.points.length > 0) {\n          edge.points[0] = { x: pos.cx, y: pos.cy }\n          modified = true\n        }\n      }\n\n      // Fix target endpoint  if the target is inside a pre-computed subgraph\n      if (preComputedNodeIds.has(edge.target)) {\n        const pos = nodePositionMap.get(edge.target)\n        if (pos && edge.points.length > 0) {\n          edge.points[edge.points.length - 1] = { x: pos.cx, y: pos.cy }\n          modified = true\n        }\n      }\n\n      // Re-snap to orthogonal after modifying endpoints\n      if (modified) {\n        edge.points = snapToOrthogonal(edge.points, verticalFirst)\n      }\n    }\n  }\n\n  // ---------------------------------------------------------------------------\n  // Post-process: add header space to subgraph groups.\n  //\n  // Dagre's compound node bounds tightly wrap children  it ignores paddingX/paddingY\n  // (those aren't in dagre's nodeNumAttrs). This means the subgraph header label\n  // overlaps with the first child node.\n  //\n  // Fix: expand each labeled group upward by headerHeight so the header band\n  // occupies its own space above the children. Process depth-first so child\n  // expansions are incorporated before parent bounds are recalculated.\n  // ---------------------------------------------------------------------------\n  const headerHeight = FONT_SIZES.groupHeader + 16\n  expandGroupsForHeaders(groups, headerHeight)\n\n  // After expanding groups upward, some may extend above dagre's original margins.\n  // Compute the global minimum Y and shift everything down uniformly if needed.\n  const flatGroups = flattenAllGroups(groups)\n  const allYs = [\n    ...nodes.map(n => n.y),\n    ...flatGroups.map(g => g.y),\n  ]\n  const currentMinY = allYs.length > 0 ? Math.min(...allYs) : padding\n  let graphWidth = g.graph().width ?? 800\n  let graphHeight = g.graph().height ?? 600\n\n  if (currentMinY < padding) {\n    const dy = padding - currentMinY\n    for (const n of nodes) n.y += dy\n    for (const e of edges) {\n      for (const p of e.points) p.y += dy\n      if (e.labelPosition) e.labelPosition.y += dy\n    }\n    for (const fg of flatGroups) fg.y += dy\n    graphHeight += dy\n  }\n\n  // Also expand graph height if any group extends beyond the original bottom margin\n  const maxBottom = Math.max(\n    ...nodes.map(n => n.y + n.height),\n    ...flatGroups.map(g => g.y + g.height),\n    ...edges.flatMap(e => e.points.map(p => p.y)),\n  )\n  if (maxBottom + padding > graphHeight) {\n    graphHeight = maxBottom + padding\n  }\n\n  return {\n    width: graphWidth,\n    height: graphHeight,\n    nodes,\n    edges,\n    groups,\n  }\n}\n\n/**\n * Extract a positioned group from a subgraph in the dagre layout.\n * Dagre gives compound nodes absolute coordinates (center-based),\n * so no container-relative offset math is needed.\n */\nfunction extractGroup(\n  g: dagre.graphlib.Graph,\n  sg: MermaidSubgraph,\n): PositionedGroup {\n  const dagreNode = g.node(sg.id)\n  const topLeft = dagreNode\n    ? centerToTopLeft(dagreNode.x, dagreNode.y, dagreNode.width, dagreNode.height)\n    : { x: 0, y: 0 }\n\n  return {\n    id: sg.id,\n    label: sg.label,\n    x: topLeft.x,\n    y: topLeft.y,\n    width: dagreNode?.width ?? 0,\n    height: dagreNode?.height ?? 0,\n    children: sg.children.map(child => extractGroup(g, child)),\n  }\n}\n\n// ============================================================================\n// Header space post-processing\n//\n// Dagre ignores paddingX/paddingY on compound nodes (not in nodeNumAttrs).\n// These helpers expand group boxes upward to create space for header labels.\n// ============================================================================\n\n/**\n * Expand all groups upward to make room for header labels.\n * Processes depth-first so child expansions are accounted for when\n * parent bounds are recalculated.\n */\nfunction expandGroupsForHeaders(groups: PositionedGroup[], headerHeight: number): void {\n  for (const group of groups) {\n    expandGroupForHeader(group, headerHeight)\n  }\n}\n\n/**\n * Recursively expand a single group and its children for header space.\n *\n * Algorithm (depth-first):\n *   1. Expand all children first\n *   2. Re-fit this group's bounds to encompass any expanded children\n *   3. Expand this group upward by headerHeight for its own header\n */\nfunction expandGroupForHeader(group: PositionedGroup, headerHeight: number): void {\n  // Step 1: process children first\n  for (const child of group.children) {\n    expandGroupForHeader(child, headerHeight)\n  }\n\n  // Step 2: re-fit bounds to encompass expanded children.\n  // After children expand upward, they may extend above this group's dagre-computed top.\n  if (group.children.length > 0) {\n    let minY = group.y\n    let maxY = group.y + group.height\n    for (const child of group.children) {\n      minY = Math.min(minY, child.y)\n      maxY = Math.max(maxY, child.y + child.height)\n    }\n    group.height = maxY - minY\n    group.y = minY\n  }\n\n  // Step 3: expand upward for this group's own header band + content padding.\n  // The content padding (GROUP_HEADER_CONTENT_PAD) creates a gap between the header\n  // band bottom and the content area, preventing nested subgraph headers from being\n  // flush against their parent's header band.\n  if (group.label) {\n    const expansion = headerHeight + GROUP_HEADER_CONTENT_PAD\n    group.y -= expansion\n    group.height += expansion\n  }\n}\n\n/** Flatten a group tree into a flat array of all groups (including nested). */\nfunction flattenAllGroups(groups: PositionedGroup[]): PositionedGroup[] {\n  const result: PositionedGroup[] = []\n  for (const g of groups) {\n    result.push(g)\n    result.push(...flattenAllGroups(g.children))\n  }\n  return result\n}\n\n/** Find a group by ID in a nested group tree (depth-first). */\nfunction findGroupById(groups: PositionedGroup[], id: string): PositionedGroup | undefined {\n  for (const g of groups) {\n    if (g.id === id) return g\n    const found = findGroupById(g.children, id)\n    if (found) return found\n  }\n  return undefined\n}\n\n/** Create a copy of a positioned group with all positions offset by (dx, dy). */\nfunction offsetGroup(group: PositionedGroup, dx: number, dy: number): PositionedGroup {\n  return {\n    ...group,\n    x: group.x + dx,\n    y: group.y + dy,\n    children: group.children.map(c => offsetGroup(c, dx, dy)),\n  }\n}\n\n/** Recursively collect all subgraph IDs (including nested) */\nfunction collectAllSubgraphIds(sg: MermaidSubgraph, out: Set<string>): void {\n  out.add(sg.id)\n  for (const child of sg.children) {\n    collectAllSubgraphIds(child, out)\n  }\n}\n","// ============================================================================\n// Font metrics  character width estimates for Inter at different sizes.\n// Used to approximate text bounding boxes without DOM measurement.\n// These are calibrated for Inter's typical glyph widths.\n//\n// NOTE: Theme/color system has moved to src/theme.ts. This file only\n// contains font metrics, spacing constants, and stroke widths.\n// ============================================================================\n\n/** Average character width in px at the given font size and weight (proportional font) */\nexport function estimateTextWidth(text: string, fontSize: number, fontWeight: number): number {\n  // Inter average character widths as fraction of fontSize, per weight.\n  // Heavier weights are slightly wider.\n  const widthRatio = fontWeight >= 600 ? 0.58 : fontWeight >= 500 ? 0.55 : 0.52\n  return text.length * fontSize * widthRatio\n}\n\n/** Average character width in px for monospace fonts (uniform glyph width) */\nexport function estimateMonoTextWidth(text: string, fontSize: number): number {\n  // Monospace fonts have uniform character width  0.6 of fontSize matches actual\n  // glyph widths for JetBrains Mono / SF Mono / Fira Code at small sizes (11px).\n  // Previous value of 0.55 underestimated widths, causing class member labels to\n  // extend beyond their box boundaries.\n  return text.length * fontSize * 0.6\n}\n\n/** Monospace font family used for code-like text (class members, types) */\nexport const MONO_FONT = \"'JetBrains Mono'\" as const\n\n/** Full CSS fallback chain for monospace text */\nexport const MONO_FONT_STACK = `${MONO_FONT}, 'SF Mono', 'Fira Code', ui-monospace, monospace` as const\n\n/** Fixed font sizes used in the renderer (in px) */\nexport const FONT_SIZES = {\n  /** Node label text */\n  nodeLabel: 13,\n  /** Edge label text */\n  edgeLabel: 11,\n  /** Subgraph header text */\n  groupHeader: 12,\n} as const\n\n/** Font weights used per element type */\nexport const FONT_WEIGHTS = {\n  nodeLabel: 500,\n  edgeLabel: 400,\n  groupHeader: 600,\n} as const\n\n// ============================================================================\n// Spacing & sizing constants\n// ============================================================================\n\n/** Vertical gap between a subgraph header band and the content area below it (px).\n * Without this, nested subgraph headers sit flush against their parent's header band. */\nexport const GROUP_HEADER_CONTENT_PAD = 8\n\n/** Padding inside node shapes */\nexport const NODE_PADDING = {\n  /** Horizontal padding inside rectangles/rounded/stadium */\n  horizontal: 16,\n  /** Vertical padding inside rectangles/rounded/stadium */\n  vertical: 10,\n  /** Extra padding for diamond shapes (they need more space due to rotation) */\n  diamondExtra: 24,\n} as const\n\n/** Stroke widths per element type (in px) */\nexport const STROKE_WIDTHS = {\n  outerBox: 1,\n  innerBox: 0.75,\n  connector: 0.75,\n} as const\n\n/**\n * Vertical shift applied to all text elements for font-agnostic centering.\n *\n * Instead of relying on `dominant-baseline=\"central\"` (which each font interprets\n * differently based on its own ascent/descent metrics), we use the default alphabetic\n * baseline and shift down by 0.35em. This places the optical center of text at the\n * y coordinate, regardless of font family (Inter, JetBrains Mono, system fallbacks).\n *\n * The 0.35em value approximates the distance from alphabetic baseline to visual\n * center of Latin text. Using `em` units ensures it scales with font size.\n */\nexport const TEXT_BASELINE_SHIFT = '0.35em' as const\n\n/** Arrow head dimensions */\nexport const ARROW_HEAD = {\n  width: 8,\n  height: 4.8,\n} as const\n\n","// ============================================================================\n// Dagre layout adapter  shared utilities for @dagrejs/dagre integration\n//\n// Provides:\n//   1. snapToOrthogonal()        post-processes edge points into 90-degree segments\n//   2. centerToTopLeft()         converts dagre's center-based coords to top-left\n//   3. clipToDiamondBoundary()   projects rectangle-boundary points onto the diamond\n//   4. clipEndpointsToNodes()    fixes endpoints after orthogonalization\n//\n// Dagre outputs node positions as center coordinates and edge points that\n// may not be strictly orthogonal. These helpers bridge the gap so our SVG\n// renderers receive the same top-left coords and orthogonal edge paths\n// they previously got from ELK.\n// ============================================================================\n\nimport type { Point } from './types.ts'\n\n/**\n * Convert dagre's center-based node coordinates to top-left origin.\n * Dagre returns (x, y) as the center of the node bounding box.\n * Our renderers expect top-left coordinates.\n */\nexport function centerToTopLeft(cx: number, cy: number, width: number, height: number): Point {\n  return { x: cx - width / 2, y: cy - height / 2 }\n}\n\n/**\n * Project a point from the rectangular bounding box onto the diamond boundary.\n *\n * Dagre treats all nodes as rectangles, so edge connection points land on the\n * rectangle boundary. For diamond shapes (rotated squares), the actual visual\n * boundary is an inscribed diamond whose vertices touch the rectangle's edge\n * midpoints. At non-cardinal angles, the rectangle boundary is *outside* the\n * diamond  making edges appear to float in the air.\n *\n * Math: the diamond boundary satisfies |dx|/hw + |dy|/hh = 1 where (dx,dy) is\n * the offset from center and (hw,hh) are half-width/height. We scale the\n * direction vector so it lands exactly on this boundary.\n */\nexport function clipToDiamondBoundary(\n  point: Point,\n  cx: number,\n  cy: number,\n  hw: number,\n  hh: number,\n): Point {\n  const dx = point.x - cx\n  const dy = point.y - cy\n  // Point is at (or very near) center  nothing to clip\n  if (Math.abs(dx) < 0.5 && Math.abs(dy) < 0.5) return point\n  // Scale the direction vector to land on the diamond boundary\n  const scale = 1 / (Math.abs(dx) / hw + Math.abs(dy) / hh)\n  return { x: cx + scale * dx, y: cy + scale * dy }\n}\n\n/**\n * Project a point from the rectangular bounding box onto the circle boundary.\n *\n * Dagre treats all nodes as rectangles, so edge connection points land on the\n * rectangle boundary. For circular shapes (circle, doublecircle, state-start,\n * state-end), the actual visual boundary is inscribed within the rectangle.\n * At non-cardinal angles, the rectangle boundary is *outside* the circle \n * making edges appear to float in the air.\n *\n * Math: scale the direction vector (from center to point) so its length equals\n * the circle radius.\n */\nexport function clipToCircleBoundary(\n  point: Point,\n  cx: number,\n  cy: number,\n  r: number,\n): Point {\n  const dx = point.x - cx\n  const dy = point.y - cy\n  const dist = Math.sqrt(dx * dx + dy * dy)\n  // Point is at (or very near) center  nothing to clip\n  if (dist < 0.5) return point\n  const scale = r / dist\n  return { x: cx + scale * dx, y: cy + scale * dy }\n}\n\n/**\n * Post-process dagre edge points into strictly orthogonal (90-degree) segments.\n *\n * Dagre's Sugiyama layout routes edges through intermediate dummy nodes at each\n * rank, so most segments are already axis-aligned. However, when source and target\n * are at different horizontal positions, diagonal segments can appear.\n *\n * Strategy: walk consecutive point pairs. If both x and y differ, insert an\n * intermediate bend point to create an L-shaped orthogonal path. The bend\n * direction depends on the layout axis:\n *   - verticalFirst=true  (TD/BT): drop vertically, then adjust sideways\n *   - verticalFirst=false (LR/RL): move sideways, then adjust vertically\n *\n * After orthogonalization, collinear points (three consecutive points on the\n * same axis) are eliminated to avoid redundant micro-segments.\n */\nexport function snapToOrthogonal(points: Point[], verticalFirst = true): Point[] {\n  if (points.length < 2) return points\n\n  const result: Point[] = [points[0]!]\n\n  for (let i = 1; i < points.length; i++) {\n    const prev = result[result.length - 1]!\n    const curr = points[i]!\n\n    const dx = Math.abs(curr.x - prev.x)\n    const dy = Math.abs(curr.y - prev.y)\n\n    // If already axis-aligned (or close enough), keep as-is\n    if (dx < 1 || dy < 1) {\n      result.push(curr)\n      continue\n    }\n\n    // Insert an L-bend whose direction matches the layout flow.\n    // TD/BT layouts: vertical first  edge drops along the rank axis, then adjusts.\n    // LR/RL layouts: horizontal first  edge moves along the rank axis, then adjusts.\n    if (verticalFirst) {\n      result.push({ x: prev.x, y: curr.y })\n    } else {\n      result.push({ x: curr.x, y: prev.y })\n    }\n    result.push(curr)\n  }\n\n  // Eliminate collinear points  if three consecutive points share the same x\n  // (vertical segment) or same y (horizontal segment), the middle point is\n  // redundant and creates visual artifacts at polyline corners.\n  return removeCollinear(result)\n}\n\n/** Remove middle points from three-in-a-row collinear sequences. */\nfunction removeCollinear(pts: Point[]): Point[] {\n  if (pts.length < 3) return pts\n  const out: Point[] = [pts[0]!]\n  for (let i = 1; i < pts.length - 1; i++) {\n    const a = out[out.length - 1]!\n    const b = pts[i]!\n    const c = pts[i + 1]!\n    // Skip b if a-b-c are all on the same horizontal or vertical line\n    const sameX = Math.abs(a.x - b.x) < 1 && Math.abs(b.x - c.x) < 1\n    const sameY = Math.abs(a.y - b.y) < 1 && Math.abs(b.y - c.y) < 1\n    if (sameX || sameY) continue\n    out.push(b)\n  }\n  out.push(pts[pts.length - 1]!)\n  return out\n}\n\n/**\n * Node rectangle for endpoint clipping  uses dagre's center-based coordinates.\n */\nexport interface NodeRect {\n  /** Center x (dagre coordinate) */\n  cx: number\n  /** Center y (dagre coordinate) */\n  cy: number\n  /** Half-width */\n  hw: number\n  /** Half-height */\n  hh: number\n}\n\n/**\n * Clip edge endpoints to the correct side of rectangular node boundaries.\n *\n * After snapToOrthogonal(), the final/first segment direction may differ from\n * dagre's original boundary intersection direction. Dagre computes boundary\n * points based on the diagonal direction between nodes, but orthogonalization\n * converts the path to L-bends  changing the approach direction of the\n * first/last segment.\n *\n * Example: in a TB layout, dagre places the target endpoint at the TOP of a\n * node (correct for a diagonal approach). After snapToOrthogonal, the last\n * segment becomes horizontal  but the endpoint stays on the top edge. The\n * arrow visually enters the box from the side at the top, going \"inside.\"\n *\n * This function corrects both endpoints so they connect to the side the edge\n * actually approaches from:\n *   - Horizontal last segment  endpoint on left/right side\n *   - Vertical last segment   endpoint on top/bottom\n *   - Similarly for the first segment and source node\n *\n * When the edge path is within the node's bounds, connects at the natural\n * position to avoid unnecessary bends. Otherwise routes to node center.\n *\n * For 2-point edges (direct connections), clips based on the overall direction\n * between endpoints to ensure arrowheads render at node boundaries.\n */\nexport function clipEndpointsToNodes(\n  points: Point[],\n  sourceNode: NodeRect | null,\n  targetNode: NodeRect | null,\n): Point[] {\n  if (points.length < 2) return points\n  const result = points.map(p => ({ ...p }))\n\n  // --- Fix target endpoint ---\n  if (targetNode) {\n    const last = result.length - 1\n\n    if (points.length === 2) {\n      // 2-point edge: clip based on overall direction between endpoints\n      // This ensures arrowheads render at node boundaries, not inside nodes\n      const first = result[0]!\n      const curr = result[last]!\n      const dx = Math.abs(curr.x - first.x)\n      const dy = Math.abs(curr.y - first.y)\n\n      if (dy >= dx) {\n        // Primarily vertical  clip to top/bottom\n        const approachFromTop = curr.y > first.y\n        const sideY = approachFromTop\n          ? targetNode.cy - targetNode.hh\n          : targetNode.cy + targetNode.hh\n        result[last] = { x: curr.x, y: sideY }\n      } else {\n        // Primarily horizontal  clip to left/right\n        const approachFromLeft = curr.x > first.x\n        const sideX = approachFromLeft\n          ? targetNode.cx - targetNode.hw\n          : targetNode.cx + targetNode.hw\n        result[last] = { x: sideX, y: curr.y }\n      }\n    } else {\n      // 3+ point edge: use last segment direction\n      const prev = result[last - 1]!\n      const curr = result[last]!\n      const dx = Math.abs(curr.x - prev.x)\n      const dy = Math.abs(curr.y - prev.y)\n\n      // Strictly axis-aligned segments (< 1px deviation) route to center for visual balance.\n      // Primarily axis-aligned segments (dx >> dy) can use natural positions within bounds.\n      const isStrictlyHorizontal = dy < 1 && dx >= 1\n      const isStrictlyVertical = dx < 1 && dy >= 1\n      const isPrimarilyHorizontal = !isStrictlyHorizontal && !isStrictlyVertical && dy < dx\n      const isPrimarilyVertical = !isStrictlyHorizontal && !isStrictlyVertical && dx < dy\n\n      if (isStrictlyHorizontal) {\n        // Strictly horizontal  route to center for visual balance\n        const approachFromLeft = curr.x > prev.x\n        const sideX = approachFromLeft\n          ? targetNode.cx - targetNode.hw\n          : targetNode.cx + targetNode.hw\n        result[last] = { x: sideX, y: targetNode.cy }\n        result[last - 1] = { ...prev, y: targetNode.cy }\n      } else if (isStrictlyVertical) {\n        // Strictly vertical  route to center for visual balance\n        const approachFromTop = curr.y > prev.y\n        const sideY = approachFromTop\n          ? targetNode.cy - targetNode.hh\n          : targetNode.cy + targetNode.hh\n        result[last] = { x: targetNode.cx, y: sideY }\n        result[last - 1] = { ...prev, x: targetNode.cx }\n      } else if (isPrimarilyHorizontal) {\n        // Primarily horizontal  use natural Y if within bounds\n        const approachFromLeft = curr.x > prev.x\n        const sideX = approachFromLeft\n          ? targetNode.cx - targetNode.hw\n          : targetNode.cx + targetNode.hw\n\n        const withinVerticalBounds =\n          prev.y >= targetNode.cy - targetNode.hh &&\n          prev.y <= targetNode.cy + targetNode.hh\n\n        if (withinVerticalBounds) {\n          result[last] = { x: sideX, y: prev.y }\n        } else {\n          result[last] = { x: sideX, y: targetNode.cy }\n          result[last - 1] = { ...prev, y: targetNode.cy }\n        }\n      } else if (isPrimarilyVertical) {\n        // Primarily vertical  use natural X if within bounds\n        const approachFromTop = curr.y > prev.y\n        const sideY = approachFromTop\n          ? targetNode.cy - targetNode.hh\n          : targetNode.cy + targetNode.hh\n\n        const withinHorizontalBounds =\n          prev.x >= targetNode.cx - targetNode.hw &&\n          prev.x <= targetNode.cx + targetNode.hw\n\n        if (withinHorizontalBounds) {\n          result[last] = { x: prev.x, y: sideY }\n        } else {\n          result[last] = { x: targetNode.cx, y: sideY }\n          result[last - 1] = { ...prev, x: targetNode.cx }\n        }\n      }\n    }\n  }\n\n  // --- Fix source endpoint (first segment) ---\n  if (sourceNode && points.length >= 3) {\n    // Only process 3+ point edges for source  2-point edges don't need source adjustment\n    const first = result[0]!\n    const next = result[1]!\n    const dx = Math.abs(next.x - first.x)\n    const dy = Math.abs(next.y - first.y)\n\n    // Strictly axis-aligned segments (< 1px deviation) route to center for visual balance.\n    // Primarily axis-aligned segments (dx >> dy) can use natural positions within bounds.\n    const isStrictlyHorizontal = dy < 1 && dx >= 1\n    const isStrictlyVertical = dx < 1 && dy >= 1\n    const isPrimarilyHorizontal = !isStrictlyHorizontal && !isStrictlyVertical && dy < dx\n    const isPrimarilyVertical = !isStrictlyHorizontal && !isStrictlyVertical && dx < dy\n\n    if (isStrictlyHorizontal) {\n      // Strictly horizontal  route from center for visual balance\n      const exitToRight = next.x > first.x\n      const sideX = exitToRight\n        ? sourceNode.cx + sourceNode.hw\n        : sourceNode.cx - sourceNode.hw\n      result[0] = { x: sideX, y: sourceNode.cy }\n      result[1] = { ...result[1]!, y: sourceNode.cy }\n    } else if (isStrictlyVertical) {\n      // Strictly vertical  route from center for visual balance\n      const exitDownward = next.y > first.y\n      const sideY = exitDownward\n        ? sourceNode.cy + sourceNode.hh\n        : sourceNode.cy - sourceNode.hh\n      result[0] = { x: sourceNode.cx, y: sideY }\n      result[1] = { ...result[1]!, x: sourceNode.cx }\n    } else if (isPrimarilyHorizontal) {\n      // Primarily horizontal  use natural Y if within bounds\n      const exitToRight = next.x > first.x\n      const sideX = exitToRight\n        ? sourceNode.cx + sourceNode.hw\n        : sourceNode.cx - sourceNode.hw\n\n      const withinVerticalBounds =\n        next.y >= sourceNode.cy - sourceNode.hh &&\n        next.y <= sourceNode.cy + sourceNode.hh\n\n      if (withinVerticalBounds) {\n        result[0] = { x: sideX, y: next.y }\n      } else {\n        result[0] = { x: sideX, y: sourceNode.cy }\n        result[1] = { ...result[1]!, y: sourceNode.cy }\n      }\n    } else if (isPrimarilyVertical) {\n      // Primarily vertical  use natural X if within bounds\n      const exitDownward = next.y > first.y\n      const sideY = exitDownward\n        ? sourceNode.cy + sourceNode.hh\n        : sourceNode.cy - sourceNode.hh\n\n      const withinHorizontalBounds =\n        next.x >= sourceNode.cx - sourceNode.hw &&\n        next.x <= sourceNode.cx + sourceNode.hw\n\n      if (withinHorizontalBounds) {\n        result[0] = { x: next.x, y: sideY }\n      } else {\n        result[0] = { x: sourceNode.cx, y: sideY }\n        result[1] = { ...result[1]!, x: sourceNode.cx }\n      }\n    }\n  }\n\n  return result\n}\n","import type { PositionedGraph, PositionedNode, PositionedEdge, PositionedGroup, Point } from './types.ts'\nimport type { DiagramColors } from './theme.ts'\nimport { svgOpenTag, buildStyleBlock } from './theme.ts'\nimport { FONT_SIZES, FONT_WEIGHTS, STROKE_WIDTHS, ARROW_HEAD, estimateTextWidth, TEXT_BASELINE_SHIFT } from './styles.ts'\n\n// ============================================================================\n// SVG renderer  converts a PositionedGraph into an SVG string.\n//\n// Pure string concatenation, no DOM manipulation.\n// Renders back-to-front: groups  edges  arrow heads  edge labels  nodes  node labels.\n//\n// All colors are referenced via CSS custom properties (var(--_xxx)) defined\n// in the <style> block. The caller provides bg/fg (+ optional enrichment\n// colors) via DiagramColors, which are set as inline CSS variables on the\n// <svg> tag. See src/theme.ts for the full variable system.\n//\n// Style spec:\n// - All corners rx=0 ry=0 (sharp)\n// - Stroke widths: outer box 1px, inner box 0.75px, connectors 0.75px\n// - Arrow heads: filled triangles, 8px wide  4.8px tall\n// - Dashed edges: stroke-dasharray=\"4 4\"\n// - Font: Inter with weight per element type\n// ============================================================================\n\n/**\n * Render a positioned graph as an SVG string.\n *\n * @param colors - DiagramColors with bg/fg and optional enrichment variables.\n *                 These are set as CSS custom properties on the <svg> tag.\n *                 All element colors reference derived --_xxx variables.\n * @param transparent - If true, renders with transparent background.\n */\nexport function renderSvg(\n  graph: PositionedGraph,\n  colors: DiagramColors,\n  font: string = 'Inter',\n  transparent: boolean = false\n): string {\n  const parts: string[] = []\n\n  // SVG root with CSS variables + style block + defs\n  parts.push(svgOpenTag(graph.width, graph.height, colors, transparent))\n  parts.push(buildStyleBlock(font, false))\n  parts.push('<defs>')\n  parts.push(arrowMarkerDefs())\n  parts.push('</defs>')\n\n  // 1. Group backgrounds (subgraph rectangles with header bands)\n  for (const group of graph.groups) {\n    parts.push(renderGroup(group, font))\n  }\n\n  // 2. Edges (polylines  rendered behind nodes)\n  for (const edge of graph.edges) {\n    parts.push(renderEdge(edge))\n  }\n\n  // 3. Edge labels (positioned at midpoint of edge)\n  for (const edge of graph.edges) {\n    if (edge.label) {\n      parts.push(renderEdgeLabel(edge, font))\n    }\n  }\n\n  // 4. Node shapes\n  for (const node of graph.nodes) {\n    parts.push(renderNodeShape(node))\n  }\n\n  // 5. Node labels\n  for (const node of graph.nodes) {\n    parts.push(renderNodeLabel(node, font))\n  }\n\n  parts.push('</svg>')\n\n  return parts.join('\\n')\n}\n\n// ============================================================================\n// Arrow marker definitions\n// ============================================================================\n\n/**\n * Reusable arrow head markers  both forward (end) and reverse (start) variants.\n * The reverse marker uses orient=\"auto-start-reverse\" to flip automatically.\n * Arrow color uses var(--_arrow) CSS variable.\n */\nfunction arrowMarkerDefs(): string {\n  const w = ARROW_HEAD.width\n  const h = ARROW_HEAD.height\n  return (\n    // Forward arrow (marker-end)  orient=\"auto\" ensures arrow points along line direction\n    `  <marker id=\"arrowhead\" markerWidth=\"${w}\" markerHeight=\"${h}\" refX=\"${w}\" refY=\"${h / 2}\" orient=\"auto\">` +\n    `\\n    <polygon points=\"0 0, ${w} ${h / 2}, 0 ${h}\" fill=\"var(--_arrow)\" />` +\n    `\\n  </marker>` +\n    // Reverse arrow (marker-start)  refX=0 so it sits at the line start, auto-start-reverse flips it\n    `\\n  <marker id=\"arrowhead-start\" markerWidth=\"${w}\" markerHeight=\"${h}\" refX=\"0\" refY=\"${h / 2}\" orient=\"auto-start-reverse\">` +\n    `\\n    <polygon points=\"${w} 0, 0 ${h / 2}, ${w} ${h}\" fill=\"var(--_arrow)\" />` +\n    `\\n  </marker>`\n  )\n}\n\n// ============================================================================\n// Group rendering (subgraph backgrounds)\n// ============================================================================\n\nfunction renderGroup(group: PositionedGroup, font: string): string {\n  const headerHeight = FONT_SIZES.groupHeader + 16\n  const parts: string[] = []\n\n  // Outer rectangle\n  parts.push(\n    `<rect x=\"${group.x}\" y=\"${group.y}\" width=\"${group.width}\" height=\"${group.height}\" ` +\n    `rx=\"0\" ry=\"0\" fill=\"var(--_group-fill)\" stroke=\"var(--_node-stroke)\" stroke-width=\"${STROKE_WIDTHS.outerBox}\" />`\n  )\n\n  // Header band\n  parts.push(\n    `<rect x=\"${group.x}\" y=\"${group.y}\" width=\"${group.width}\" height=\"${headerHeight}\" ` +\n    `rx=\"0\" ry=\"0\" fill=\"var(--_group-hdr)\" stroke=\"var(--_node-stroke)\" stroke-width=\"${STROKE_WIDTHS.outerBox}\" />`\n  )\n\n  // Header label\n  parts.push(\n    `<text x=\"${group.x + 12}\" y=\"${group.y + headerHeight / 2}\" ` +\n    `dy=\"${TEXT_BASELINE_SHIFT}\" font-size=\"${FONT_SIZES.groupHeader}\" font-weight=\"${FONT_WEIGHTS.groupHeader}\" ` +\n    `fill=\"var(--_text-sec)\">${escapeXml(group.label)}</text>`\n  )\n\n  // Render nested groups recursively\n  for (const child of group.children) {\n    parts.push(renderGroup(child, font))\n  }\n\n  return parts.join('\\n')\n}\n\n// ============================================================================\n// Edge rendering\n// ============================================================================\n\nfunction renderEdge(edge: PositionedEdge): string {\n  if (edge.points.length < 2) return ''\n\n  const pathData = pointsToPolylinePath(edge.points)\n  const dashArray = edge.style === 'dotted' ? ' stroke-dasharray=\"4 4\"' : ''\n  const strokeWidth = edge.style === 'thick' ? STROKE_WIDTHS.connector * 2 : STROKE_WIDTHS.connector\n\n  // Build marker attributes based on arrow direction flags\n  let markers = ''\n  if (edge.hasArrowEnd) markers += ' marker-end=\"url(#arrowhead)\"'\n  if (edge.hasArrowStart) markers += ' marker-start=\"url(#arrowhead-start)\"'\n\n  return (\n    `<polyline points=\"${pathData}\" fill=\"none\" stroke=\"var(--_line)\" ` +\n    `stroke-width=\"${strokeWidth}\"${dashArray}${markers} />`\n  )\n}\n\n/** Convert points to SVG polyline points attribute: \"x1,y1 x2,y2 ...\" */\nfunction pointsToPolylinePath(points: Point[]): string {\n  return points.map(p => `${p.x},${p.y}`).join(' ')\n}\n\nfunction renderEdgeLabel(edge: PositionedEdge, font: string): string {\n  // Use dagre-computed label position when available (layout-aware, avoids collisions).\n  // Fall back to geometric midpoint of the edge polyline.\n  const mid = edge.labelPosition ?? edgeMidpoint(edge.points)\n  const label = edge.label!\n  const textWidth = estimateTextWidth(label, FONT_SIZES.edgeLabel, FONT_WEIGHTS.edgeLabel)\n  const padding = 8\n\n  // Background pill behind text for readability\n  const bgWidth = textWidth + padding * 2\n  const bgHeight = FONT_SIZES.edgeLabel + padding * 2\n\n  return (\n    `<rect x=\"${mid.x - bgWidth / 2}\" y=\"${mid.y - bgHeight / 2}\" ` +\n    `width=\"${bgWidth}\" height=\"${bgHeight}\" rx=\"4\" ry=\"4\" ` +\n    `fill=\"var(--bg)\" stroke=\"var(--_inner-stroke)\" stroke-width=\"0.5\" />\\n` +\n    `<text x=\"${mid.x}\" y=\"${mid.y}\" text-anchor=\"middle\" dy=\"${TEXT_BASELINE_SHIFT}\" ` +\n    `font-size=\"${FONT_SIZES.edgeLabel}\" font-weight=\"${FONT_WEIGHTS.edgeLabel}\" ` +\n    `fill=\"var(--_text-muted)\">${escapeXml(label)}</text>`\n  )\n}\n\n/** Get the midpoint of a polyline (by walking segments) */\nfunction edgeMidpoint(points: Point[]): Point {\n  if (points.length === 0) return { x: 0, y: 0 }\n  if (points.length === 1) return points[0]!\n\n  // Calculate total length\n  let totalLength = 0\n  for (let i = 1; i < points.length; i++) {\n    totalLength += dist(points[i - 1]!, points[i]!)\n  }\n\n  // Walk to the halfway point\n  let remaining = totalLength / 2\n  for (let i = 1; i < points.length; i++) {\n    const segLen = dist(points[i - 1]!, points[i]!)\n    if (remaining <= segLen) {\n      const t = remaining / segLen\n      return {\n        x: points[i - 1]!.x + t * (points[i]!.x - points[i - 1]!.x),\n        y: points[i - 1]!.y + t * (points[i]!.y - points[i - 1]!.y),\n      }\n    }\n    remaining -= segLen\n  }\n\n  return points[points.length - 1]!\n}\n\nfunction dist(a: Point, b: Point): number {\n  return Math.sqrt((b.x - a.x) ** 2 + (b.y - a.y) ** 2)\n}\n\n// ============================================================================\n// Node rendering\n// ============================================================================\n\nfunction renderNodeShape(node: PositionedNode): string {\n  const { x, y, width, height, shape, inlineStyle } = node\n\n  // Resolve fill and stroke  inline styles (from mermaid `style` directives)\n  // override the CSS variable defaults. When no inline style is present, the\n  // CSS variable handles theming automatically via color-mix() derivation.\n  const fill = escapeXml(inlineStyle?.fill ?? 'var(--_node-fill)')\n  const stroke = escapeXml(inlineStyle?.stroke ?? 'var(--_node-stroke)')\n  const sw = escapeXml(inlineStyle?.['stroke-width'] ?? String(STROKE_WIDTHS.innerBox))\n\n  switch (shape) {\n    case 'diamond':\n      return renderDiamond(x, y, width, height, fill, stroke, sw)\n    case 'rounded':\n      return renderRoundedRect(x, y, width, height, fill, stroke, sw)\n    case 'stadium':\n      return renderStadium(x, y, width, height, fill, stroke, sw)\n    case 'circle':\n      return renderCircle(x, y, width, height, fill, stroke, sw)\n    case 'subroutine':\n      return renderSubroutine(x, y, width, height, fill, stroke, sw)\n    case 'doublecircle':\n      return renderDoubleCircle(x, y, width, height, fill, stroke, sw)\n    case 'hexagon':\n      return renderHexagon(x, y, width, height, fill, stroke, sw)\n    case 'cylinder':\n      return renderCylinder(x, y, width, height, fill, stroke, sw)\n    case 'asymmetric':\n      return renderAsymmetric(x, y, width, height, fill, stroke, sw)\n    case 'trapezoid':\n      return renderTrapezoid(x, y, width, height, fill, stroke, sw)\n    case 'trapezoid-alt':\n      return renderTrapezoidAlt(x, y, width, height, fill, stroke, sw)\n    case 'state-start':\n      return renderStateStart(x, y, width, height)\n    case 'state-end':\n      return renderStateEnd(x, y, width, height)\n    case 'rectangle':\n    default:\n      return renderRect(x, y, width, height, fill, stroke, sw)\n  }\n}\n\n// --- Basic shapes ---\n\nfunction renderRect(x: number, y: number, w: number, h: number, fill: string, stroke: string, sw: string): string {\n  return (\n    `<rect x=\"${x}\" y=\"${y}\" width=\"${w}\" height=\"${h}\" ` +\n    `rx=\"0\" ry=\"0\" fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${sw}\" />`\n  )\n}\n\nfunction renderRoundedRect(x: number, y: number, w: number, h: number, fill: string, stroke: string, sw: string): string {\n  return (\n    `<rect x=\"${x}\" y=\"${y}\" width=\"${w}\" height=\"${h}\" ` +\n    `rx=\"6\" ry=\"6\" fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${sw}\" />`\n  )\n}\n\nfunction renderStadium(x: number, y: number, w: number, h: number, fill: string, stroke: string, sw: string): string {\n  const r = h / 2\n  return (\n    `<rect x=\"${x}\" y=\"${y}\" width=\"${w}\" height=\"${h}\" ` +\n    `rx=\"${r}\" ry=\"${r}\" fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${sw}\" />`\n  )\n}\n\nfunction renderCircle(x: number, y: number, w: number, h: number, fill: string, stroke: string, sw: string): string {\n  const cx = x + w / 2\n  const cy = y + h / 2\n  const r = Math.min(w, h) / 2\n  return (\n    `<circle cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\" ` +\n    `fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${sw}\" />`\n  )\n}\n\nfunction renderDiamond(x: number, y: number, w: number, h: number, fill: string, stroke: string, sw: string): string {\n  const cx = x + w / 2\n  const cy = y + h / 2\n  const hw = w / 2\n  const hh = h / 2\n  const points = [\n    `${cx},${cy - hh}`,   // top\n    `${cx + hw},${cy}`,   // right\n    `${cx},${cy + hh}`,   // bottom\n    `${cx - hw},${cy}`,   // left\n  ].join(' ')\n\n  return (\n    `<polygon points=\"${points}\" fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${sw}\" />`\n  )\n}\n\n// --- Batch 1 shapes ---\n\n/** Subroutine: rectangle with double vertical borders on left and right */\nfunction renderSubroutine(x: number, y: number, w: number, h: number, fill: string, stroke: string, sw: string): string {\n  const inset = 8 // distance from edge to inner vertical line\n  return (\n    `<rect x=\"${x}\" y=\"${y}\" width=\"${w}\" height=\"${h}\" ` +\n    `rx=\"0\" ry=\"0\" fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${sw}\" />` +\n    `\\n<line x1=\"${x + inset}\" y1=\"${y}\" x2=\"${x + inset}\" y2=\"${y + h}\" ` +\n    `stroke=\"${stroke}\" stroke-width=\"${sw}\" />` +\n    `\\n<line x1=\"${x + w - inset}\" y1=\"${y}\" x2=\"${x + w - inset}\" y2=\"${y + h}\" ` +\n    `stroke=\"${stroke}\" stroke-width=\"${sw}\" />`\n  )\n}\n\n/** Double circle: two concentric circles with a gap between them */\nfunction renderDoubleCircle(x: number, y: number, w: number, h: number, fill: string, stroke: string, sw: string): string {\n  const cx = x + w / 2\n  const cy = y + h / 2\n  const outerR = Math.min(w, h) / 2\n  const innerR = outerR - 5 // 5px gap between rings\n  return (\n    `<circle cx=\"${cx}\" cy=\"${cy}\" r=\"${outerR}\" ` +\n    `fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${sw}\" />` +\n    `\\n<circle cx=\"${cx}\" cy=\"${cy}\" r=\"${innerR}\" ` +\n    `fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${sw}\" />`\n  )\n}\n\n/** Hexagon: 6-point polygon with flat top/bottom and angled sides */\nfunction renderHexagon(x: number, y: number, w: number, h: number, fill: string, stroke: string, sw: string): string {\n  const inset = h / 4 // horizontal inset for the angled sides\n  const points = [\n    `${x + inset},${y}`,           // top-left\n    `${x + w - inset},${y}`,       // top-right\n    `${x + w},${y + h / 2}`,       // mid-right\n    `${x + w - inset},${y + h}`,   // bottom-right\n    `${x + inset},${y + h}`,       // bottom-left\n    `${x},${y + h / 2}`,           // mid-left\n  ].join(' ')\n\n  return `<polygon points=\"${points}\" fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${sw}\" />`\n}\n\n// --- Batch 2 shapes ---\n\n/** Cylinder / database: top ellipse cap + body rect + bottom ellipse */\nfunction renderCylinder(x: number, y: number, w: number, h: number, fill: string, stroke: string, sw: string): string {\n  const ry = 7 // ellipse vertical radius for the cap\n  const cx = x + w / 2\n  const bodyTop = y + ry\n  const bodyH = h - 2 * ry\n\n  return (\n    // Body rectangle (no top border  covered by top ellipse)\n    `<rect x=\"${x}\" y=\"${bodyTop}\" width=\"${w}\" height=\"${bodyH}\" ` +\n    `fill=\"${fill}\" stroke=\"none\" />` +\n    // Left and right body borders\n    `\\n<line x1=\"${x}\" y1=\"${bodyTop}\" x2=\"${x}\" y2=\"${bodyTop + bodyH}\" stroke=\"${stroke}\" stroke-width=\"${sw}\" />` +\n    `\\n<line x1=\"${x + w}\" y1=\"${bodyTop}\" x2=\"${x + w}\" y2=\"${bodyTop + bodyH}\" stroke=\"${stroke}\" stroke-width=\"${sw}\" />` +\n    // Bottom ellipse (half visible)\n    `\\n<ellipse cx=\"${cx}\" cy=\"${y + h - ry}\" rx=\"${w / 2}\" ry=\"${ry}\" ` +\n    `fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${sw}\" />` +\n    // Top ellipse (full, on top)\n    `\\n<ellipse cx=\"${cx}\" cy=\"${bodyTop}\" rx=\"${w / 2}\" ry=\"${ry}\" ` +\n    `fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${sw}\" />`\n  )\n}\n\n/** Asymmetric / flag: rectangle with a pointed left edge */\nfunction renderAsymmetric(x: number, y: number, w: number, h: number, fill: string, stroke: string, sw: string): string {\n  const indent = 12 // how far the point indents\n  const points = [\n    `${x + indent},${y}`,       // top-left (indented)\n    `${x + w},${y}`,            // top-right\n    `${x + w},${y + h}`,        // bottom-right\n    `${x + indent},${y + h}`,   // bottom-left (indented)\n    `${x},${y + h / 2}`,        // left point\n  ].join(' ')\n\n  return `<polygon points=\"${points}\" fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${sw}\" />`\n}\n\n/** Trapezoid [/text\\]: wider bottom, narrower top */\nfunction renderTrapezoid(x: number, y: number, w: number, h: number, fill: string, stroke: string, sw: string): string {\n  const inset = w * 0.15 // top edge is narrower by this amount on each side\n  const points = [\n    `${x + inset},${y}`,         // top-left (indented)\n    `${x + w - inset},${y}`,     // top-right (indented)\n    `${x + w},${y + h}`,         // bottom-right (full width)\n    `${x},${y + h}`,             // bottom-left (full width)\n  ].join(' ')\n\n  return `<polygon points=\"${points}\" fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${sw}\" />`\n}\n\n/** Trapezoid-alt [\\text/]: wider top, narrower bottom */\nfunction renderTrapezoidAlt(x: number, y: number, w: number, h: number, fill: string, stroke: string, sw: string): string {\n  const inset = w * 0.15 // bottom edge is narrower\n  const points = [\n    `${x},${y}`,                     // top-left (full width)\n    `${x + w},${y}`,                 // top-right (full width)\n    `${x + w - inset},${y + h}`,     // bottom-right (indented)\n    `${x + inset},${y + h}`,         // bottom-left (indented)\n  ].join(' ')\n\n  return `<polygon points=\"${points}\" fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${sw}\" />`\n}\n\n// --- Batch 3: State diagram pseudostates ---\n\n/** State start: small filled circle using primary text color */\nfunction renderStateStart(x: number, y: number, w: number, h: number): string {\n  const cx = x + w / 2\n  const cy = y + h / 2\n  const r = Math.min(w, h) / 2 - 2\n  return `<circle cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\" fill=\"var(--_text)\" stroke=\"none\" />`\n}\n\n/** State end: bullseye  outer ring + inner filled circle using primary text color */\nfunction renderStateEnd(x: number, y: number, w: number, h: number): string {\n  const cx = x + w / 2\n  const cy = y + h / 2\n  const outerR = Math.min(w, h) / 2 - 2\n  const innerR = outerR - 4\n  return (\n    `<circle cx=\"${cx}\" cy=\"${cy}\" r=\"${outerR}\" ` +\n    `fill=\"none\" stroke=\"var(--_text)\" stroke-width=\"${STROKE_WIDTHS.innerBox * 2}\" />` +\n    `\\n<circle cx=\"${cx}\" cy=\"${cy}\" r=\"${innerR}\" fill=\"var(--_text)\" stroke=\"none\" />`\n  )\n}\n\n// ============================================================================\n// Node label rendering\n// ============================================================================\n\nfunction renderNodeLabel(node: PositionedNode, font: string): string {\n  // State pseudostates have no label\n  if (node.shape === 'state-start' || node.shape === 'state-end') {\n    if (!node.label) return ''\n  }\n\n  const cx = node.x + node.width / 2\n  const cy = node.y + node.height / 2\n\n  // Resolve text color  inline styles can override the CSS variable default\n  const textColor = escapeXml(node.inlineStyle?.color ?? 'var(--_text)')\n\n  return (\n    `<text x=\"${cx}\" y=\"${cy}\" text-anchor=\"middle\" dy=\"${TEXT_BASELINE_SHIFT}\" ` +\n    `font-size=\"${FONT_SIZES.nodeLabel}\" font-weight=\"${FONT_WEIGHTS.nodeLabel}\" ` +\n    `fill=\"${textColor}\">${escapeXml(node.label)}</text>`\n  )\n}\n\n// ============================================================================\n// Utilities\n// ============================================================================\n\n/** Escape special XML characters in text content */\nfunction escapeXml(text: string): string {\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;')\n}\n","import type { SequenceDiagram, PositionedSequenceDiagram, PositionedActor, Lifeline, PositionedMessage, Activation, PositionedBlock, PositionedNote } from './types.ts'\nimport type { RenderOptions } from '../types.ts'\nimport { estimateTextWidth, FONT_SIZES, FONT_WEIGHTS } from '../styles.ts'\n\n// ============================================================================\n// Sequence diagram layout engine\n//\n// Custom timeline-based layout (no dagre  sequence diagrams aren't graphs).\n//\n// Layout strategy:\n//   1. Space actors horizontally based on label widths + min gap\n//   2. Stack messages vertically in chronological order\n//   3. Track activation boxes via a stack\n//   4. Position blocks (loop/alt/opt) as background rectangles\n//   5. Position notes next to their target actors\n// ============================================================================\n\n/** Layout constants specific to sequence diagrams */\nconst SEQ = {\n  /** Padding around the entire diagram */\n  padding: 30,\n  /** Minimum gap between actor centers */\n  actorGap: 140,\n  /** Actor box height */\n  actorHeight: 40,\n  /** Horizontal padding inside actor boxes */\n  actorPadX: 16,\n  /** Vertical space between actor boxes and first message */\n  headerGap: 20,\n  /** Vertical space per message row */\n  messageRowHeight: 40,\n  /** Extra vertical space for self-messages (they loop back) */\n  selfMessageHeight: 30,\n  /** Activation box width (narrow rectangle on lifeline) */\n  activationWidth: 10,\n  /** Block padding (loop/alt borders) */\n  blockPadX: 10,\n  blockPadTop: 40,\n  blockPadBottom: 8,\n  /** Extra vertical space before the first message in a block (room for the header label) */\n  blockHeaderExtra: 28,\n  /** Extra vertical space before a message at a divider boundary (room for else/and label) */\n  dividerExtra: 24,\n  /** Note dimensions */\n  noteWidth: 120,\n  notePadding: 8,\n  noteGap: 10,\n} as const\n\n/**\n * Lay out a parsed sequence diagram.\n * Returns a fully positioned diagram ready for SVG rendering.\n */\nexport function layoutSequenceDiagram(\n  diagram: SequenceDiagram,\n  _options: RenderOptions = {}\n): PositionedSequenceDiagram {\n  if (diagram.actors.length === 0) {\n    return { width: 0, height: 0, actors: [], lifelines: [], messages: [], activations: [], blocks: [], notes: [] }\n  }\n\n  // 1. Calculate actor widths and assign horizontal positions (center X)\n  const actorWidths = diagram.actors.map(a => {\n    const textW = estimateTextWidth(a.label, FONT_SIZES.nodeLabel, FONT_WEIGHTS.nodeLabel)\n    return Math.max(textW + SEQ.actorPadX * 2, 80)\n  })\n\n  // Build actor center X positions with minimum gap\n  const actorCenterX: number[] = []\n  let currentX = SEQ.padding + actorWidths[0]! / 2\n  for (let i = 0; i < diagram.actors.length; i++) {\n    if (i > 0) {\n      const minGap = Math.max(SEQ.actorGap, (actorWidths[i - 1]! + actorWidths[i]!) / 2 + 40)\n      currentX += minGap\n    }\n    actorCenterX.push(currentX)\n  }\n\n  // Build actor ID  index lookup\n  const actorIndex = new Map<string, number>()\n  for (let i = 0; i < diagram.actors.length; i++) {\n    actorIndex.set(diagram.actors[i]!.id, i)\n  }\n\n  // 2. Position actors at the top\n  const actorY = SEQ.padding\n  const actors: PositionedActor[] = diagram.actors.map((a, i) => ({\n    id: a.id,\n    label: a.label,\n    type: a.type,\n    x: actorCenterX[i]!,\n    y: actorY,\n    width: actorWidths[i]!,\n    height: SEQ.actorHeight,\n  }))\n\n  // 3. Stack messages vertically\n  let messageY = actorY + SEQ.actorHeight + SEQ.headerGap\n  const messages: PositionedMessage[] = []\n\n  // Pre-scan blocks to determine which message indices need extra vertical\n  // space for block headers (e.g. \"alt [Valid credentials]\") or divider\n  // labels (e.g. \"[else Invalid]\"). Without this, messages inside blocks\n  // overlap with the header/divider text that sits above them.\n  const extraSpaceBefore = new Map<number, number>()\n  for (const block of diagram.blocks) {\n    // First message in the block needs room for the block header label\n    const prev = extraSpaceBefore.get(block.startIndex) ?? 0\n    extraSpaceBefore.set(block.startIndex, Math.max(prev, SEQ.blockHeaderExtra))\n\n    // Each divider (else/and) needs room for the divider label\n    for (const div of block.dividers) {\n      const prevDiv = extraSpaceBefore.get(div.index) ?? 0\n      extraSpaceBefore.set(div.index, Math.max(prevDiv, SEQ.dividerExtra))\n    }\n  }\n\n  // Track activation stack per actor: array of start-Y positions\n  const activationStacks = new Map<string, number[]>()\n  const activations: Activation[] = []\n\n  for (let msgIdx = 0; msgIdx < diagram.messages.length; msgIdx++) {\n    const msg = diagram.messages[msgIdx]!\n    const fromIdx = actorIndex.get(msg.from) ?? 0\n    const toIdx = actorIndex.get(msg.to) ?? 0\n    const isSelf = msg.from === msg.to\n\n    // Add extra vertical space if this message sits below a block header or divider\n    const extra = extraSpaceBefore.get(msgIdx) ?? 0\n    if (extra > 0) messageY += extra\n\n    const x1 = actorCenterX[fromIdx]!\n    const x2 = actorCenterX[toIdx]!\n\n    messages.push({\n      from: msg.from,\n      to: msg.to,\n      label: msg.label,\n      lineStyle: msg.lineStyle,\n      arrowHead: msg.arrowHead,\n      x1, x2,\n      y: messageY,\n      isSelf,\n    })\n\n    // Handle activation\n    if (msg.activate) {\n      if (!activationStacks.has(msg.to)) {\n        activationStacks.set(msg.to, [])\n      }\n      activationStacks.get(msg.to)!.push(messageY)\n    }\n\n    if (msg.deactivate) {\n      const stack = activationStacks.get(msg.from)\n      if (stack && stack.length > 0) {\n        const startY = stack.pop()!\n        const idx = actorIndex.get(msg.from) ?? 0\n        activations.push({\n          actorId: msg.from,\n          x: actorCenterX[idx]! - SEQ.activationWidth / 2,\n          topY: startY,\n          bottomY: messageY,\n          width: SEQ.activationWidth,\n        })\n      }\n    }\n\n    messageY += isSelf ? SEQ.selfMessageHeight + SEQ.messageRowHeight : SEQ.messageRowHeight\n  }\n\n  // Close any unclosed activations\n  for (const [actorId, stack] of activationStacks) {\n    for (const startY of stack) {\n      const idx = actorIndex.get(actorId) ?? 0\n      activations.push({\n        actorId,\n        x: actorCenterX[idx]! - SEQ.activationWidth / 2,\n        topY: startY,\n        bottomY: messageY - SEQ.messageRowHeight / 2,\n        width: SEQ.activationWidth,\n      })\n    }\n  }\n\n  // 4. Position blocks (loop/alt/opt)\n  const blocks: PositionedBlock[] = diagram.blocks.map(block => {\n    // Block spans from the Y of startIndex to endIndex messages\n    const startMsg = messages[block.startIndex]\n    const endMsg = messages[block.endIndex]\n    const blockTop = (startMsg?.y ?? messageY) - SEQ.blockPadTop\n    const blockBottom = (endMsg?.y ?? messageY) + SEQ.blockPadBottom + 12\n\n    // Block width spans all actors involved in its messages\n    const involvedActors = new Set<number>()\n    for (let mi = block.startIndex; mi <= block.endIndex; mi++) {\n      const m = diagram.messages[mi]\n      if (m) {\n        involvedActors.add(actorIndex.get(m.from) ?? 0)\n        involvedActors.add(actorIndex.get(m.to) ?? 0)\n      }\n    }\n    // Fallback: span all actors if none involved\n    if (involvedActors.size === 0) {\n      for (let ai = 0; ai < diagram.actors.length; ai++) involvedActors.add(ai)\n    }\n    const minIdx = Math.min(...involvedActors)\n    const maxIdx = Math.max(...involvedActors)\n    const blockLeft = actorCenterX[minIdx]! - actorWidths[minIdx]! / 2 - SEQ.blockPadX\n    const blockRight = actorCenterX[maxIdx]! + actorWidths[maxIdx]! / 2 + SEQ.blockPadX\n\n    // Position dividers  offset from message Y so the divider label text\n    // (rendered at divider.y + 14 in the renderer) clears the message label\n    // (rendered at msg.y - 6).\n    //\n    // Default offset 28 gives ~8px baseline clearance, which is sufficient\n    // when the divider label (left-aligned at block edge) and message label\n    // (centered between actors) don't share horizontal space. When they DO\n    // overlap horizontally (e.g. long divider labels like \"[Account locked]\"\n    // next to centered message labels like \"403 Forbidden\"), we increase the\n    // offset to 36 so text bounding boxes have ~5px visual clearance.\n    const dividers = block.dividers.map(d => {\n      const msg = messages[d.index]\n      const msgY = msg?.y ?? messageY\n      let offset = 28\n\n      // Dynamic overlap detection: increase offset when the divider label\n      // and message label occupy the same horizontal region, which would\n      // cause vertical text overlap at the default 8px baseline gap.\n      if (d.label && msg?.label) {\n        const divLabelText = `[${d.label}]`\n        const divLabelW = estimateTextWidth(divLabelText, FONT_SIZES.edgeLabel, FONT_WEIGHTS.edgeLabel)\n        const divLabelLeft = blockLeft + 8\n        const divLabelRight = divLabelLeft + divLabelW\n\n        const msgLabelW = estimateTextWidth(msg.label, FONT_SIZES.edgeLabel, FONT_WEIGHTS.edgeLabel)\n        // Self-messages render labels at x1 + 36 (left-aligned); normal\n        // messages center the label between the two actor lifelines.\n        const msgLabelLeft = msg.isSelf\n          ? msg.x1 + 36\n          : (msg.x1 + msg.x2) / 2 - msgLabelW / 2\n        const msgLabelRight = msgLabelLeft + msgLabelW\n\n        if (divLabelRight > msgLabelLeft && divLabelLeft < msgLabelRight) {\n          offset = 36\n        }\n      }\n\n      return { y: msgY - offset, label: d.label }\n    })\n\n    return {\n      type: block.type,\n      label: block.label,\n      x: blockLeft,\n      y: blockTop,\n      width: blockRight - blockLeft,\n      height: blockBottom - blockTop,\n      dividers,\n    }\n  })\n\n  // 5. Position notes\n  const notes: PositionedNote[] = diagram.notes.map(note => {\n    const noteW = Math.max(\n      SEQ.noteWidth,\n      estimateTextWidth(note.text, FONT_SIZES.edgeLabel, FONT_WEIGHTS.edgeLabel) + SEQ.notePadding * 2\n    )\n    const noteH = FONT_SIZES.edgeLabel + SEQ.notePadding * 2\n\n    // Position based on the message after which it appears\n    const refMsg = messages[note.afterIndex]\n    const noteY = (refMsg?.y ?? actorY + SEQ.actorHeight) + 4\n\n    // X based on actor position and note type\n    const firstActorIdx = actorIndex.get(note.actorIds[0] ?? '') ?? 0\n    let noteX: number\n    if (note.position === 'left') {\n      noteX = actorCenterX[firstActorIdx]! - actorWidths[firstActorIdx]! / 2 - noteW - SEQ.noteGap\n    } else if (note.position === 'right') {\n      noteX = actorCenterX[firstActorIdx]! + actorWidths[firstActorIdx]! / 2 + SEQ.noteGap\n    } else {\n      // over  center between first and last actor\n      if (note.actorIds.length > 1) {\n        const lastActorIdx = actorIndex.get(note.actorIds[note.actorIds.length - 1] ?? '') ?? firstActorIdx\n        noteX = (actorCenterX[firstActorIdx]! + actorCenterX[lastActorIdx]!) / 2 - noteW / 2\n      } else {\n        noteX = actorCenterX[firstActorIdx]! - noteW / 2\n      }\n    }\n\n    return { text: note.text, x: noteX, y: noteY, width: noteW, height: noteH }\n  })\n\n  // 6. Bounding-box post-processing\n  //\n  // Notes positioned \"left of\" the first actor or \"right of\" the last actor\n  // can extend beyond the actor-based viewport. Compute the true bounding box\n  // across all positioned elements, then shift everything right if anything\n  // extends left of the desired padding margin and expand the width to fit.\n  const diagramBottom = messageY + SEQ.padding\n\n  // Find global X extents across actors, blocks, and notes\n  let globalMinX = SEQ.padding // actors already start at SEQ.padding\n  let globalMaxX = 0\n  for (const a of actors) {\n    globalMinX = Math.min(globalMinX, a.x - a.width / 2)\n    globalMaxX = Math.max(globalMaxX, a.x + a.width / 2)\n  }\n  for (const b of blocks) {\n    globalMinX = Math.min(globalMinX, b.x)\n    globalMaxX = Math.max(globalMaxX, b.x + b.width)\n  }\n  for (const n of notes) {\n    globalMinX = Math.min(globalMinX, n.x)\n    globalMaxX = Math.max(globalMaxX, n.x + n.width)\n  }\n\n  // If elements extend left of the desired padding, shift everything right\n  const shiftX = globalMinX < SEQ.padding ? SEQ.padding - globalMinX : 0\n  if (shiftX > 0) {\n    for (const a of actors) a.x += shiftX\n    for (const m of messages) { m.x1 += shiftX; m.x2 += shiftX }\n    for (const act of activations) act.x += shiftX\n    for (const b of blocks) { b.x += shiftX; }\n    for (const n of notes) n.x += shiftX\n    // Also shift actor center X array (used for lifelines below)\n    for (let i = 0; i < actorCenterX.length; i++) actorCenterX[i]! += shiftX\n  }\n\n  // 7. Calculate final lifelines (after shift so X positions are correct)\n  const lifelines: Lifeline[] = diagram.actors.map((a, i) => ({\n    actorId: a.id,\n    x: actorCenterX[i]!,\n    topY: actorY + SEQ.actorHeight,\n    bottomY: diagramBottom - SEQ.padding,\n  }))\n\n  // 8. Calculate diagram dimensions from the bounding box\n  const diagramWidth = globalMaxX + shiftX + SEQ.padding\n  const diagramHeight = diagramBottom\n\n  return {\n    width: Math.max(diagramWidth, 200),\n    height: Math.max(diagramHeight, 100),\n    actors,\n    lifelines,\n    messages,\n    activations,\n    blocks,\n    notes,\n  }\n}\n","import type { PositionedSequenceDiagram, PositionedActor, Lifeline, PositionedMessage, Activation, PositionedBlock, PositionedNote } from './types.ts'\nimport type { DiagramColors } from '../theme.ts'\nimport { svgOpenTag, buildStyleBlock } from '../theme.ts'\nimport { FONT_SIZES, FONT_WEIGHTS, STROKE_WIDTHS, ARROW_HEAD, estimateTextWidth, TEXT_BASELINE_SHIFT } from '../styles.ts'\n\n// ============================================================================\n// Sequence diagram SVG renderer\n//\n// Renders a positioned sequence diagram to SVG string.\n// All colors use CSS custom properties (var(--_xxx)) from the theme system.\n//\n// Render order (back to front):\n//   1. Block backgrounds (loop/alt/opt)\n//   2. Lifelines (dashed vertical lines)\n//   3. Activation boxes\n//   4. Messages (arrows with labels)\n//   5. Notes\n//   6. Actor boxes (at top)\n// ============================================================================\n\n/**\n * Render a positioned sequence diagram as an SVG string.\n *\n * @param colors - DiagramColors with bg/fg and optional enrichment variables.\n * @param transparent - If true, renders with transparent background.\n */\nexport function renderSequenceSvg(\n  diagram: PositionedSequenceDiagram,\n  colors: DiagramColors,\n  font: string = 'Inter',\n  transparent: boolean = false\n): string {\n  const parts: string[] = []\n\n  // SVG root with CSS variables + style block + defs\n  parts.push(svgOpenTag(diagram.width, diagram.height, colors, transparent))\n  parts.push(buildStyleBlock(font, false))\n  parts.push('<defs>')\n\n  // Arrow marker definitions\n  parts.push(arrowMarkerDefs())\n  parts.push('</defs>')\n\n  // 1. Block backgrounds (loop/alt/opt rectangles)\n  for (const block of diagram.blocks) {\n    parts.push(renderBlock(block))\n  }\n\n  // 2. Lifelines (dashed vertical lines from actor to bottom)\n  for (const lifeline of diagram.lifelines) {\n    parts.push(renderLifeline(lifeline))\n  }\n\n  // 3. Activation boxes\n  for (const activation of diagram.activations) {\n    parts.push(renderActivation(activation))\n  }\n\n  // 4. Messages (horizontal arrows with labels)\n  for (const message of diagram.messages) {\n    parts.push(renderMessage(message))\n  }\n\n  // 5. Notes\n  for (const note of diagram.notes) {\n    parts.push(renderNote(note))\n  }\n\n  // 6. Actor boxes at top (rendered last so they're on top)\n  for (const actor of diagram.actors) {\n    parts.push(renderActor(actor))\n  }\n\n  parts.push('</svg>')\n  return parts.join('\\n')\n}\n\n// ============================================================================\n// Arrow marker definitions\n// ============================================================================\n\nfunction arrowMarkerDefs(): string {\n  const w = ARROW_HEAD.width\n  const h = ARROW_HEAD.height\n  return (\n    `  <marker id=\"seq-arrow\" markerWidth=\"${w}\" markerHeight=\"${h}\" refX=\"${w}\" refY=\"${h / 2}\" orient=\"auto-start-reverse\">` +\n    `\\n    <polygon points=\"0 0, ${w} ${h / 2}, 0 ${h}\" fill=\"var(--_arrow)\" />` +\n    `\\n  </marker>` +\n    // Open arrow head (just lines, no fill)\n    `\\n  <marker id=\"seq-arrow-open\" markerWidth=\"${w}\" markerHeight=\"${h}\" refX=\"${w}\" refY=\"${h / 2}\" orient=\"auto-start-reverse\">` +\n    `\\n    <polyline points=\"0 0, ${w} ${h / 2}, 0 ${h}\" fill=\"none\" stroke=\"var(--_arrow)\" stroke-width=\"1\" />` +\n    `\\n  </marker>`\n  )\n}\n\n// ============================================================================\n// Component renderers\n// ============================================================================\n\n/** Render an actor box (participant = rectangle, actor = stick figure) */\nfunction renderActor(actor: PositionedActor): string {\n  const { x, y, width, height, label, type } = actor\n\n  if (type === 'actor') {\n    // Circle-person icon: outer circle + head circle + shoulders arc.\n    // Defined in a 2424 coordinate space, scaled to 90% of the actor box height\n    // and centered both horizontally and vertically within the box.\n    // Stroke width is inverse-scaled so the visual thickness matches STROKE_WIDTHS.outerBox.\n    const s = (height / 24) * 0.9\n    const tx = x - 12 * s            // center icon horizontally on actor.x\n    const ty = y + (height - 24 * s) / 2  // center icon vertically in actor box\n    const sw = STROKE_WIDTHS.outerBox / s  // compensate for scale transform\n    const iconStroke = 'var(--_line)'      // use line color for actor icon strokes\n\n    return (\n      `<g transform=\"translate(${tx},${ty}) scale(${s})\">` +\n      // Outer circle\n      `\\n  <path d=\"M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z\" fill=\"none\" stroke=\"${iconStroke}\" stroke-width=\"${sw}\" />` +\n      // Head\n      `\\n  <path d=\"M15 10C15 11.6569 13.6569 13 12 13C10.3431 13 9 11.6569 9 10C9 8.34315 10.3431 7 12 7C13.6569 7 15 8.34315 15 10Z\" fill=\"none\" stroke=\"${iconStroke}\" stroke-width=\"${sw}\" />` +\n      // Shoulders\n      `\\n  <path d=\"M5.62842 18.3563C7.08963 17.0398 9.39997 16 12 16C14.6 16 16.9104 17.0398 18.3716 18.3563\" fill=\"none\" stroke=\"${iconStroke}\" stroke-width=\"${sw}\" />` +\n      `\\n</g>` +\n      // Label below the icon\n      `\\n<text x=\"${x}\" y=\"${y + height + 14}\" text-anchor=\"middle\" font-size=\"${FONT_SIZES.nodeLabel}\" font-weight=\"${FONT_WEIGHTS.nodeLabel}\" fill=\"var(--_text)\">${escapeXml(label)}</text>`\n    )\n  }\n\n  // Participant: rectangle box with label\n  const boxX = x - width / 2\n  return (\n    `<rect x=\"${boxX}\" y=\"${y}\" width=\"${width}\" height=\"${height}\" rx=\"4\" ry=\"4\" ` +\n    `fill=\"var(--_node-fill)\" stroke=\"var(--_node-stroke)\" stroke-width=\"${STROKE_WIDTHS.outerBox}\" />` +\n    `\\n<text x=\"${x}\" y=\"${y + height / 2}\" text-anchor=\"middle\" dy=\"${TEXT_BASELINE_SHIFT}\" ` +\n    `font-size=\"${FONT_SIZES.nodeLabel}\" font-weight=\"${FONT_WEIGHTS.nodeLabel}\" fill=\"var(--_text)\">${escapeXml(label)}</text>`\n  )\n}\n\n/** Render a lifeline (dashed vertical line from actor to bottom) */\nfunction renderLifeline(lifeline: Lifeline): string {\n  return (\n    `<line x1=\"${lifeline.x}\" y1=\"${lifeline.topY}\" x2=\"${lifeline.x}\" y2=\"${lifeline.bottomY}\" ` +\n    `stroke=\"var(--_line)\" stroke-width=\"0.75\" stroke-dasharray=\"6 4\" />`\n  )\n}\n\n/** Render an activation box (narrow filled rectangle on lifeline) */\nfunction renderActivation(activation: Activation): string {\n  return (\n    `<rect x=\"${activation.x}\" y=\"${activation.topY}\" width=\"${activation.width}\" height=\"${activation.bottomY - activation.topY}\" ` +\n    `fill=\"var(--_node-fill)\" stroke=\"var(--_node-stroke)\" stroke-width=\"${STROKE_WIDTHS.innerBox}\" />`\n  )\n}\n\n/** Render a message arrow with label */\nfunction renderMessage(msg: PositionedMessage): string {\n  const parts: string[] = []\n  const dashArray = msg.lineStyle === 'dashed' ? ' stroke-dasharray=\"6 4\"' : ''\n  const markerId = msg.arrowHead === 'filled' ? 'seq-arrow' : 'seq-arrow-open'\n\n  if (msg.isSelf) {\n    // Self-message: curved loop going right and back\n    const loopW = 30\n    const loopH = 20\n    parts.push(\n      `<polyline points=\"${msg.x1},${msg.y} ${msg.x1 + loopW},${msg.y} ${msg.x1 + loopW},${msg.y + loopH} ${msg.x2},${msg.y + loopH}\" ` +\n      `fill=\"none\" stroke=\"var(--_line)\" stroke-width=\"${STROKE_WIDTHS.connector}\"${dashArray} marker-end=\"url(#${markerId})\" />`\n    )\n    // Label to the right of the loop\n    parts.push(\n      `<text x=\"${msg.x1 + loopW + 6}\" y=\"${msg.y + loopH / 2}\" dy=\"${TEXT_BASELINE_SHIFT}\" ` +\n      `font-size=\"${FONT_SIZES.edgeLabel}\" font-weight=\"${FONT_WEIGHTS.edgeLabel}\" fill=\"var(--_text-muted)\">${escapeXml(msg.label)}</text>`\n    )\n  } else {\n    // Normal message: horizontal arrow\n    parts.push(\n      `<line x1=\"${msg.x1}\" y1=\"${msg.y}\" x2=\"${msg.x2}\" y2=\"${msg.y}\" ` +\n      `stroke=\"var(--_line)\" stroke-width=\"${STROKE_WIDTHS.connector}\"${dashArray} marker-end=\"url(#${markerId})\" />`\n    )\n    // Label above the arrow, centered\n    const midX = (msg.x1 + msg.x2) / 2\n    parts.push(\n      `<text x=\"${midX}\" y=\"${msg.y - 6}\" text-anchor=\"middle\" ` +\n      `font-size=\"${FONT_SIZES.edgeLabel}\" font-weight=\"${FONT_WEIGHTS.edgeLabel}\" fill=\"var(--_text-muted)\">${escapeXml(msg.label)}</text>`\n    )\n  }\n\n  return parts.join('\\n')\n}\n\n/** Render a block background (loop/alt/opt) */\nfunction renderBlock(block: PositionedBlock): string {\n  const parts: string[] = []\n\n  // Outer rectangle\n  parts.push(\n    `<rect x=\"${block.x}\" y=\"${block.y}\" width=\"${block.width}\" height=\"${block.height}\" ` +\n    `rx=\"0\" ry=\"0\" fill=\"none\" stroke=\"var(--_node-stroke)\" stroke-width=\"${STROKE_WIDTHS.outerBox}\" />`\n  )\n\n  // Type label tab (top-left corner)\n  const labelText = `${block.type}${block.label ? ` [${block.label}]` : ''}`\n  const tabWidth = estimateTextWidth(labelText, FONT_SIZES.edgeLabel, FONT_WEIGHTS.groupHeader) + 16\n  const tabHeight = 18\n\n  parts.push(\n    `<rect x=\"${block.x}\" y=\"${block.y}\" width=\"${tabWidth}\" height=\"${tabHeight}\" ` +\n    `fill=\"var(--_group-hdr)\" stroke=\"var(--_node-stroke)\" stroke-width=\"${STROKE_WIDTHS.outerBox}\" />`\n  )\n  parts.push(\n    `<text x=\"${block.x + 6}\" y=\"${block.y + tabHeight / 2}\" dy=\"${TEXT_BASELINE_SHIFT}\" ` +\n    `font-size=\"${FONT_SIZES.edgeLabel}\" font-weight=\"${FONT_WEIGHTS.groupHeader}\" fill=\"var(--_text-sec)\">${escapeXml(labelText)}</text>`\n  )\n\n  // Divider lines (for alt/else, par/and)\n  for (const divider of block.dividers) {\n    parts.push(\n      `<line x1=\"${block.x}\" y1=\"${divider.y}\" x2=\"${block.x + block.width}\" y2=\"${divider.y}\" ` +\n      `stroke=\"var(--_line)\" stroke-width=\"0.75\" stroke-dasharray=\"6 4\" />`\n    )\n    if (divider.label) {\n      parts.push(\n        `<text x=\"${block.x + 8}\" y=\"${divider.y + 14}\" font-size=\"${FONT_SIZES.edgeLabel}\" ` +\n        `font-weight=\"${FONT_WEIGHTS.edgeLabel}\" fill=\"var(--_text-muted)\">[${escapeXml(divider.label)}]</text>`\n      )\n    }\n  }\n\n  return parts.join('\\n')\n}\n\n/** Render a note box */\nfunction renderNote(note: PositionedNote): string {\n  // Folded corner effect: note rectangle + small triangle in top-right\n  const foldSize = 6\n  return (\n    `<rect x=\"${note.x}\" y=\"${note.y}\" width=\"${note.width}\" height=\"${note.height}\" ` +\n    `fill=\"var(--_group-hdr)\" stroke=\"var(--_node-stroke)\" stroke-width=\"${STROKE_WIDTHS.innerBox}\" />` +\n    // Fold triangle\n    `\\n<polygon points=\"${note.x + note.width - foldSize},${note.y} ${note.x + note.width},${note.y + foldSize} ${note.x + note.width - foldSize},${note.y + foldSize}\" ` +\n    `fill=\"var(--_inner-stroke)\" />` +\n    // Note text\n    `\\n<text x=\"${note.x + note.width / 2}\" y=\"${note.y + note.height / 2}\" text-anchor=\"middle\" dy=\"${TEXT_BASELINE_SHIFT}\" ` +\n    `font-size=\"${FONT_SIZES.edgeLabel}\" font-weight=\"${FONT_WEIGHTS.edgeLabel}\" fill=\"var(--_text-muted)\">${escapeXml(note.text)}</text>`\n  )\n}\n\n// ============================================================================\n// Utilities\n// ============================================================================\n\nfunction escapeXml(text: string): string {\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;')\n}\n","// @ts-expect-error  dagre types are declared for the package root, not the dist path;\n// importing the pre-built browser bundle avoids Bun.build hanging on 30+ CJS file resolution\nimport dagre from '@dagrejs/dagre/dist/dagre.js'\nimport type { ClassDiagram, ClassNode, ClassMember, PositionedClassDiagram, PositionedClassNode, PositionedClassRelationship } from './types.ts'\nimport type { RenderOptions } from '../types.ts'\nimport { estimateTextWidth, estimateMonoTextWidth, FONT_SIZES, FONT_WEIGHTS } from '../styles.ts'\nimport { centerToTopLeft, snapToOrthogonal, clipEndpointsToNodes } from '../dagre-adapter.ts'\n\n// ============================================================================\n// Class diagram layout engine\n//\n// Uses dagre for positioning class boxes, then sizes each box based on\n// the number of attributes and methods it contains.\n//\n// Each class box has 3 compartments:\n//   1. Header (class name + optional annotation)\n//   2. Attributes section\n//   3. Methods section\n// ============================================================================\n\n/** Layout constants for class diagrams */\nexport const CLS = {\n  /** Padding around the diagram */\n  padding: 40,\n  /** Horizontal padding inside class boxes  used by both layout and renderer */\n  boxPadX: 8,\n  /** Header height (class name + annotation) */\n  headerBaseHeight: 32,\n  /** Extra height when annotation is present */\n  annotationHeight: 16,\n  /** Height per member row (attribute or method) */\n  memberRowHeight: 20,\n  /** Vertical padding around member sections (4px top + 4px bottom) */\n  sectionPadY: 8,\n  /** Minimum empty section height (when no attrs or no methods) */\n  emptySectionHeight: 8,\n  /** Minimum box width */\n  minWidth: 120,\n  /** Font size for member text */\n  memberFontSize: 11,\n  /** Font weight for member text */\n  memberFontWeight: 400,\n  /** Spacing between class nodes */\n  nodeSpacing: 40,\n  /** Spacing between layers */\n  layerSpacing: 60,\n} as const\n\n/**\n * Lay out a parsed class diagram using dagre.\n * Returns positioned class nodes and relationship paths.\n *\n * Kept async for API compatibility  dagre itself is synchronous.\n */\nexport async function layoutClassDiagram(\n  diagram: ClassDiagram,\n  _options: RenderOptions = {}\n): Promise<PositionedClassDiagram> {\n  if (diagram.classes.length === 0) {\n    return { width: 0, height: 0, classes: [], relationships: [] }\n  }\n\n  // 1. Calculate box dimensions for each class\n  const classSizes = new Map<string, { width: number; height: number; headerHeight: number; attrHeight: number; methodHeight: number }>()\n\n  for (const cls of diagram.classes) {\n    const headerHeight = cls.annotation\n      ? CLS.headerBaseHeight + CLS.annotationHeight\n      : CLS.headerBaseHeight\n\n    const attrHeight = cls.attributes.length > 0\n      ? cls.attributes.length * CLS.memberRowHeight + CLS.sectionPadY\n      : CLS.emptySectionHeight\n\n    const methodHeight = cls.methods.length > 0\n      ? cls.methods.length * CLS.memberRowHeight + CLS.sectionPadY\n      : CLS.emptySectionHeight\n\n    // Width: max of header text, widest attribute, widest method\n    const headerTextW = estimateTextWidth(cls.label, FONT_SIZES.nodeLabel, FONT_WEIGHTS.nodeLabel)\n    const maxAttrW = maxMemberWidth(cls.attributes)\n    const maxMethodW = maxMemberWidth(cls.methods)\n    const width = Math.max(CLS.minWidth, headerTextW + CLS.boxPadX * 2, maxAttrW + CLS.boxPadX * 2, maxMethodW + CLS.boxPadX * 2)\n\n    const height = headerHeight + attrHeight + methodHeight\n\n    classSizes.set(cls.id, { width, height, headerHeight, attrHeight, methodHeight })\n  }\n\n  // 2. Build dagre graph\n  const g = new dagre.graphlib.Graph({ directed: true })\n  g.setGraph({\n    rankdir: 'TB',\n    acyclicer: 'greedy', // break cycles before ranking to prevent infinite loop on bidirectional edges\n    nodesep: CLS.nodeSpacing,\n    ranksep: CLS.layerSpacing,\n    marginx: CLS.padding,\n    marginy: CLS.padding,\n  })\n  g.setDefaultEdgeLabel(() => ({}))\n\n  for (const cls of diagram.classes) {\n    const size = classSizes.get(cls.id)!\n    g.setNode(cls.id, { width: size.width, height: size.height })\n  }\n\n  // Add edges with label dimensions for collision-free label placement\n  for (let i = 0; i < diagram.relationships.length; i++) {\n    const rel = diagram.relationships[i]!\n    const edgeLabel: Record<string, unknown> = { _index: i }\n    if (rel.label) {\n      edgeLabel.label = rel.label\n      edgeLabel.width = estimateTextWidth(rel.label, FONT_SIZES.edgeLabel, FONT_WEIGHTS.edgeLabel) + 8\n      edgeLabel.height = FONT_SIZES.edgeLabel + 6\n      edgeLabel.labelpos = 'c'\n    }\n    g.setEdge(rel.from, rel.to, edgeLabel)\n  }\n\n  // 3. Run dagre layout (synchronous).\n  // Wrapped in try-catch to surface clear errors on malformed class diagrams.\n  try {\n    dagre.layout(g)\n  } catch (err) {\n    const message = err instanceof Error ? err.message : String(err)\n    throw new Error(`Dagre layout failed (class diagram): ${message}`)\n  }\n\n  // 4. Extract positioned classes\n  const classLookup = new Map<string, ClassNode>()\n  for (const cls of diagram.classes) classLookup.set(cls.id, cls)\n\n  const positionedClasses: PositionedClassNode[] = diagram.classes.map(cls => {\n    const dagreNode = g.node(cls.id)\n    const size = classSizes.get(cls.id)!\n    const topLeft = centerToTopLeft(dagreNode.x, dagreNode.y, dagreNode.width, dagreNode.height)\n    return {\n      id: cls.id,\n      label: cls.label,\n      annotation: cls.annotation,\n      attributes: cls.attributes,\n      methods: cls.methods,\n      x: topLeft.x,\n      y: topLeft.y,\n      width: dagreNode.width ?? size.width,\n      height: dagreNode.height ?? size.height,\n      headerHeight: size.headerHeight,\n      attrHeight: size.attrHeight,\n      methodHeight: size.methodHeight,\n    }\n  })\n\n  // 5. Extract relationship paths and label positions\n  const relationships: PositionedClassRelationship[] = g.edges().map(edgeObj => {\n    const dagreEdge = g.edge(edgeObj)\n    const rel = diagram.relationships[dagreEdge._index as number]!\n    const rawPoints = dagreEdge.points ?? []\n    // TB layout  vertical-first bends\n    const orthoPoints = snapToOrthogonal(rawPoints, true)\n\n    // Clip endpoints to the correct side of source/target class boxes.\n    // After orthogonalization the approach direction may differ from dagre's\n    // original boundary intersection  e.g. a horizontal last segment should\n    // connect to the side of the target at its vertical center, not the top.\n    const srcNode = g.node(edgeObj.v)\n    const tgtNode = g.node(edgeObj.w)\n    const points = clipEndpointsToNodes(\n      orthoPoints,\n      srcNode ? { cx: srcNode.x, cy: srcNode.y, hw: srcNode.width / 2, hh: srcNode.height / 2 } : null,\n      tgtNode ? { cx: tgtNode.x, cy: tgtNode.y, hw: tgtNode.width / 2, hh: tgtNode.height / 2 } : null,\n    )\n\n    // Dagre returns edge label center position directly as edge.x, edge.y\n    let labelPosition: { x: number; y: number } | undefined\n    if (rel.label && dagreEdge.x != null && dagreEdge.y != null) {\n      labelPosition = { x: dagreEdge.x, y: dagreEdge.y }\n    }\n\n    return {\n      from: rel.from,\n      to: rel.to,\n      type: rel.type,\n      markerAt: rel.markerAt,\n      label: rel.label,\n      fromCardinality: rel.fromCardinality,\n      toCardinality: rel.toCardinality,\n      points,\n      labelPosition,\n    }\n  })\n\n  return {\n    width: g.graph().width ?? 600,\n    height: g.graph().height ?? 400,\n    classes: positionedClasses,\n    relationships,\n  }\n}\n\n/** Calculate the max width of a list of class members (uses mono metrics) */\nfunction maxMemberWidth(members: ClassMember[]): number {\n  if (members.length === 0) return 0\n  let maxW = 0\n  for (const m of members) {\n    const text = memberToString(m)\n    // Members render in monospace  use mono width estimation for accurate box sizing\n    const w = estimateMonoTextWidth(text, CLS.memberFontSize)\n    if (w > maxW) maxW = w\n  }\n  return maxW\n}\n\n/** Convert a class member to its display string */\nexport function memberToString(m: ClassMember): string {\n  const vis = m.visibility ? `${m.visibility} ` : ''\n  const type = m.type ? `: ${m.type}` : ''\n  return `${vis}${m.name}${type}`\n}\n","import type { PositionedClassDiagram, PositionedClassNode, PositionedClassRelationship, ClassMember, RelationshipType } from './types.ts'\nimport type { DiagramColors } from '../theme.ts'\nimport { svgOpenTag, buildStyleBlock } from '../theme.ts'\nimport { FONT_SIZES, FONT_WEIGHTS, STROKE_WIDTHS, estimateTextWidth, TEXT_BASELINE_SHIFT } from '../styles.ts'\nimport { CLS } from './layout.ts'\n\n// ============================================================================\n// Class diagram SVG renderer\n//\n// Renders positioned class diagrams to SVG.\n// All colors use CSS custom properties (var(--_xxx)) from the theme system.\n//\n// Render order:\n//   1. Relationship lines (behind boxes)\n//   2. Class boxes (header + attributes + methods compartments)\n//   3. Relationship endpoint markers (diamonds, triangles)\n//   4. Labels and cardinality\n// ============================================================================\n\n/** Font sizes specific to class diagrams */\nconst CLS_FONT = {\n  memberSize: 11,\n  memberWeight: 400,\n  annotationSize: 10,\n  annotationWeight: 500,\n} as const\n\n/**\n * Render a positioned class diagram as an SVG string.\n *\n * @param colors - DiagramColors with bg/fg and optional enrichment variables.\n * @param transparent - If true, renders with transparent background.\n */\nexport function renderClassSvg(\n  diagram: PositionedClassDiagram,\n  colors: DiagramColors,\n  font: string = 'Inter',\n  transparent: boolean = false\n): string {\n  const parts: string[] = []\n\n  // SVG root with CSS variables + style block (with mono font) + defs\n  parts.push(svgOpenTag(diagram.width, diagram.height, colors, transparent))\n  parts.push(buildStyleBlock(font, true))\n  parts.push('<defs>')\n  parts.push(relationshipMarkerDefs())\n  parts.push('</defs>')\n\n  // 1. Relationship lines (rendered behind boxes)\n  for (const rel of diagram.relationships) {\n    parts.push(renderRelationship(rel))\n  }\n\n  // 2. Class boxes\n  for (const cls of diagram.classes) {\n    parts.push(renderClassBox(cls))\n  }\n\n  // 3. Relationship labels and cardinality\n  for (const rel of diagram.relationships) {\n    parts.push(renderRelationshipLabels(rel))\n  }\n\n  parts.push('</svg>')\n  return parts.join('\\n')\n}\n\n// ============================================================================\n// Marker definitions\n// ============================================================================\n\n/**\n * Marker definitions for class relationship endpoints.\n * Each relationship type has a distinct marker:\n *   - inheritance: hollow triangle\n *   - composition: filled diamond\n *   - aggregation: hollow diamond\n *   - association: open arrow (simple >)\n *   - dependency: open arrow (simple >)\n *   - realization: hollow triangle (same as inheritance)\n *\n * Uses var(--_arrow) for fill/stroke and var(--bg) for hollow marker fills.\n */\nfunction relationshipMarkerDefs(): string {\n  return (\n    // Hollow triangle (inheritance, realization)  points at target\n    `  <marker id=\"cls-inherit\" markerWidth=\"12\" markerHeight=\"10\" refX=\"12\" refY=\"5\" orient=\"auto-start-reverse\">` +\n    `\\n    <polygon points=\"0 0, 12 5, 0 10\" fill=\"var(--bg)\" stroke=\"var(--_arrow)\" stroke-width=\"1.5\" />` +\n    `\\n  </marker>` +\n    // Filled diamond (composition)  points at source\n    `\\n  <marker id=\"cls-composition\" markerWidth=\"12\" markerHeight=\"10\" refX=\"0\" refY=\"5\" orient=\"auto-start-reverse\">` +\n    `\\n    <polygon points=\"6 0, 12 5, 6 10, 0 5\" fill=\"var(--_arrow)\" stroke=\"var(--_arrow)\" stroke-width=\"1\" />` +\n    `\\n  </marker>` +\n    // Hollow diamond (aggregation)  points at source\n    `\\n  <marker id=\"cls-aggregation\" markerWidth=\"12\" markerHeight=\"10\" refX=\"0\" refY=\"5\" orient=\"auto-start-reverse\">` +\n    `\\n    <polygon points=\"6 0, 12 5, 6 10, 0 5\" fill=\"var(--bg)\" stroke=\"var(--_arrow)\" stroke-width=\"1.5\" />` +\n    `\\n  </marker>` +\n    // Open arrow (association, dependency)\n    `\\n  <marker id=\"cls-arrow\" markerWidth=\"8\" markerHeight=\"6\" refX=\"8\" refY=\"3\" orient=\"auto-start-reverse\">` +\n    `\\n    <polyline points=\"0 0, 8 3, 0 6\" fill=\"none\" stroke=\"var(--_arrow)\" stroke-width=\"1.5\" />` +\n    `\\n  </marker>`\n  )\n}\n\n// ============================================================================\n// Class box rendering\n// ============================================================================\n\n/** Render a class box with 3 compartments: header, attributes, methods */\nfunction renderClassBox(cls: PositionedClassNode): string {\n  const { x, y, width, height, headerHeight, attrHeight, methodHeight } = cls\n  const parts: string[] = []\n\n  // Outer rectangle (full box)\n  parts.push(\n    `<rect x=\"${x}\" y=\"${y}\" width=\"${width}\" height=\"${height}\" ` +\n    `rx=\"0\" ry=\"0\" fill=\"var(--_node-fill)\" stroke=\"var(--_node-stroke)\" stroke-width=\"${STROKE_WIDTHS.outerBox}\" />`\n  )\n\n  // Header background\n  parts.push(\n    `<rect x=\"${x}\" y=\"${y}\" width=\"${width}\" height=\"${headerHeight}\" ` +\n    `rx=\"0\" ry=\"0\" fill=\"var(--_group-hdr)\" stroke=\"var(--_node-stroke)\" stroke-width=\"${STROKE_WIDTHS.outerBox}\" />`\n  )\n\n  // Annotation (<<interface>>, <<abstract>>, etc.)\n  let nameY = y + headerHeight / 2\n  if (cls.annotation) {\n    const annotY = y + 12\n    parts.push(\n      `<text x=\"${x + width / 2}\" y=\"${annotY}\" text-anchor=\"middle\" dy=\"${TEXT_BASELINE_SHIFT}\" ` +\n      `font-size=\"${CLS_FONT.annotationSize}\" font-weight=\"${CLS_FONT.annotationWeight}\" ` +\n      `font-style=\"italic\" fill=\"var(--_text-muted)\">&lt;&lt;${escapeXml(cls.annotation)}&gt;&gt;</text>`\n    )\n    nameY = y + headerHeight / 2 + 6\n  }\n\n  // Class name\n  parts.push(\n    `<text x=\"${x + width / 2}\" y=\"${nameY}\" text-anchor=\"middle\" dy=\"${TEXT_BASELINE_SHIFT}\" ` +\n    `font-size=\"${FONT_SIZES.nodeLabel}\" font-weight=\"700\" fill=\"var(--_text)\">${escapeXml(cls.label)}</text>`\n  )\n\n  // Divider line between header and attributes\n  const attrTop = y + headerHeight\n  parts.push(\n    `<line x1=\"${x}\" y1=\"${attrTop}\" x2=\"${x + width}\" y2=\"${attrTop}\" ` +\n    `stroke=\"var(--_node-stroke)\" stroke-width=\"${STROKE_WIDTHS.innerBox}\" />`\n  )\n\n  // Attributes\n  const memberRowH = 20\n  for (let i = 0; i < cls.attributes.length; i++) {\n    const member = cls.attributes[i]!\n    const memberY = attrTop + 4 + i * memberRowH + memberRowH / 2\n    parts.push(renderMember(member, x + CLS.boxPadX, memberY))\n  }\n\n  // Divider line between attributes and methods\n  const methodTop = attrTop + attrHeight\n  parts.push(\n    `<line x1=\"${x}\" y1=\"${methodTop}\" x2=\"${x + width}\" y2=\"${methodTop}\" ` +\n    `stroke=\"var(--_node-stroke)\" stroke-width=\"${STROKE_WIDTHS.innerBox}\" />`\n  )\n\n  // Methods\n  for (let i = 0; i < cls.methods.length; i++) {\n    const member = cls.methods[i]!\n    const memberY = methodTop + 4 + i * memberRowH + memberRowH / 2\n    parts.push(renderMember(member, x + CLS.boxPadX, memberY))\n  }\n\n  return parts.join('\\n')\n}\n\n/**\n * Render a single class member with syntax highlighting.\n * Uses <tspan> elements to color each part of the member differently:\n *   - visibility symbol (+/-/#/~)  textFaint\n *   - member name (incl. parens for methods)  textSecondary\n *   - colon separator  textFaint\n *   - type annotation  textMuted\n */\nfunction renderMember(member: ClassMember, x: number, y: number): string {\n  const fontStyle = member.isAbstract ? ' font-style=\"italic\"' : ''\n  const decoration = member.isStatic ? ' text-decoration=\"underline\"' : ''\n\n  // Build tspan parts for syntax-highlighted member text\n  const spans: string[] = []\n\n  if (member.visibility) {\n    spans.push(`<tspan fill=\"var(--_text-faint)\">${escapeXml(member.visibility)} </tspan>`)\n  }\n\n  spans.push(`<tspan fill=\"var(--_text-sec)\">${escapeXml(member.name)}</tspan>`)\n\n  if (member.type) {\n    spans.push(`<tspan fill=\"var(--_text-faint)\">: </tspan>`)\n    spans.push(`<tspan fill=\"var(--_text-muted)\">${escapeXml(member.type)}</tspan>`)\n  }\n\n  return (\n    `<text x=\"${x}\" y=\"${y}\" class=\"mono\" dy=\"${TEXT_BASELINE_SHIFT}\" ` +\n    `font-size=\"${CLS_FONT.memberSize}\" font-weight=\"${CLS_FONT.memberWeight}\"${fontStyle}${decoration}>` +\n    `${spans.join('')}</text>`\n  )\n}\n\n// ============================================================================\n// Relationship rendering\n// ============================================================================\n\n/** Render a relationship line with appropriate markers */\nfunction renderRelationship(rel: PositionedClassRelationship): string {\n  if (rel.points.length < 2) return ''\n\n  const pathData = rel.points.map(p => `${p.x},${p.y}`).join(' ')\n  const isDashed = rel.type === 'dependency' || rel.type === 'realization'\n  const dashArray = isDashed ? ' stroke-dasharray=\"6 4\"' : ''\n\n  // Determine markers based on relationship type and which end has the marker\n  const markers = getRelationshipMarkers(rel.type, rel.markerAt)\n\n  return (\n    `<polyline points=\"${pathData}\" fill=\"none\" stroke=\"var(--_line)\" ` +\n    `stroke-width=\"${STROKE_WIDTHS.connector}\"${dashArray}${markers} />`\n  )\n}\n\n/**\n * Get marker-start/marker-end attributes for a relationship type.\n * Uses `markerAt` from the parser to place the marker on the correct end:\n *   - 'from'  marker-start (prefix arrows like `<|--`, `*--`, `o--`)\n *   - 'to'    marker-end   (suffix arrows like `..|>`, `-->`, `--*`)\n */\nfunction getRelationshipMarkers(type: RelationshipType, markerAt: 'from' | 'to'): string {\n  const markerId = getMarkerDefId(type)\n  if (!markerId) return ''\n\n  if (markerAt === 'from') {\n    return ` marker-start=\"url(#${markerId})\"`\n  } else {\n    return ` marker-end=\"url(#${markerId})\"`\n  }\n}\n\n/** Map relationship type to its SVG marker definition ID */\nfunction getMarkerDefId(type: RelationshipType): string | null {\n  switch (type) {\n    case 'inheritance':\n    case 'realization':\n      return 'cls-inherit'\n    case 'composition':\n      return 'cls-composition'\n    case 'aggregation':\n      return 'cls-aggregation'\n    case 'association':\n    case 'dependency':\n      return 'cls-arrow'\n    default:\n      return null\n  }\n}\n\n/** Render relationship labels and cardinality text */\nfunction renderRelationshipLabels(rel: PositionedClassRelationship): string {\n  if (!rel.label && !rel.fromCardinality && !rel.toCardinality) return ''\n  if (rel.points.length < 2) return ''\n\n  const parts: string[] = []\n\n  // Label  prefer dagre-computed position (collision-aware), fall back to midpoint\n  if (rel.label) {\n    const pos = rel.labelPosition ?? midpoint(rel.points)\n    parts.push(\n      `<text x=\"${pos.x}\" y=\"${pos.y - 8}\" text-anchor=\"middle\" ` +\n      `font-size=\"${FONT_SIZES.edgeLabel}\" font-weight=\"${FONT_WEIGHTS.edgeLabel}\" ` +\n      `fill=\"var(--_text-muted)\">${escapeXml(rel.label)}</text>`\n    )\n  }\n\n  // From cardinality (near start)\n  if (rel.fromCardinality) {\n    const p = rel.points[0]!\n    const next = rel.points[1]!\n    const offset = cardinalityOffset(p, next)\n    parts.push(\n      `<text x=\"${p.x + offset.x}\" y=\"${p.y + offset.y}\" text-anchor=\"middle\" ` +\n      `font-size=\"${FONT_SIZES.edgeLabel}\" font-weight=\"${FONT_WEIGHTS.edgeLabel}\" ` +\n      `fill=\"var(--_text-muted)\">${escapeXml(rel.fromCardinality)}</text>`\n    )\n  }\n\n  // To cardinality (near end)\n  if (rel.toCardinality) {\n    const p = rel.points[rel.points.length - 1]!\n    const prev = rel.points[rel.points.length - 2]!\n    const offset = cardinalityOffset(p, prev)\n    parts.push(\n      `<text x=\"${p.x + offset.x}\" y=\"${p.y + offset.y}\" text-anchor=\"middle\" ` +\n      `font-size=\"${FONT_SIZES.edgeLabel}\" font-weight=\"${FONT_WEIGHTS.edgeLabel}\" ` +\n      `fill=\"var(--_text-muted)\">${escapeXml(rel.toCardinality)}</text>`\n    )\n  }\n\n  return parts.join('\\n')\n}\n\n/** Get the midpoint of a point array */\nfunction midpoint(points: Array<{ x: number; y: number }>): { x: number; y: number } {\n  if (points.length === 0) return { x: 0, y: 0 }\n  const mid = Math.floor(points.length / 2)\n  return points[mid]!\n}\n\n/** Calculate offset for cardinality label perpendicular to edge direction */\nfunction cardinalityOffset(\n  from: { x: number; y: number },\n  to: { x: number; y: number }\n): { x: number; y: number } {\n  const dx = to.x - from.x\n  const dy = to.y - from.y\n  // Place label perpendicular to the edge, 14px away\n  if (Math.abs(dx) > Math.abs(dy)) {\n    // Mostly horizontal  offset vertically\n    return { x: dx > 0 ? 14 : -14, y: -10 }\n  }\n  // Mostly vertical  offset horizontally\n  return { x: -14, y: dy > 0 ? 14 : -14 }\n}\n\n// ============================================================================\n// Utilities\n// ============================================================================\n\nfunction escapeXml(text: string): string {\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;')\n}\n","// @ts-expect-error  dagre types are declared for the package root, not the dist path;\n// importing the pre-built browser bundle avoids Bun.build hanging on 30+ CJS file resolution\nimport dagre from '@dagrejs/dagre/dist/dagre.js'\nimport type { ErDiagram, ErEntity, PositionedErDiagram, PositionedErEntity, PositionedErRelationship } from './types.ts'\nimport type { RenderOptions } from '../types.ts'\nimport { estimateTextWidth, estimateMonoTextWidth, FONT_SIZES, FONT_WEIGHTS } from '../styles.ts'\nimport { centerToTopLeft, snapToOrthogonal, clipEndpointsToNodes } from '../dagre-adapter.ts'\n\n// ============================================================================\n// ER diagram layout engine\n//\n// Uses dagre for positioning entity boxes, then sizes each box based on\n// the entity name and number of attributes.\n//\n// Each entity box has:\n//   1. Header (entity name)\n//   2. Attribute rows (type, name, keys)\n// ============================================================================\n\n/** Layout constants for ER diagrams */\nconst ER = {\n  padding: 40,\n  boxPadX: 12,\n  headerHeight: 32,\n  rowHeight: 22,\n  minWidth: 140,\n  attrFontSize: 11,\n  attrFontWeight: 400,\n  nodeSpacing: 50,\n  layerSpacing: 70,\n} as const\n\n/**\n * Lay out a parsed ER diagram using dagre.\n * Returns positioned entity boxes and relationship paths.\n *\n * Kept async for API compatibility  dagre itself is synchronous.\n */\nexport async function layoutErDiagram(\n  diagram: ErDiagram,\n  _options: RenderOptions = {}\n): Promise<PositionedErDiagram> {\n  if (diagram.entities.length === 0) {\n    return { width: 0, height: 0, entities: [], relationships: [] }\n  }\n\n  // 1. Calculate box dimensions for each entity\n  const entitySizes = new Map<string, { width: number; height: number }>()\n\n  for (const entity of diagram.entities) {\n    // Header width from entity label\n    const headerTextW = estimateTextWidth(entity.label, FONT_SIZES.nodeLabel, FONT_WEIGHTS.nodeLabel)\n\n    // Max attribute row width: \"type  name  PK FK\"\n    // Attribute text renders in monospace  use mono width estimation for accurate box sizing\n    let maxAttrW = 0\n    for (const attr of entity.attributes) {\n      const attrText = `${attr.type}  ${attr.name}${attr.keys.length > 0 ? '  ' + attr.keys.join(',') : ''}`\n      const w = estimateMonoTextWidth(attrText, ER.attrFontSize)\n      if (w > maxAttrW) maxAttrW = w\n    }\n\n    const width = Math.max(ER.minWidth, headerTextW + ER.boxPadX * 2, maxAttrW + ER.boxPadX * 2)\n    const height = ER.headerHeight + Math.max(entity.attributes.length, 1) * ER.rowHeight\n\n    entitySizes.set(entity.id, { width, height })\n  }\n\n  // 2. Build dagre graph\n  const g = new dagre.graphlib.Graph({ directed: true })\n  g.setGraph({\n    rankdir: 'LR',\n    acyclicer: 'greedy', // break cycles before ranking to prevent infinite loop on bidirectional edges\n    nodesep: ER.nodeSpacing,\n    ranksep: ER.layerSpacing,\n    marginx: ER.padding,\n    marginy: ER.padding,\n  })\n  g.setDefaultEdgeLabel(() => ({}))\n\n  for (const entity of diagram.entities) {\n    const size = entitySizes.get(entity.id)!\n    g.setNode(entity.id, { width: size.width, height: size.height })\n  }\n\n  for (let i = 0; i < diagram.relationships.length; i++) {\n    const rel = diagram.relationships[i]!\n    g.setEdge(rel.entity1, rel.entity2, {\n      _index: i,\n      label: rel.label,\n      width: estimateTextWidth(rel.label, FONT_SIZES.edgeLabel, FONT_WEIGHTS.edgeLabel) + 8,\n      height: FONT_SIZES.edgeLabel + 6,\n      labelpos: 'c',\n    })\n  }\n\n  // 3. Run dagre layout (synchronous).\n  // Wrapped in try-catch to surface clear errors on malformed ER diagrams.\n  try {\n    dagre.layout(g)\n  } catch (err) {\n    const message = err instanceof Error ? err.message : String(err)\n    throw new Error(`Dagre layout failed (ER diagram): ${message}`)\n  }\n\n  // 4. Extract positioned entities\n  const entityLookup = new Map<string, ErEntity>()\n  for (const entity of diagram.entities) entityLookup.set(entity.id, entity)\n\n  const positionedEntities: PositionedErEntity[] = diagram.entities.map(entity => {\n    const dagreNode = g.node(entity.id)\n    const topLeft = centerToTopLeft(dagreNode.x, dagreNode.y, dagreNode.width, dagreNode.height)\n    return {\n      id: entity.id,\n      label: entity.label,\n      attributes: entity.attributes,\n      x: topLeft.x,\n      y: topLeft.y,\n      width: dagreNode.width ?? entitySizes.get(entity.id)!.width,\n      height: dagreNode.height ?? entitySizes.get(entity.id)!.height,\n      headerHeight: ER.headerHeight,\n      rowHeight: ER.rowHeight,\n    }\n  })\n\n  // 5. Extract relationship paths\n  const relationships: PositionedErRelationship[] = g.edges().map(edgeObj => {\n    const dagreEdge = g.edge(edgeObj)\n    const rel = diagram.relationships[dagreEdge._index as number]!\n    const rawPoints = dagreEdge.points ?? []\n    // LR layout  horizontal-first bends\n    const orthoPoints = snapToOrthogonal(rawPoints, false)\n\n    // Clip endpoints to the correct side of source/target entity boxes.\n    // After orthogonalization the approach direction may differ from dagre's\n    // original boundary intersection  e.g. a vertical last segment should\n    // connect to the top/bottom of the target at its horizontal center.\n    const srcNode = g.node(edgeObj.v)\n    const tgtNode = g.node(edgeObj.w)\n    const points = clipEndpointsToNodes(\n      orthoPoints,\n      srcNode ? { cx: srcNode.x, cy: srcNode.y, hw: srcNode.width / 2, hh: srcNode.height / 2 } : null,\n      tgtNode ? { cx: tgtNode.x, cy: tgtNode.y, hw: tgtNode.width / 2, hh: tgtNode.height / 2 } : null,\n    )\n\n    return {\n      entity1: rel.entity1,\n      entity2: rel.entity2,\n      cardinality1: rel.cardinality1,\n      cardinality2: rel.cardinality2,\n      label: rel.label,\n      identifying: rel.identifying,\n      points,\n    }\n  })\n\n  return {\n    width: g.graph().width ?? 600,\n    height: g.graph().height ?? 400,\n    entities: positionedEntities,\n    relationships,\n  }\n}\n","import type { PositionedErDiagram, PositionedErEntity, PositionedErRelationship, ErAttribute, Cardinality } from './types.ts'\nimport type { DiagramColors } from '../theme.ts'\nimport { svgOpenTag, buildStyleBlock } from '../theme.ts'\nimport { FONT_SIZES, FONT_WEIGHTS, STROKE_WIDTHS, estimateTextWidth, TEXT_BASELINE_SHIFT } from '../styles.ts'\n\n// ============================================================================\n// ER diagram SVG renderer\n//\n// Renders positioned ER diagrams to SVG.\n// All colors use CSS custom properties (var(--_xxx)) from the theme system.\n//\n// Render order:\n//   1. Relationship lines (behind boxes)\n//   2. Entity boxes (header + attribute rows)\n//   3. Cardinality markers (crow's foot notation)\n//   4. Relationship labels\n// ============================================================================\n\n/** Font sizes specific to ER diagrams */\nconst ER_FONT = {\n  attrSize: 11,\n  attrWeight: 400,\n  keySize: 9,\n  keyWeight: 600,\n} as const\n\n/**\n * Render a positioned ER diagram as an SVG string.\n *\n * @param colors - DiagramColors with bg/fg and optional enrichment variables.\n * @param transparent - If true, renders with transparent background.\n */\nexport function renderErSvg(\n  diagram: PositionedErDiagram,\n  colors: DiagramColors,\n  font: string = 'Inter',\n  transparent: boolean = false\n): string {\n  const parts: string[] = []\n\n  // SVG root with CSS variables + style block (with mono font) + defs\n  parts.push(svgOpenTag(diagram.width, diagram.height, colors, transparent))\n  parts.push(buildStyleBlock(font, true))\n  parts.push('<defs>')\n  parts.push('</defs>') // No marker defs  we draw crow's foot inline\n\n  // 1. Relationship lines\n  for (const rel of diagram.relationships) {\n    parts.push(renderRelationshipLine(rel))\n  }\n\n  // 2. Entity boxes\n  for (const entity of diagram.entities) {\n    parts.push(renderEntityBox(entity))\n  }\n\n  // 3. Cardinality markers at relationship endpoints\n  for (const rel of diagram.relationships) {\n    parts.push(renderCardinality(rel))\n  }\n\n  // 4. Relationship labels\n  for (const rel of diagram.relationships) {\n    parts.push(renderRelationshipLabel(rel))\n  }\n\n  parts.push('</svg>')\n  return parts.join('\\n')\n}\n\n// ============================================================================\n// Entity box rendering\n// ============================================================================\n\n/** Render an entity box with header and attribute rows */\nfunction renderEntityBox(entity: PositionedErEntity): string {\n  const { x, y, width, height, headerHeight, rowHeight, label, attributes } = entity\n  const parts: string[] = []\n\n  // Outer rectangle\n  parts.push(\n    `<rect x=\"${x}\" y=\"${y}\" width=\"${width}\" height=\"${height}\" ` +\n    `rx=\"0\" ry=\"0\" fill=\"var(--_node-fill)\" stroke=\"var(--_node-stroke)\" stroke-width=\"${STROKE_WIDTHS.outerBox}\" />`\n  )\n\n  // Header background\n  parts.push(\n    `<rect x=\"${x}\" y=\"${y}\" width=\"${width}\" height=\"${headerHeight}\" ` +\n    `rx=\"0\" ry=\"0\" fill=\"var(--_group-hdr)\" stroke=\"var(--_node-stroke)\" stroke-width=\"${STROKE_WIDTHS.outerBox}\" />`\n  )\n\n  // Entity name\n  parts.push(\n    `<text x=\"${x + width / 2}\" y=\"${y + headerHeight / 2}\" text-anchor=\"middle\" dy=\"${TEXT_BASELINE_SHIFT}\" ` +\n    `font-size=\"${FONT_SIZES.nodeLabel}\" font-weight=\"700\" fill=\"var(--_text)\">${escapeXml(label)}</text>`\n  )\n\n  // Divider\n  const attrTop = y + headerHeight\n  parts.push(\n    `<line x1=\"${x}\" y1=\"${attrTop}\" x2=\"${x + width}\" y2=\"${attrTop}\" ` +\n    `stroke=\"var(--_node-stroke)\" stroke-width=\"${STROKE_WIDTHS.innerBox}\" />`\n  )\n\n  // Attribute rows\n  for (let i = 0; i < attributes.length; i++) {\n    const attr = attributes[i]!\n    const rowY = attrTop + i * rowHeight + rowHeight / 2\n    parts.push(renderAttribute(attr, x, rowY, width))\n  }\n\n  // Empty row placeholder when no attributes\n  if (attributes.length === 0) {\n    parts.push(\n      `<text x=\"${x + width / 2}\" y=\"${attrTop + rowHeight / 2}\" text-anchor=\"middle\" dy=\"${TEXT_BASELINE_SHIFT}\" ` +\n      `font-size=\"${ER_FONT.attrSize}\" fill=\"var(--_text-faint)\" font-style=\"italic\">(no attributes)</text>`\n    )\n  }\n\n  return parts.join('\\n')\n}\n\n/**\n * Render a single attribute row with monospace syntax highlighting.\n * Layout: [PK badge]  type  name  (left-aligned in mono, name right-aligned)\n * Uses <tspan> elements for per-part coloring, matching the class diagram style.\n *\n * Key badge uses var(--_key-badge) for background tint.\n */\nfunction renderAttribute(attr: ErAttribute, boxX: number, y: number, boxWidth: number): string {\n  const parts: string[] = []\n\n  // Key badges on the left (keep proportional font  they're visual tags, not code)\n  let keyWidth = 0\n  if (attr.keys.length > 0) {\n    const keyText = attr.keys.join(',')\n    keyWidth = estimateTextWidth(keyText, ER_FONT.keySize, ER_FONT.keyWeight) + 8\n    parts.push(\n      `<rect x=\"${boxX + 6}\" y=\"${y - 7}\" width=\"${keyWidth}\" height=\"14\" rx=\"2\" ry=\"2\" ` +\n      `fill=\"var(--_key-badge)\" />`\n    )\n    parts.push(\n      `<text x=\"${boxX + 6 + keyWidth / 2}\" y=\"${y}\" text-anchor=\"middle\" dy=\"${TEXT_BASELINE_SHIFT}\" ` +\n      `font-size=\"${ER_FONT.keySize}\" font-weight=\"${ER_FONT.keyWeight}\" fill=\"var(--_text-sec)\">${attr.keys.join(',')}</text>`\n    )\n  }\n\n  // Type (left-aligned after keys, monospace with syntax highlighting)\n  const typeX = boxX + 8 + (keyWidth > 0 ? keyWidth + 6 : 0)\n  parts.push(\n    `<text x=\"${typeX}\" y=\"${y}\" class=\"mono\" dy=\"${TEXT_BASELINE_SHIFT}\" ` +\n    `font-size=\"${ER_FONT.attrSize}\" font-weight=\"${ER_FONT.attrWeight}\">` +\n    `<tspan fill=\"var(--_text-muted)\">${escapeXml(attr.type)}</tspan></text>`\n  )\n\n  // Name (right-aligned, monospace with syntax highlighting)\n  const nameX = boxX + boxWidth - 8\n  parts.push(\n    `<text x=\"${nameX}\" y=\"${y}\" class=\"mono\" text-anchor=\"end\" dy=\"${TEXT_BASELINE_SHIFT}\" ` +\n    `font-size=\"${ER_FONT.attrSize}\" font-weight=\"${ER_FONT.attrWeight}\">` +\n    `<tspan fill=\"var(--_text-sec)\">${escapeXml(attr.name)}</tspan></text>`\n  )\n\n  return parts.join('\\n')\n}\n\n// ============================================================================\n// Relationship rendering\n// ============================================================================\n\n/** Render a relationship line */\nfunction renderRelationshipLine(rel: PositionedErRelationship): string {\n  if (rel.points.length < 2) return ''\n\n  const pathData = rel.points.map(p => `${p.x},${p.y}`).join(' ')\n  const dashArray = !rel.identifying ? ' stroke-dasharray=\"6 4\"' : ''\n\n  return (\n    `<polyline points=\"${pathData}\" fill=\"none\" stroke=\"var(--_line)\" ` +\n    `stroke-width=\"${STROKE_WIDTHS.connector}\"${dashArray} />`\n  )\n}\n\n/** Render a relationship label at the midpoint */\nfunction renderRelationshipLabel(rel: PositionedErRelationship): string {\n  if (!rel.label || rel.points.length < 2) return ''\n\n  const mid = midpoint(rel.points)\n  const textWidth = estimateTextWidth(rel.label, FONT_SIZES.edgeLabel, FONT_WEIGHTS.edgeLabel)\n\n  // Background pill for readability\n  const bgW = textWidth + 8\n  const bgH = FONT_SIZES.edgeLabel + 6\n\n  return (\n    `<rect x=\"${mid.x - bgW / 2}\" y=\"${mid.y - bgH / 2}\" width=\"${bgW}\" height=\"${bgH}\" rx=\"2\" ry=\"2\" ` +\n    `fill=\"var(--bg)\" stroke=\"var(--_inner-stroke)\" stroke-width=\"0.5\" />` +\n    `\\n<text x=\"${mid.x}\" y=\"${mid.y}\" text-anchor=\"middle\" dy=\"${TEXT_BASELINE_SHIFT}\" ` +\n    `font-size=\"${FONT_SIZES.edgeLabel}\" font-weight=\"${FONT_WEIGHTS.edgeLabel}\" fill=\"var(--_text-muted)\">${escapeXml(rel.label)}</text>`\n  )\n}\n\n/**\n * Render crow's foot cardinality markers at both endpoints of a relationship.\n *\n * Crow's foot notation:\n *   'one':          (single vertical line)\n *   'zero-one':  o  (circle + single line)\n *   'many':         (crow's foot + single line)\n *   'zero-many': o  (circle + crow's foot)\n */\nfunction renderCardinality(rel: PositionedErRelationship): string {\n  if (rel.points.length < 2) return ''\n  const parts: string[] = []\n\n  // Entity1 side (first point, direction toward second point)\n  const p1 = rel.points[0]!\n  const p2 = rel.points[1]!\n  parts.push(renderCrowsFoot(p1, p2, rel.cardinality1))\n\n  // Entity2 side (last point, direction toward second-to-last point)\n  const pN = rel.points[rel.points.length - 1]!\n  const pN1 = rel.points[rel.points.length - 2]!\n  parts.push(renderCrowsFoot(pN, pN1, rel.cardinality2))\n\n  return parts.join('\\n')\n}\n\n/**\n * Render a crow's foot marker at a given endpoint.\n * `point` is the endpoint, `toward` gives the direction the line comes from.\n */\nfunction renderCrowsFoot(\n  point: { x: number; y: number },\n  toward: { x: number; y: number },\n  cardinality: Cardinality\n): string {\n  const parts: string[] = []\n  const sw = STROKE_WIDTHS.connector + 0.25\n\n  // Calculate direction from toward  point (unit vector)\n  const dx = point.x - toward.x\n  const dy = point.y - toward.y\n  const len = Math.sqrt(dx * dx + dy * dy)\n  if (len === 0) return ''\n  const ux = dx / len\n  const uy = dy / len\n\n  // Perpendicular direction\n  const px = -uy\n  const py = ux\n\n  // Marker sits 4px from the endpoint, extending 12px back along the edge\n  const tipX = point.x - ux * 4\n  const tipY = point.y - uy * 4\n  const backX = point.x - ux * 16\n  const backY = point.y - uy * 16\n\n  // Single line: always present for 'one' and part of others\n  const hasOneLine = cardinality === 'one' || cardinality === 'zero-one'\n  const hasCrowsFoot = cardinality === 'many' || cardinality === 'zero-many'\n  const hasCircle = cardinality === 'zero-one' || cardinality === 'zero-many'\n\n  // Draw single vertical line (perpendicular to edge) at the tip\n  if (hasOneLine) {\n    const halfW = 6\n    parts.push(\n      `<line x1=\"${tipX + px * halfW}\" y1=\"${tipY + py * halfW}\" ` +\n      `x2=\"${tipX - px * halfW}\" y2=\"${tipY - py * halfW}\" ` +\n      `stroke=\"var(--_line)\" stroke-width=\"${sw}\" />`\n    )\n    // Second line slightly back for \"exactly one\" emphasis\n    const line2X = tipX - ux * 4\n    const line2Y = tipY - uy * 4\n    parts.push(\n      `<line x1=\"${line2X + px * halfW}\" y1=\"${line2Y + py * halfW}\" ` +\n      `x2=\"${line2X - px * halfW}\" y2=\"${line2Y - py * halfW}\" ` +\n      `stroke=\"var(--_line)\" stroke-width=\"${sw}\" />`\n    )\n  }\n\n  // Crow's foot (three lines fanning out from tip)\n  if (hasCrowsFoot) {\n    const fanW = 7\n    // Center line\n    const cfTipX = tipX\n    const cfTipY = tipY\n    // Three lines from tip to back, fanning out\n    parts.push(\n      // Top fan line\n      `<line x1=\"${cfTipX + px * fanW}\" y1=\"${cfTipY + py * fanW}\" ` +\n      `x2=\"${backX}\" y2=\"${backY}\" ` +\n      `stroke=\"var(--_line)\" stroke-width=\"${sw}\" />`\n    )\n    parts.push(\n      // Center line\n      `<line x1=\"${cfTipX}\" y1=\"${cfTipY}\" ` +\n      `x2=\"${backX}\" y2=\"${backY}\" ` +\n      `stroke=\"var(--_line)\" stroke-width=\"${sw}\" />`\n    )\n    parts.push(\n      // Bottom fan line\n      `<line x1=\"${cfTipX - px * fanW}\" y1=\"${cfTipY - py * fanW}\" ` +\n      `x2=\"${backX}\" y2=\"${backY}\" ` +\n      `stroke=\"var(--_line)\" stroke-width=\"${sw}\" />`\n    )\n  }\n\n  // Circle (for zero variants)\n  if (hasCircle) {\n    const circleOffset = hasCrowsFoot ? 20 : 12\n    const circleX = point.x - ux * circleOffset\n    const circleY = point.y - uy * circleOffset\n    parts.push(\n      `<circle cx=\"${circleX}\" cy=\"${circleY}\" r=\"4\" ` +\n      `fill=\"var(--bg)\" stroke=\"var(--_line)\" stroke-width=\"${sw}\" />`\n    )\n  }\n\n  return parts.join('\\n')\n}\n\n/** Compute the arc-length midpoint of a polyline path.\n *  Walks along each segment, finds the point at exactly 50% of total path length.\n *  This ensures the label sits ON the path even for orthogonal routes with bends,\n *  unlike the naive first/last geometric center which floats in space for L/Z shapes. */\nfunction midpoint(points: Array<{ x: number; y: number }>): { x: number; y: number } {\n  if (points.length === 0) return { x: 0, y: 0 }\n  if (points.length === 1) return points[0]!\n\n  // Compute total path length\n  let totalLen = 0\n  for (let i = 1; i < points.length; i++) {\n    const dx = points[i]!.x - points[i - 1]!.x\n    const dy = points[i]!.y - points[i - 1]!.y\n    totalLen += Math.sqrt(dx * dx + dy * dy)\n  }\n\n  if (totalLen === 0) return points[0]!\n\n  // Walk to 50% of total length, interpolating within the segment that crosses the halfway mark\n  const halfLen = totalLen / 2\n  let walked = 0\n  for (let i = 1; i < points.length; i++) {\n    const dx = points[i]!.x - points[i - 1]!.x\n    const dy = points[i]!.y - points[i - 1]!.y\n    const segLen = Math.sqrt(dx * dx + dy * dy)\n    if (walked + segLen >= halfLen) {\n      const t = segLen > 0 ? (halfLen - walked) / segLen : 0\n      return {\n        x: points[i - 1]!.x + dx * t,\n        y: points[i - 1]!.y + dy * t,\n      }\n    }\n    walked += segLen\n  }\n\n  return points[points.length - 1]!\n}\n\n// ============================================================================\n// Utilities\n// ============================================================================\n\nfunction escapeXml(text: string): string {\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;')\n}\n","// ============================================================================\n// beautiful-mermaid  public API\n//\n// Renders Mermaid diagrams to styled SVG strings.\n// Framework-agnostic, no DOM required. Pure TypeScript.\n//\n// Supported diagram types:\n//   - Flowcharts (graph TD / flowchart LR)\n//   - State diagrams (stateDiagram-v2)\n//   - Sequence diagrams (sequenceDiagram)\n//   - Class diagrams (classDiagram)\n//   - ER diagrams (erDiagram)\n//\n// Theming uses CSS custom properties (--bg, --fg, + optional enrichment).\n// See src/theme.ts for the full variable system.\n//\n// Usage:\n//   import { renderMermaid } from 'beautiful-mermaid'\n//   const svg = await renderMermaid('graph TD\\n  A --> B')\n//   const svg = await renderMermaid('graph TD\\n  A --> B', { bg: '#1a1b26', fg: '#a9b1d6' })\n// ============================================================================\n\nexport type { RenderOptions, MermaidGraph, PositionedGraph } from './types.ts'\nexport type { DiagramColors, ThemeName } from './theme.ts'\nexport { fromShikiTheme, THEMES, DEFAULTS } from './theme.ts'\nexport { parseMermaid } from './parser.ts'\nexport { renderMermaidAscii } from './ascii/index.ts'\nexport type { AsciiRenderOptions } from './ascii/index.ts'\n\nimport { parseMermaid } from './parser.ts'\nimport { layoutGraph } from './layout.ts'\nimport { renderSvg } from './renderer.ts'\nimport type { RenderOptions } from './types.ts'\nimport type { DiagramColors } from './theme.ts'\nimport { DEFAULTS } from './theme.ts'\n\n// New diagram type imports\nimport { parseSequenceDiagram } from './sequence/parser.ts'\nimport { layoutSequenceDiagram } from './sequence/layout.ts'\nimport { renderSequenceSvg } from './sequence/renderer.ts'\nimport { parseClassDiagram } from './class/parser.ts'\nimport { layoutClassDiagram } from './class/layout.ts'\nimport { renderClassSvg } from './class/renderer.ts'\nimport { parseErDiagram } from './er/parser.ts'\nimport { layoutErDiagram } from './er/layout.ts'\nimport { renderErSvg } from './er/renderer.ts'\n\n/**\n * Detect the diagram type from the mermaid source text.\n * Returns the type keyword used for routing to the correct pipeline.\n */\nfunction detectDiagramType(text: string): 'flowchart' | 'sequence' | 'class' | 'er' {\n  const firstLine = text.trim().split('\\n')[0]?.trim().toLowerCase() ?? ''\n\n  if (/^sequencediagram\\s*$/.test(firstLine)) return 'sequence'\n  if (/^classdiagram\\s*$/.test(firstLine)) return 'class'\n  if (/^erdiagram\\s*$/.test(firstLine)) return 'er'\n\n  // Default: flowchart/state (handled by parseMermaid internally)\n  return 'flowchart'\n}\n\n/**\n * Build a DiagramColors object from render options.\n * Uses DEFAULTS for bg/fg when not provided, and passes through\n * optional enrichment colors (line, accent, muted, surface, border).\n */\nfunction buildColors(options: RenderOptions): DiagramColors {\n  return {\n    bg: options.bg ?? DEFAULTS.bg,\n    fg: options.fg ?? DEFAULTS.fg,\n    line: options.line,\n    accent: options.accent,\n    muted: options.muted,\n    surface: options.surface,\n    border: options.border,\n  }\n}\n\n/**\n * Render Mermaid diagram text to an SVG string.\n *\n * Async because layout engines run asynchronously.\n * Auto-detects diagram type from the header line.\n *\n * Colors are set via CSS custom properties on the <svg> tag:\n *   - bg/fg: Required base colors (default: white/#27272A)\n *   - line/accent/muted/surface/border: Optional enrichment colors\n *     (fall back to color-mix() derivations from bg+fg)\n *\n * @param text - Mermaid source text\n * @param options - Rendering options (colors, font, spacing)\n * @returns A self-contained SVG string\n *\n * @example\n * ```ts\n * // Mono  just defaults, everything derived from bg+fg\n * const svg = await renderMermaid('graph TD\\n  A --> B')\n *\n * // Custom colors\n * const svg = await renderMermaid('graph TD\\n  A --> B', {\n *   bg: '#1a1b26', fg: '#a9b1d6'\n * })\n *\n * // Enriched  Tokyo Night with accent + line colors\n * const svg = await renderMermaid('graph TD\\n  A --> B', {\n *   bg: '#1a1b26', fg: '#a9b1d6',\n *   line: '#3d59a1', accent: '#7aa2f7', muted: '#565f89',\n * })\n * ```\n */\nexport async function renderMermaid(\n  text: string,\n  options: RenderOptions = {}\n): Promise<string> {\n  const colors = buildColors(options)\n  const font = options.font ?? 'Inter'\n  const transparent = options.transparent ?? false\n  const diagramType = detectDiagramType(text)\n\n  // Preprocess: strip leading/trailing whitespace, filter comments\n  const lines = text.split('\\n').map(l => l.trim()).filter(l => l.length > 0 && !l.startsWith('%%'))\n\n  switch (diagramType) {\n    case 'sequence': {\n      const diagram = parseSequenceDiagram(lines)\n      const positioned = layoutSequenceDiagram(diagram, options)\n      return renderSequenceSvg(positioned, colors, font, transparent)\n    }\n    case 'class': {\n      const diagram = parseClassDiagram(lines)\n      const positioned = await layoutClassDiagram(diagram, options)\n      return renderClassSvg(positioned, colors, font, transparent)\n    }\n    case 'er': {\n      const diagram = parseErDiagram(lines)\n      const positioned = await layoutErDiagram(diagram, options)\n      return renderErSvg(positioned, colors, font, transparent)\n    }\n    case 'flowchart':\n    default: {\n      // Flowchart + state diagram pipeline (original)\n      const graph = parseMermaid(text)\n      const positioned = await layoutGraph(graph, options)\n      return renderSvg(positioned, colors, font, transparent)\n    }\n  }\n}\n","// ============================================================================\n// Browser entry point for beautiful-mermaid\n//\n// This file serves two purposes:\n//\n// 1. CDN bundle (via tsup IIFE build):\n//    Exposes `window.beautifulMermaid` with all public APIs for <script> tags.\n//    Usage:\n//      <script src=\"https://unpkg.com/beautiful-mermaid/dist/beautiful-mermaid.browser.global.js\"></script>\n//      <script>\n//        const { renderMermaid, THEMES } = beautifulMermaid;\n//        renderMermaid('graph TD\\n  A --> B').then(svg => { ... });\n//      </script>\n//\n// 2. Internal samples page (via Bun.build in index.ts):\n//    Also sets `window.__mermaid` for the dynamically generated samples HTML.\n// ============================================================================\n\nimport { renderMermaid } from './index.ts'\nimport { renderMermaidAscii } from './ascii/index.ts'\nimport { THEMES, DEFAULTS, fromShikiTheme } from './theme.ts'\n\n// Re-export for tsup IIFE bundle (creates window.beautifulMermaid)\nexport { renderMermaid, renderMermaidAscii, THEMES, DEFAULTS, fromShikiTheme }\nexport type { RenderOptions } from './types.ts'\nexport type { AsciiRenderOptions } from './ascii/index.ts'\nexport type { DiagramColors, ThemeName } from './theme.ts'\n\n// Also set window.__mermaid for internal samples page (Bun.build uses ESM format)\nif (typeof window !== 'undefined') {\n  ;(window as unknown as Record<string, unknown>).__mermaid = {\n    renderMermaid,\n    renderMermaidAscii,\n    THEMES,\n    DEFAULTS,\n    fromShikiTheme,\n  }\n}\n"]}